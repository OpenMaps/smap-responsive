if(!function(t){if("object"==typeof exports)module.exports=t();else if("function"==typeof define&&define.amd)define(t);else{var e;"undefined"!=typeof window?e=window:"undefined"!=typeof global?e=global:"undefined"!=typeof self&&(e=self),e.proj4=t()}}(function(){return function t(e,i,n){function s(o,a){if(!i[o]){if(!e[o]){var l="function"==typeof require&&require;if(!a&&l)return l(o,!0);if(r)return r(o,!0);throw new Error("Cannot find module '"+o+"'")}var h=i[o]={exports:{}};e[o][0].call(h.exports,function(t){var i=e[o][1][t];return s(i?i:t)},h,h.exports,t,e,i,n)}return i[o].exports}for(var r="function"==typeof require&&require,o=0;o<n.length;o++)s(n[o]);return s}({1:[function(t,e){function i(t,e,n){if(!(this instanceof i))return new i(t,e,n);if(Array.isArray(t))this.x=t[0],this.y=t[1],this.z=t[2]||0;else if("object"==typeof t)this.x=t.x,this.y=t.y,this.z=t.z||0;else if("string"==typeof t&&"undefined"==typeof e){var s=t.split(",");this.x=parseFloat(s[0],10),this.y=parseFloat(s[1],10),this.z=parseFloat(s[2],10)||0}else this.x=t,this.y=e,this.z=n||0;console.warn("proj4.Point will be removed in version 3, use proj4.toPoint")}var n=t("mgrs");i.fromMGRS=function(t){return new i(n.toPoint(t))},i.prototype.toMGRS=function(t){return n.forward([this.x,this.y],t)},e.exports=i},{mgrs:66}],2:[function(t,e){function i(t,e){if(!(this instanceof i))return new i(t);e=e||function(t){if(t)throw t};var r=n(t);if("object"!=typeof r)return void e(t);var a=o(r),l=i.projections.get(a.projName);l?(s(this,a),s(this,l),this.init(),e(null,this)):e(t)}var n=t("./parseCode"),s=t("./extend"),r=t("./projections"),o=t("./deriveConstants");i.projections=r,i.projections.start(),e.exports=i},{"./deriveConstants":32,"./extend":33,"./parseCode":36,"./projections":38}],3:[function(t,e){e.exports=function(t,e,i){var n,s,r,o=i.x,a=i.y,l=i.z||0;for(r=0;3>r;r++)if(!e||2!==r||void 0!==i.z)switch(0===r?(n=o,s="x"):1===r?(n=a,s="y"):(n=l,s="z"),t.axis[r]){case"e":i[s]=n;break;case"w":i[s]=-n;break;case"n":i[s]=n;break;case"s":i[s]=-n;break;case"u":void 0!==i[s]&&(i.z=n);break;case"d":void 0!==i[s]&&(i.z=-n);break;default:return null}return i}},{}],4:[function(t,e){var i=Math.PI/2,n=t("./sign");e.exports=function(t){return Math.abs(t)<i?t:t-n(t)*Math.PI}},{"./sign":21}],5:[function(t,e){var i=2*Math.PI,n=t("./sign");e.exports=function(t){return Math.abs(t)<Math.PI?t:t-n(t)*i}},{"./sign":21}],6:[function(t,e){e.exports=function(t){return Math.abs(t)>1&&(t=t>1?1:-1),Math.asin(t)}},{}],7:[function(t,e){e.exports=function(t){return 1-.25*t*(1+t/16*(3+1.25*t))}},{}],8:[function(t,e){e.exports=function(t){return.375*t*(1+.25*t*(1+.46875*t))}},{}],9:[function(t,e){e.exports=function(t){return.05859375*t*t*(1+.75*t)}},{}],10:[function(t,e){e.exports=function(t){return t*t*t*(35/3072)}},{}],11:[function(t,e){e.exports=function(t,e,i){var n=e*i;return t/Math.sqrt(1-n*n)}},{}],12:[function(t,e){e.exports=function(t,e,i,n,s){var r,o;r=t/e;for(var a=0;15>a;a++)if(o=(t-(e*r-i*Math.sin(2*r)+n*Math.sin(4*r)-s*Math.sin(6*r)))/(e-2*i*Math.cos(2*r)+4*n*Math.cos(4*r)-6*s*Math.cos(6*r)),r+=o,Math.abs(o)<=1e-10)return r;return 0/0}},{}],13:[function(t,e){var i=Math.PI/2;e.exports=function(t,e){var n=1-(1-t*t)/(2*t)*Math.log((1-t)/(1+t));if(Math.abs(Math.abs(e)-n)<1e-6)return 0>e?-1*i:i;for(var s,r,o,a,l=Math.asin(.5*e),h=0;30>h;h++)if(r=Math.sin(l),o=Math.cos(l),a=t*r,s=Math.pow(1-a*a,2)/(2*o)*(e/(1-t*t)-r/(1-a*a)+.5/t*Math.log((1-a)/(1+a))),l+=s,Math.abs(s)<=1e-10)return l;return 0/0}},{}],14:[function(t,e){e.exports=function(t,e,i,n,s){return t*s-e*Math.sin(2*s)+i*Math.sin(4*s)-n*Math.sin(6*s)}},{}],15:[function(t,e){e.exports=function(t,e,i){var n=t*e;return i/Math.sqrt(1-n*n)}},{}],16:[function(t,e){var i=Math.PI/2;e.exports=function(t,e){for(var n,s,r=.5*t,o=i-2*Math.atan(e),a=0;15>=a;a++)if(n=t*Math.sin(o),s=i-2*Math.atan(e*Math.pow((1-n)/(1+n),r))-o,o+=s,Math.abs(s)<=1e-10)return o;return-9999}},{}],17:[function(t,e){var i=1,n=.25,s=.046875,r=.01953125,o=.01068115234375,a=.75,l=.46875,h=.013020833333333334,u=.007120768229166667,p=.3645833333333333,c=.005696614583333333,d=.3076171875;e.exports=function(t){var e=[];e[0]=i-t*(n+t*(s+t*(r+t*o))),e[1]=t*(a-t*(s+t*(r+t*o)));var m=t*t;return e[2]=m*(l-t*(h+t*u)),m*=t,e[3]=m*(p-t*c),e[4]=m*t*d,e}},{}],18:[function(t,e){var i=t("./pj_mlfn"),n=1e-10,s=20;e.exports=function(t,e,r){for(var o=1/(1-e),a=t,l=s;l;--l){var h=Math.sin(a),u=1-e*h*h;if(u=(i(a,h,Math.cos(a),r)-t)*u*Math.sqrt(u)*o,a-=u,Math.abs(u)<n)return a}return a}},{"./pj_mlfn":19}],19:[function(t,e){e.exports=function(t,e,i,n){return i*=e,e*=e,n[0]*t-i*(n[1]+e*(n[2]+e*(n[3]+e*n[4])))}},{}],20:[function(t,e){e.exports=function(t,e){var i;return t>1e-7?(i=t*e,(1-t*t)*(e/(1-i*i)-.5/t*Math.log((1-i)/(1+i)))):2*e}},{}],21:[function(t,e){e.exports=function(t){return 0>t?-1:1}},{}],22:[function(t,e){e.exports=function(t,e){return Math.pow((1-t)/(1+t),e)}},{}],23:[function(t,e){e.exports=function(t){var e={x:t[0],y:t[1]};return t.length>2&&(e.z=t[2]),t.length>3&&(e.m=t[3]),e}},{}],24:[function(t,e){var i=Math.PI/2;e.exports=function(t,e,n){var s=t*n,r=.5*t;return s=Math.pow((1-s)/(1+s),r),Math.tan(.5*(i-e))/s}},{}],25:[function(t,e,i){i.wgs84={towgs84:"0,0,0",ellipse:"WGS84",datumName:"WGS84"},i.ch1903={towgs84:"674.374,15.056,405.346",ellipse:"bessel",datumName:"swiss"},i.ggrs87={towgs84:"-199.87,74.79,246.62",ellipse:"GRS80",datumName:"Greek_Geodetic_Reference_System_1987"},i.nad83={towgs84:"0,0,0",ellipse:"GRS80",datumName:"North_American_Datum_1983"},i.nad27={nadgrids:"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat",ellipse:"clrk66",datumName:"North_American_Datum_1927"},i.potsdam={towgs84:"606.0,23.0,413.0",ellipse:"bessel",datumName:"Potsdam Rauenberg 1950 DHDN"},i.carthage={towgs84:"-263.0,6.0,431.0",ellipse:"clark80",datumName:"Carthage 1934 Tunisia"},i.hermannskogel={towgs84:"653.0,-212.0,449.0",ellipse:"bessel",datumName:"Hermannskogel"},i.ire65={towgs84:"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15",ellipse:"mod_airy",datumName:"Ireland 1965"},i.rassadiran={towgs84:"-133.63,-157.5,-158.62",ellipse:"intl",datumName:"Rassadiran"},i.nzgd49={towgs84:"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993",ellipse:"intl",datumName:"New Zealand Geodetic Datum 1949"},i.osgb36={towgs84:"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894",ellipse:"airy",datumName:"Airy 1830"},i.s_jtsk={towgs84:"589,76,480",ellipse:"bessel",datumName:"S-JTSK (Ferro)"},i.beduaram={towgs84:"-106,-87,188",ellipse:"clrk80",datumName:"Beduaram"},i.gunung_segara={towgs84:"-403,684,41",ellipse:"bessel",datumName:"Gunung Segara Jakarta"},i.rnb72={towgs84:"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1",ellipse:"intl",datumName:"Reseau National Belge 1972"}},{}],26:[function(t,e,i){i.MERIT={a:6378137,rf:298.257,ellipseName:"MERIT 1983"},i.SGS85={a:6378136,rf:298.257,ellipseName:"Soviet Geodetic System 85"},i.GRS80={a:6378137,rf:298.257222101,ellipseName:"GRS 1980(IUGG, 1980)"},i.IAU76={a:6378140,rf:298.257,ellipseName:"IAU 1976"},i.airy={a:6377563.396,b:6356256.91,ellipseName:"Airy 1830"},i.APL4={a:6378137,rf:298.25,ellipseName:"Appl. Physics. 1965"},i.NWL9D={a:6378145,rf:298.25,ellipseName:"Naval Weapons Lab., 1965"},i.mod_airy={a:6377340.189,b:6356034.446,ellipseName:"Modified Airy"},i.andrae={a:6377104.43,rf:300,ellipseName:"Andrae 1876 (Den., Iclnd.)"},i.aust_SA={a:6378160,rf:298.25,ellipseName:"Australian Natl & S. Amer. 1969"},i.GRS67={a:6378160,rf:298.247167427,ellipseName:"GRS 67(IUGG 1967)"},i.bessel={a:6377397.155,rf:299.1528128,ellipseName:"Bessel 1841"},i.bess_nam={a:6377483.865,rf:299.1528128,ellipseName:"Bessel 1841 (Namibia)"},i.clrk66={a:6378206.4,b:6356583.8,ellipseName:"Clarke 1866"},i.clrk80={a:6378249.145,rf:293.4663,ellipseName:"Clarke 1880 mod."},i.clrk58={a:6378293.645208759,rf:294.2606763692654,ellipseName:"Clarke 1858"},i.CPM={a:6375738.7,rf:334.29,ellipseName:"Comm. des Poids et Mesures 1799"},i.delmbr={a:6376428,rf:311.5,ellipseName:"Delambre 1810 (Belgium)"},i.engelis={a:6378136.05,rf:298.2566,ellipseName:"Engelis 1985"},i.evrst30={a:6377276.345,rf:300.8017,ellipseName:"Everest 1830"},i.evrst48={a:6377304.063,rf:300.8017,ellipseName:"Everest 1948"},i.evrst56={a:6377301.243,rf:300.8017,ellipseName:"Everest 1956"},i.evrst69={a:6377295.664,rf:300.8017,ellipseName:"Everest 1969"},i.evrstSS={a:6377298.556,rf:300.8017,ellipseName:"Everest (Sabah & Sarawak)"},i.fschr60={a:6378166,rf:298.3,ellipseName:"Fischer (Mercury Datum) 1960"},i.fschr60m={a:6378155,rf:298.3,ellipseName:"Fischer 1960"},i.fschr68={a:6378150,rf:298.3,ellipseName:"Fischer 1968"},i.helmert={a:6378200,rf:298.3,ellipseName:"Helmert 1906"},i.hough={a:6378270,rf:297,ellipseName:"Hough"},i.intl={a:6378388,rf:297,ellipseName:"International 1909 (Hayford)"},i.kaula={a:6378163,rf:298.24,ellipseName:"Kaula 1961"},i.lerch={a:6378139,rf:298.257,ellipseName:"Lerch 1979"},i.mprts={a:6397300,rf:191,ellipseName:"Maupertius 1738"},i.new_intl={a:6378157.5,b:6356772.2,ellipseName:"New International 1967"},i.plessis={a:6376523,rf:6355863,ellipseName:"Plessis 1817 (France)"},i.krass={a:6378245,rf:298.3,ellipseName:"Krassovsky, 1942"},i.SEasia={a:6378155,b:6356773.3205,ellipseName:"Southeast Asia"},i.walbeck={a:6376896,b:6355834.8467,ellipseName:"Walbeck"},i.WGS60={a:6378165,rf:298.3,ellipseName:"WGS 60"},i.WGS66={a:6378145,rf:298.25,ellipseName:"WGS 66"},i.WGS7={a:6378135,rf:298.26,ellipseName:"WGS 72"},i.WGS84={a:6378137,rf:298.257223563,ellipseName:"WGS 84"},i.sphere={a:6370997,b:6370997,ellipseName:"Normal Sphere (r=6370997)"}},{}],27:[function(t,e,i){i.greenwich=0,i.lisbon=-9.131906111111,i.paris=2.337229166667,i.bogota=-74.080916666667,i.madrid=-3.687938888889,i.rome=12.452333333333,i.bern=7.439583333333,i.jakarta=106.807719444444,i.ferro=-17.666666666667,i.brussels=4.367975,i.stockholm=18.058277777778,i.athens=23.7163375,i.oslo=10.722916666667},{}],28:[function(t,e){function i(t,e,i){var n;return Array.isArray(i)?(n=o(t,e,i),3===i.length?[n.x,n.y,n.z]:[n.x,n.y]):o(t,e,i)}function n(t){return t instanceof r?t:t.oProj?t.oProj:r(t)}function s(t,e,s){t=n(t);var r,o=!1;return"undefined"==typeof e?(e=t,t=a,o=!0):("undefined"!=typeof e.x||Array.isArray(e))&&(s=e,e=t,t=a,o=!0),e=n(e),s?i(t,e,s):(r={forward:function(n){return i(t,e,n)},inverse:function(n){return i(e,t,n)}},o&&(r.oProj=e),r)}var r=t("./Proj"),o=t("./transform"),a=r("WGS84");e.exports=s},{"./Proj":2,"./transform":64}],29:[function(t,e){var i=Math.PI/2,n=1,s=2,r=3,o=4,a=5,l=484813681109536e-20,h=1.0026,u=.3826834323650898,p=function(t){if(!(this instanceof p))return new p(t);if(this.datum_type=o,t){if(t.datumCode&&"none"===t.datumCode&&(this.datum_type=a),t.datum_params){for(var e=0;e<t.datum_params.length;e++)t.datum_params[e]=parseFloat(t.datum_params[e]);(0!==t.datum_params[0]||0!==t.datum_params[1]||0!==t.datum_params[2])&&(this.datum_type=n),t.datum_params.length>3&&(0!==t.datum_params[3]||0!==t.datum_params[4]||0!==t.datum_params[5]||0!==t.datum_params[6])&&(this.datum_type=s,t.datum_params[3]*=l,t.datum_params[4]*=l,t.datum_params[5]*=l,t.datum_params[6]=t.datum_params[6]/1e6+1)}this.datum_type=t.grids?r:this.datum_type,this.a=t.a,this.b=t.b,this.es=t.es,this.ep2=t.ep2,this.datum_params=t.datum_params,this.datum_type===r&&(this.grids=t.grids)}};p.prototype={compare_datums:function(t){return this.datum_type!==t.datum_type?!1:this.a!==t.a||Math.abs(this.es-t.es)>5e-11?!1:this.datum_type===n?this.datum_params[0]===t.datum_params[0]&&this.datum_params[1]===t.datum_params[1]&&this.datum_params[2]===t.datum_params[2]:this.datum_type===s?this.datum_params[0]===t.datum_params[0]&&this.datum_params[1]===t.datum_params[1]&&this.datum_params[2]===t.datum_params[2]&&this.datum_params[3]===t.datum_params[3]&&this.datum_params[4]===t.datum_params[4]&&this.datum_params[5]===t.datum_params[5]&&this.datum_params[6]===t.datum_params[6]:this.datum_type===r||t.datum_type===r?this.nadgrids===t.nadgrids:!0},geodetic_to_geocentric:function(t){var e,n,s,r,o,a,l,h=t.x,u=t.y,p=t.z?t.z:0,c=0;if(-i>u&&u>-1.001*i)u=-i;else if(u>i&&1.001*i>u)u=i;else if(-i>u||u>i)return null;return h>Math.PI&&(h-=2*Math.PI),o=Math.sin(u),l=Math.cos(u),a=o*o,r=this.a/Math.sqrt(1-this.es*a),e=(r+p)*l*Math.cos(h),n=(r+p)*l*Math.sin(h),s=(r*(1-this.es)+p)*o,t.x=e,t.y=n,t.z=s,c},geocentric_to_geodetic:function(t){var e,n,s,r,o,a,l,h,u,p,c,d,m,f,y,g,v,L=1e-12,_=L*L,O=30,b=t.x,w=t.y,x=t.z?t.z:0;if(m=!1,e=Math.sqrt(b*b+w*w),n=Math.sqrt(b*b+w*w+x*x),e/this.a<L){if(m=!0,y=0,n/this.a<L)return g=i,void(v=-this.b)}else y=Math.atan2(w,b);s=x/n,r=e/n,o=1/Math.sqrt(1-this.es*(2-this.es)*r*r),h=r*(1-this.es)*o,u=s*o,f=0;do f++,l=this.a/Math.sqrt(1-this.es*u*u),v=e*h+x*u-l*(1-this.es*u*u),a=this.es*l/(l+v),o=1/Math.sqrt(1-a*(2-a)*r*r),p=r*(1-a)*o,c=s*o,d=c*h-p*u,h=p,u=c;while(d*d>_&&O>f);return g=Math.atan(c/Math.abs(p)),t.x=y,t.y=g,t.z=v,t},geocentric_to_geodetic_noniter:function(t){var e,n,s,r,o,a,l,p,c,d,m,f,y,g,v,L,_,O=t.x,b=t.y,w=t.z?t.z:0;if(O=parseFloat(O),b=parseFloat(b),w=parseFloat(w),_=!1,0!==O)e=Math.atan2(b,O);else if(b>0)e=i;else if(0>b)e=-i;else if(_=!0,e=0,w>0)n=i;else{if(!(0>w))return n=i,void(s=-this.b);n=-i}return o=O*O+b*b,r=Math.sqrt(o),a=w*h,p=Math.sqrt(a*a+o),d=a/p,f=r/p,m=d*d*d,l=w+this.b*this.ep2*m,L=r-this.a*this.es*f*f*f,c=Math.sqrt(l*l+L*L),y=l/c,g=L/c,v=this.a/Math.sqrt(1-this.es*y*y),s=g>=u?r/g-v:-u>=g?r/-g-v:w/y+v*(this.es-1),_===!1&&(n=Math.atan(y/g)),t.x=e,t.y=n,t.z=s,t},geocentric_to_wgs84:function(t){if(this.datum_type===n)t.x+=this.datum_params[0],t.y+=this.datum_params[1],t.z+=this.datum_params[2];else if(this.datum_type===s){var e=this.datum_params[0],i=this.datum_params[1],r=this.datum_params[2],o=this.datum_params[3],a=this.datum_params[4],l=this.datum_params[5],h=this.datum_params[6],u=h*(t.x-l*t.y+a*t.z)+e,p=h*(l*t.x+t.y-o*t.z)+i,c=h*(-a*t.x+o*t.y+t.z)+r;t.x=u,t.y=p,t.z=c}},geocentric_from_wgs84:function(t){if(this.datum_type===n)t.x-=this.datum_params[0],t.y-=this.datum_params[1],t.z-=this.datum_params[2];else if(this.datum_type===s){var e=this.datum_params[0],i=this.datum_params[1],r=this.datum_params[2],o=this.datum_params[3],a=this.datum_params[4],l=this.datum_params[5],h=this.datum_params[6],u=(t.x-e)/h,p=(t.y-i)/h,c=(t.z-r)/h;t.x=u+l*p-a*c,t.y=-l*u+p+o*c,t.z=a*u-o*p+c}}},e.exports=p},{}],30:[function(t,e){var i=1,n=2,s=3,r=5,o=6378137,a=.006694379990141316;e.exports=function(t,e,l){function h(t){return t===i||t===n}var u,p,c;if(t.compare_datums(e))return l;if(t.datum_type===r||e.datum_type===r)return l;var d=t.a,m=t.es,f=e.a,y=e.es,g=t.datum_type;if(g===s)if(0===this.apply_gridshift(t,0,l))t.a=o,t.es=a;else{if(!t.datum_params)return t.a=d,t.es=t.es,l;for(u=1,p=0,c=t.datum_params.length;c>p;p++)u*=t.datum_params[p];if(0===u)return t.a=d,t.es=t.es,l;g=t.datum_params.length>3?n:i}return e.datum_type===s&&(e.a=o,e.es=a),(t.es!==e.es||t.a!==e.a||h(g)||h(e.datum_type))&&(t.geodetic_to_geocentric(l),h(t.datum_type)&&t.geocentric_to_wgs84(l),h(e.datum_type)&&e.geocentric_from_wgs84(l),e.geocentric_to_geodetic(l)),e.datum_type===s&&this.apply_gridshift(e,1,l),t.a=d,t.es=m,e.a=f,e.es=y,l}},{}],31:[function(t,e){function i(t){var e=this;if(2===arguments.length)i[t]="+"===arguments[1][0]?s(arguments[1]):r(arguments[1]);else if(1===arguments.length)return Array.isArray(t)?t.map(function(t){Array.isArray(t)?i.apply(e,t):i(t)}):void("string"==typeof t||("EPSG"in t?i["EPSG:"+t.EPSG]=t:"ESRI"in t?i["ESRI:"+t.ESRI]=t:"IAU2000"in t?i["IAU2000:"+t.IAU2000]=t:console.log(t)))}var n=t("./global"),s=t("./projString"),r=t("./wkt");n(i),e.exports=i},{"./global":34,"./projString":37,"./wkt":65}],32:[function(t,e){var i=t("./constants/Datum"),n=t("./constants/Ellipsoid"),s=t("./extend"),r=t("./datum"),o=1e-10,a=.16666666666666666,l=.04722222222222222,h=.022156084656084655;e.exports=function(t){if(t.datumCode&&"none"!==t.datumCode){var e=i[t.datumCode];e&&(t.datum_params=e.towgs84?e.towgs84.split(","):null,t.ellps=e.ellipse,t.datumName=e.datumName?e.datumName:t.datumCode)}if(!t.a){var u=n[t.ellps]?n[t.ellps]:n.WGS84;s(t,u)}return t.rf&&!t.b&&(t.b=(1-1/t.rf)*t.a),(0===t.rf||Math.abs(t.a-t.b)<o)&&(t.sphere=!0,t.b=t.a),t.a2=t.a*t.a,t.b2=t.b*t.b,t.es=(t.a2-t.b2)/t.a2,t.e=Math.sqrt(t.es),t.R_A&&(t.a*=1-t.es*(a+t.es*(l+t.es*h)),t.a2=t.a*t.a,t.b2=t.b*t.b,t.es=0),t.ep2=(t.a2-t.b2)/t.b2,t.k0||(t.k0=1),t.axis||(t.axis="enu"),t.datum=r(t),t}},{"./constants/Datum":25,"./constants/Ellipsoid":26,"./datum":29,"./extend":33}],33:[function(t,e){e.exports=function(t,e){t=t||{};var i,n;if(!e)return t;for(n in e)i=e[n],void 0!==i&&(t[n]=i);return t}},{}],34:[function(t,e){e.exports=function(t){t("WGS84","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),t("EPSG:4326","+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees"),t("EPSG:4269","+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees"),t("EPSG:3857","+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs"),t["EPSG:3785"]=t["EPSG:3857"],t.GOOGLE=t["EPSG:3857"],t["EPSG:900913"]=t["EPSG:3857"],t["EPSG:102113"]=t["EPSG:3857"]}},{}],35:[function(t,e){var i=t("./core");i.defaultDatum="WGS84",i.Proj=t("./Proj"),i.WGS84=new i.Proj("WGS84"),i.Point=t("./Point"),i.toPoint=t("./common/toPoint"),i.defs=t("./defs"),i.transform=t("./transform"),i.mgrs=t("mgrs"),i.version=t("../package.json").version,t("./includedProjections")(i),e.exports=i},{"../package.json":67,"./Point":1,"./Proj":2,"./common/toPoint":23,"./core":28,"./defs":31,"./includedProjections":"gWUPNW","./transform":64,mgrs:66}],36:[function(t,e){function i(t){return"string"==typeof t}function n(t){return t in a}function s(t){var e=["GEOGCS","GEOCCS","PROJCS","LOCAL_CS"];return e.reduce(function(e,i){return e+1+t.indexOf(i)},0)}function r(t){return"+"===t[0]}function o(t){return i(t)?n(t)?a[t]:s(t)?l(t):r(t)?h(t):void 0:t}var a=t("./defs"),l=t("./wkt"),h=t("./projString");e.exports=o},{"./defs":31,"./projString":37,"./wkt":65}],37:[function(t,e){var i=.017453292519943295,n=t("./constants/PrimeMeridian");e.exports=function(t){var e={},s={};t.split("+").map(function(t){return t.trim()}).filter(function(t){return t}).forEach(function(t){var e=t.split("=");e.push(!0),s[e[0].toLowerCase()]=e[1]});var r,o,a,l={proj:"projName",datum:"datumCode",rf:function(t){e.rf=parseFloat(t,10)},lat_0:function(t){e.lat0=t*i},lat_1:function(t){e.lat1=t*i},lat_2:function(t){e.lat2=t*i},lat_ts:function(t){e.lat_ts=t*i},lon_0:function(t){e.long0=t*i},lon_1:function(t){e.long1=t*i},lon_2:function(t){e.long2=t*i},alpha:function(t){e.alpha=parseFloat(t)*i},lonc:function(t){e.longc=t*i},x_0:function(t){e.x0=parseFloat(t,10)},y_0:function(t){e.y0=parseFloat(t,10)},k_0:function(t){e.k0=parseFloat(t,10)},k:function(t){e.k0=parseFloat(t,10)},r_a:function(){e.R_A=!0},zone:function(t){e.zone=parseInt(t,10)},south:function(){e.utmSouth=!0},towgs84:function(t){e.datum_params=t.split(",").map(function(t){return parseFloat(t,10)})},to_meter:function(t){e.to_meter=parseFloat(t,10)},from_greenwich:function(t){e.from_greenwich=t*i},pm:function(t){e.from_greenwich=(n[t]?n[t]:parseFloat(t,10))*i},nadgrids:function(t){"@null"===t?e.datumCode="none":e.nadgrids=t},axis:function(t){var i="ewnsud";3===t.length&&-1!==i.indexOf(t.substr(0,1))&&-1!==i.indexOf(t.substr(1,1))&&-1!==i.indexOf(t.substr(2,1))&&(e.axis=t)}};for(r in s)o=s[r],r in l?(a=l[r],"function"==typeof a?a(o):e[a]=o):e[r]=o;return"string"==typeof e.datumCode&&"WGS84"!==e.datumCode&&(e.datumCode=e.datumCode.toLowerCase()),e}},{"./constants/PrimeMeridian":27}],38:[function(t,e,i){function n(t,e){var i=o.length;return t.names?(o[i]=t,t.names.forEach(function(t){r[t.toLowerCase()]=i}),this):(console.log(e),!0)}var s=[t("./projections/merc"),t("./projections/longlat")],r={},o=[];i.add=n,i.get=function(t){if(!t)return!1;var e=t.toLowerCase();return"undefined"!=typeof r[e]&&o[r[e]]?o[r[e]]:void 0},i.start=function(){s.forEach(n)}},{"./projections/longlat":50,"./projections/merc":51}],39:[function(t,e,i){var n=1e-10,s=t("../common/msfnz"),r=t("../common/qsfnz"),o=t("../common/adjust_lon"),a=t("../common/asinz");i.init=function(){Math.abs(this.lat1+this.lat2)<n||(this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e3=Math.sqrt(this.es),this.sin_po=Math.sin(this.lat1),this.cos_po=Math.cos(this.lat1),this.t1=this.sin_po,this.con=this.sin_po,this.ms1=s(this.e3,this.sin_po,this.cos_po),this.qs1=r(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat2),this.cos_po=Math.cos(this.lat2),this.t2=this.sin_po,this.ms2=s(this.e3,this.sin_po,this.cos_po),this.qs2=r(this.e3,this.sin_po,this.cos_po),this.sin_po=Math.sin(this.lat0),this.cos_po=Math.cos(this.lat0),this.t3=this.sin_po,this.qs0=r(this.e3,this.sin_po,this.cos_po),this.ns0=Math.abs(this.lat1-this.lat2)>n?(this.ms1*this.ms1-this.ms2*this.ms2)/(this.qs2-this.qs1):this.con,this.c=this.ms1*this.ms1+this.ns0*this.qs1,this.rh=this.a*Math.sqrt(this.c-this.ns0*this.qs0)/this.ns0)},i.forward=function(t){var e=t.x,i=t.y;this.sin_phi=Math.sin(i),this.cos_phi=Math.cos(i);var n=r(this.e3,this.sin_phi,this.cos_phi),s=this.a*Math.sqrt(this.c-this.ns0*n)/this.ns0,a=this.ns0*o(e-this.long0),l=s*Math.sin(a)+this.x0,h=this.rh-s*Math.cos(a)+this.y0;return t.x=l,t.y=h,t},i.inverse=function(t){var e,i,n,s,r,a;return t.x-=this.x0,t.y=this.rh-t.y+this.y0,this.ns0>=0?(e=Math.sqrt(t.x*t.x+t.y*t.y),n=1):(e=-Math.sqrt(t.x*t.x+t.y*t.y),n=-1),s=0,0!==e&&(s=Math.atan2(n*t.x,n*t.y)),n=e*this.ns0/this.a,this.sphere?a=Math.asin((this.c-n*n)/(2*this.ns0)):(i=(this.c-n*n)/this.ns0,a=this.phi1z(this.e3,i)),r=o(s/this.ns0+this.long0),t.x=r,t.y=a,t},i.phi1z=function(t,e){var i,s,r,o,l,h=a(.5*e);if(n>t)return h;for(var u=t*t,p=1;25>=p;p++)if(i=Math.sin(h),s=Math.cos(h),r=t*i,o=1-r*r,l=.5*o*o/s*(e/(1-u)-i/o+.5/t*Math.log((1-r)/(1+r))),h+=l,Math.abs(l)<=1e-7)return h;return null},i.names=["Albers_Conic_Equal_Area","Albers","aea"]},{"../common/adjust_lon":5,"../common/asinz":6,"../common/msfnz":15,"../common/qsfnz":20}],40:[function(t,e,i){var n=t("../common/adjust_lon"),s=Math.PI/2,r=1e-10,o=t("../common/mlfn"),a=t("../common/e0fn"),l=t("../common/e1fn"),h=t("../common/e2fn"),u=t("../common/e3fn"),p=t("../common/gN"),c=t("../common/asinz"),d=t("../common/imlfn");i.init=function(){this.sin_p12=Math.sin(this.lat0),this.cos_p12=Math.cos(this.lat0)},i.forward=function(t){var e,i,c,d,m,f,y,g,v,L,_,O,b,w,x,S,C,E,P,M,N,T,A,k=t.x,D=t.y,F=Math.sin(t.y),I=Math.cos(t.y),R=n(k-this.long0);return this.sphere?Math.abs(this.sin_p12-1)<=r?(t.x=this.x0+this.a*(s-D)*Math.sin(R),t.y=this.y0-this.a*(s-D)*Math.cos(R),t):Math.abs(this.sin_p12+1)<=r?(t.x=this.x0+this.a*(s+D)*Math.sin(R),t.y=this.y0+this.a*(s+D)*Math.cos(R),t):(E=this.sin_p12*F+this.cos_p12*I*Math.cos(R),S=Math.acos(E),C=S/Math.sin(S),t.x=this.x0+this.a*C*I*Math.sin(R),t.y=this.y0+this.a*C*(this.cos_p12*F-this.sin_p12*I*Math.cos(R)),t):(e=a(this.es),i=l(this.es),c=h(this.es),d=u(this.es),Math.abs(this.sin_p12-1)<=r?(m=this.a*o(e,i,c,d,s),f=this.a*o(e,i,c,d,D),t.x=this.x0+(m-f)*Math.sin(R),t.y=this.y0-(m-f)*Math.cos(R),t):Math.abs(this.sin_p12+1)<=r?(m=this.a*o(e,i,c,d,s),f=this.a*o(e,i,c,d,D),t.x=this.x0+(m+f)*Math.sin(R),t.y=this.y0+(m+f)*Math.cos(R),t):(y=F/I,g=p(this.a,this.e,this.sin_p12),v=p(this.a,this.e,F),L=Math.atan((1-this.es)*y+this.es*g*this.sin_p12/(v*I)),_=Math.atan2(Math.sin(R),this.cos_p12*Math.tan(L)-this.sin_p12*Math.cos(R)),P=0===_?Math.asin(this.cos_p12*Math.sin(L)-this.sin_p12*Math.cos(L)):Math.abs(Math.abs(_)-Math.PI)<=r?-Math.asin(this.cos_p12*Math.sin(L)-this.sin_p12*Math.cos(L)):Math.asin(Math.sin(R)*Math.cos(L)/Math.sin(_)),O=this.e*this.sin_p12/Math.sqrt(1-this.es),b=this.e*this.cos_p12*Math.cos(_)/Math.sqrt(1-this.es),w=O*b,x=b*b,M=P*P,N=M*P,T=N*P,A=T*P,S=g*P*(1-M*x*(1-x)/6+N/8*w*(1-2*x)+T/120*(x*(4-7*x)-3*O*O*(1-7*x))-A/48*w),t.x=this.x0+S*Math.sin(_),t.y=this.y0+S*Math.cos(_),t))},i.inverse=function(t){t.x-=this.x0,t.y-=this.y0;var e,i,m,f,y,g,v,L,_,O,b,w,x,S,C,E,P,M,N,T,A,k,D;if(this.sphere){if(e=Math.sqrt(t.x*t.x+t.y*t.y),e>2*s*this.a)return;return i=e/this.a,m=Math.sin(i),f=Math.cos(i),y=this.long0,Math.abs(e)<=r?g=this.lat0:(g=c(f*this.sin_p12+t.y*m*this.cos_p12/e),v=Math.abs(this.lat0)-s,y=n(Math.abs(v)<=r?this.lat0>=0?this.long0+Math.atan2(t.x,-t.y):this.long0-Math.atan2(-t.x,t.y):this.long0+Math.atan2(t.x*m,e*this.cos_p12*f-t.y*this.sin_p12*m))),t.x=y,t.y=g,t}return L=a(this.es),_=l(this.es),O=h(this.es),b=u(this.es),Math.abs(this.sin_p12-1)<=r?(w=this.a*o(L,_,O,b,s),e=Math.sqrt(t.x*t.x+t.y*t.y),x=w-e,g=d(x/this.a,L,_,O,b),y=n(this.long0+Math.atan2(t.x,-1*t.y)),t.x=y,t.y=g,t):Math.abs(this.sin_p12+1)<=r?(w=this.a*o(L,_,O,b,s),e=Math.sqrt(t.x*t.x+t.y*t.y),x=e-w,g=d(x/this.a,L,_,O,b),y=n(this.long0+Math.atan2(t.x,t.y)),t.x=y,t.y=g,t):(e=Math.sqrt(t.x*t.x+t.y*t.y),E=Math.atan2(t.x,t.y),S=p(this.a,this.e,this.sin_p12),P=Math.cos(E),M=this.e*this.cos_p12*P,N=-M*M/(1-this.es),T=3*this.es*(1-N)*this.sin_p12*this.cos_p12*P/(1-this.es),A=e/S,k=A-N*(1+N)*Math.pow(A,3)/6-T*(1+3*N)*Math.pow(A,4)/24,D=1-N*k*k/2-A*k*k*k/6,C=Math.asin(this.sin_p12*Math.cos(k)+this.cos_p12*Math.sin(k)*P),y=n(this.long0+Math.asin(Math.sin(E)*Math.sin(k)/Math.cos(C))),g=Math.atan((1-this.es*D*this.sin_p12/Math.sin(C))*Math.tan(C)/(1-this.es)),t.x=y,t.y=g,t)},i.names=["Azimuthal_Equidistant","aeqd"]},{"../common/adjust_lon":5,"../common/asinz":6,"../common/e0fn":7,"../common/e1fn":8,"../common/e2fn":9,"../common/e3fn":10,"../common/gN":11,"../common/imlfn":12,"../common/mlfn":14}],41:[function(t,e,i){var n=t("../common/mlfn"),s=t("../common/e0fn"),r=t("../common/e1fn"),o=t("../common/e2fn"),a=t("../common/e3fn"),l=t("../common/gN"),h=t("../common/adjust_lon"),u=t("../common/adjust_lat"),p=t("../common/imlfn"),c=Math.PI/2,d=1e-10;i.init=function(){this.sphere||(this.e0=s(this.es),this.e1=r(this.es),this.e2=o(this.es),this.e3=a(this.es),this.ml0=this.a*n(this.e0,this.e1,this.e2,this.e3,this.lat0))},i.forward=function(t){var e,i,s=t.x,r=t.y;if(s=h(s-this.long0),this.sphere)e=this.a*Math.asin(Math.cos(r)*Math.sin(s)),i=this.a*(Math.atan2(Math.tan(r),Math.cos(s))-this.lat0);else{var o=Math.sin(r),a=Math.cos(r),u=l(this.a,this.e,o),p=Math.tan(r)*Math.tan(r),c=s*Math.cos(r),d=c*c,m=this.es*a*a/(1-this.es),f=this.a*n(this.e0,this.e1,this.e2,this.e3,r);e=u*c*(1-d*p*(1/6-(8-p+8*m)*d/120)),i=f-this.ml0+u*o/a*d*(.5+(5-p+6*m)*d/24)}return t.x=e+this.x0,t.y=i+this.y0,t},i.inverse=function(t){t.x-=this.x0,t.y-=this.y0;var e,i,n=t.x/this.a,s=t.y/this.a;if(this.sphere){var r=s+this.lat0;e=Math.asin(Math.sin(r)*Math.cos(n)),i=Math.atan2(Math.tan(n),Math.cos(r))}else{var o=this.ml0/this.a+s,a=p(o,this.e0,this.e1,this.e2,this.e3);if(Math.abs(Math.abs(a)-c)<=d)return t.x=this.long0,t.y=c,0>s&&(t.y*=-1),t;var m=l(this.a,this.e,Math.sin(a)),f=m*m*m/this.a/this.a*(1-this.es),y=Math.pow(Math.tan(a),2),g=n*this.a/m,v=g*g;e=a-m*Math.tan(a)/f*g*g*(.5-(1+3*y)*g*g/24),i=g*(1-v*(y/3+(1+3*y)*y*v/15))/Math.cos(a)}return t.x=h(i+this.long0),t.y=u(e),t},i.names=["Cassini","Cassini_Soldner","cass"]},{"../common/adjust_lat":4,"../common/adjust_lon":5,"../common/e0fn":7,"../common/e1fn":8,"../common/e2fn":9,"../common/e3fn":10,"../common/gN":11,"../common/imlfn":12,"../common/mlfn":14}],42:[function(t,e,i){var n=t("../common/adjust_lon"),s=t("../common/qsfnz"),r=t("../common/msfnz"),o=t("../common/iqsfnz");i.init=function(){this.sphere||(this.k0=r(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)))},i.forward=function(t){var e,i,r=t.x,o=t.y,a=n(r-this.long0);if(this.sphere)e=this.x0+this.a*a*Math.cos(this.lat_ts),i=this.y0+this.a*Math.sin(o)/Math.cos(this.lat_ts);else{var l=s(this.e,Math.sin(o));e=this.x0+this.a*this.k0*a,i=this.y0+this.a*l*.5/this.k0}return t.x=e,t.y=i,t},i.inverse=function(t){t.x-=this.x0,t.y-=this.y0;var e,i;return this.sphere?(e=n(this.long0+t.x/this.a/Math.cos(this.lat_ts)),i=Math.asin(t.y/this.a*Math.cos(this.lat_ts))):(i=o(this.e,2*t.y*this.k0/this.a),e=n(this.long0+t.x/(this.a*this.k0))),t.x=e,t.y=i,t},i.names=["cea"]},{"../common/adjust_lon":5,"../common/iqsfnz":13,"../common/msfnz":15,"../common/qsfnz":20}],43:[function(t,e,i){var n=t("../common/adjust_lon"),s=t("../common/adjust_lat");i.init=function(){this.x0=this.x0||0,this.y0=this.y0||0,this.lat0=this.lat0||0,this.long0=this.long0||0,this.lat_ts=this.lat_ts||0,this.title=this.title||"Equidistant Cylindrical (Plate Carre)",this.rc=Math.cos(this.lat_ts)},i.forward=function(t){var e=t.x,i=t.y,r=n(e-this.long0),o=s(i-this.lat0);return t.x=this.x0+this.a*r*this.rc,t.y=this.y0+this.a*o,t},i.inverse=function(t){var e=t.x,i=t.y;return t.x=n(this.long0+(e-this.x0)/(this.a*this.rc)),t.y=s(this.lat0+(i-this.y0)/this.a),t},i.names=["Equirectangular","Equidistant_Cylindrical","eqc"]},{"../common/adjust_lat":4,"../common/adjust_lon":5}],44:[function(t,e,i){var n=t("../common/e0fn"),s=t("../common/e1fn"),r=t("../common/e2fn"),o=t("../common/e3fn"),a=t("../common/msfnz"),l=t("../common/mlfn"),h=t("../common/adjust_lon"),u=t("../common/adjust_lat"),p=t("../common/imlfn"),c=1e-10;i.init=function(){Math.abs(this.lat1+this.lat2)<c||(this.lat2=this.lat2||this.lat1,this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=n(this.es),this.e1=s(this.es),this.e2=r(this.es),this.e3=o(this.es),this.sinphi=Math.sin(this.lat1),this.cosphi=Math.cos(this.lat1),this.ms1=a(this.e,this.sinphi,this.cosphi),this.ml1=l(this.e0,this.e1,this.e2,this.e3,this.lat1),Math.abs(this.lat1-this.lat2)<c?this.ns=this.sinphi:(this.sinphi=Math.sin(this.lat2),this.cosphi=Math.cos(this.lat2),this.ms2=a(this.e,this.sinphi,this.cosphi),this.ml2=l(this.e0,this.e1,this.e2,this.e3,this.lat2),this.ns=(this.ms1-this.ms2)/(this.ml2-this.ml1)),this.g=this.ml1+this.ms1/this.ns,this.ml0=l(this.e0,this.e1,this.e2,this.e3,this.lat0),this.rh=this.a*(this.g-this.ml0))},i.forward=function(t){var e,i=t.x,n=t.y;if(this.sphere)e=this.a*(this.g-n);else{var s=l(this.e0,this.e1,this.e2,this.e3,n);e=this.a*(this.g-s)}var r=this.ns*h(i-this.long0),o=this.x0+e*Math.sin(r),a=this.y0+this.rh-e*Math.cos(r);return t.x=o,t.y=a,t},i.inverse=function(t){t.x-=this.x0,t.y=this.rh-t.y+this.y0;var e,i,n,s;this.ns>=0?(i=Math.sqrt(t.x*t.x+t.y*t.y),e=1):(i=-Math.sqrt(t.x*t.x+t.y*t.y),e=-1);var r=0;if(0!==i&&(r=Math.atan2(e*t.x,e*t.y)),this.sphere)return s=h(this.long0+r/this.ns),n=u(this.g-i/this.a),t.x=s,t.y=n,t;var o=this.g-i/this.a;return n=p(o,this.e0,this.e1,this.e2,this.e3),s=h(this.long0+r/this.ns),t.x=s,t.y=n,t},i.names=["Equidistant_Conic","eqdc"]},{"../common/adjust_lat":4,"../common/adjust_lon":5,"../common/e0fn":7,"../common/e1fn":8,"../common/e2fn":9,"../common/e3fn":10,"../common/imlfn":12,"../common/mlfn":14,"../common/msfnz":15}],45:[function(t,e,i){var n=Math.PI/4,s=t("../common/srat"),r=Math.PI/2,o=20;i.init=function(){var t=Math.sin(this.lat0),e=Math.cos(this.lat0);e*=e,this.rc=Math.sqrt(1-this.es)/(1-this.es*t*t),this.C=Math.sqrt(1+this.es*e*e/(1-this.es)),this.phic0=Math.asin(t/this.C),this.ratexp=.5*this.C*this.e,this.K=Math.tan(.5*this.phic0+n)/(Math.pow(Math.tan(.5*this.lat0+n),this.C)*s(this.e*t,this.ratexp))},i.forward=function(t){var e=t.x,i=t.y;return t.y=2*Math.atan(this.K*Math.pow(Math.tan(.5*i+n),this.C)*s(this.e*Math.sin(i),this.ratexp))-r,t.x=this.C*e,t},i.inverse=function(t){for(var e=1e-14,i=t.x/this.C,a=t.y,l=Math.pow(Math.tan(.5*a+n)/this.K,1/this.C),h=o;h>0&&(a=2*Math.atan(l*s(this.e*Math.sin(t.y),-.5*this.e))-r,!(Math.abs(a-t.y)<e));--h)t.y=a;return h?(t.x=i,t.y=a,t):null},i.names=["gauss"]},{"../common/srat":22}],46:[function(t,e,i){var n=t("../common/adjust_lon"),s=1e-10,r=t("../common/asinz");i.init=function(){this.sin_p14=Math.sin(this.lat0),this.cos_p14=Math.cos(this.lat0),this.infinity_dist=1e3*this.a,this.rc=1},i.forward=function(t){var e,i,r,o,a,l,h,u,p=t.x,c=t.y;return r=n(p-this.long0),e=Math.sin(c),i=Math.cos(c),o=Math.cos(r),l=this.sin_p14*e+this.cos_p14*i*o,a=1,l>0||Math.abs(l)<=s?(h=this.x0+this.a*a*i*Math.sin(r)/l,u=this.y0+this.a*a*(this.cos_p14*e-this.sin_p14*i*o)/l):(h=this.x0+this.infinity_dist*i*Math.sin(r),u=this.y0+this.infinity_dist*(this.cos_p14*e-this.sin_p14*i*o)),t.x=h,t.y=u,t
},i.inverse=function(t){var e,i,s,o,a,l;return t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,t.x/=this.k0,t.y/=this.k0,(e=Math.sqrt(t.x*t.x+t.y*t.y))?(o=Math.atan2(e,this.rc),i=Math.sin(o),s=Math.cos(o),l=r(s*this.sin_p14+t.y*i*this.cos_p14/e),a=Math.atan2(t.x*i,e*this.cos_p14*s-t.y*this.sin_p14*i),a=n(this.long0+a)):(l=this.phic0,a=0),t.x=a,t.y=l,t},i.names=["gnom"]},{"../common/adjust_lon":5,"../common/asinz":6}],47:[function(t,e,i){var n=t("../common/adjust_lon");i.init=function(){this.a=6377397.155,this.es=.006674372230614,this.e=Math.sqrt(this.es),this.lat0||(this.lat0=.863937979737193),this.long0||(this.long0=.4334234309119251),this.k0||(this.k0=.9999),this.s45=.785398163397448,this.s90=2*this.s45,this.fi0=this.lat0,this.e2=this.es,this.e=Math.sqrt(this.e2),this.alfa=Math.sqrt(1+this.e2*Math.pow(Math.cos(this.fi0),4)/(1-this.e2)),this.uq=1.04216856380474,this.u0=Math.asin(Math.sin(this.fi0)/this.alfa),this.g=Math.pow((1+this.e*Math.sin(this.fi0))/(1-this.e*Math.sin(this.fi0)),this.alfa*this.e/2),this.k=Math.tan(this.u0/2+this.s45)/Math.pow(Math.tan(this.fi0/2+this.s45),this.alfa)*this.g,this.k1=this.k0,this.n0=this.a*Math.sqrt(1-this.e2)/(1-this.e2*Math.pow(Math.sin(this.fi0),2)),this.s0=1.37008346281555,this.n=Math.sin(this.s0),this.ro0=this.k1*this.n0/Math.tan(this.s0),this.ad=this.s90-this.uq},i.forward=function(t){var e,i,s,r,o,a,l,h=t.x,u=t.y,p=n(h-this.long0);return e=Math.pow((1+this.e*Math.sin(u))/(1-this.e*Math.sin(u)),this.alfa*this.e/2),i=2*(Math.atan(this.k*Math.pow(Math.tan(u/2+this.s45),this.alfa)/e)-this.s45),s=-p*this.alfa,r=Math.asin(Math.cos(this.ad)*Math.sin(i)+Math.sin(this.ad)*Math.cos(i)*Math.cos(s)),o=Math.asin(Math.cos(i)*Math.sin(s)/Math.cos(r)),a=this.n*o,l=this.ro0*Math.pow(Math.tan(this.s0/2+this.s45),this.n)/Math.pow(Math.tan(r/2+this.s45),this.n),t.y=l*Math.cos(a)/1,t.x=l*Math.sin(a)/1,this.czech||(t.y*=-1,t.x*=-1),t},i.inverse=function(t){var e,i,n,s,r,o,a,l,h=t.x;t.x=t.y,t.y=h,this.czech||(t.y*=-1,t.x*=-1),o=Math.sqrt(t.x*t.x+t.y*t.y),r=Math.atan2(t.y,t.x),s=r/Math.sin(this.s0),n=2*(Math.atan(Math.pow(this.ro0/o,1/this.n)*Math.tan(this.s0/2+this.s45))-this.s45),e=Math.asin(Math.cos(this.ad)*Math.sin(n)-Math.sin(this.ad)*Math.cos(n)*Math.cos(s)),i=Math.asin(Math.cos(n)*Math.sin(s)/Math.cos(e)),t.x=this.long0-i/this.alfa,a=e,l=0;var u=0;do t.y=2*(Math.atan(Math.pow(this.k,-1/this.alfa)*Math.pow(Math.tan(e/2+this.s45),1/this.alfa)*Math.pow((1+this.e*Math.sin(a))/(1-this.e*Math.sin(a)),this.e/2))-this.s45),Math.abs(a-t.y)<1e-10&&(l=1),a=t.y,u+=1;while(0===l&&15>u);return u>=15?null:t},i.names=["Krovak","krovak"]},{"../common/adjust_lon":5}],48:[function(t,e,i){var n=Math.PI/2,s=Math.PI/4,r=1e-10,o=t("../common/qsfnz"),a=t("../common/adjust_lon");i.S_POLE=1,i.N_POLE=2,i.EQUIT=3,i.OBLIQ=4,i.init=function(){var t=Math.abs(this.lat0);if(this.mode=Math.abs(t-n)<r?this.lat0<0?this.S_POLE:this.N_POLE:Math.abs(t)<r?this.EQUIT:this.OBLIQ,this.es>0){var e;switch(this.qp=o(this.e,1),this.mmf=.5/(1-this.es),this.apa=this.authset(this.es),this.mode){case this.N_POLE:this.dd=1;break;case this.S_POLE:this.dd=1;break;case this.EQUIT:this.rq=Math.sqrt(.5*this.qp),this.dd=1/this.rq,this.xmf=1,this.ymf=.5*this.qp;break;case this.OBLIQ:this.rq=Math.sqrt(.5*this.qp),e=Math.sin(this.lat0),this.sinb1=o(this.e,e)/this.qp,this.cosb1=Math.sqrt(1-this.sinb1*this.sinb1),this.dd=Math.cos(this.lat0)/(Math.sqrt(1-this.es*e*e)*this.rq*this.cosb1),this.ymf=(this.xmf=this.rq)/this.dd,this.xmf*=this.dd}}else this.mode===this.OBLIQ&&(this.sinph0=Math.sin(this.lat0),this.cosph0=Math.cos(this.lat0))},i.forward=function(t){var e,i,l,h,u,p,c,d,m,f,y=t.x,g=t.y;if(y=a(y-this.long0),this.sphere){if(u=Math.sin(g),f=Math.cos(g),l=Math.cos(y),this.mode===this.OBLIQ||this.mode===this.EQUIT){if(i=this.mode===this.EQUIT?1+f*l:1+this.sinph0*u+this.cosph0*f*l,r>=i)return null;i=Math.sqrt(2/i),e=i*f*Math.sin(y),i*=this.mode===this.EQUIT?u:this.cosph0*u-this.sinph0*f*l}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(l=-l),Math.abs(g+this.phi0)<r)return null;i=s-.5*g,i=2*(this.mode===this.S_POLE?Math.cos(i):Math.sin(i)),e=i*Math.sin(y),i*=l}}else{switch(c=0,d=0,m=0,l=Math.cos(y),h=Math.sin(y),u=Math.sin(g),p=o(this.e,u),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(c=p/this.qp,d=Math.sqrt(1-c*c)),this.mode){case this.OBLIQ:m=1+this.sinb1*c+this.cosb1*d*l;break;case this.EQUIT:m=1+d*l;break;case this.N_POLE:m=n+g,p=this.qp-p;break;case this.S_POLE:m=g-n,p=this.qp+p}if(Math.abs(m)<r)return null;switch(this.mode){case this.OBLIQ:case this.EQUIT:m=Math.sqrt(2/m),i=this.mode===this.OBLIQ?this.ymf*m*(this.cosb1*c-this.sinb1*d*l):(m=Math.sqrt(2/(1+d*l)))*c*this.ymf,e=this.xmf*m*d*h;break;case this.N_POLE:case this.S_POLE:p>=0?(e=(m=Math.sqrt(p))*h,i=l*(this.mode===this.S_POLE?m:-m)):e=i=0}}return t.x=this.a*e+this.x0,t.y=this.a*i+this.y0,t},i.inverse=function(t){t.x-=this.x0,t.y-=this.y0;var e,i,s,o,l,h,u,p=t.x/this.a,c=t.y/this.a;if(this.sphere){var d,m=0,f=0;if(d=Math.sqrt(p*p+c*c),i=.5*d,i>1)return null;switch(i=2*Math.asin(i),(this.mode===this.OBLIQ||this.mode===this.EQUIT)&&(f=Math.sin(i),m=Math.cos(i)),this.mode){case this.EQUIT:i=Math.abs(d)<=r?0:Math.asin(c*f/d),p*=f,c=m*d;break;case this.OBLIQ:i=Math.abs(d)<=r?this.phi0:Math.asin(m*this.sinph0+c*f*this.cosph0/d),p*=f*this.cosph0,c=(m-Math.sin(i)*this.sinph0)*d;break;case this.N_POLE:c=-c,i=n-i;break;case this.S_POLE:i-=n}e=0!==c||this.mode!==this.EQUIT&&this.mode!==this.OBLIQ?Math.atan2(p,c):0}else{if(u=0,this.mode===this.OBLIQ||this.mode===this.EQUIT){if(p/=this.dd,c*=this.dd,h=Math.sqrt(p*p+c*c),r>h)return t.x=0,t.y=this.phi0,t;o=2*Math.asin(.5*h/this.rq),s=Math.cos(o),p*=o=Math.sin(o),this.mode===this.OBLIQ?(u=s*this.sinb1+c*o*this.cosb1/h,l=this.qp*u,c=h*this.cosb1*s-c*this.sinb1*o):(u=c*o/h,l=this.qp*u,c=h*s)}else if(this.mode===this.N_POLE||this.mode===this.S_POLE){if(this.mode===this.N_POLE&&(c=-c),l=p*p+c*c,!l)return t.x=0,t.y=this.phi0,t;u=1-l/this.qp,this.mode===this.S_POLE&&(u=-u)}e=Math.atan2(p,c),i=this.authlat(Math.asin(u),this.apa)}return t.x=a(this.long0+e),t.y=i,t},i.P00=.3333333333333333,i.P01=.17222222222222222,i.P02=.10257936507936508,i.P10=.06388888888888888,i.P11=.0664021164021164,i.P20=.016415012942191543,i.authset=function(t){var e,i=[];return i[0]=t*this.P00,e=t*t,i[0]+=e*this.P01,i[1]=e*this.P10,e*=t,i[0]+=e*this.P02,i[1]+=e*this.P11,i[2]=e*this.P20,i},i.authlat=function(t,e){var i=t+t;return t+e[0]*Math.sin(i)+e[1]*Math.sin(i+i)+e[2]*Math.sin(i+i+i)},i.names=["Lambert Azimuthal Equal Area","Lambert_Azimuthal_Equal_Area","laea"]},{"../common/adjust_lon":5,"../common/qsfnz":20}],49:[function(t,e,i){var n=1e-10,s=t("../common/msfnz"),r=t("../common/tsfnz"),o=Math.PI/2,a=t("../common/sign"),l=t("../common/adjust_lon"),h=t("../common/phi2z");i.init=function(){if(this.lat2||(this.lat2=this.lat1),this.k0||(this.k0=1),this.x0=this.x0||0,this.y0=this.y0||0,!(Math.abs(this.lat1+this.lat2)<n)){var t=this.b/this.a;this.e=Math.sqrt(1-t*t);var e=Math.sin(this.lat1),i=Math.cos(this.lat1),o=s(this.e,e,i),a=r(this.e,this.lat1,e),l=Math.sin(this.lat2),h=Math.cos(this.lat2),u=s(this.e,l,h),p=r(this.e,this.lat2,l),c=r(this.e,this.lat0,Math.sin(this.lat0));this.ns=Math.abs(this.lat1-this.lat2)>n?Math.log(o/u)/Math.log(a/p):e,isNaN(this.ns)&&(this.ns=e),this.f0=o/(this.ns*Math.pow(a,this.ns)),this.rh=this.a*this.f0*Math.pow(c,this.ns),this.title||(this.title="Lambert Conformal Conic")}},i.forward=function(t){var e=t.x,i=t.y;Math.abs(2*Math.abs(i)-Math.PI)<=n&&(i=a(i)*(o-2*n));var s,h,u=Math.abs(Math.abs(i)-o);if(u>n)s=r(this.e,i,Math.sin(i)),h=this.a*this.f0*Math.pow(s,this.ns);else{if(u=i*this.ns,0>=u)return null;h=0}var p=this.ns*l(e-this.long0);return t.x=this.k0*h*Math.sin(p)+this.x0,t.y=this.k0*(this.rh-h*Math.cos(p))+this.y0,t},i.inverse=function(t){var e,i,n,s,r,a=(t.x-this.x0)/this.k0,u=this.rh-(t.y-this.y0)/this.k0;this.ns>0?(e=Math.sqrt(a*a+u*u),i=1):(e=-Math.sqrt(a*a+u*u),i=-1);var p=0;if(0!==e&&(p=Math.atan2(i*a,i*u)),0!==e||this.ns>0){if(i=1/this.ns,n=Math.pow(e/(this.a*this.f0),i),s=h(this.e,n),-9999===s)return null}else s=-o;return r=l(p/this.ns+this.long0),t.x=r,t.y=s,t},i.names=["Lambert Tangential Conformal Conic Projection","Lambert_Conformal_Conic","Lambert_Conformal_Conic_2SP","lcc"]},{"../common/adjust_lon":5,"../common/msfnz":15,"../common/phi2z":16,"../common/sign":21,"../common/tsfnz":24}],50:[function(t,e,i){function n(t){return t}i.init=function(){},i.forward=n,i.inverse=n,i.names=["longlat","identity"]},{}],51:[function(t,e,i){var n=t("../common/msfnz"),s=Math.PI/2,r=1e-10,o=57.29577951308232,a=t("../common/adjust_lon"),l=Math.PI/4,h=t("../common/tsfnz"),u=t("../common/phi2z");i.init=function(){var t=this.b/this.a;this.es=1-t*t,"x0"in this||(this.x0=0),"y0"in this||(this.y0=0),this.e=Math.sqrt(this.es),this.lat_ts?this.k0=this.sphere?Math.cos(this.lat_ts):n(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts)):this.k0||(this.k0=this.k?this.k:1)},i.forward=function(t){var e=t.x,i=t.y;if(i*o>90&&-90>i*o&&e*o>180&&-180>e*o)return null;var n,u;if(Math.abs(Math.abs(i)-s)<=r)return null;if(this.sphere)n=this.x0+this.a*this.k0*a(e-this.long0),u=this.y0+this.a*this.k0*Math.log(Math.tan(l+.5*i));else{var p=Math.sin(i),c=h(this.e,i,p);n=this.x0+this.a*this.k0*a(e-this.long0),u=this.y0-this.a*this.k0*Math.log(c)}return t.x=n,t.y=u,t},i.inverse=function(t){var e,i,n=t.x-this.x0,r=t.y-this.y0;if(this.sphere)i=s-2*Math.atan(Math.exp(-r/(this.a*this.k0)));else{var o=Math.exp(-r/(this.a*this.k0));if(i=u(this.e,o),-9999===i)return null}return e=a(this.long0+n/(this.a*this.k0)),t.x=e,t.y=i,t},i.names=["Mercator","Popular Visualisation Pseudo Mercator","Mercator_1SP","Mercator_Auxiliary_Sphere","merc"]},{"../common/adjust_lon":5,"../common/msfnz":15,"../common/phi2z":16,"../common/tsfnz":24}],52:[function(t,e,i){var n=t("../common/adjust_lon");i.init=function(){},i.forward=function(t){var e=t.x,i=t.y,s=n(e-this.long0),r=this.x0+this.a*s,o=this.y0+this.a*Math.log(Math.tan(Math.PI/4+i/2.5))*1.25;return t.x=r,t.y=o,t},i.inverse=function(t){t.x-=this.x0,t.y-=this.y0;var e=n(this.long0+t.x/this.a),i=2.5*(Math.atan(Math.exp(.8*t.y/this.a))-Math.PI/4);return t.x=e,t.y=i,t},i.names=["Miller_Cylindrical","mill"]},{"../common/adjust_lon":5}],53:[function(t,e,i){var n=t("../common/adjust_lon"),s=1e-10;i.init=function(){},i.forward=function(t){for(var e=t.x,i=t.y,r=n(e-this.long0),o=i,a=Math.PI*Math.sin(i),l=0;!0;l++){var h=-(o+Math.sin(o)-a)/(1+Math.cos(o));if(o+=h,Math.abs(h)<s)break}o/=2,Math.PI/2-Math.abs(i)<s&&(r=0);var u=.900316316158*this.a*r*Math.cos(o)+this.x0,p=1.4142135623731*this.a*Math.sin(o)+this.y0;return t.x=u,t.y=p,t},i.inverse=function(t){var e,i;t.x-=this.x0,t.y-=this.y0,i=t.y/(1.4142135623731*this.a),Math.abs(i)>.999999999999&&(i=.999999999999),e=Math.asin(i);var s=n(this.long0+t.x/(.900316316158*this.a*Math.cos(e)));s<-Math.PI&&(s=-Math.PI),s>Math.PI&&(s=Math.PI),i=(2*e+Math.sin(2*e))/Math.PI,Math.abs(i)>1&&(i=1);var r=Math.asin(i);return t.x=s,t.y=r,t},i.names=["Mollweide","moll"]},{"../common/adjust_lon":5}],54:[function(t,e,i){var n=484813681109536e-20;i.iterations=1,i.init=function(){this.A=[],this.A[1]=.6399175073,this.A[2]=-.1358797613,this.A[3]=.063294409,this.A[4]=-.02526853,this.A[5]=.0117879,this.A[6]=-.0055161,this.A[7]=.0026906,this.A[8]=-.001333,this.A[9]=67e-5,this.A[10]=-34e-5,this.B_re=[],this.B_im=[],this.B_re[1]=.7557853228,this.B_im[1]=0,this.B_re[2]=.249204646,this.B_im[2]=.003371507,this.B_re[3]=-.001541739,this.B_im[3]=.04105856,this.B_re[4]=-.10162907,this.B_im[4]=.01727609,this.B_re[5]=-.26623489,this.B_im[5]=-.36249218,this.B_re[6]=-.6870983,this.B_im[6]=-1.1651967,this.C_re=[],this.C_im=[],this.C_re[1]=1.3231270439,this.C_im[1]=0,this.C_re[2]=-.577245789,this.C_im[2]=-.007809598,this.C_re[3]=.508307513,this.C_im[3]=-.112208952,this.C_re[4]=-.15094762,this.C_im[4]=.18200602,this.C_re[5]=1.01418179,this.C_im[5]=1.64497696,this.C_re[6]=1.9660549,this.C_im[6]=2.5127645,this.D=[],this.D[1]=1.5627014243,this.D[2]=.5185406398,this.D[3]=-.03333098,this.D[4]=-.1052906,this.D[5]=-.0368594,this.D[6]=.007317,this.D[7]=.0122,this.D[8]=.00394,this.D[9]=-.0013},i.forward=function(t){var e,i=t.x,s=t.y,r=s-this.lat0,o=i-this.long0,a=r/n*1e-5,l=o,h=1,u=0;for(e=1;10>=e;e++)h*=a,u+=this.A[e]*h;var p,c,d=u,m=l,f=1,y=0,g=0,v=0;for(e=1;6>=e;e++)p=f*d-y*m,c=y*d+f*m,f=p,y=c,g=g+this.B_re[e]*f-this.B_im[e]*y,v=v+this.B_im[e]*f+this.B_re[e]*y;return t.x=v*this.a+this.x0,t.y=g*this.a+this.y0,t},i.inverse=function(t){var e,i,s,r=t.x,o=t.y,a=r-this.x0,l=o-this.y0,h=l/this.a,u=a/this.a,p=1,c=0,d=0,m=0;for(e=1;6>=e;e++)i=p*h-c*u,s=c*h+p*u,p=i,c=s,d=d+this.C_re[e]*p-this.C_im[e]*c,m=m+this.C_im[e]*p+this.C_re[e]*c;for(var f=0;f<this.iterations;f++){var y,g,v=d,L=m,_=h,O=u;for(e=2;6>=e;e++)y=v*d-L*m,g=L*d+v*m,v=y,L=g,_+=(e-1)*(this.B_re[e]*v-this.B_im[e]*L),O+=(e-1)*(this.B_im[e]*v+this.B_re[e]*L);v=1,L=0;var b=this.B_re[1],w=this.B_im[1];for(e=2;6>=e;e++)y=v*d-L*m,g=L*d+v*m,v=y,L=g,b+=e*(this.B_re[e]*v-this.B_im[e]*L),w+=e*(this.B_im[e]*v+this.B_re[e]*L);var x=b*b+w*w;d=(_*b+O*w)/x,m=(O*b-_*w)/x}var S=d,C=m,E=1,P=0;for(e=1;9>=e;e++)E*=S,P+=this.D[e]*E;var M=this.lat0+P*n*1e5,N=this.long0+C;return t.x=N,t.y=M,t},i.names=["New_Zealand_Map_Grid","nzmg"]},{}],55:[function(t,e,i){var n=t("../common/tsfnz"),s=t("../common/adjust_lon"),r=t("../common/phi2z"),o=Math.PI/2,a=Math.PI/4,l=1e-10;i.init=function(){this.no_off=this.no_off||!1,this.no_rot=this.no_rot||!1,isNaN(this.k0)&&(this.k0=1);var t=Math.sin(this.lat0),e=Math.cos(this.lat0),i=this.e*t;this.bl=Math.sqrt(1+this.es/(1-this.es)*Math.pow(e,4)),this.al=this.a*this.bl*this.k0*Math.sqrt(1-this.es)/(1-i*i);var r=n(this.e,this.lat0,t),o=this.bl/e*Math.sqrt((1-this.es)/(1-i*i));1>o*o&&(o=1);var a,l;if(isNaN(this.longc)){var h=n(this.e,this.lat1,Math.sin(this.lat1)),u=n(this.e,this.lat2,Math.sin(this.lat2));this.el=this.lat0>=0?(o+Math.sqrt(o*o-1))*Math.pow(r,this.bl):(o-Math.sqrt(o*o-1))*Math.pow(r,this.bl);var p=Math.pow(h,this.bl),c=Math.pow(u,this.bl);a=this.el/p,l=.5*(a-1/a);var d=(this.el*this.el-c*p)/(this.el*this.el+c*p),m=(c-p)/(c+p),f=s(this.long1-this.long2);this.long0=.5*(this.long1+this.long2)-Math.atan(d*Math.tan(.5*this.bl*f)/m)/this.bl,this.long0=s(this.long0);var y=s(this.long1-this.long0);this.gamma0=Math.atan(Math.sin(this.bl*y)/l),this.alpha=Math.asin(o*Math.sin(this.gamma0))}else a=this.lat0>=0?o+Math.sqrt(o*o-1):o-Math.sqrt(o*o-1),this.el=a*Math.pow(r,this.bl),l=.5*(a-1/a),this.gamma0=Math.asin(Math.sin(this.alpha)/o),this.long0=this.longc-Math.asin(l*Math.tan(this.gamma0))/this.bl;this.uc=this.no_off?0:this.lat0>=0?this.al/this.bl*Math.atan2(Math.sqrt(o*o-1),Math.cos(this.alpha)):-1*this.al/this.bl*Math.atan2(Math.sqrt(o*o-1),Math.cos(this.alpha))},i.forward=function(t){var e,i,r,h=t.x,u=t.y,p=s(h-this.long0);if(Math.abs(Math.abs(u)-o)<=l)r=u>0?-1:1,i=this.al/this.bl*Math.log(Math.tan(a+r*this.gamma0*.5)),e=-1*r*o*this.al/this.bl;else{var c=n(this.e,u,Math.sin(u)),d=this.el/Math.pow(c,this.bl),m=.5*(d-1/d),f=.5*(d+1/d),y=Math.sin(this.bl*p),g=(m*Math.sin(this.gamma0)-y*Math.cos(this.gamma0))/f;i=Math.abs(Math.abs(g)-1)<=l?Number.POSITIVE_INFINITY:.5*this.al*Math.log((1-g)/(1+g))/this.bl,e=Math.abs(Math.cos(this.bl*p))<=l?this.al*this.bl*p:this.al*Math.atan2(m*Math.cos(this.gamma0)+y*Math.sin(this.gamma0),Math.cos(this.bl*p))/this.bl}return this.no_rot?(t.x=this.x0+e,t.y=this.y0+i):(e-=this.uc,t.x=this.x0+i*Math.cos(this.alpha)+e*Math.sin(this.alpha),t.y=this.y0+e*Math.cos(this.alpha)-i*Math.sin(this.alpha)),t},i.inverse=function(t){var e,i;this.no_rot?(i=t.y-this.y0,e=t.x-this.x0):(i=(t.x-this.x0)*Math.cos(this.alpha)-(t.y-this.y0)*Math.sin(this.alpha),e=(t.y-this.y0)*Math.cos(this.alpha)+(t.x-this.x0)*Math.sin(this.alpha),e+=this.uc);var n=Math.exp(-1*this.bl*i/this.al),a=.5*(n-1/n),h=.5*(n+1/n),u=Math.sin(this.bl*e/this.al),p=(u*Math.cos(this.gamma0)+a*Math.sin(this.gamma0))/h,c=Math.pow(this.el/Math.sqrt((1+p)/(1-p)),1/this.bl);return Math.abs(p-1)<l?(t.x=this.long0,t.y=o):Math.abs(p+1)<l?(t.x=this.long0,t.y=-1*o):(t.y=r(this.e,c),t.x=s(this.long0-Math.atan2(a*Math.cos(this.gamma0)-u*Math.sin(this.gamma0),Math.cos(this.bl*e/this.al))/this.bl)),t},i.names=["Hotine_Oblique_Mercator","Hotine Oblique Mercator","Hotine_Oblique_Mercator_Azimuth_Natural_Origin","Hotine_Oblique_Mercator_Azimuth_Center","omerc"]},{"../common/adjust_lon":5,"../common/phi2z":16,"../common/tsfnz":24}],56:[function(t,e,i){var n=t("../common/e0fn"),s=t("../common/e1fn"),r=t("../common/e2fn"),o=t("../common/e3fn"),a=t("../common/adjust_lon"),l=t("../common/adjust_lat"),h=t("../common/mlfn"),u=1e-10,p=t("../common/gN"),c=20;i.init=function(){this.temp=this.b/this.a,this.es=1-Math.pow(this.temp,2),this.e=Math.sqrt(this.es),this.e0=n(this.es),this.e1=s(this.es),this.e2=r(this.es),this.e3=o(this.es),this.ml0=this.a*h(this.e0,this.e1,this.e2,this.e3,this.lat0)},i.forward=function(t){var e,i,n,s=t.x,r=t.y,o=a(s-this.long0);if(n=o*Math.sin(r),this.sphere)Math.abs(r)<=u?(e=this.a*o,i=-1*this.a*this.lat0):(e=this.a*Math.sin(n)/Math.tan(r),i=this.a*(l(r-this.lat0)+(1-Math.cos(n))/Math.tan(r)));else if(Math.abs(r)<=u)e=this.a*o,i=-1*this.ml0;else{var c=p(this.a,this.e,Math.sin(r))/Math.tan(r);e=c*Math.sin(n),i=this.a*h(this.e0,this.e1,this.e2,this.e3,r)-this.ml0+c*(1-Math.cos(n))}return t.x=e+this.x0,t.y=i+this.y0,t},i.inverse=function(t){var e,i,n,s,r,o,l,p,d;if(n=t.x-this.x0,s=t.y-this.y0,this.sphere)if(Math.abs(s+this.a*this.lat0)<=u)e=a(n/this.a+this.long0),i=0;else{o=this.lat0+s/this.a,l=n*n/this.a/this.a+o*o,p=o;var m;for(r=c;r;--r)if(m=Math.tan(p),d=-1*(o*(p*m+1)-p-.5*(p*p+l)*m)/((p-o)/m-1),p+=d,Math.abs(d)<=u){i=p;break}e=a(this.long0+Math.asin(n*Math.tan(p)/this.a)/Math.sin(i))}else if(Math.abs(s+this.ml0)<=u)i=0,e=a(this.long0+n/this.a);else{o=(this.ml0+s)/this.a,l=n*n/this.a/this.a+o*o,p=o;var f,y,g,v,L;for(r=c;r;--r)if(L=this.e*Math.sin(p),f=Math.sqrt(1-L*L)*Math.tan(p),y=this.a*h(this.e0,this.e1,this.e2,this.e3,p),g=this.e0-2*this.e1*Math.cos(2*p)+4*this.e2*Math.cos(4*p)-6*this.e3*Math.cos(6*p),v=y/this.a,d=(o*(f*v+1)-v-.5*f*(v*v+l))/(this.es*Math.sin(2*p)*(v*v+l-2*o*v)/(4*f)+(o-v)*(f*g-2/Math.sin(2*p))-g),p-=d,Math.abs(d)<=u){i=p;break}f=Math.sqrt(1-this.es*Math.pow(Math.sin(i),2))*Math.tan(i),e=a(this.long0+Math.asin(n*f/this.a)/Math.sin(i))}return t.x=e,t.y=i,t},i.names=["Polyconic","poly"]},{"../common/adjust_lat":4,"../common/adjust_lon":5,"../common/e0fn":7,"../common/e1fn":8,"../common/e2fn":9,"../common/e3fn":10,"../common/gN":11,"../common/mlfn":14}],57:[function(t,e,i){var n=t("../common/adjust_lon"),s=t("../common/adjust_lat"),r=t("../common/pj_enfn"),o=20,a=t("../common/pj_mlfn"),l=t("../common/pj_inv_mlfn"),h=Math.PI/2,u=1e-10,p=t("../common/asinz");i.init=function(){this.sphere?(this.n=1,this.m=0,this.es=0,this.C_y=Math.sqrt((this.m+1)/this.n),this.C_x=this.C_y/(this.m+1)):this.en=r(this.es)},i.forward=function(t){var e,i,s=t.x,r=t.y;if(s=n(s-this.long0),this.sphere){if(this.m)for(var l=this.n*Math.sin(r),h=o;h;--h){var p=(this.m*r+Math.sin(r)-l)/(this.m+Math.cos(r));if(r-=p,Math.abs(p)<u)break}else r=1!==this.n?Math.asin(this.n*Math.sin(r)):r;e=this.a*this.C_x*s*(this.m+Math.cos(r)),i=this.a*this.C_y*r}else{var c=Math.sin(r),d=Math.cos(r);i=this.a*a(r,c,d,this.en),e=this.a*s*d/Math.sqrt(1-this.es*c*c)}return t.x=e,t.y=i,t},i.inverse=function(t){var e,i,r,o;return t.x-=this.x0,r=t.x/this.a,t.y-=this.y0,e=t.y/this.a,this.sphere?(e/=this.C_y,r/=this.C_x*(this.m+Math.cos(e)),this.m?e=p((this.m*e+Math.sin(e))/this.n):1!==this.n&&(e=p(Math.sin(e)/this.n)),r=n(r+this.long0),e=s(e)):(e=l(t.y/this.a,this.es,this.en),o=Math.abs(e),h>o?(o=Math.sin(e),i=this.long0+t.x*Math.sqrt(1-this.es*o*o)/(this.a*Math.cos(e)),r=n(i)):h>o-u&&(r=this.long0)),t.x=r,t.y=e,t},i.names=["Sinusoidal","sinu"]},{"../common/adjust_lat":4,"../common/adjust_lon":5,"../common/asinz":6,"../common/pj_enfn":17,"../common/pj_inv_mlfn":18,"../common/pj_mlfn":19}],58:[function(t,e,i){i.init=function(){var t=this.lat0;this.lambda0=this.long0;var e=Math.sin(t),i=this.a,n=this.rf,s=1/n,r=2*s-Math.pow(s,2),o=this.e=Math.sqrt(r);this.R=this.k0*i*Math.sqrt(1-r)/(1-r*Math.pow(e,2)),this.alpha=Math.sqrt(1+r/(1-r)*Math.pow(Math.cos(t),4)),this.b0=Math.asin(e/this.alpha);var a=Math.log(Math.tan(Math.PI/4+this.b0/2)),l=Math.log(Math.tan(Math.PI/4+t/2)),h=Math.log((1+o*e)/(1-o*e));this.K=a-this.alpha*l+this.alpha*o/2*h},i.forward=function(t){var e=Math.log(Math.tan(Math.PI/4-t.y/2)),i=this.e/2*Math.log((1+this.e*Math.sin(t.y))/(1-this.e*Math.sin(t.y))),n=-this.alpha*(e+i)+this.K,s=2*(Math.atan(Math.exp(n))-Math.PI/4),r=this.alpha*(t.x-this.lambda0),o=Math.atan(Math.sin(r)/(Math.sin(this.b0)*Math.tan(s)+Math.cos(this.b0)*Math.cos(r))),a=Math.asin(Math.cos(this.b0)*Math.sin(s)-Math.sin(this.b0)*Math.cos(s)*Math.cos(r));return t.y=this.R/2*Math.log((1+Math.sin(a))/(1-Math.sin(a)))+this.y0,t.x=this.R*o+this.x0,t},i.inverse=function(t){for(var e=t.x-this.x0,i=t.y-this.y0,n=e/this.R,s=2*(Math.atan(Math.exp(i/this.R))-Math.PI/4),r=Math.asin(Math.cos(this.b0)*Math.sin(s)+Math.sin(this.b0)*Math.cos(s)*Math.cos(n)),o=Math.atan(Math.sin(n)/(Math.cos(this.b0)*Math.cos(n)-Math.sin(this.b0)*Math.tan(s))),a=this.lambda0+o/this.alpha,l=0,h=r,u=-1e3,p=0;Math.abs(h-u)>1e-7;){if(++p>20)return;l=1/this.alpha*(Math.log(Math.tan(Math.PI/4+r/2))-this.K)+this.e*Math.log(Math.tan(Math.PI/4+Math.asin(this.e*Math.sin(h))/2)),u=h,h=2*Math.atan(Math.exp(l))-Math.PI/2}return t.x=a,t.y=h,t},i.names=["somerc"]},{}],59:[function(t,e,i){var n=Math.PI/2,s=1e-10,r=t("../common/sign"),o=t("../common/msfnz"),a=t("../common/tsfnz"),l=t("../common/phi2z"),h=t("../common/adjust_lon");i.ssfn_=function(t,e,i){return e*=i,Math.tan(.5*(n+t))*Math.pow((1-e)/(1+e),.5*i)},i.init=function(){this.coslat0=Math.cos(this.lat0),this.sinlat0=Math.sin(this.lat0),this.sphere?1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=s&&(this.k0=.5*(1+r(this.lat0)*Math.sin(this.lat_ts))):(Math.abs(this.coslat0)<=s&&(this.con=this.lat0>0?1:-1),this.cons=Math.sqrt(Math.pow(1+this.e,1+this.e)*Math.pow(1-this.e,1-this.e)),1===this.k0&&!isNaN(this.lat_ts)&&Math.abs(this.coslat0)<=s&&(this.k0=.5*this.cons*o(this.e,Math.sin(this.lat_ts),Math.cos(this.lat_ts))/a(this.e,this.con*this.lat_ts,this.con*Math.sin(this.lat_ts))),this.ms1=o(this.e,this.sinlat0,this.coslat0),this.X0=2*Math.atan(this.ssfn_(this.lat0,this.sinlat0,this.e))-n,this.cosX0=Math.cos(this.X0),this.sinX0=Math.sin(this.X0))},i.forward=function(t){var e,i,r,o,l,u,p=t.x,c=t.y,d=Math.sin(c),m=Math.cos(c),f=h(p-this.long0);return Math.abs(Math.abs(p-this.long0)-Math.PI)<=s&&Math.abs(c+this.lat0)<=s?(t.x=0/0,t.y=0/0,t):this.sphere?(e=2*this.k0/(1+this.sinlat0*d+this.coslat0*m*Math.cos(f)),t.x=this.a*e*m*Math.sin(f)+this.x0,t.y=this.a*e*(this.coslat0*d-this.sinlat0*m*Math.cos(f))+this.y0,t):(i=2*Math.atan(this.ssfn_(c,d,this.e))-n,o=Math.cos(i),r=Math.sin(i),Math.abs(this.coslat0)<=s?(l=a(this.e,c*this.con,this.con*d),u=2*this.a*this.k0*l/this.cons,t.x=this.x0+u*Math.sin(p-this.long0),t.y=this.y0-this.con*u*Math.cos(p-this.long0),t):(Math.abs(this.sinlat0)<s?(e=2*this.a*this.k0/(1+o*Math.cos(f)),t.y=e*r):(e=2*this.a*this.k0*this.ms1/(this.cosX0*(1+this.sinX0*r+this.cosX0*o*Math.cos(f))),t.y=e*(this.cosX0*r-this.sinX0*o*Math.cos(f))+this.y0),t.x=e*o*Math.sin(f)+this.x0,t))},i.inverse=function(t){t.x-=this.x0,t.y-=this.y0;var e,i,r,o,a,u=Math.sqrt(t.x*t.x+t.y*t.y);if(this.sphere){var p=2*Math.atan(u/(.5*this.a*this.k0));return e=this.long0,i=this.lat0,s>=u?(t.x=e,t.y=i,t):(i=Math.asin(Math.cos(p)*this.sinlat0+t.y*Math.sin(p)*this.coslat0/u),e=h(Math.abs(this.coslat0)<s?this.lat0>0?this.long0+Math.atan2(t.x,-1*t.y):this.long0+Math.atan2(t.x,t.y):this.long0+Math.atan2(t.x*Math.sin(p),u*this.coslat0*Math.cos(p)-t.y*this.sinlat0*Math.sin(p))),t.x=e,t.y=i,t)}if(Math.abs(this.coslat0)<=s){if(s>=u)return i=this.lat0,e=this.long0,t.x=e,t.y=i,t;t.x*=this.con,t.y*=this.con,r=u*this.cons/(2*this.a*this.k0),i=this.con*l(this.e,r),e=this.con*h(this.con*this.long0+Math.atan2(t.x,-1*t.y))}else o=2*Math.atan(u*this.cosX0/(2*this.a*this.k0*this.ms1)),e=this.long0,s>=u?a=this.X0:(a=Math.asin(Math.cos(o)*this.sinX0+t.y*Math.sin(o)*this.cosX0/u),e=h(this.long0+Math.atan2(t.x*Math.sin(o),u*this.cosX0*Math.cos(o)-t.y*this.sinX0*Math.sin(o)))),i=-1*l(this.e,Math.tan(.5*(n+a)));return t.x=e,t.y=i,t},i.names=["stere"]},{"../common/adjust_lon":5,"../common/msfnz":15,"../common/phi2z":16,"../common/sign":21,"../common/tsfnz":24}],60:[function(t,e,i){var n=t("./gauss"),s=t("../common/adjust_lon");i.init=function(){n.init.apply(this),this.rc&&(this.sinc0=Math.sin(this.phic0),this.cosc0=Math.cos(this.phic0),this.R2=2*this.rc,this.title||(this.title="Oblique Stereographic Alternative"))},i.forward=function(t){var e,i,r,o;return t.x=s(t.x-this.long0),n.forward.apply(this,[t]),e=Math.sin(t.y),i=Math.cos(t.y),r=Math.cos(t.x),o=this.k0*this.R2/(1+this.sinc0*e+this.cosc0*i*r),t.x=o*i*Math.sin(t.x),t.y=o*(this.cosc0*e-this.sinc0*i*r),t.x=this.a*t.x+this.x0,t.y=this.a*t.y+this.y0,t},i.inverse=function(t){var e,i,r,o,a;if(t.x=(t.x-this.x0)/this.a,t.y=(t.y-this.y0)/this.a,t.x/=this.k0,t.y/=this.k0,a=Math.sqrt(t.x*t.x+t.y*t.y)){var l=2*Math.atan2(a,this.R2);e=Math.sin(l),i=Math.cos(l),o=Math.asin(i*this.sinc0+t.y*e*this.cosc0/a),r=Math.atan2(t.x*e,a*this.cosc0*i-t.y*this.sinc0*e)}else o=this.phic0,r=0;return t.x=r,t.y=o,n.inverse.apply(this,[t]),t.x=s(t.x+this.long0),t},i.names=["Stereographic_North_Pole","Oblique_Stereographic","Polar_Stereographic","sterea","Oblique Stereographic Alternative"]},{"../common/adjust_lon":5,"./gauss":45}],61:[function(t,e,i){var n=t("../common/e0fn"),s=t("../common/e1fn"),r=t("../common/e2fn"),o=t("../common/e3fn"),a=t("../common/mlfn"),l=t("../common/adjust_lon"),h=Math.PI/2,u=1e-10,p=t("../common/sign"),c=t("../common/asinz");i.init=function(){this.e0=n(this.es),this.e1=s(this.es),this.e2=r(this.es),this.e3=o(this.es),this.ml0=this.a*a(this.e0,this.e1,this.e2,this.e3,this.lat0)},i.forward=function(t){var e,i,n,s=t.x,r=t.y,o=l(s-this.long0),h=Math.sin(r),u=Math.cos(r);if(this.sphere){var p=u*Math.sin(o);if(Math.abs(Math.abs(p)-1)<1e-10)return 93;i=.5*this.a*this.k0*Math.log((1+p)/(1-p)),e=Math.acos(u*Math.cos(o)/Math.sqrt(1-p*p)),0>r&&(e=-e),n=this.a*this.k0*(e-this.lat0)}else{var c=u*o,d=Math.pow(c,2),m=this.ep2*Math.pow(u,2),f=Math.tan(r),y=Math.pow(f,2);e=1-this.es*Math.pow(h,2);var g=this.a/Math.sqrt(e),v=this.a*a(this.e0,this.e1,this.e2,this.e3,r);i=this.k0*g*c*(1+d/6*(1-y+m+d/20*(5-18*y+Math.pow(y,2)+72*m-58*this.ep2)))+this.x0,n=this.k0*(v-this.ml0+g*f*d*(.5+d/24*(5-y+9*m+4*Math.pow(m,2)+d/30*(61-58*y+Math.pow(y,2)+600*m-330*this.ep2))))+this.y0}return t.x=i,t.y=n,t},i.inverse=function(t){var e,i,n,s,r,o,a=6;if(this.sphere){var d=Math.exp(t.x/(this.a*this.k0)),m=.5*(d-1/d),f=this.lat0+t.y/(this.a*this.k0),y=Math.cos(f);e=Math.sqrt((1-y*y)/(1+m*m)),r=c(e),0>f&&(r=-r),o=0===m&&0===y?this.long0:l(Math.atan2(m,y)+this.long0)}else{var g=t.x-this.x0,v=t.y-this.y0;for(e=(this.ml0+v/this.k0)/this.a,i=e,s=0;n=(e+this.e1*Math.sin(2*i)-this.e2*Math.sin(4*i)+this.e3*Math.sin(6*i))/this.e0-i,i+=n,!(Math.abs(n)<=u);s++)if(s>=a)return 95;if(Math.abs(i)<h){var L=Math.sin(i),_=Math.cos(i),O=Math.tan(i),b=this.ep2*Math.pow(_,2),w=Math.pow(b,2),x=Math.pow(O,2),S=Math.pow(x,2);e=1-this.es*Math.pow(L,2);var C=this.a/Math.sqrt(e),E=C*(1-this.es)/e,P=g/(C*this.k0),M=Math.pow(P,2);r=i-C*O*M/E*(.5-M/24*(5+3*x+10*b-4*w-9*this.ep2-M/30*(61+90*x+298*b+45*S-252*this.ep2-3*w))),o=l(this.long0+P*(1-M/6*(1+2*x+b-M/20*(5-2*b+28*x-3*w+8*this.ep2+24*S)))/_)}else r=h*p(v),o=this.long0}return t.x=o,t.y=r,t},i.names=["Transverse_Mercator","Transverse Mercator","tmerc"]},{"../common/adjust_lon":5,"../common/asinz":6,"../common/e0fn":7,"../common/e1fn":8,"../common/e2fn":9,"../common/e3fn":10,"../common/mlfn":14,"../common/sign":21}],62:[function(t,e,i){var n=.017453292519943295,s=t("./tmerc");i.dependsOn="tmerc",i.init=function(){this.zone&&(this.lat0=0,this.long0=(6*Math.abs(this.zone)-183)*n,this.x0=5e5,this.y0=this.utmSouth?1e7:0,this.k0=.9996,s.init.apply(this),this.forward=s.forward,this.inverse=s.inverse)},i.names=["Universal Transverse Mercator System","utm"]},{"./tmerc":61}],63:[function(t,e,i){var n=t("../common/adjust_lon"),s=Math.PI/2,r=1e-10,o=t("../common/asinz");i.init=function(){this.R=this.a},i.forward=function(t){var e,i,a=t.x,l=t.y,h=n(a-this.long0);Math.abs(l)<=r&&(e=this.x0+this.R*h,i=this.y0);var u=o(2*Math.abs(l/Math.PI));(Math.abs(h)<=r||Math.abs(Math.abs(l)-s)<=r)&&(e=this.x0,i=l>=0?this.y0+Math.PI*this.R*Math.tan(.5*u):this.y0+Math.PI*this.R*-Math.tan(.5*u));var p=.5*Math.abs(Math.PI/h-h/Math.PI),c=p*p,d=Math.sin(u),m=Math.cos(u),f=m/(d+m-1),y=f*f,g=f*(2/d-1),v=g*g,L=Math.PI*this.R*(p*(f-v)+Math.sqrt(c*(f-v)*(f-v)-(v+c)*(y-v)))/(v+c);0>h&&(L=-L),e=this.x0+L;var _=c+f;return L=Math.PI*this.R*(g*_-p*Math.sqrt((v+c)*(c+1)-_*_))/(v+c),i=l>=0?this.y0+L:this.y0-L,t.x=e,t.y=i,t},i.inverse=function(t){var e,i,s,o,a,l,h,u,p,c,d,m,f;return t.x-=this.x0,t.y-=this.y0,d=Math.PI*this.R,s=t.x/d,o=t.y/d,a=s*s+o*o,l=-Math.abs(o)*(1+a),h=l-2*o*o+s*s,u=-2*l+1+2*o*o+a*a,f=o*o/u+(2*h*h*h/u/u/u-9*l*h/u/u)/27,p=(l-h*h/3/u)/u,c=2*Math.sqrt(-p/3),d=3*f/p/c,Math.abs(d)>1&&(d=d>=0?1:-1),m=Math.acos(d)/3,i=t.y>=0?(-c*Math.cos(m+Math.PI/3)-h/3/u)*Math.PI:-(-c*Math.cos(m+Math.PI/3)-h/3/u)*Math.PI,e=Math.abs(s)<r?this.long0:n(this.long0+Math.PI*(a-1+Math.sqrt(1+2*(s*s-o*o)+a*a))/2/s),t.x=e,t.y=i,t},i.names=["Van_der_Grinten_I","VanDerGrinten","vandg"]},{"../common/adjust_lon":5,"../common/asinz":6}],64:[function(t,e){var i=.017453292519943295,n=57.29577951308232,s=1,r=2,o=t("./datum_transform"),a=t("./adjust_axis"),l=t("./Proj"),h=t("./common/toPoint");e.exports=function u(t,e,p){function c(t,e){return(t.datum.datum_type===s||t.datum.datum_type===r)&&"WGS84"!==e.datumCode}var d;return Array.isArray(p)&&(p=h(p)),t.datum&&e.datum&&(c(t,e)||c(e,t))&&(d=new l("WGS84"),u(t,d,p),t=d),"enu"!==t.axis&&a(t,!1,p),"longlat"===t.projName?(p.x*=i,p.y*=i):(t.to_meter&&(p.x*=t.to_meter,p.y*=t.to_meter),t.inverse(p)),t.from_greenwich&&(p.x+=t.from_greenwich),p=o(t.datum,e.datum,p),e.from_greenwich&&(p.x-=e.from_greenwich),"longlat"===e.projName?(p.x*=n,p.y*=n):(e.forward(p),e.to_meter&&(p.x/=e.to_meter,p.y/=e.to_meter)),"enu"!==e.axis&&a(e,!0,p),p}},{"./Proj":2,"./adjust_axis":3,"./common/toPoint":23,"./datum_transform":30}],65:[function(t,e){function i(t,e,i){t[e]=i.map(function(t){var e={};return n(t,e),e}).reduce(function(t,e){return l(t,e)},{})}function n(t,e){var s;return Array.isArray(t)?(s=t.shift(),"PARAMETER"===s&&(s=t.shift()),void(1===t.length?Array.isArray(t[0])?(e[s]={},n(t[0],e[s])):e[s]=t[0]:t.length?"TOWGS84"===s?e[s]=t:(e[s]={},["UNIT","PRIMEM","VERT_DATUM"].indexOf(s)>-1?(e[s]={name:t[0].toLowerCase(),convert:t[1]},3===t.length&&(e[s].auth=t[2])):"SPHEROID"===s?(e[s]={name:t[0],a:t[1],rf:t[2]},4===t.length&&(e[s].auth=t[3])):["GEOGCS","GEOCCS","DATUM","VERT_CS","COMPD_CS","LOCAL_CS","FITTED_CS","LOCAL_DATUM"].indexOf(s)>-1?(t[0]=["name",t[0]],i(e,s,t)):t.every(function(t){return Array.isArray(t)})?i(e,s,t):n(t,e[s])):e[s]=!0)):void(e[t]=!0)}function s(t,e){var i=e[0],n=e[1];!(i in t)&&n in t&&(t[i]=t[n],3===e.length&&(t[i]=e[2](t[i])))}function r(t){return t*a}function o(t){function e(e){var i=t.to_meter||1;return parseFloat(e,10)*i}"GEOGCS"===t.type?t.projName="longlat":"LOCAL_CS"===t.type?(t.projName="identity",t.local=!0):t.projName="object"==typeof t.PROJECTION?Object.keys(t.PROJECTION)[0]:t.PROJECTION,t.UNIT&&(t.units=t.UNIT.name.toLowerCase(),"metre"===t.units&&(t.units="meter"),t.UNIT.convert&&(t.to_meter=parseFloat(t.UNIT.convert,10))),t.GEOGCS&&(t.datumCode=t.GEOGCS.DATUM?t.GEOGCS.DATUM.name.toLowerCase():t.GEOGCS.name.toLowerCase(),"d_"===t.datumCode.slice(0,2)&&(t.datumCode=t.datumCode.slice(2)),("new_zealand_geodetic_datum_1949"===t.datumCode||"new_zealand_1949"===t.datumCode)&&(t.datumCode="nzgd49"),"wgs_1984"===t.datumCode&&("Mercator_Auxiliary_Sphere"===t.PROJECTION&&(t.sphere=!0),t.datumCode="wgs84"),"_ferro"===t.datumCode.slice(-6)&&(t.datumCode=t.datumCode.slice(0,-6)),"_jakarta"===t.datumCode.slice(-8)&&(t.datumCode=t.datumCode.slice(0,-8)),~t.datumCode.indexOf("belge")&&(t.datumCode="rnb72"),t.GEOGCS.DATUM&&t.GEOGCS.DATUM.SPHEROID&&(t.ellps=t.GEOGCS.DATUM.SPHEROID.name.replace("_19","").replace(/[Cc]larke\_18/,"clrk"),"international"===t.ellps.toLowerCase().slice(0,13)&&(t.ellps="intl"),t.a=t.GEOGCS.DATUM.SPHEROID.a,t.rf=parseFloat(t.GEOGCS.DATUM.SPHEROID.rf,10))),t.b&&!isFinite(t.b)&&(t.b=t.a);
var i=function(e){return s(t,e)},n=[["standard_parallel_1","Standard_Parallel_1"],["standard_parallel_2","Standard_Parallel_2"],["false_easting","False_Easting"],["false_northing","False_Northing"],["central_meridian","Central_Meridian"],["latitude_of_origin","Latitude_Of_Origin"],["scale_factor","Scale_Factor"],["k0","scale_factor"],["latitude_of_center","Latitude_of_center"],["lat0","latitude_of_center",r],["longitude_of_center","Longitude_Of_Center"],["longc","longitude_of_center",r],["x0","false_easting",e],["y0","false_northing",e],["long0","central_meridian",r],["lat0","latitude_of_origin",r],["lat0","standard_parallel_1",r],["lat1","standard_parallel_1",r],["lat2","standard_parallel_2",r],["alpha","azimuth",r],["srsCode","name"]];n.forEach(i),t.long0||!t.longc||"Albers_Conic_Equal_Area"!==t.PROJECTION&&"Lambert_Azimuthal_Equal_Area"!==t.PROJECTION||(t.long0=t.longc)}var a=.017453292519943295,l=t("./extend");e.exports=function(t,e){var i=JSON.parse((","+t).replace(/\s*\,\s*([A-Z_0-9]+?)(\[)/g,',["$1",').slice(1).replace(/\s*\,\s*([A-Z_0-9]+?)\]/g,',"$1"]')),s=i.shift(),r=i.shift();i.unshift(["name",r]),i.unshift(["type",s]),i.unshift("output");var a={};return n(i,a),o(a.output),l(e,a.output)}},{"./extend":33}],66:[function(t,e,i){function n(t){return t*(Math.PI/180)}function s(t){return 180*(t/Math.PI)}function r(t){var e,i,s,r,o,l,h,u,p,c=t.lat,d=t.lon,m=6378137,f=.00669438,y=.9996,g=n(c),v=n(d);p=Math.floor((d+180)/6)+1,180===d&&(p=60),c>=56&&64>c&&d>=3&&12>d&&(p=32),c>=72&&84>c&&(d>=0&&9>d?p=31:d>=9&&21>d?p=33:d>=21&&33>d?p=35:d>=33&&42>d&&(p=37)),e=6*(p-1)-180+3,u=n(e),i=f/(1-f),s=m/Math.sqrt(1-f*Math.sin(g)*Math.sin(g)),r=Math.tan(g)*Math.tan(g),o=i*Math.cos(g)*Math.cos(g),l=Math.cos(g)*(v-u),h=m*((1-f/4-3*f*f/64-5*f*f*f/256)*g-(3*f/8+3*f*f/32+45*f*f*f/1024)*Math.sin(2*g)+(15*f*f/256+45*f*f*f/1024)*Math.sin(4*g)-35*f*f*f/3072*Math.sin(6*g));var L=y*s*(l+(1-r+o)*l*l*l/6+(5-18*r+r*r+72*o-58*i)*l*l*l*l*l/120)+5e5,_=y*(h+s*Math.tan(g)*(l*l/2+(5-r+9*o+4*o*o)*l*l*l*l/24+(61-58*r+r*r+600*o-330*i)*l*l*l*l*l*l/720));return 0>c&&(_+=1e7),{northing:Math.round(_),easting:Math.round(L),zoneNumber:p,zoneLetter:a(c)}}function o(t){var e=t.northing,i=t.easting,n=t.zoneLetter,r=t.zoneNumber;if(0>r||r>60)return null;var a,l,h,u,p,c,d,m,f,y,g=.9996,v=6378137,L=.00669438,_=(1-Math.sqrt(1-L))/(1+Math.sqrt(1-L)),O=i-5e5,b=e;"N">n&&(b-=1e7),m=6*(r-1)-180+3,a=L/(1-L),d=b/g,f=d/(v*(1-L/4-3*L*L/64-5*L*L*L/256)),y=f+(3*_/2-27*_*_*_/32)*Math.sin(2*f)+(21*_*_/16-55*_*_*_*_/32)*Math.sin(4*f)+151*_*_*_/96*Math.sin(6*f),l=v/Math.sqrt(1-L*Math.sin(y)*Math.sin(y)),h=Math.tan(y)*Math.tan(y),u=a*Math.cos(y)*Math.cos(y),p=v*(1-L)/Math.pow(1-L*Math.sin(y)*Math.sin(y),1.5),c=O/(l*g);var w=y-l*Math.tan(y)/p*(c*c/2-(5+3*h+10*u-4*u*u-9*a)*c*c*c*c/24+(61+90*h+298*u+45*h*h-252*a-3*u*u)*c*c*c*c*c*c/720);w=s(w);var x=(c-(1+2*h+u)*c*c*c/6+(5-2*u+28*h-3*u*u+8*a+24*h*h)*c*c*c*c*c/120)/Math.cos(y);x=m+s(x);var S;if(t.accuracy){var C=o({northing:t.northing+t.accuracy,easting:t.easting+t.accuracy,zoneLetter:t.zoneLetter,zoneNumber:t.zoneNumber});S={top:C.lat,right:C.lon,bottom:w,left:x}}else S={lat:w,lon:x};return S}function a(t){var e="Z";return 84>=t&&t>=72?e="X":72>t&&t>=64?e="W":64>t&&t>=56?e="V":56>t&&t>=48?e="U":48>t&&t>=40?e="T":40>t&&t>=32?e="S":32>t&&t>=24?e="R":24>t&&t>=16?e="Q":16>t&&t>=8?e="P":8>t&&t>=0?e="N":0>t&&t>=-8?e="M":-8>t&&t>=-16?e="L":-16>t&&t>=-24?e="K":-24>t&&t>=-32?e="J":-32>t&&t>=-40?e="H":-40>t&&t>=-48?e="G":-48>t&&t>=-56?e="F":-56>t&&t>=-64?e="E":-64>t&&t>=-72?e="D":-72>t&&t>=-80&&(e="C"),e}function l(t,e){var i=""+t.easting,n=""+t.northing;return t.zoneNumber+t.zoneLetter+h(t.easting,t.northing,t.zoneNumber)+i.substr(i.length-5,e)+n.substr(n.length-5,e)}function h(t,e,i){var n=u(i),s=Math.floor(t/1e5),r=Math.floor(e/1e5)%20;return p(s,r,n)}function u(t){var e=t%y;return 0===e&&(e=y),e}function p(t,e,i){var n=i-1,s=g.charCodeAt(n),r=v.charCodeAt(n),o=s+t-1,a=r+e,l=!1;o>w&&(o=o-w+L-1,l=!0),(o===_||_>s&&o>_||(o>_||_>s)&&l)&&o++,(o===O||O>s&&o>O||(o>O||O>s)&&l)&&(o++,o===_&&o++),o>w&&(o=o-w+L-1),a>b?(a=a-b+L-1,l=!0):l=!1,(a===_||_>r&&a>_||(a>_||_>r)&&l)&&a++,(a===O||O>r&&a>O||(a>O||O>r)&&l)&&(a++,a===_&&a++),a>b&&(a=a-b+L-1);var h=String.fromCharCode(o)+String.fromCharCode(a);return h}function c(t){if(t&&0===t.length)throw"MGRSPoint coverting from nothing";for(var e,i=t.length,n=null,s="",r=0;!/[A-Z]/.test(e=t.charAt(r));){if(r>=2)throw"MGRSPoint bad conversion from: "+t;s+=e,r++}var o=parseInt(s,10);if(0===r||r+3>i)throw"MGRSPoint bad conversion from: "+t;var a=t.charAt(r++);if("A">=a||"B"===a||"Y"===a||a>="Z"||"I"===a||"O"===a)throw"MGRSPoint zone letter "+a+" not handled: "+t;n=t.substring(r,r+=2);for(var l=u(o),h=d(n.charAt(0),l),p=m(n.charAt(1),l);p<f(a);)p+=2e6;var c=i-r;if(c%2!==0)throw"MGRSPoint has to have an even number \nof digits after the zone letter and two 100km letters - front \nhalf for easting meters, second half for \nnorthing meters"+t;var y,g,v,L,_,O=c/2,b=0,w=0;return O>0&&(y=1e5/Math.pow(10,O),g=t.substring(r,r+O),b=parseFloat(g)*y,v=t.substring(r+O),w=parseFloat(v)*y),L=b+h,_=w+p,{easting:L,northing:_,zoneLetter:a,zoneNumber:o,accuracy:y}}function d(t,e){for(var i=g.charCodeAt(e-1),n=1e5,s=!1;i!==t.charCodeAt(0);){if(i++,i===_&&i++,i===O&&i++,i>w){if(s)throw"Bad character: "+t;i=L,s=!0}n+=1e5}return n}function m(t,e){if(t>"V")throw"MGRSPoint given invalid Northing "+t;for(var i=v.charCodeAt(e-1),n=0,s=!1;i!==t.charCodeAt(0);){if(i++,i===_&&i++,i===O&&i++,i>b){if(s)throw"Bad character: "+t;i=L,s=!0}n+=1e5}return n}function f(t){var e;switch(t){case"C":e=11e5;break;case"D":e=2e6;break;case"E":e=28e5;break;case"F":e=37e5;break;case"G":e=46e5;break;case"H":e=55e5;break;case"J":e=64e5;break;case"K":e=73e5;break;case"L":e=82e5;break;case"M":e=91e5;break;case"N":e=0;break;case"P":e=8e5;break;case"Q":e=17e5;break;case"R":e=26e5;break;case"S":e=35e5;break;case"T":e=44e5;break;case"U":e=53e5;break;case"V":e=62e5;break;case"W":e=7e6;break;case"X":e=79e5;break;default:e=-1}if(e>=0)return e;throw"Invalid zone letter: "+t}var y=6,g="AJSAJS",v="AFAFAF",L=65,_=73,O=79,b=86,w=90;i.forward=function(t,e){return e=e||5,l(r({lat:t[1],lon:t[0]}),e)},i.inverse=function(t){var e=o(c(t.toUpperCase()));return[e.left,e.bottom,e.right,e.top]},i.toPoint=function(t){var e=i.inverse(t);return[(e[2]+e[0])/2,(e[3]+e[1])/2]}},{}],67:[function(t,e){e.exports={name:"proj4",version:"2.1.4",description:"Proj4js is a JavaScript library to transform point coordinates from one coordinate system to another, including datum transformations.",main:"lib/index.js",directories:{test:"test",doc:"docs"},scripts:{test:"./node_modules/istanbul/lib/cli.js test ./node_modules/mocha/bin/_mocha test/test.js"},repository:{type:"git",url:"git://github.com/proj4js/proj4js.git"},author:"",license:"MIT",jam:{main:"dist/proj4.js",include:["dist/proj4.js","README.md","AUTHORS","LICENSE.md"]},devDependencies:{"grunt-cli":"~0.1.13",grunt:"~0.4.2","grunt-contrib-connect":"~0.6.0","grunt-contrib-jshint":"~0.8.0",chai:"~1.8.1",mocha:"~1.17.1","grunt-mocha-phantomjs":"~0.4.0",browserify:"~3.24.5","grunt-browserify":"~1.3.0","grunt-contrib-uglify":"~0.3.2",curl:"git://github.com/cujojs/curl.git",istanbul:"~0.2.4",tin:"~0.4.0"},dependencies:{mgrs:"0.0.0"}}},{}],"./includedProjections":[function(t,e){e.exports=t("gWUPNW")},{}],gWUPNW:[function(t,e){var i=[t("./lib/projections/tmerc"),t("./lib/projections/utm"),t("./lib/projections/sterea"),t("./lib/projections/stere"),t("./lib/projections/somerc"),t("./lib/projections/omerc"),t("./lib/projections/lcc"),t("./lib/projections/krovak"),t("./lib/projections/cass"),t("./lib/projections/laea"),t("./lib/projections/aea"),t("./lib/projections/gnom"),t("./lib/projections/cea"),t("./lib/projections/eqc"),t("./lib/projections/poly"),t("./lib/projections/nzmg"),t("./lib/projections/mill"),t("./lib/projections/sinu"),t("./lib/projections/moll"),t("./lib/projections/eqdc"),t("./lib/projections/vandg"),t("./lib/projections/aeqd")];e.exports=function(t){i.forEach(function(e){t.Proj.projections.add(e)})}},{"./lib/projections/aea":39,"./lib/projections/aeqd":40,"./lib/projections/cass":41,"./lib/projections/cea":42,"./lib/projections/eqc":43,"./lib/projections/eqdc":44,"./lib/projections/gnom":46,"./lib/projections/krovak":47,"./lib/projections/laea":48,"./lib/projections/lcc":49,"./lib/projections/mill":52,"./lib/projections/moll":53,"./lib/projections/nzmg":54,"./lib/projections/omerc":55,"./lib/projections/poly":56,"./lib/projections/sinu":57,"./lib/projections/somerc":58,"./lib/projections/stere":59,"./lib/projections/sterea":60,"./lib/projections/tmerc":61,"./lib/projections/utm":62,"./lib/projections/vandg":63}]},{},[35])(35)}),function(t,e){function i(t){var e=t.length,i=ue.type(t);return ue.isWindow(t)?!1:1===t.nodeType&&e?!0:"array"===i||"function"!==i&&(0===e||"number"==typeof e&&e>0&&e-1 in t)}function n(t){var e=Se[t]={};return ue.each(t.match(ce)||[],function(t,i){e[i]=!0}),e}function s(t,i,n,s){if(ue.acceptData(t)){var r,o,a=ue.expando,l=t.nodeType,h=l?ue.cache:t,u=l?t[a]:t[a]&&a;if(u&&h[u]&&(s||h[u].data)||n!==e||"string"!=typeof i)return u||(u=l?t[a]=ee.pop()||ue.guid++:a),h[u]||(h[u]=l?{}:{toJSON:ue.noop}),("object"==typeof i||"function"==typeof i)&&(s?h[u]=ue.extend(h[u],i):h[u].data=ue.extend(h[u].data,i)),o=h[u],s||(o.data||(o.data={}),o=o.data),n!==e&&(o[ue.camelCase(i)]=n),"string"==typeof i?(r=o[i],null==r&&(r=o[ue.camelCase(i)])):r=o,r}}function r(t,e,i){if(ue.acceptData(t)){var n,s,r=t.nodeType,o=r?ue.cache:t,l=r?t[ue.expando]:ue.expando;if(o[l]){if(e&&(n=i?o[l]:o[l].data)){ue.isArray(e)?e=e.concat(ue.map(e,ue.camelCase)):e in n?e=[e]:(e=ue.camelCase(e),e=e in n?[e]:e.split(" ")),s=e.length;for(;s--;)delete n[e[s]];if(i?!a(n):!ue.isEmptyObject(n))return}(i||(delete o[l].data,a(o[l])))&&(r?ue.cleanData([t],!0):ue.support.deleteExpando||o!=o.window?delete o[l]:o[l]=null)}}}function o(t,i,n){if(n===e&&1===t.nodeType){var s="data-"+i.replace(Ee,"-$1").toLowerCase();if(n=t.getAttribute(s),"string"==typeof n){try{n="true"===n?!0:"false"===n?!1:"null"===n?null:+n+""===n?+n:Ce.test(n)?ue.parseJSON(n):n}catch(r){}ue.data(t,i,n)}else n=e}return n}function a(t){var e;for(e in t)if(("data"!==e||!ue.isEmptyObject(t[e]))&&"toJSON"!==e)return!1;return!0}function l(){return!0}function h(){return!1}function u(){try{return Y.activeElement}catch(t){}}function p(t,e){do t=t[e];while(t&&1!==t.nodeType);return t}function c(t,e,i){if(ue.isFunction(e))return ue.grep(t,function(t,n){return!!e.call(t,n,t)!==i});if(e.nodeType)return ue.grep(t,function(t){return t===e!==i});if("string"==typeof e){if(je.test(e))return ue.filter(e,t,i);e=ue.filter(e,t)}return ue.grep(t,function(t){return ue.inArray(t,e)>=0!==i})}function d(t){var e=qe.split("|"),i=t.createDocumentFragment();if(i.createElement)for(;e.length;)i.createElement(e.pop());return i}function m(t,e){return ue.nodeName(t,"table")&&ue.nodeName(1===e.nodeType?e:e.firstChild,"tr")?t.getElementsByTagName("tbody")[0]||t.appendChild(t.ownerDocument.createElement("tbody")):t}function f(t){return t.type=(null!==ue.find.attr(t,"type"))+"/"+t.type,t}function y(t){var e=si.exec(t.type);return e?t.type=e[1]:t.removeAttribute("type"),t}function g(t,e){for(var i,n=0;null!=(i=t[n]);n++)ue._data(i,"globalEval",!e||ue._data(e[n],"globalEval"))}function v(t,e){if(1===e.nodeType&&ue.hasData(t)){var i,n,s,r=ue._data(t),o=ue._data(e,r),a=r.events;if(a){delete o.handle,o.events={};for(i in a)for(n=0,s=a[i].length;s>n;n++)ue.event.add(e,i,a[i][n])}o.data&&(o.data=ue.extend({},o.data))}}function L(t,e){var i,n,s;if(1===e.nodeType){if(i=e.nodeName.toLowerCase(),!ue.support.noCloneEvent&&e[ue.expando]){s=ue._data(e);for(n in s.events)ue.removeEvent(e,n,s.handle);e.removeAttribute(ue.expando)}"script"===i&&e.text!==t.text?(f(e).text=t.text,y(e)):"object"===i?(e.parentNode&&(e.outerHTML=t.outerHTML),ue.support.html5Clone&&t.innerHTML&&!ue.trim(e.innerHTML)&&(e.innerHTML=t.innerHTML)):"input"===i&&ei.test(t.type)?(e.defaultChecked=e.checked=t.checked,e.value!==t.value&&(e.value=t.value)):"option"===i?e.defaultSelected=e.selected=t.defaultSelected:("input"===i||"textarea"===i)&&(e.defaultValue=t.defaultValue)}}function _(t,i){var n,s,r=0,o=typeof t.getElementsByTagName!==X?t.getElementsByTagName(i||"*"):typeof t.querySelectorAll!==X?t.querySelectorAll(i||"*"):e;if(!o)for(o=[],n=t.childNodes||t;null!=(s=n[r]);r++)!i||ue.nodeName(s,i)?o.push(s):ue.merge(o,_(s,i));return i===e||i&&ue.nodeName(t,i)?ue.merge([t],o):o}function O(t){ei.test(t.type)&&(t.defaultChecked=t.checked)}function b(t,e){if(e in t)return e;for(var i=e.charAt(0).toUpperCase()+e.slice(1),n=e,s=xi.length;s--;)if(e=xi[s]+i,e in t)return e;return n}function w(t,e){return t=e||t,"none"===ue.css(t,"display")||!ue.contains(t.ownerDocument,t)}function x(t,e){for(var i,n,s,r=[],o=0,a=t.length;a>o;o++)n=t[o],n.style&&(r[o]=ue._data(n,"olddisplay"),i=n.style.display,e?(r[o]||"none"!==i||(n.style.display=""),""===n.style.display&&w(n)&&(r[o]=ue._data(n,"olddisplay",P(n.nodeName)))):r[o]||(s=w(n),(i&&"none"!==i||!s)&&ue._data(n,"olddisplay",s?i:ue.css(n,"display"))));for(o=0;a>o;o++)n=t[o],n.style&&(e&&"none"!==n.style.display&&""!==n.style.display||(n.style.display=e?r[o]||"":"none"));return t}function S(t,e,i){var n=gi.exec(e);return n?Math.max(0,n[1]-(i||0))+(n[2]||"px"):e}function C(t,e,i,n,s){for(var r=i===(n?"border":"content")?4:"width"===e?1:0,o=0;4>r;r+=2)"margin"===i&&(o+=ue.css(t,i+wi[r],!0,s)),n?("content"===i&&(o-=ue.css(t,"padding"+wi[r],!0,s)),"margin"!==i&&(o-=ue.css(t,"border"+wi[r]+"Width",!0,s))):(o+=ue.css(t,"padding"+wi[r],!0,s),"padding"!==i&&(o+=ue.css(t,"border"+wi[r]+"Width",!0,s)));return o}function E(t,e,i){var n=!0,s="width"===e?t.offsetWidth:t.offsetHeight,r=ui(t),o=ue.support.boxSizing&&"border-box"===ue.css(t,"boxSizing",!1,r);if(0>=s||null==s){if(s=pi(t,e,r),(0>s||null==s)&&(s=t.style[e]),vi.test(s))return s;n=o&&(ue.support.boxSizingReliable||s===t.style[e]),s=parseFloat(s)||0}return s+C(t,e,i||(o?"border":"content"),n,r)+"px"}function P(t){var e=Y,i=_i[t];return i||(i=M(t,e),"none"!==i&&i||(hi=(hi||ue("<iframe frameborder='0' width='0' height='0'/>").css("cssText","display:block !important")).appendTo(e.documentElement),e=(hi[0].contentWindow||hi[0].contentDocument).document,e.write("<!doctype html><html><body>"),e.close(),i=M(t,e),hi.detach()),_i[t]=i),i}function M(t,e){var i=ue(e.createElement(t)).appendTo(e.body),n=ue.css(i[0],"display");return i.remove(),n}function N(t,e,i,n){var s;if(ue.isArray(e))ue.each(e,function(e,s){i||Ci.test(t)?n(t,s):N(t+"["+("object"==typeof s?e:"")+"]",s,i,n)});else if(i||"object"!==ue.type(e))n(t,e);else for(s in e)N(t+"["+s+"]",e[s],i,n)}function T(t){return function(e,i){"string"!=typeof e&&(i=e,e="*");var n,s=0,r=e.toLowerCase().match(ce)||[];if(ue.isFunction(i))for(;n=r[s++];)"+"===n[0]?(n=n.slice(1)||"*",(t[n]=t[n]||[]).unshift(i)):(t[n]=t[n]||[]).push(i)}}function A(t,e,i,n){function s(a){var l;return r[a]=!0,ue.each(t[a]||[],function(t,a){var h=a(e,i,n);return"string"!=typeof h||o||r[h]?o?!(l=h):void 0:(e.dataTypes.unshift(h),s(h),!1)}),l}var r={},o=t===Hi;return s(e.dataTypes[0])||!r["*"]&&s("*")}function k(t,i){var n,s,r=ue.ajaxSettings.flatOptions||{};for(s in i)i[s]!==e&&((r[s]?t:n||(n={}))[s]=i[s]);return n&&ue.extend(!0,t,n),t}function D(t,i,n){for(var s,r,o,a,l=t.contents,h=t.dataTypes;"*"===h[0];)h.shift(),r===e&&(r=t.mimeType||i.getResponseHeader("Content-Type"));if(r)for(a in l)if(l[a]&&l[a].test(r)){h.unshift(a);break}if(h[0]in n)o=h[0];else{for(a in n){if(!h[0]||t.converters[a+" "+h[0]]){o=a;break}s||(s=a)}o=o||s}return o?(o!==h[0]&&h.unshift(o),n[o]):void 0}function F(t,e,i,n){var s,r,o,a,l,h={},u=t.dataTypes.slice();if(u[1])for(o in t.converters)h[o.toLowerCase()]=t.converters[o];for(r=u.shift();r;)if(t.responseFields[r]&&(i[t.responseFields[r]]=e),!l&&n&&t.dataFilter&&(e=t.dataFilter(e,t.dataType)),l=r,r=u.shift())if("*"===r)r=l;else if("*"!==l&&l!==r){if(o=h[l+" "+r]||h["* "+r],!o)for(s in h)if(a=s.split(" "),a[1]===r&&(o=h[l+" "+a[0]]||h["* "+a[0]])){o===!0?o=h[s]:h[s]!==!0&&(r=a[0],u.unshift(a[1]));break}if(o!==!0)if(o&&t["throws"])e=o(e);else try{e=o(e)}catch(p){return{state:"parsererror",error:o?p:"No conversion from "+l+" to "+r}}}return{state:"success",data:e}}function I(){try{return new t.XMLHttpRequest}catch(e){}}function R(){try{return new t.ActiveXObject("Microsoft.XMLHTTP")}catch(e){}}function z(){return setTimeout(function(){Ji=e}),Ji=ue.now()}function U(t,e,i){for(var n,s=(rn[e]||[]).concat(rn["*"]),r=0,o=s.length;o>r;r++)if(n=s[r].call(i,e,t))return n}function B(t,e,i){var n,s,r=0,o=sn.length,a=ue.Deferred().always(function(){delete l.elem}),l=function(){if(s)return!1;for(var e=Ji||z(),i=Math.max(0,h.startTime+h.duration-e),n=i/h.duration||0,r=1-n,o=0,l=h.tweens.length;l>o;o++)h.tweens[o].run(r);return a.notifyWith(t,[h,r,i]),1>r&&l?i:(a.resolveWith(t,[h]),!1)},h=a.promise({elem:t,props:ue.extend({},e),opts:ue.extend(!0,{specialEasing:{}},i),originalProperties:e,originalOptions:i,startTime:Ji||z(),duration:i.duration,tweens:[],createTween:function(e,i){var n=ue.Tween(t,h.opts,e,i,h.opts.specialEasing[e]||h.opts.easing);return h.tweens.push(n),n},stop:function(e){var i=0,n=e?h.tweens.length:0;if(s)return this;for(s=!0;n>i;i++)h.tweens[i].run(1);return e?a.resolveWith(t,[h,e]):a.rejectWith(t,[h,e]),this}}),u=h.props;for(G(u,h.opts.specialEasing);o>r;r++)if(n=sn[r].call(h,t,u,h.opts))return n;return ue.map(u,U,h),ue.isFunction(h.opts.start)&&h.opts.start.call(t,h),ue.fx.timer(ue.extend(l,{elem:t,anim:h,queue:h.opts.queue})),h.progress(h.opts.progress).done(h.opts.done,h.opts.complete).fail(h.opts.fail).always(h.opts.always)}function G(t,e){var i,n,s,r,o;for(i in t)if(n=ue.camelCase(i),s=e[n],r=t[i],ue.isArray(r)&&(s=r[1],r=t[i]=r[0]),i!==n&&(t[n]=r,delete t[i]),o=ue.cssHooks[n],o&&"expand"in o){r=o.expand(r),delete t[n];for(i in r)i in t||(t[i]=r[i],e[i]=s)}else e[n]=s}function j(t,e,i){var n,s,r,o,a,l,h=this,u={},p=t.style,c=t.nodeType&&w(t),d=ue._data(t,"fxshow");i.queue||(a=ue._queueHooks(t,"fx"),null==a.unqueued&&(a.unqueued=0,l=a.empty.fire,a.empty.fire=function(){a.unqueued||l()}),a.unqueued++,h.always(function(){h.always(function(){a.unqueued--,ue.queue(t,"fx").length||a.empty.fire()})})),1===t.nodeType&&("height"in e||"width"in e)&&(i.overflow=[p.overflow,p.overflowX,p.overflowY],"inline"===ue.css(t,"display")&&"none"===ue.css(t,"float")&&(ue.support.inlineBlockNeedsLayout&&"inline"!==P(t.nodeName)?p.zoom=1:p.display="inline-block")),i.overflow&&(p.overflow="hidden",ue.support.shrinkWrapBlocks||h.always(function(){p.overflow=i.overflow[0],p.overflowX=i.overflow[1],p.overflowY=i.overflow[2]}));for(n in e)if(s=e[n],tn.exec(s)){if(delete e[n],r=r||"toggle"===s,s===(c?"hide":"show"))continue;u[n]=d&&d[n]||ue.style(t,n)}if(!ue.isEmptyObject(u)){d?"hidden"in d&&(c=d.hidden):d=ue._data(t,"fxshow",{}),r&&(d.hidden=!c),c?ue(t).show():h.done(function(){ue(t).hide()}),h.done(function(){var e;ue._removeData(t,"fxshow");for(e in u)ue.style(t,e,u[e])});for(n in u)o=U(c?d[n]:0,n,h),n in d||(d[n]=o.start,c&&(o.end=o.start,o.start="width"===n||"height"===n?1:0))}}function H(t,e,i,n,s){return new H.prototype.init(t,e,i,n,s)}function W(t,e){var i,n={height:t},s=0;for(e=e?1:0;4>s;s+=2-e)i=wi[s],n["margin"+i]=n["padding"+i]=t;return e&&(n.opacity=n.width=t),n}function V(t){return ue.isWindow(t)?t:9===t.nodeType?t.defaultView||t.parentWindow:!1}var q,Z,X=typeof e,$=t.location,Y=t.document,K=Y.documentElement,J=t.jQuery,Q=t.$,te={},ee=[],ie="1.10.2",ne=ee.concat,se=ee.push,re=ee.slice,oe=ee.indexOf,ae=te.toString,le=te.hasOwnProperty,he=ie.trim,ue=function(t,e){return new ue.fn.init(t,e,Z)},pe=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,ce=/\S+/g,de=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,me=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,fe=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,ye=/^[\],:{}\s]*$/,ge=/(?:^|:|,)(?:\s*\[)+/g,ve=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,Le=/"[^"\\\r\n]*"|true|false|null|-?(?:\d+\.|)\d+(?:[eE][+-]?\d+|)/g,_e=/^-ms-/,Oe=/-([\da-z])/gi,be=function(t,e){return e.toUpperCase()},we=function(t){(Y.addEventListener||"load"===t.type||"complete"===Y.readyState)&&(xe(),ue.ready())},xe=function(){Y.addEventListener?(Y.removeEventListener("DOMContentLoaded",we,!1),t.removeEventListener("load",we,!1)):(Y.detachEvent("onreadystatechange",we),t.detachEvent("onload",we))};ue.fn=ue.prototype={jquery:ie,constructor:ue,init:function(t,i,n){var s,r;if(!t)return this;if("string"==typeof t){if(s="<"===t.charAt(0)&&">"===t.charAt(t.length-1)&&t.length>=3?[null,t,null]:me.exec(t),!s||!s[1]&&i)return!i||i.jquery?(i||n).find(t):this.constructor(i).find(t);if(s[1]){if(i=i instanceof ue?i[0]:i,ue.merge(this,ue.parseHTML(s[1],i&&i.nodeType?i.ownerDocument||i:Y,!0)),fe.test(s[1])&&ue.isPlainObject(i))for(s in i)ue.isFunction(this[s])?this[s](i[s]):this.attr(s,i[s]);return this}if(r=Y.getElementById(s[2]),r&&r.parentNode){if(r.id!==s[2])return n.find(t);this.length=1,this[0]=r}return this.context=Y,this.selector=t,this}return t.nodeType?(this.context=this[0]=t,this.length=1,this):ue.isFunction(t)?n.ready(t):(t.selector!==e&&(this.selector=t.selector,this.context=t.context),ue.makeArray(t,this))},selector:"",length:0,toArray:function(){return re.call(this)},get:function(t){return null==t?this.toArray():0>t?this[this.length+t]:this[t]},pushStack:function(t){var e=ue.merge(this.constructor(),t);return e.prevObject=this,e.context=this.context,e},each:function(t,e){return ue.each(this,t,e)},ready:function(t){return ue.ready.promise().done(t),this},slice:function(){return this.pushStack(re.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(t){var e=this.length,i=+t+(0>t?e:0);return this.pushStack(i>=0&&e>i?[this[i]]:[])},map:function(t){return this.pushStack(ue.map(this,function(e,i){return t.call(e,i,e)}))},end:function(){return this.prevObject||this.constructor(null)},push:se,sort:[].sort,splice:[].splice},ue.fn.init.prototype=ue.fn,ue.extend=ue.fn.extend=function(){var t,i,n,s,r,o,a=arguments[0]||{},l=1,h=arguments.length,u=!1;for("boolean"==typeof a&&(u=a,a=arguments[1]||{},l=2),"object"==typeof a||ue.isFunction(a)||(a={}),h===l&&(a=this,--l);h>l;l++)if(null!=(r=arguments[l]))for(s in r)t=a[s],n=r[s],a!==n&&(u&&n&&(ue.isPlainObject(n)||(i=ue.isArray(n)))?(i?(i=!1,o=t&&ue.isArray(t)?t:[]):o=t&&ue.isPlainObject(t)?t:{},a[s]=ue.extend(u,o,n)):n!==e&&(a[s]=n));return a},ue.extend({expando:"jQuery"+(ie+Math.random()).replace(/\D/g,""),noConflict:function(e){return t.$===ue&&(t.$=Q),e&&t.jQuery===ue&&(t.jQuery=J),ue},isReady:!1,readyWait:1,holdReady:function(t){t?ue.readyWait++:ue.ready(!0)},ready:function(t){if(t===!0?!--ue.readyWait:!ue.isReady){if(!Y.body)return setTimeout(ue.ready);ue.isReady=!0,t!==!0&&--ue.readyWait>0||(q.resolveWith(Y,[ue]),ue.fn.trigger&&ue(Y).trigger("ready").off("ready"))}},isFunction:function(t){return"function"===ue.type(t)},isArray:Array.isArray||function(t){return"array"===ue.type(t)},isWindow:function(t){return null!=t&&t==t.window},isNumeric:function(t){return!isNaN(parseFloat(t))&&isFinite(t)},type:function(t){return null==t?String(t):"object"==typeof t||"function"==typeof t?te[ae.call(t)]||"object":typeof t},isPlainObject:function(t){var i;if(!t||"object"!==ue.type(t)||t.nodeType||ue.isWindow(t))return!1;try{if(t.constructor&&!le.call(t,"constructor")&&!le.call(t.constructor.prototype,"isPrototypeOf"))return!1}catch(n){return!1}if(ue.support.ownLast)for(i in t)return le.call(t,i);for(i in t);return i===e||le.call(t,i)},isEmptyObject:function(t){var e;for(e in t)return!1;return!0},error:function(t){throw new Error(t)},parseHTML:function(t,e,i){if(!t||"string"!=typeof t)return null;"boolean"==typeof e&&(i=e,e=!1),e=e||Y;var n=fe.exec(t),s=!i&&[];return n?[e.createElement(n[1])]:(n=ue.buildFragment([t],e,s),s&&ue(s).remove(),ue.merge([],n.childNodes))},parseJSON:function(e){return t.JSON&&t.JSON.parse?t.JSON.parse(e):null===e?e:"string"==typeof e&&(e=ue.trim(e),e&&ye.test(e.replace(ve,"@").replace(Le,"]").replace(ge,"")))?new Function("return "+e)():void ue.error("Invalid JSON: "+e)},parseXML:function(i){var n,s;if(!i||"string"!=typeof i)return null;try{t.DOMParser?(s=new DOMParser,n=s.parseFromString(i,"text/xml")):(n=new ActiveXObject("Microsoft.XMLDOM"),n.async="false",n.loadXML(i))}catch(r){n=e}return n&&n.documentElement&&!n.getElementsByTagName("parsererror").length||ue.error("Invalid XML: "+i),n},noop:function(){},globalEval:function(e){e&&ue.trim(e)&&(t.execScript||function(e){t.eval.call(t,e)})(e)},camelCase:function(t){return t.replace(_e,"ms-").replace(Oe,be)},nodeName:function(t,e){return t.nodeName&&t.nodeName.toLowerCase()===e.toLowerCase()},each:function(t,e,n){var s,r=0,o=t.length,a=i(t);if(n){if(a)for(;o>r&&(s=e.apply(t[r],n),s!==!1);r++);else for(r in t)if(s=e.apply(t[r],n),s===!1)break}else if(a)for(;o>r&&(s=e.call(t[r],r,t[r]),s!==!1);r++);else for(r in t)if(s=e.call(t[r],r,t[r]),s===!1)break;return t},trim:he&&!he.call("﻿ ")?function(t){return null==t?"":he.call(t)}:function(t){return null==t?"":(t+"").replace(de,"")},makeArray:function(t,e){var n=e||[];return null!=t&&(i(Object(t))?ue.merge(n,"string"==typeof t?[t]:t):se.call(n,t)),n},inArray:function(t,e,i){var n;if(e){if(oe)return oe.call(e,t,i);for(n=e.length,i=i?0>i?Math.max(0,n+i):i:0;n>i;i++)if(i in e&&e[i]===t)return i}return-1},merge:function(t,i){var n=i.length,s=t.length,r=0;if("number"==typeof n)for(;n>r;r++)t[s++]=i[r];else for(;i[r]!==e;)t[s++]=i[r++];return t.length=s,t},grep:function(t,e,i){var n,s=[],r=0,o=t.length;for(i=!!i;o>r;r++)n=!!e(t[r],r),i!==n&&s.push(t[r]);return s},map:function(t,e,n){var s,r=0,o=t.length,a=i(t),l=[];if(a)for(;o>r;r++)s=e(t[r],r,n),null!=s&&(l[l.length]=s);else for(r in t)s=e(t[r],r,n),null!=s&&(l[l.length]=s);return ne.apply([],l)},guid:1,proxy:function(t,i){var n,s,r;return"string"==typeof i&&(r=t[i],i=t,t=r),ue.isFunction(t)?(n=re.call(arguments,2),s=function(){return t.apply(i||this,n.concat(re.call(arguments)))},s.guid=t.guid=t.guid||ue.guid++,s):e},access:function(t,i,n,s,r,o,a){var l=0,h=t.length,u=null==n;if("object"===ue.type(n)){r=!0;for(l in n)ue.access(t,i,l,n[l],!0,o,a)}else if(s!==e&&(r=!0,ue.isFunction(s)||(a=!0),u&&(a?(i.call(t,s),i=null):(u=i,i=function(t,e,i){return u.call(ue(t),i)})),i))for(;h>l;l++)i(t[l],n,a?s:s.call(t[l],l,i(t[l],n)));return r?t:u?i.call(t):h?i(t[0],n):o},now:function(){return(new Date).getTime()},swap:function(t,e,i,n){var s,r,o={};for(r in e)o[r]=t.style[r],t.style[r]=e[r];s=i.apply(t,n||[]);for(r in e)t.style[r]=o[r];return s}}),ue.ready.promise=function(e){if(!q)if(q=ue.Deferred(),"complete"===Y.readyState)setTimeout(ue.ready);else if(Y.addEventListener)Y.addEventListener("DOMContentLoaded",we,!1),t.addEventListener("load",we,!1);else{Y.attachEvent("onreadystatechange",we),t.attachEvent("onload",we);var i=!1;try{i=null==t.frameElement&&Y.documentElement}catch(n){}i&&i.doScroll&&!function s(){if(!ue.isReady){try{i.doScroll("left")}catch(t){return setTimeout(s,50)}xe(),ue.ready()}}()}return q.promise(e)},ue.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(t,e){te["[object "+e+"]"]=e.toLowerCase()}),Z=ue(Y),function(t,e){function i(t,e,i,n){var s,r,o,a,l,h,u,p,m,f;if((e?e.ownerDocument||e:B)!==A&&T(e),e=e||A,i=i||[],!t||"string"!=typeof t)return i;if(1!==(a=e.nodeType)&&9!==a)return[];if(D&&!n){if(s=Le.exec(t))if(o=s[1]){if(9===a){if(r=e.getElementById(o),!r||!r.parentNode)return i;if(r.id===o)return i.push(r),i}else if(e.ownerDocument&&(r=e.ownerDocument.getElementById(o))&&z(e,r)&&r.id===o)return i.push(r),i}else{if(s[2])return te.apply(i,e.getElementsByTagName(t)),i;if((o=s[3])&&w.getElementsByClassName&&e.getElementsByClassName)return te.apply(i,e.getElementsByClassName(o)),i}if(w.qsa&&(!F||!F.test(t))){if(p=u=U,m=e,f=9===a&&t,1===a&&"object"!==e.nodeName.toLowerCase()){for(h=c(t),(u=e.getAttribute("id"))?p=u.replace(be,"\\$&"):e.setAttribute("id",p),p="[id='"+p+"'] ",l=h.length;l--;)h[l]=p+d(h[l]);m=de.test(t)&&e.parentNode||e,f=h.join(",")}if(f)try{return te.apply(i,m.querySelectorAll(f)),i}catch(y){}finally{u||e.removeAttribute("id")}}}return O(t.replace(he,"$1"),e,i,n)}function n(){function t(i,n){return e.push(i+=" ")>S.cacheLength&&delete t[e.shift()],t[i]=n}var e=[];return t}function s(t){return t[U]=!0,t}function r(t){var e=A.createElement("div");try{return!!t(e)}catch(i){return!1}finally{e.parentNode&&e.parentNode.removeChild(e),e=null}}function o(t,e){for(var i=t.split("|"),n=t.length;n--;)S.attrHandle[i[n]]=e}function a(t,e){var i=e&&t,n=i&&1===t.nodeType&&1===e.nodeType&&(~e.sourceIndex||$)-(~t.sourceIndex||$);if(n)return n;if(i)for(;i=i.nextSibling;)if(i===e)return-1;return t?1:-1}function l(t){return function(e){var i=e.nodeName.toLowerCase();return"input"===i&&e.type===t}}function h(t){return function(e){var i=e.nodeName.toLowerCase();return("input"===i||"button"===i)&&e.type===t}}function u(t){return s(function(e){return e=+e,s(function(i,n){for(var s,r=t([],i.length,e),o=r.length;o--;)i[s=r[o]]&&(i[s]=!(n[s]=i[s]))})})}function p(){}function c(t,e){var n,s,r,o,a,l,h,u=W[t+" "];if(u)return e?0:u.slice(0);for(a=t,l=[],h=S.preFilter;a;){(!n||(s=pe.exec(a)))&&(s&&(a=a.slice(s[0].length)||a),l.push(r=[])),n=!1,(s=ce.exec(a))&&(n=s.shift(),r.push({value:n,type:s[0].replace(he," ")}),a=a.slice(n.length));for(o in S.filter)!(s=ge[o].exec(a))||h[o]&&!(s=h[o](s))||(n=s.shift(),r.push({value:n,type:o,matches:s}),a=a.slice(n.length));if(!n)break}return e?a.length:a?i.error(t):W(t,l).slice(0)}function d(t){for(var e=0,i=t.length,n="";i>e;e++)n+=t[e].value;return n}function m(t,e,i){var n=e.dir,s=i&&"parentNode"===n,r=j++;return e.first?function(e,i,r){for(;e=e[n];)if(1===e.nodeType||s)return t(e,i,r)}:function(e,i,o){var a,l,h,u=G+" "+r;if(o){for(;e=e[n];)if((1===e.nodeType||s)&&t(e,i,o))return!0}else for(;e=e[n];)if(1===e.nodeType||s)if(h=e[U]||(e[U]={}),(l=h[n])&&l[0]===u){if((a=l[1])===!0||a===x)return a===!0}else if(l=h[n]=[u],l[1]=t(e,i,o)||x,l[1]===!0)return!0}}function f(t){return t.length>1?function(e,i,n){for(var s=t.length;s--;)if(!t[s](e,i,n))return!1;return!0}:t[0]}function y(t,e,i,n,s){for(var r,o=[],a=0,l=t.length,h=null!=e;l>a;a++)(r=t[a])&&(!i||i(r,n,s))&&(o.push(r),h&&e.push(a));return o}function g(t,e,i,n,r,o){return n&&!n[U]&&(n=g(n)),r&&!r[U]&&(r=g(r,o)),s(function(s,o,a,l){var h,u,p,c=[],d=[],m=o.length,f=s||_(e||"*",a.nodeType?[a]:a,[]),g=!t||!s&&e?f:y(f,c,t,a,l),v=i?r||(s?t:m||n)?[]:o:g;if(i&&i(g,v,a,l),n)for(h=y(v,d),n(h,[],a,l),u=h.length;u--;)(p=h[u])&&(v[d[u]]=!(g[d[u]]=p));if(s){if(r||t){if(r){for(h=[],u=v.length;u--;)(p=v[u])&&h.push(g[u]=p);r(null,v=[],h,l)}for(u=v.length;u--;)(p=v[u])&&(h=r?ie.call(s,p):c[u])>-1&&(s[h]=!(o[h]=p))}}else v=y(v===o?v.splice(m,v.length):v),r?r(null,o,v,l):te.apply(o,v)})}function v(t){for(var e,i,n,s=t.length,r=S.relative[t[0].type],o=r||S.relative[" "],a=r?1:0,l=m(function(t){return t===e},o,!0),h=m(function(t){return ie.call(e,t)>-1},o,!0),u=[function(t,i,n){return!r&&(n||i!==M)||((e=i).nodeType?l(t,i,n):h(t,i,n))}];s>a;a++)if(i=S.relative[t[a].type])u=[m(f(u),i)];else{if(i=S.filter[t[a].type].apply(null,t[a].matches),i[U]){for(n=++a;s>n&&!S.relative[t[n].type];n++);return g(a>1&&f(u),a>1&&d(t.slice(0,a-1).concat({value:" "===t[a-2].type?"*":""})).replace(he,"$1"),i,n>a&&v(t.slice(a,n)),s>n&&v(t=t.slice(n)),s>n&&d(t))}u.push(i)}return f(u)}function L(t,e){var n=0,r=e.length>0,o=t.length>0,a=function(s,a,l,h,u){var p,c,d,m=[],f=0,g="0",v=s&&[],L=null!=u,_=M,O=s||o&&S.find.TAG("*",u&&a.parentNode||a),b=G+=null==_?1:Math.random()||.1;for(L&&(M=a!==A&&a,x=n);null!=(p=O[g]);g++){if(o&&p){for(c=0;d=t[c++];)if(d(p,a,l)){h.push(p);break}L&&(G=b,x=++n)}r&&((p=!d&&p)&&f--,s&&v.push(p))}if(f+=g,r&&g!==f){for(c=0;d=e[c++];)d(v,m,a,l);if(s){if(f>0)for(;g--;)v[g]||m[g]||(m[g]=J.call(h));m=y(m)}te.apply(h,m),L&&!s&&m.length>0&&f+e.length>1&&i.uniqueSort(h)}return L&&(G=b,M=_),v};return r?s(a):a}function _(t,e,n){for(var s=0,r=e.length;r>s;s++)i(t,e[s],n);return n}function O(t,e,i,n){var s,r,o,a,l,h=c(t);if(!n&&1===h.length){if(r=h[0]=h[0].slice(0),r.length>2&&"ID"===(o=r[0]).type&&w.getById&&9===e.nodeType&&D&&S.relative[r[1].type]){if(e=(S.find.ID(o.matches[0].replace(we,xe),e)||[])[0],!e)return i;
t=t.slice(r.shift().value.length)}for(s=ge.needsContext.test(t)?0:r.length;s--&&(o=r[s],!S.relative[a=o.type]);)if((l=S.find[a])&&(n=l(o.matches[0].replace(we,xe),de.test(r[0].type)&&e.parentNode||e))){if(r.splice(s,1),t=n.length&&d(r),!t)return te.apply(i,n),i;break}}return P(t,h)(n,e,!D,i,de.test(t)),i}var b,w,x,S,C,E,P,M,N,T,A,k,D,F,I,R,z,U="sizzle"+-new Date,B=t.document,G=0,j=0,H=n(),W=n(),V=n(),q=!1,Z=function(t,e){return t===e?(q=!0,0):0},X=typeof e,$=1<<31,Y={}.hasOwnProperty,K=[],J=K.pop,Q=K.push,te=K.push,ee=K.slice,ie=K.indexOf||function(t){for(var e=0,i=this.length;i>e;e++)if(this[e]===t)return e;return-1},ne="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",se="[\\x20\\t\\r\\n\\f]",re="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",oe=re.replace("w","w#"),ae="\\["+se+"*("+re+")"+se+"*(?:([*^$|!~]?=)"+se+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+oe+")|)|)"+se+"*\\]",le=":("+re+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+ae.replace(3,8)+")*)|.*)\\)|)",he=new RegExp("^"+se+"+|((?:^|[^\\\\])(?:\\\\.)*)"+se+"+$","g"),pe=new RegExp("^"+se+"*,"+se+"*"),ce=new RegExp("^"+se+"*([>+~]|"+se+")"+se+"*"),de=new RegExp(se+"*[+~]"),me=new RegExp("="+se+"*([^\\]'\"]*)"+se+"*\\]","g"),fe=new RegExp(le),ye=new RegExp("^"+oe+"$"),ge={ID:new RegExp("^#("+re+")"),CLASS:new RegExp("^\\.("+re+")"),TAG:new RegExp("^("+re.replace("w","w*")+")"),ATTR:new RegExp("^"+ae),PSEUDO:new RegExp("^"+le),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+se+"*(even|odd|(([+-]|)(\\d*)n|)"+se+"*(?:([+-]|)"+se+"*(\\d+)|))"+se+"*\\)|)","i"),bool:new RegExp("^(?:"+ne+")$","i"),needsContext:new RegExp("^"+se+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+se+"*((?:-\\d)?\\d*)"+se+"*\\)|)(?=[^-]|$)","i")},ve=/^[^{]+\{\s*\[native \w/,Le=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,_e=/^(?:input|select|textarea|button)$/i,Oe=/^h\d$/i,be=/'|\\/g,we=new RegExp("\\\\([\\da-f]{1,6}"+se+"?|("+se+")|.)","ig"),xe=function(t,e,i){var n="0x"+e-65536;return n!==n||i?e:0>n?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320)};try{te.apply(K=ee.call(B.childNodes),B.childNodes),K[B.childNodes.length].nodeType}catch(Se){te={apply:K.length?function(t,e){Q.apply(t,ee.call(e))}:function(t,e){for(var i=t.length,n=0;t[i++]=e[n++];);t.length=i-1}}}E=i.isXML=function(t){var e=t&&(t.ownerDocument||t).documentElement;return e?"HTML"!==e.nodeName:!1},w=i.support={},T=i.setDocument=function(t){var e=t?t.ownerDocument||t:B,i=e.defaultView;return e!==A&&9===e.nodeType&&e.documentElement?(A=e,k=e.documentElement,D=!E(e),i&&i.attachEvent&&i!==i.top&&i.attachEvent("onbeforeunload",function(){T()}),w.attributes=r(function(t){return t.className="i",!t.getAttribute("className")}),w.getElementsByTagName=r(function(t){return t.appendChild(e.createComment("")),!t.getElementsByTagName("*").length}),w.getElementsByClassName=r(function(t){return t.innerHTML="<div class='a'></div><div class='a i'></div>",t.firstChild.className="i",2===t.getElementsByClassName("i").length}),w.getById=r(function(t){return k.appendChild(t).id=U,!e.getElementsByName||!e.getElementsByName(U).length}),w.getById?(S.find.ID=function(t,e){if(typeof e.getElementById!==X&&D){var i=e.getElementById(t);return i&&i.parentNode?[i]:[]}},S.filter.ID=function(t){var e=t.replace(we,xe);return function(t){return t.getAttribute("id")===e}}):(delete S.find.ID,S.filter.ID=function(t){var e=t.replace(we,xe);return function(t){var i=typeof t.getAttributeNode!==X&&t.getAttributeNode("id");return i&&i.value===e}}),S.find.TAG=w.getElementsByTagName?function(t,e){return typeof e.getElementsByTagName!==X?e.getElementsByTagName(t):void 0}:function(t,e){var i,n=[],s=0,r=e.getElementsByTagName(t);if("*"===t){for(;i=r[s++];)1===i.nodeType&&n.push(i);return n}return r},S.find.CLASS=w.getElementsByClassName&&function(t,e){return typeof e.getElementsByClassName!==X&&D?e.getElementsByClassName(t):void 0},I=[],F=[],(w.qsa=ve.test(e.querySelectorAll))&&(r(function(t){t.innerHTML="<select><option selected=''></option></select>",t.querySelectorAll("[selected]").length||F.push("\\["+se+"*(?:value|"+ne+")"),t.querySelectorAll(":checked").length||F.push(":checked")}),r(function(t){var i=e.createElement("input");i.setAttribute("type","hidden"),t.appendChild(i).setAttribute("t",""),t.querySelectorAll("[t^='']").length&&F.push("[*^$]="+se+"*(?:''|\"\")"),t.querySelectorAll(":enabled").length||F.push(":enabled",":disabled"),t.querySelectorAll("*,:x"),F.push(",.*:")})),(w.matchesSelector=ve.test(R=k.webkitMatchesSelector||k.mozMatchesSelector||k.oMatchesSelector||k.msMatchesSelector))&&r(function(t){w.disconnectedMatch=R.call(t,"div"),R.call(t,"[s!='']:x"),I.push("!=",le)}),F=F.length&&new RegExp(F.join("|")),I=I.length&&new RegExp(I.join("|")),z=ve.test(k.contains)||k.compareDocumentPosition?function(t,e){var i=9===t.nodeType?t.documentElement:t,n=e&&e.parentNode;return t===n||!(!n||1!==n.nodeType||!(i.contains?i.contains(n):t.compareDocumentPosition&&16&t.compareDocumentPosition(n)))}:function(t,e){if(e)for(;e=e.parentNode;)if(e===t)return!0;return!1},Z=k.compareDocumentPosition?function(t,i){if(t===i)return q=!0,0;var n=i.compareDocumentPosition&&t.compareDocumentPosition&&t.compareDocumentPosition(i);return n?1&n||!w.sortDetached&&i.compareDocumentPosition(t)===n?t===e||z(B,t)?-1:i===e||z(B,i)?1:N?ie.call(N,t)-ie.call(N,i):0:4&n?-1:1:t.compareDocumentPosition?-1:1}:function(t,i){var n,s=0,r=t.parentNode,o=i.parentNode,l=[t],h=[i];if(t===i)return q=!0,0;if(!r||!o)return t===e?-1:i===e?1:r?-1:o?1:N?ie.call(N,t)-ie.call(N,i):0;if(r===o)return a(t,i);for(n=t;n=n.parentNode;)l.unshift(n);for(n=i;n=n.parentNode;)h.unshift(n);for(;l[s]===h[s];)s++;return s?a(l[s],h[s]):l[s]===B?-1:h[s]===B?1:0},e):A},i.matches=function(t,e){return i(t,null,null,e)},i.matchesSelector=function(t,e){if((t.ownerDocument||t)!==A&&T(t),e=e.replace(me,"='$1']"),!(!w.matchesSelector||!D||I&&I.test(e)||F&&F.test(e)))try{var n=R.call(t,e);if(n||w.disconnectedMatch||t.document&&11!==t.document.nodeType)return n}catch(s){}return i(e,A,null,[t]).length>0},i.contains=function(t,e){return(t.ownerDocument||t)!==A&&T(t),z(t,e)},i.attr=function(t,i){(t.ownerDocument||t)!==A&&T(t);var n=S.attrHandle[i.toLowerCase()],s=n&&Y.call(S.attrHandle,i.toLowerCase())?n(t,i,!D):e;return s===e?w.attributes||!D?t.getAttribute(i):(s=t.getAttributeNode(i))&&s.specified?s.value:null:s},i.error=function(t){throw new Error("Syntax error, unrecognized expression: "+t)},i.uniqueSort=function(t){var e,i=[],n=0,s=0;if(q=!w.detectDuplicates,N=!w.sortStable&&t.slice(0),t.sort(Z),q){for(;e=t[s++];)e===t[s]&&(n=i.push(s));for(;n--;)t.splice(i[n],1)}return t},C=i.getText=function(t){var e,i="",n=0,s=t.nodeType;if(s){if(1===s||9===s||11===s){if("string"==typeof t.textContent)return t.textContent;for(t=t.firstChild;t;t=t.nextSibling)i+=C(t)}else if(3===s||4===s)return t.nodeValue}else for(;e=t[n];n++)i+=C(e);return i},S=i.selectors={cacheLength:50,createPseudo:s,match:ge,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(t){return t[1]=t[1].replace(we,xe),t[3]=(t[4]||t[5]||"").replace(we,xe),"~="===t[2]&&(t[3]=" "+t[3]+" "),t.slice(0,4)},CHILD:function(t){return t[1]=t[1].toLowerCase(),"nth"===t[1].slice(0,3)?(t[3]||i.error(t[0]),t[4]=+(t[4]?t[5]+(t[6]||1):2*("even"===t[3]||"odd"===t[3])),t[5]=+(t[7]+t[8]||"odd"===t[3])):t[3]&&i.error(t[0]),t},PSEUDO:function(t){var i,n=!t[5]&&t[2];return ge.CHILD.test(t[0])?null:(t[3]&&t[4]!==e?t[2]=t[4]:n&&fe.test(n)&&(i=c(n,!0))&&(i=n.indexOf(")",n.length-i)-n.length)&&(t[0]=t[0].slice(0,i),t[2]=n.slice(0,i)),t.slice(0,3))}},filter:{TAG:function(t){var e=t.replace(we,xe).toLowerCase();return"*"===t?function(){return!0}:function(t){return t.nodeName&&t.nodeName.toLowerCase()===e}},CLASS:function(t){var e=H[t+" "];return e||(e=new RegExp("(^|"+se+")"+t+"("+se+"|$)"))&&H(t,function(t){return e.test("string"==typeof t.className&&t.className||typeof t.getAttribute!==X&&t.getAttribute("class")||"")})},ATTR:function(t,e,n){return function(s){var r=i.attr(s,t);return null==r?"!="===e:e?(r+="","="===e?r===n:"!="===e?r!==n:"^="===e?n&&0===r.indexOf(n):"*="===e?n&&r.indexOf(n)>-1:"$="===e?n&&r.slice(-n.length)===n:"~="===e?(" "+r+" ").indexOf(n)>-1:"|="===e?r===n||r.slice(0,n.length+1)===n+"-":!1):!0}},CHILD:function(t,e,i,n,s){var r="nth"!==t.slice(0,3),o="last"!==t.slice(-4),a="of-type"===e;return 1===n&&0===s?function(t){return!!t.parentNode}:function(e,i,l){var h,u,p,c,d,m,f=r!==o?"nextSibling":"previousSibling",y=e.parentNode,g=a&&e.nodeName.toLowerCase(),v=!l&&!a;if(y){if(r){for(;f;){for(p=e;p=p[f];)if(a?p.nodeName.toLowerCase()===g:1===p.nodeType)return!1;m=f="only"===t&&!m&&"nextSibling"}return!0}if(m=[o?y.firstChild:y.lastChild],o&&v){for(u=y[U]||(y[U]={}),h=u[t]||[],d=h[0]===G&&h[1],c=h[0]===G&&h[2],p=d&&y.childNodes[d];p=++d&&p&&p[f]||(c=d=0)||m.pop();)if(1===p.nodeType&&++c&&p===e){u[t]=[G,d,c];break}}else if(v&&(h=(e[U]||(e[U]={}))[t])&&h[0]===G)c=h[1];else for(;(p=++d&&p&&p[f]||(c=d=0)||m.pop())&&((a?p.nodeName.toLowerCase()!==g:1!==p.nodeType)||!++c||(v&&((p[U]||(p[U]={}))[t]=[G,c]),p!==e)););return c-=s,c===n||c%n===0&&c/n>=0}}},PSEUDO:function(t,e){var n,r=S.pseudos[t]||S.setFilters[t.toLowerCase()]||i.error("unsupported pseudo: "+t);return r[U]?r(e):r.length>1?(n=[t,t,"",e],S.setFilters.hasOwnProperty(t.toLowerCase())?s(function(t,i){for(var n,s=r(t,e),o=s.length;o--;)n=ie.call(t,s[o]),t[n]=!(i[n]=s[o])}):function(t){return r(t,0,n)}):r}},pseudos:{not:s(function(t){var e=[],i=[],n=P(t.replace(he,"$1"));return n[U]?s(function(t,e,i,s){for(var r,o=n(t,null,s,[]),a=t.length;a--;)(r=o[a])&&(t[a]=!(e[a]=r))}):function(t,s,r){return e[0]=t,n(e,null,r,i),!i.pop()}}),has:s(function(t){return function(e){return i(t,e).length>0}}),contains:s(function(t){return function(e){return(e.textContent||e.innerText||C(e)).indexOf(t)>-1}}),lang:s(function(t){return ye.test(t||"")||i.error("unsupported lang: "+t),t=t.replace(we,xe).toLowerCase(),function(e){var i;do if(i=D?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return i=i.toLowerCase(),i===t||0===i.indexOf(t+"-");while((e=e.parentNode)&&1===e.nodeType);return!1}}),target:function(e){var i=t.location&&t.location.hash;return i&&i.slice(1)===e.id},root:function(t){return t===k},focus:function(t){return t===A.activeElement&&(!A.hasFocus||A.hasFocus())&&!!(t.type||t.href||~t.tabIndex)},enabled:function(t){return t.disabled===!1},disabled:function(t){return t.disabled===!0},checked:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&!!t.checked||"option"===e&&!!t.selected},selected:function(t){return t.parentNode&&t.parentNode.selectedIndex,t.selected===!0},empty:function(t){for(t=t.firstChild;t;t=t.nextSibling)if(t.nodeName>"@"||3===t.nodeType||4===t.nodeType)return!1;return!0},parent:function(t){return!S.pseudos.empty(t)},header:function(t){return Oe.test(t.nodeName)},input:function(t){return _e.test(t.nodeName)},button:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&"button"===t.type||"button"===e},text:function(t){var e;return"input"===t.nodeName.toLowerCase()&&"text"===t.type&&(null==(e=t.getAttribute("type"))||e.toLowerCase()===t.type)},first:u(function(){return[0]}),last:u(function(t,e){return[e-1]}),eq:u(function(t,e,i){return[0>i?i+e:i]}),even:u(function(t,e){for(var i=0;e>i;i+=2)t.push(i);return t}),odd:u(function(t,e){for(var i=1;e>i;i+=2)t.push(i);return t}),lt:u(function(t,e,i){for(var n=0>i?i+e:i;--n>=0;)t.push(n);return t}),gt:u(function(t,e,i){for(var n=0>i?i+e:i;++n<e;)t.push(n);return t})}},S.pseudos.nth=S.pseudos.eq;for(b in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})S.pseudos[b]=l(b);for(b in{submit:!0,reset:!0})S.pseudos[b]=h(b);p.prototype=S.filters=S.pseudos,S.setFilters=new p,P=i.compile=function(t,e){var i,n=[],s=[],r=V[t+" "];if(!r){for(e||(e=c(t)),i=e.length;i--;)r=v(e[i]),r[U]?n.push(r):s.push(r);r=V(t,L(s,n))}return r},w.sortStable=U.split("").sort(Z).join("")===U,w.detectDuplicates=q,T(),w.sortDetached=r(function(t){return 1&t.compareDocumentPosition(A.createElement("div"))}),r(function(t){return t.innerHTML="<a href='#'></a>","#"===t.firstChild.getAttribute("href")})||o("type|href|height|width",function(t,e,i){return i?void 0:t.getAttribute(e,"type"===e.toLowerCase()?1:2)}),w.attributes&&r(function(t){return t.innerHTML="<input/>",t.firstChild.setAttribute("value",""),""===t.firstChild.getAttribute("value")})||o("value",function(t,e,i){return i||"input"!==t.nodeName.toLowerCase()?void 0:t.defaultValue}),r(function(t){return null==t.getAttribute("disabled")})||o(ne,function(t,e,i){var n;return i?void 0:(n=t.getAttributeNode(e))&&n.specified?n.value:t[e]===!0?e.toLowerCase():null}),ue.find=i,ue.expr=i.selectors,ue.expr[":"]=ue.expr.pseudos,ue.unique=i.uniqueSort,ue.text=i.getText,ue.isXMLDoc=i.isXML,ue.contains=i.contains}(t);var Se={};ue.Callbacks=function(t){t="string"==typeof t?Se[t]||n(t):ue.extend({},t);var i,s,r,o,a,l,h=[],u=!t.once&&[],p=function(e){for(s=t.memory&&e,r=!0,a=l||0,l=0,o=h.length,i=!0;h&&o>a;a++)if(h[a].apply(e[0],e[1])===!1&&t.stopOnFalse){s=!1;break}i=!1,h&&(u?u.length&&p(u.shift()):s?h=[]:c.disable())},c={add:function(){if(h){var e=h.length;!function n(e){ue.each(e,function(e,i){var s=ue.type(i);"function"===s?t.unique&&c.has(i)||h.push(i):i&&i.length&&"string"!==s&&n(i)})}(arguments),i?o=h.length:s&&(l=e,p(s))}return this},remove:function(){return h&&ue.each(arguments,function(t,e){for(var n;(n=ue.inArray(e,h,n))>-1;)h.splice(n,1),i&&(o>=n&&o--,a>=n&&a--)}),this},has:function(t){return t?ue.inArray(t,h)>-1:!(!h||!h.length)},empty:function(){return h=[],o=0,this},disable:function(){return h=u=s=e,this},disabled:function(){return!h},lock:function(){return u=e,s||c.disable(),this},locked:function(){return!u},fireWith:function(t,e){return!h||r&&!u||(e=e||[],e=[t,e.slice?e.slice():e],i?u.push(e):p(e)),this},fire:function(){return c.fireWith(this,arguments),this},fired:function(){return!!r}};return c},ue.extend({Deferred:function(t){var e=[["resolve","done",ue.Callbacks("once memory"),"resolved"],["reject","fail",ue.Callbacks("once memory"),"rejected"],["notify","progress",ue.Callbacks("memory")]],i="pending",n={state:function(){return i},always:function(){return s.done(arguments).fail(arguments),this},then:function(){var t=arguments;return ue.Deferred(function(i){ue.each(e,function(e,r){var o=r[0],a=ue.isFunction(t[e])&&t[e];s[r[1]](function(){var t=a&&a.apply(this,arguments);t&&ue.isFunction(t.promise)?t.promise().done(i.resolve).fail(i.reject).progress(i.notify):i[o+"With"](this===n?i.promise():this,a?[t]:arguments)})}),t=null}).promise()},promise:function(t){return null!=t?ue.extend(t,n):n}},s={};return n.pipe=n.then,ue.each(e,function(t,r){var o=r[2],a=r[3];n[r[1]]=o.add,a&&o.add(function(){i=a},e[1^t][2].disable,e[2][2].lock),s[r[0]]=function(){return s[r[0]+"With"](this===s?n:this,arguments),this},s[r[0]+"With"]=o.fireWith}),n.promise(s),t&&t.call(s,s),s},when:function(t){var e,i,n,s=0,r=re.call(arguments),o=r.length,a=1!==o||t&&ue.isFunction(t.promise)?o:0,l=1===a?t:ue.Deferred(),h=function(t,i,n){return function(s){i[t]=this,n[t]=arguments.length>1?re.call(arguments):s,n===e?l.notifyWith(i,n):--a||l.resolveWith(i,n)}};if(o>1)for(e=new Array(o),i=new Array(o),n=new Array(o);o>s;s++)r[s]&&ue.isFunction(r[s].promise)?r[s].promise().done(h(s,n,r)).fail(l.reject).progress(h(s,i,e)):--a;return a||l.resolveWith(n,r),l.promise()}}),ue.support=function(e){var i,n,s,r,o,a,l,h,u,p=Y.createElement("div");if(p.setAttribute("className","t"),p.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",i=p.getElementsByTagName("*")||[],n=p.getElementsByTagName("a")[0],!n||!n.style||!i.length)return e;r=Y.createElement("select"),a=r.appendChild(Y.createElement("option")),s=p.getElementsByTagName("input")[0],n.style.cssText="top:1px;float:left;opacity:.5",e.getSetAttribute="t"!==p.className,e.leadingWhitespace=3===p.firstChild.nodeType,e.tbody=!p.getElementsByTagName("tbody").length,e.htmlSerialize=!!p.getElementsByTagName("link").length,e.style=/top/.test(n.getAttribute("style")),e.hrefNormalized="/a"===n.getAttribute("href"),e.opacity=/^0.5/.test(n.style.opacity),e.cssFloat=!!n.style.cssFloat,e.checkOn=!!s.value,e.optSelected=a.selected,e.enctype=!!Y.createElement("form").enctype,e.html5Clone="<:nav></:nav>"!==Y.createElement("nav").cloneNode(!0).outerHTML,e.inlineBlockNeedsLayout=!1,e.shrinkWrapBlocks=!1,e.pixelPosition=!1,e.deleteExpando=!0,e.noCloneEvent=!0,e.reliableMarginRight=!0,e.boxSizingReliable=!0,s.checked=!0,e.noCloneChecked=s.cloneNode(!0).checked,r.disabled=!0,e.optDisabled=!a.disabled;try{delete p.test}catch(c){e.deleteExpando=!1}s=Y.createElement("input"),s.setAttribute("value",""),e.input=""===s.getAttribute("value"),s.value="t",s.setAttribute("type","radio"),e.radioValue="t"===s.value,s.setAttribute("checked","t"),s.setAttribute("name","t"),o=Y.createDocumentFragment(),o.appendChild(s),e.appendChecked=s.checked,e.checkClone=o.cloneNode(!0).cloneNode(!0).lastChild.checked,p.attachEvent&&(p.attachEvent("onclick",function(){e.noCloneEvent=!1}),p.cloneNode(!0).click());for(u in{submit:!0,change:!0,focusin:!0})p.setAttribute(l="on"+u,"t"),e[u+"Bubbles"]=l in t||p.attributes[l].expando===!1;p.style.backgroundClip="content-box",p.cloneNode(!0).style.backgroundClip="",e.clearCloneStyle="content-box"===p.style.backgroundClip;for(u in ue(e))break;return e.ownLast="0"!==u,ue(function(){var i,n,s,r="padding:0;margin:0;border:0;display:block;box-sizing:content-box;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;",o=Y.getElementsByTagName("body")[0];o&&(i=Y.createElement("div"),i.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",o.appendChild(i).appendChild(p),p.innerHTML="<table><tr><td></td><td>t</td></tr></table>",s=p.getElementsByTagName("td"),s[0].style.cssText="padding:0;margin:0;border:0;display:none",h=0===s[0].offsetHeight,s[0].style.display="",s[1].style.display="none",e.reliableHiddenOffsets=h&&0===s[0].offsetHeight,p.innerHTML="",p.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;",ue.swap(o,null!=o.style.zoom?{zoom:1}:{},function(){e.boxSizing=4===p.offsetWidth}),t.getComputedStyle&&(e.pixelPosition="1%"!==(t.getComputedStyle(p,null)||{}).top,e.boxSizingReliable="4px"===(t.getComputedStyle(p,null)||{width:"4px"}).width,n=p.appendChild(Y.createElement("div")),n.style.cssText=p.style.cssText=r,n.style.marginRight=n.style.width="0",p.style.width="1px",e.reliableMarginRight=!parseFloat((t.getComputedStyle(n,null)||{}).marginRight)),typeof p.style.zoom!==X&&(p.innerHTML="",p.style.cssText=r+"width:1px;padding:1px;display:inline;zoom:1",e.inlineBlockNeedsLayout=3===p.offsetWidth,p.style.display="block",p.innerHTML="<div></div>",p.firstChild.style.width="5px",e.shrinkWrapBlocks=3!==p.offsetWidth,e.inlineBlockNeedsLayout&&(o.style.zoom=1)),o.removeChild(i),i=p=s=n=null)}),i=r=o=a=n=s=null,e}({});var Ce=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,Ee=/([A-Z])/g;ue.extend({cache:{},noData:{applet:!0,embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:function(t){return t=t.nodeType?ue.cache[t[ue.expando]]:t[ue.expando],!!t&&!a(t)},data:function(t,e,i){return s(t,e,i)},removeData:function(t,e){return r(t,e)},_data:function(t,e,i){return s(t,e,i,!0)},_removeData:function(t,e){return r(t,e,!0)},acceptData:function(t){if(t.nodeType&&1!==t.nodeType&&9!==t.nodeType)return!1;var e=t.nodeName&&ue.noData[t.nodeName.toLowerCase()];return!e||e!==!0&&t.getAttribute("classid")===e}}),ue.fn.extend({data:function(t,i){var n,s,r=null,a=0,l=this[0];if(t===e){if(this.length&&(r=ue.data(l),1===l.nodeType&&!ue._data(l,"parsedAttrs"))){for(n=l.attributes;a<n.length;a++)s=n[a].name,0===s.indexOf("data-")&&(s=ue.camelCase(s.slice(5)),o(l,s,r[s]));ue._data(l,"parsedAttrs",!0)}return r}return"object"==typeof t?this.each(function(){ue.data(this,t)}):arguments.length>1?this.each(function(){ue.data(this,t,i)}):l?o(l,t,ue.data(l,t)):null},removeData:function(t){return this.each(function(){ue.removeData(this,t)})}}),ue.extend({queue:function(t,e,i){var n;return t?(e=(e||"fx")+"queue",n=ue._data(t,e),i&&(!n||ue.isArray(i)?n=ue._data(t,e,ue.makeArray(i)):n.push(i)),n||[]):void 0},dequeue:function(t,e){e=e||"fx";var i=ue.queue(t,e),n=i.length,s=i.shift(),r=ue._queueHooks(t,e),o=function(){ue.dequeue(t,e)};"inprogress"===s&&(s=i.shift(),n--),s&&("fx"===e&&i.unshift("inprogress"),delete r.stop,s.call(t,o,r)),!n&&r&&r.empty.fire()},_queueHooks:function(t,e){var i=e+"queueHooks";return ue._data(t,i)||ue._data(t,i,{empty:ue.Callbacks("once memory").add(function(){ue._removeData(t,e+"queue"),ue._removeData(t,i)})})}}),ue.fn.extend({queue:function(t,i){var n=2;return"string"!=typeof t&&(i=t,t="fx",n--),arguments.length<n?ue.queue(this[0],t):i===e?this:this.each(function(){var e=ue.queue(this,t,i);ue._queueHooks(this,t),"fx"===t&&"inprogress"!==e[0]&&ue.dequeue(this,t)})},dequeue:function(t){return this.each(function(){ue.dequeue(this,t)})},delay:function(t,e){return t=ue.fx?ue.fx.speeds[t]||t:t,e=e||"fx",this.queue(e,function(e,i){var n=setTimeout(e,t);i.stop=function(){clearTimeout(n)}})},clearQueue:function(t){return this.queue(t||"fx",[])},promise:function(t,i){var n,s=1,r=ue.Deferred(),o=this,a=this.length,l=function(){--s||r.resolveWith(o,[o])};for("string"!=typeof t&&(i=t,t=e),t=t||"fx";a--;)n=ue._data(o[a],t+"queueHooks"),n&&n.empty&&(s++,n.empty.add(l));return l(),r.promise(i)}});var Pe,Me,Ne=/[\t\r\n\f]/g,Te=/\r/g,Ae=/^(?:input|select|textarea|button|object)$/i,ke=/^(?:a|area)$/i,De=/^(?:checked|selected)$/i,Fe=ue.support.getSetAttribute,Ie=ue.support.input;ue.fn.extend({attr:function(t,e){return ue.access(this,ue.attr,t,e,arguments.length>1)},removeAttr:function(t){return this.each(function(){ue.removeAttr(this,t)})},prop:function(t,e){return ue.access(this,ue.prop,t,e,arguments.length>1)},removeProp:function(t){return t=ue.propFix[t]||t,this.each(function(){try{this[t]=e,delete this[t]}catch(i){}})},addClass:function(t){var e,i,n,s,r,o=0,a=this.length,l="string"==typeof t&&t;if(ue.isFunction(t))return this.each(function(e){ue(this).addClass(t.call(this,e,this.className))});if(l)for(e=(t||"").match(ce)||[];a>o;o++)if(i=this[o],n=1===i.nodeType&&(i.className?(" "+i.className+" ").replace(Ne," "):" ")){for(r=0;s=e[r++];)n.indexOf(" "+s+" ")<0&&(n+=s+" ");i.className=ue.trim(n)}return this},removeClass:function(t){var e,i,n,s,r,o=0,a=this.length,l=0===arguments.length||"string"==typeof t&&t;if(ue.isFunction(t))return this.each(function(e){ue(this).removeClass(t.call(this,e,this.className))});if(l)for(e=(t||"").match(ce)||[];a>o;o++)if(i=this[o],n=1===i.nodeType&&(i.className?(" "+i.className+" ").replace(Ne," "):"")){for(r=0;s=e[r++];)for(;n.indexOf(" "+s+" ")>=0;)n=n.replace(" "+s+" "," ");i.className=t?ue.trim(n):""}return this},toggleClass:function(t,e){var i=typeof t;return"boolean"==typeof e&&"string"===i?e?this.addClass(t):this.removeClass(t):this.each(ue.isFunction(t)?function(i){ue(this).toggleClass(t.call(this,i,this.className,e),e)}:function(){if("string"===i)for(var e,n=0,s=ue(this),r=t.match(ce)||[];e=r[n++];)s.hasClass(e)?s.removeClass(e):s.addClass(e);else(i===X||"boolean"===i)&&(this.className&&ue._data(this,"__className__",this.className),this.className=this.className||t===!1?"":ue._data(this,"__className__")||"")})},hasClass:function(t){for(var e=" "+t+" ",i=0,n=this.length;n>i;i++)if(1===this[i].nodeType&&(" "+this[i].className+" ").replace(Ne," ").indexOf(e)>=0)return!0;return!1},val:function(t){var i,n,s,r=this[0];{if(arguments.length)return s=ue.isFunction(t),this.each(function(i){var r;1===this.nodeType&&(r=s?t.call(this,i,ue(this).val()):t,null==r?r="":"number"==typeof r?r+="":ue.isArray(r)&&(r=ue.map(r,function(t){return null==t?"":t+""})),n=ue.valHooks[this.type]||ue.valHooks[this.nodeName.toLowerCase()],n&&"set"in n&&n.set(this,r,"value")!==e||(this.value=r))});if(r)return n=ue.valHooks[r.type]||ue.valHooks[r.nodeName.toLowerCase()],n&&"get"in n&&(i=n.get(r,"value"))!==e?i:(i=r.value,"string"==typeof i?i.replace(Te,""):null==i?"":i)}}}),ue.extend({valHooks:{option:{get:function(t){var e=ue.find.attr(t,"value");return null!=e?e:t.text}},select:{get:function(t){for(var e,i,n=t.options,s=t.selectedIndex,r="select-one"===t.type||0>s,o=r?null:[],a=r?s+1:n.length,l=0>s?a:r?s:0;a>l;l++)if(i=n[l],!(!i.selected&&l!==s||(ue.support.optDisabled?i.disabled:null!==i.getAttribute("disabled"))||i.parentNode.disabled&&ue.nodeName(i.parentNode,"optgroup"))){if(e=ue(i).val(),r)return e;o.push(e)}return o},set:function(t,e){for(var i,n,s=t.options,r=ue.makeArray(e),o=s.length;o--;)n=s[o],(n.selected=ue.inArray(ue(n).val(),r)>=0)&&(i=!0);return i||(t.selectedIndex=-1),r}}},attr:function(t,i,n){var s,r,o=t.nodeType;if(t&&3!==o&&8!==o&&2!==o)return typeof t.getAttribute===X?ue.prop(t,i,n):(1===o&&ue.isXMLDoc(t)||(i=i.toLowerCase(),s=ue.attrHooks[i]||(ue.expr.match.bool.test(i)?Me:Pe)),n===e?s&&"get"in s&&null!==(r=s.get(t,i))?r:(r=ue.find.attr(t,i),null==r?e:r):null!==n?s&&"set"in s&&(r=s.set(t,n,i))!==e?r:(t.setAttribute(i,n+""),n):void ue.removeAttr(t,i))},removeAttr:function(t,e){var i,n,s=0,r=e&&e.match(ce);if(r&&1===t.nodeType)for(;i=r[s++];)n=ue.propFix[i]||i,ue.expr.match.bool.test(i)?Ie&&Fe||!De.test(i)?t[n]=!1:t[ue.camelCase("default-"+i)]=t[n]=!1:ue.attr(t,i,""),t.removeAttribute(Fe?i:n)},attrHooks:{type:{set:function(t,e){if(!ue.support.radioValue&&"radio"===e&&ue.nodeName(t,"input")){var i=t.value;return t.setAttribute("type",e),i&&(t.value=i),e}}}},propFix:{"for":"htmlFor","class":"className"},prop:function(t,i,n){var s,r,o,a=t.nodeType;if(t&&3!==a&&8!==a&&2!==a)return o=1!==a||!ue.isXMLDoc(t),o&&(i=ue.propFix[i]||i,r=ue.propHooks[i]),n!==e?r&&"set"in r&&(s=r.set(t,n,i))!==e?s:t[i]=n:r&&"get"in r&&null!==(s=r.get(t,i))?s:t[i]},propHooks:{tabIndex:{get:function(t){var e=ue.find.attr(t,"tabindex");return e?parseInt(e,10):Ae.test(t.nodeName)||ke.test(t.nodeName)&&t.href?0:-1}}}}),Me={set:function(t,e,i){return e===!1?ue.removeAttr(t,i):Ie&&Fe||!De.test(i)?t.setAttribute(!Fe&&ue.propFix[i]||i,i):t[ue.camelCase("default-"+i)]=t[i]=!0,i}},ue.each(ue.expr.match.bool.source.match(/\w+/g),function(t,i){var n=ue.expr.attrHandle[i]||ue.find.attr;ue.expr.attrHandle[i]=Ie&&Fe||!De.test(i)?function(t,i,s){var r=ue.expr.attrHandle[i],o=s?e:(ue.expr.attrHandle[i]=e)!=n(t,i,s)?i.toLowerCase():null;return ue.expr.attrHandle[i]=r,o}:function(t,i,n){return n?e:t[ue.camelCase("default-"+i)]?i.toLowerCase():null}}),Ie&&Fe||(ue.attrHooks.value={set:function(t,e,i){return ue.nodeName(t,"input")?void(t.defaultValue=e):Pe&&Pe.set(t,e,i)}}),Fe||(Pe={set:function(t,i,n){var s=t.getAttributeNode(n);return s||t.setAttributeNode(s=t.ownerDocument.createAttribute(n)),s.value=i+="","value"===n||i===t.getAttribute(n)?i:e}},ue.expr.attrHandle.id=ue.expr.attrHandle.name=ue.expr.attrHandle.coords=function(t,i,n){var s;return n?e:(s=t.getAttributeNode(i))&&""!==s.value?s.value:null},ue.valHooks.button={get:function(t,i){var n=t.getAttributeNode(i);return n&&n.specified?n.value:e},set:Pe.set},ue.attrHooks.contenteditable={set:function(t,e,i){Pe.set(t,""===e?!1:e,i)}},ue.each(["width","height"],function(t,e){ue.attrHooks[e]={set:function(t,i){return""===i?(t.setAttribute(e,"auto"),i):void 0}}})),ue.support.hrefNormalized||ue.each(["href","src"],function(t,e){ue.propHooks[e]={get:function(t){return t.getAttribute(e,4)}}}),ue.support.style||(ue.attrHooks.style={get:function(t){return t.style.cssText||e},set:function(t,e){return t.style.cssText=e+""}}),ue.support.optSelected||(ue.propHooks.selected={get:function(t){var e=t.parentNode;return e&&(e.selectedIndex,e.parentNode&&e.parentNode.selectedIndex),null}}),ue.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){ue.propFix[this.toLowerCase()]=this}),ue.support.enctype||(ue.propFix.enctype="encoding"),ue.each(["radio","checkbox"],function(){ue.valHooks[this]={set:function(t,e){return ue.isArray(e)?t.checked=ue.inArray(ue(t).val(),e)>=0:void 0}},ue.support.checkOn||(ue.valHooks[this].get=function(t){return null===t.getAttribute("value")?"on":t.value})});var Re=/^(?:input|select|textarea)$/i,ze=/^key/,Ue=/^(?:mouse|contextmenu)|click/,Be=/^(?:focusinfocus|focusoutblur)$/,Ge=/^([^.]*)(?:\.(.+)|)$/;ue.event={global:{},add:function(t,i,n,s,r){var o,a,l,h,u,p,c,d,m,f,y,g=ue._data(t);if(g){for(n.handler&&(h=n,n=h.handler,r=h.selector),n.guid||(n.guid=ue.guid++),(a=g.events)||(a=g.events={}),(p=g.handle)||(p=g.handle=function(t){return typeof ue===X||t&&ue.event.triggered===t.type?e:ue.event.dispatch.apply(p.elem,arguments)},p.elem=t),i=(i||"").match(ce)||[""],l=i.length;l--;)o=Ge.exec(i[l])||[],m=y=o[1],f=(o[2]||"").split(".").sort(),m&&(u=ue.event.special[m]||{},m=(r?u.delegateType:u.bindType)||m,u=ue.event.special[m]||{},c=ue.extend({type:m,origType:y,data:s,handler:n,guid:n.guid,selector:r,needsContext:r&&ue.expr.match.needsContext.test(r),namespace:f.join(".")},h),(d=a[m])||(d=a[m]=[],d.delegateCount=0,u.setup&&u.setup.call(t,s,f,p)!==!1||(t.addEventListener?t.addEventListener(m,p,!1):t.attachEvent&&t.attachEvent("on"+m,p))),u.add&&(u.add.call(t,c),c.handler.guid||(c.handler.guid=n.guid)),r?d.splice(d.delegateCount++,0,c):d.push(c),ue.event.global[m]=!0);t=null}},remove:function(t,e,i,n,s){var r,o,a,l,h,u,p,c,d,m,f,y=ue.hasData(t)&&ue._data(t);if(y&&(u=y.events)){for(e=(e||"").match(ce)||[""],h=e.length;h--;)if(a=Ge.exec(e[h])||[],d=f=a[1],m=(a[2]||"").split(".").sort(),d){for(p=ue.event.special[d]||{},d=(n?p.delegateType:p.bindType)||d,c=u[d]||[],a=a[2]&&new RegExp("(^|\\.)"+m.join("\\.(?:.*\\.|)")+"(\\.|$)"),l=r=c.length;r--;)o=c[r],!s&&f!==o.origType||i&&i.guid!==o.guid||a&&!a.test(o.namespace)||n&&n!==o.selector&&("**"!==n||!o.selector)||(c.splice(r,1),o.selector&&c.delegateCount--,p.remove&&p.remove.call(t,o));l&&!c.length&&(p.teardown&&p.teardown.call(t,m,y.handle)!==!1||ue.removeEvent(t,d,y.handle),delete u[d])}else for(d in u)ue.event.remove(t,d+e[h],i,n,!0);ue.isEmptyObject(u)&&(delete y.handle,ue._removeData(t,"events"))}},trigger:function(i,n,s,r){var o,a,l,h,u,p,c,d=[s||Y],m=le.call(i,"type")?i.type:i,f=le.call(i,"namespace")?i.namespace.split("."):[];if(l=p=s=s||Y,3!==s.nodeType&&8!==s.nodeType&&!Be.test(m+ue.event.triggered)&&(m.indexOf(".")>=0&&(f=m.split("."),m=f.shift(),f.sort()),a=m.indexOf(":")<0&&"on"+m,i=i[ue.expando]?i:new ue.Event(m,"object"==typeof i&&i),i.isTrigger=r?2:3,i.namespace=f.join("."),i.namespace_re=i.namespace?new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,i.result=e,i.target||(i.target=s),n=null==n?[i]:ue.makeArray(n,[i]),u=ue.event.special[m]||{},r||!u.trigger||u.trigger.apply(s,n)!==!1)){if(!r&&!u.noBubble&&!ue.isWindow(s)){for(h=u.delegateType||m,Be.test(h+m)||(l=l.parentNode);l;l=l.parentNode)d.push(l),p=l;p===(s.ownerDocument||Y)&&d.push(p.defaultView||p.parentWindow||t)}for(c=0;(l=d[c++])&&!i.isPropagationStopped();)i.type=c>1?h:u.bindType||m,o=(ue._data(l,"events")||{})[i.type]&&ue._data(l,"handle"),o&&o.apply(l,n),o=a&&l[a],o&&ue.acceptData(l)&&o.apply&&o.apply(l,n)===!1&&i.preventDefault();if(i.type=m,!r&&!i.isDefaultPrevented()&&(!u._default||u._default.apply(d.pop(),n)===!1)&&ue.acceptData(s)&&a&&s[m]&&!ue.isWindow(s)){p=s[a],p&&(s[a]=null),ue.event.triggered=m;try{s[m]()}catch(y){}ue.event.triggered=e,p&&(s[a]=p)}return i.result}},dispatch:function(t){t=ue.event.fix(t);var i,n,s,r,o,a=[],l=re.call(arguments),h=(ue._data(this,"events")||{})[t.type]||[],u=ue.event.special[t.type]||{};if(l[0]=t,t.delegateTarget=this,!u.preDispatch||u.preDispatch.call(this,t)!==!1){for(a=ue.event.handlers.call(this,t,h),i=0;(r=a[i++])&&!t.isPropagationStopped();)for(t.currentTarget=r.elem,o=0;(s=r.handlers[o++])&&!t.isImmediatePropagationStopped();)(!t.namespace_re||t.namespace_re.test(s.namespace))&&(t.handleObj=s,t.data=s.data,n=((ue.event.special[s.origType]||{}).handle||s.handler).apply(r.elem,l),n!==e&&(t.result=n)===!1&&(t.preventDefault(),t.stopPropagation()));
return u.postDispatch&&u.postDispatch.call(this,t),t.result}},handlers:function(t,i){var n,s,r,o,a=[],l=i.delegateCount,h=t.target;if(l&&h.nodeType&&(!t.button||"click"!==t.type))for(;h!=this;h=h.parentNode||this)if(1===h.nodeType&&(h.disabled!==!0||"click"!==t.type)){for(r=[],o=0;l>o;o++)s=i[o],n=s.selector+" ",r[n]===e&&(r[n]=s.needsContext?ue(n,this).index(h)>=0:ue.find(n,this,null,[h]).length),r[n]&&r.push(s);r.length&&a.push({elem:h,handlers:r})}return l<i.length&&a.push({elem:this,handlers:i.slice(l)}),a},fix:function(t){if(t[ue.expando])return t;var e,i,n,s=t.type,r=t,o=this.fixHooks[s];for(o||(this.fixHooks[s]=o=Ue.test(s)?this.mouseHooks:ze.test(s)?this.keyHooks:{}),n=o.props?this.props.concat(o.props):this.props,t=new ue.Event(r),e=n.length;e--;)i=n[e],t[i]=r[i];return t.target||(t.target=r.srcElement||Y),3===t.target.nodeType&&(t.target=t.target.parentNode),t.metaKey=!!t.metaKey,o.filter?o.filter(t,r):t},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(t,e){return null==t.which&&(t.which=null!=e.charCode?e.charCode:e.keyCode),t}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(t,i){var n,s,r,o=i.button,a=i.fromElement;return null==t.pageX&&null!=i.clientX&&(s=t.target.ownerDocument||Y,r=s.documentElement,n=s.body,t.pageX=i.clientX+(r&&r.scrollLeft||n&&n.scrollLeft||0)-(r&&r.clientLeft||n&&n.clientLeft||0),t.pageY=i.clientY+(r&&r.scrollTop||n&&n.scrollTop||0)-(r&&r.clientTop||n&&n.clientTop||0)),!t.relatedTarget&&a&&(t.relatedTarget=a===t.target?i.toElement:a),t.which||o===e||(t.which=1&o?1:2&o?3:4&o?2:0),t}},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==u()&&this.focus)try{return this.focus(),!1}catch(t){}},delegateType:"focusin"},blur:{trigger:function(){return this===u()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return ue.nodeName(this,"input")&&"checkbox"===this.type&&this.click?(this.click(),!1):void 0},_default:function(t){return ue.nodeName(t.target,"a")}},beforeunload:{postDispatch:function(t){t.result!==e&&(t.originalEvent.returnValue=t.result)}}},simulate:function(t,e,i,n){var s=ue.extend(new ue.Event,i,{type:t,isSimulated:!0,originalEvent:{}});n?ue.event.trigger(s,null,e):ue.event.dispatch.call(e,s),s.isDefaultPrevented()&&i.preventDefault()}},ue.removeEvent=Y.removeEventListener?function(t,e,i){t.removeEventListener&&t.removeEventListener(e,i,!1)}:function(t,e,i){var n="on"+e;t.detachEvent&&(typeof t[n]===X&&(t[n]=null),t.detachEvent(n,i))},ue.Event=function(t,e){return this instanceof ue.Event?(t&&t.type?(this.originalEvent=t,this.type=t.type,this.isDefaultPrevented=t.defaultPrevented||t.returnValue===!1||t.getPreventDefault&&t.getPreventDefault()?l:h):this.type=t,e&&ue.extend(this,e),this.timeStamp=t&&t.timeStamp||ue.now(),void(this[ue.expando]=!0)):new ue.Event(t,e)},ue.Event.prototype={isDefaultPrevented:h,isPropagationStopped:h,isImmediatePropagationStopped:h,preventDefault:function(){var t=this.originalEvent;this.isDefaultPrevented=l,t&&(t.preventDefault?t.preventDefault():t.returnValue=!1)},stopPropagation:function(){var t=this.originalEvent;this.isPropagationStopped=l,t&&(t.stopPropagation&&t.stopPropagation(),t.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=l,this.stopPropagation()}},ue.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(t,e){ue.event.special[t]={delegateType:e,bindType:e,handle:function(t){var i,n=this,s=t.relatedTarget,r=t.handleObj;return(!s||s!==n&&!ue.contains(n,s))&&(t.type=r.origType,i=r.handler.apply(this,arguments),t.type=e),i}}}),ue.support.submitBubbles||(ue.event.special.submit={setup:function(){return ue.nodeName(this,"form")?!1:void ue.event.add(this,"click._submit keypress._submit",function(t){var i=t.target,n=ue.nodeName(i,"input")||ue.nodeName(i,"button")?i.form:e;n&&!ue._data(n,"submitBubbles")&&(ue.event.add(n,"submit._submit",function(t){t._submit_bubble=!0}),ue._data(n,"submitBubbles",!0))})},postDispatch:function(t){t._submit_bubble&&(delete t._submit_bubble,this.parentNode&&!t.isTrigger&&ue.event.simulate("submit",this.parentNode,t,!0))},teardown:function(){return ue.nodeName(this,"form")?!1:void ue.event.remove(this,"._submit")}}),ue.support.changeBubbles||(ue.event.special.change={setup:function(){return Re.test(this.nodeName)?(("checkbox"===this.type||"radio"===this.type)&&(ue.event.add(this,"propertychange._change",function(t){"checked"===t.originalEvent.propertyName&&(this._just_changed=!0)}),ue.event.add(this,"click._change",function(t){this._just_changed&&!t.isTrigger&&(this._just_changed=!1),ue.event.simulate("change",this,t,!0)})),!1):void ue.event.add(this,"beforeactivate._change",function(t){var e=t.target;Re.test(e.nodeName)&&!ue._data(e,"changeBubbles")&&(ue.event.add(e,"change._change",function(t){!this.parentNode||t.isSimulated||t.isTrigger||ue.event.simulate("change",this.parentNode,t,!0)}),ue._data(e,"changeBubbles",!0))})},handle:function(t){var e=t.target;return this!==e||t.isSimulated||t.isTrigger||"radio"!==e.type&&"checkbox"!==e.type?t.handleObj.handler.apply(this,arguments):void 0},teardown:function(){return ue.event.remove(this,"._change"),!Re.test(this.nodeName)}}),ue.support.focusinBubbles||ue.each({focus:"focusin",blur:"focusout"},function(t,e){var i=0,n=function(t){ue.event.simulate(e,t.target,ue.event.fix(t),!0)};ue.event.special[e]={setup:function(){0===i++&&Y.addEventListener(t,n,!0)},teardown:function(){0===--i&&Y.removeEventListener(t,n,!0)}}}),ue.fn.extend({on:function(t,i,n,s,r){var o,a;if("object"==typeof t){"string"!=typeof i&&(n=n||i,i=e);for(o in t)this.on(o,i,n,t[o],r);return this}if(null==n&&null==s?(s=i,n=i=e):null==s&&("string"==typeof i?(s=n,n=e):(s=n,n=i,i=e)),s===!1)s=h;else if(!s)return this;return 1===r&&(a=s,s=function(t){return ue().off(t),a.apply(this,arguments)},s.guid=a.guid||(a.guid=ue.guid++)),this.each(function(){ue.event.add(this,t,s,n,i)})},one:function(t,e,i,n){return this.on(t,e,i,n,1)},off:function(t,i,n){var s,r;if(t&&t.preventDefault&&t.handleObj)return s=t.handleObj,ue(t.delegateTarget).off(s.namespace?s.origType+"."+s.namespace:s.origType,s.selector,s.handler),this;if("object"==typeof t){for(r in t)this.off(r,i,t[r]);return this}return(i===!1||"function"==typeof i)&&(n=i,i=e),n===!1&&(n=h),this.each(function(){ue.event.remove(this,t,n,i)})},trigger:function(t,e){return this.each(function(){ue.event.trigger(t,e,this)})},triggerHandler:function(t,e){var i=this[0];return i?ue.event.trigger(t,e,i,!0):void 0}});var je=/^.[^:#\[\.,]*$/,He=/^(?:parents|prev(?:Until|All))/,We=ue.expr.match.needsContext,Ve={children:!0,contents:!0,next:!0,prev:!0};ue.fn.extend({find:function(t){var e,i=[],n=this,s=n.length;if("string"!=typeof t)return this.pushStack(ue(t).filter(function(){for(e=0;s>e;e++)if(ue.contains(n[e],this))return!0}));for(e=0;s>e;e++)ue.find(t,n[e],i);return i=this.pushStack(s>1?ue.unique(i):i),i.selector=this.selector?this.selector+" "+t:t,i},has:function(t){var e,i=ue(t,this),n=i.length;return this.filter(function(){for(e=0;n>e;e++)if(ue.contains(this,i[e]))return!0})},not:function(t){return this.pushStack(c(this,t||[],!0))},filter:function(t){return this.pushStack(c(this,t||[],!1))},is:function(t){return!!c(this,"string"==typeof t&&We.test(t)?ue(t):t||[],!1).length},closest:function(t,e){for(var i,n=0,s=this.length,r=[],o=We.test(t)||"string"!=typeof t?ue(t,e||this.context):0;s>n;n++)for(i=this[n];i&&i!==e;i=i.parentNode)if(i.nodeType<11&&(o?o.index(i)>-1:1===i.nodeType&&ue.find.matchesSelector(i,t))){i=r.push(i);break}return this.pushStack(r.length>1?ue.unique(r):r)},index:function(t){return t?"string"==typeof t?ue.inArray(this[0],ue(t)):ue.inArray(t.jquery?t[0]:t,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(t,e){var i="string"==typeof t?ue(t,e):ue.makeArray(t&&t.nodeType?[t]:t),n=ue.merge(this.get(),i);return this.pushStack(ue.unique(n))},addBack:function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}}),ue.each({parent:function(t){var e=t.parentNode;return e&&11!==e.nodeType?e:null},parents:function(t){return ue.dir(t,"parentNode")},parentsUntil:function(t,e,i){return ue.dir(t,"parentNode",i)},next:function(t){return p(t,"nextSibling")},prev:function(t){return p(t,"previousSibling")},nextAll:function(t){return ue.dir(t,"nextSibling")},prevAll:function(t){return ue.dir(t,"previousSibling")},nextUntil:function(t,e,i){return ue.dir(t,"nextSibling",i)},prevUntil:function(t,e,i){return ue.dir(t,"previousSibling",i)},siblings:function(t){return ue.sibling((t.parentNode||{}).firstChild,t)},children:function(t){return ue.sibling(t.firstChild)},contents:function(t){return ue.nodeName(t,"iframe")?t.contentDocument||t.contentWindow.document:ue.merge([],t.childNodes)}},function(t,e){ue.fn[t]=function(i,n){var s=ue.map(this,e,i);return"Until"!==t.slice(-5)&&(n=i),n&&"string"==typeof n&&(s=ue.filter(n,s)),this.length>1&&(Ve[t]||(s=ue.unique(s)),He.test(t)&&(s=s.reverse())),this.pushStack(s)}}),ue.extend({filter:function(t,e,i){var n=e[0];return i&&(t=":not("+t+")"),1===e.length&&1===n.nodeType?ue.find.matchesSelector(n,t)?[n]:[]:ue.find.matches(t,ue.grep(e,function(t){return 1===t.nodeType}))},dir:function(t,i,n){for(var s=[],r=t[i];r&&9!==r.nodeType&&(n===e||1!==r.nodeType||!ue(r).is(n));)1===r.nodeType&&s.push(r),r=r[i];return s},sibling:function(t,e){for(var i=[];t;t=t.nextSibling)1===t.nodeType&&t!==e&&i.push(t);return i}});var qe="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",Ze=/ jQuery\d+="(?:null|\d+)"/g,Xe=new RegExp("<(?:"+qe+")[\\s/>]","i"),$e=/^\s+/,Ye=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,Ke=/<([\w:]+)/,Je=/<tbody/i,Qe=/<|&#?\w+;/,ti=/<(?:script|style|link)/i,ei=/^(?:checkbox|radio)$/i,ii=/checked\s*(?:[^=]|=\s*.checked.)/i,ni=/^$|\/(?:java|ecma)script/i,si=/^true\/(.*)/,ri=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,oi={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:ue.support.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},ai=d(Y),li=ai.appendChild(Y.createElement("div"));oi.optgroup=oi.option,oi.tbody=oi.tfoot=oi.colgroup=oi.caption=oi.thead,oi.th=oi.td,ue.fn.extend({text:function(t){return ue.access(this,function(t){return t===e?ue.text(this):this.empty().append((this[0]&&this[0].ownerDocument||Y).createTextNode(t))},null,t,arguments.length)},append:function(){return this.domManip(arguments,function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=m(this,t);e.appendChild(t)}})},prepend:function(){return this.domManip(arguments,function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=m(this,t);e.insertBefore(t,e.firstChild)}})},before:function(){return this.domManip(arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this)})},after:function(){return this.domManip(arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this.nextSibling)})},remove:function(t,e){for(var i,n=t?ue.filter(t,this):this,s=0;null!=(i=n[s]);s++)e||1!==i.nodeType||ue.cleanData(_(i)),i.parentNode&&(e&&ue.contains(i.ownerDocument,i)&&g(_(i,"script")),i.parentNode.removeChild(i));return this},empty:function(){for(var t,e=0;null!=(t=this[e]);e++){for(1===t.nodeType&&ue.cleanData(_(t,!1));t.firstChild;)t.removeChild(t.firstChild);t.options&&ue.nodeName(t,"select")&&(t.options.length=0)}return this},clone:function(t,e){return t=null==t?!1:t,e=null==e?t:e,this.map(function(){return ue.clone(this,t,e)})},html:function(t){return ue.access(this,function(t){var i=this[0]||{},n=0,s=this.length;if(t===e)return 1===i.nodeType?i.innerHTML.replace(Ze,""):e;if(!("string"!=typeof t||ti.test(t)||!ue.support.htmlSerialize&&Xe.test(t)||!ue.support.leadingWhitespace&&$e.test(t)||oi[(Ke.exec(t)||["",""])[1].toLowerCase()])){t=t.replace(Ye,"<$1></$2>");try{for(;s>n;n++)i=this[n]||{},1===i.nodeType&&(ue.cleanData(_(i,!1)),i.innerHTML=t);i=0}catch(r){}}i&&this.empty().append(t)},null,t,arguments.length)},replaceWith:function(){var t=ue.map(this,function(t){return[t.nextSibling,t.parentNode]}),e=0;return this.domManip(arguments,function(i){var n=t[e++],s=t[e++];s&&(n&&n.parentNode!==s&&(n=this.nextSibling),ue(this).remove(),s.insertBefore(i,n))},!0),e?this:this.remove()},detach:function(t){return this.remove(t,!0)},domManip:function(t,e,i){t=ne.apply([],t);var n,s,r,o,a,l,h=0,u=this.length,p=this,c=u-1,d=t[0],m=ue.isFunction(d);if(m||!(1>=u||"string"!=typeof d||ue.support.checkClone)&&ii.test(d))return this.each(function(n){var s=p.eq(n);m&&(t[0]=d.call(this,n,s.html())),s.domManip(t,e,i)});if(u&&(l=ue.buildFragment(t,this[0].ownerDocument,!1,!i&&this),n=l.firstChild,1===l.childNodes.length&&(l=n),n)){for(o=ue.map(_(l,"script"),f),r=o.length;u>h;h++)s=l,h!==c&&(s=ue.clone(s,!0,!0),r&&ue.merge(o,_(s,"script"))),e.call(this[h],s,h);if(r)for(a=o[o.length-1].ownerDocument,ue.map(o,y),h=0;r>h;h++)s=o[h],ni.test(s.type||"")&&!ue._data(s,"globalEval")&&ue.contains(a,s)&&(s.src?ue._evalUrl(s.src):ue.globalEval((s.text||s.textContent||s.innerHTML||"").replace(ri,"")));l=n=null}return this}}),ue.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(t,e){ue.fn[t]=function(t){for(var i,n=0,s=[],r=ue(t),o=r.length-1;o>=n;n++)i=n===o?this:this.clone(!0),ue(r[n])[e](i),se.apply(s,i.get());return this.pushStack(s)}}),ue.extend({clone:function(t,e,i){var n,s,r,o,a,l=ue.contains(t.ownerDocument,t);if(ue.support.html5Clone||ue.isXMLDoc(t)||!Xe.test("<"+t.nodeName+">")?r=t.cloneNode(!0):(li.innerHTML=t.outerHTML,li.removeChild(r=li.firstChild)),!(ue.support.noCloneEvent&&ue.support.noCloneChecked||1!==t.nodeType&&11!==t.nodeType||ue.isXMLDoc(t)))for(n=_(r),a=_(t),o=0;null!=(s=a[o]);++o)n[o]&&L(s,n[o]);if(e)if(i)for(a=a||_(t),n=n||_(r),o=0;null!=(s=a[o]);o++)v(s,n[o]);else v(t,r);return n=_(r,"script"),n.length>0&&g(n,!l&&_(t,"script")),n=a=s=null,r},buildFragment:function(t,e,i,n){for(var s,r,o,a,l,h,u,p=t.length,c=d(e),m=[],f=0;p>f;f++)if(r=t[f],r||0===r)if("object"===ue.type(r))ue.merge(m,r.nodeType?[r]:r);else if(Qe.test(r)){for(a=a||c.appendChild(e.createElement("div")),l=(Ke.exec(r)||["",""])[1].toLowerCase(),u=oi[l]||oi._default,a.innerHTML=u[1]+r.replace(Ye,"<$1></$2>")+u[2],s=u[0];s--;)a=a.lastChild;if(!ue.support.leadingWhitespace&&$e.test(r)&&m.push(e.createTextNode($e.exec(r)[0])),!ue.support.tbody)for(r="table"!==l||Je.test(r)?"<table>"!==u[1]||Je.test(r)?0:a:a.firstChild,s=r&&r.childNodes.length;s--;)ue.nodeName(h=r.childNodes[s],"tbody")&&!h.childNodes.length&&r.removeChild(h);for(ue.merge(m,a.childNodes),a.textContent="";a.firstChild;)a.removeChild(a.firstChild);a=c.lastChild}else m.push(e.createTextNode(r));for(a&&c.removeChild(a),ue.support.appendChecked||ue.grep(_(m,"input"),O),f=0;r=m[f++];)if((!n||-1===ue.inArray(r,n))&&(o=ue.contains(r.ownerDocument,r),a=_(c.appendChild(r),"script"),o&&g(a),i))for(s=0;r=a[s++];)ni.test(r.type||"")&&i.push(r);return a=null,c},cleanData:function(t,e){for(var i,n,s,r,o=0,a=ue.expando,l=ue.cache,h=ue.support.deleteExpando,u=ue.event.special;null!=(i=t[o]);o++)if((e||ue.acceptData(i))&&(s=i[a],r=s&&l[s])){if(r.events)for(n in r.events)u[n]?ue.event.remove(i,n):ue.removeEvent(i,n,r.handle);l[s]&&(delete l[s],h?delete i[a]:typeof i.removeAttribute!==X?i.removeAttribute(a):i[a]=null,ee.push(s))}},_evalUrl:function(t){return ue.ajax({url:t,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})}}),ue.fn.extend({wrapAll:function(t){if(ue.isFunction(t))return this.each(function(e){ue(this).wrapAll(t.call(this,e))});if(this[0]){var e=ue(t,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&e.insertBefore(this[0]),e.map(function(){for(var t=this;t.firstChild&&1===t.firstChild.nodeType;)t=t.firstChild;return t}).append(this)}return this},wrapInner:function(t){return this.each(ue.isFunction(t)?function(e){ue(this).wrapInner(t.call(this,e))}:function(){var e=ue(this),i=e.contents();i.length?i.wrapAll(t):e.append(t)})},wrap:function(t){var e=ue.isFunction(t);return this.each(function(i){ue(this).wrapAll(e?t.call(this,i):t)})},unwrap:function(){return this.parent().each(function(){ue.nodeName(this,"body")||ue(this).replaceWith(this.childNodes)}).end()}});var hi,ui,pi,ci=/alpha\([^)]*\)/i,di=/opacity\s*=\s*([^)]*)/,mi=/^(top|right|bottom|left)$/,fi=/^(none|table(?!-c[ea]).+)/,yi=/^margin/,gi=new RegExp("^("+pe+")(.*)$","i"),vi=new RegExp("^("+pe+")(?!px)[a-z%]+$","i"),Li=new RegExp("^([+-])=("+pe+")","i"),_i={BODY:"block"},Oi={position:"absolute",visibility:"hidden",display:"block"},bi={letterSpacing:0,fontWeight:400},wi=["Top","Right","Bottom","Left"],xi=["Webkit","O","Moz","ms"];ue.fn.extend({css:function(t,i){return ue.access(this,function(t,i,n){var s,r,o={},a=0;if(ue.isArray(i)){for(r=ui(t),s=i.length;s>a;a++)o[i[a]]=ue.css(t,i[a],!1,r);return o}return n!==e?ue.style(t,i,n):ue.css(t,i)},t,i,arguments.length>1)},show:function(){return x(this,!0)},hide:function(){return x(this)},toggle:function(t){return"boolean"==typeof t?t?this.show():this.hide():this.each(function(){w(this)?ue(this).show():ue(this).hide()})}}),ue.extend({cssHooks:{opacity:{get:function(t,e){if(e){var i=pi(t,"opacity");return""===i?"1":i}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":ue.support.cssFloat?"cssFloat":"styleFloat"},style:function(t,i,n,s){if(t&&3!==t.nodeType&&8!==t.nodeType&&t.style){var r,o,a,l=ue.camelCase(i),h=t.style;if(i=ue.cssProps[l]||(ue.cssProps[l]=b(h,l)),a=ue.cssHooks[i]||ue.cssHooks[l],n===e)return a&&"get"in a&&(r=a.get(t,!1,s))!==e?r:h[i];if(o=typeof n,"string"===o&&(r=Li.exec(n))&&(n=(r[1]+1)*r[2]+parseFloat(ue.css(t,i)),o="number"),!(null==n||"number"===o&&isNaN(n)||("number"!==o||ue.cssNumber[l]||(n+="px"),ue.support.clearCloneStyle||""!==n||0!==i.indexOf("background")||(h[i]="inherit"),a&&"set"in a&&(n=a.set(t,n,s))===e)))try{h[i]=n}catch(u){}}},css:function(t,i,n,s){var r,o,a,l=ue.camelCase(i);return i=ue.cssProps[l]||(ue.cssProps[l]=b(t.style,l)),a=ue.cssHooks[i]||ue.cssHooks[l],a&&"get"in a&&(o=a.get(t,!0,n)),o===e&&(o=pi(t,i,s)),"normal"===o&&i in bi&&(o=bi[i]),""===n||n?(r=parseFloat(o),n===!0||ue.isNumeric(r)?r||0:o):o}}),t.getComputedStyle?(ui=function(e){return t.getComputedStyle(e,null)},pi=function(t,i,n){var s,r,o,a=n||ui(t),l=a?a.getPropertyValue(i)||a[i]:e,h=t.style;return a&&(""!==l||ue.contains(t.ownerDocument,t)||(l=ue.style(t,i)),vi.test(l)&&yi.test(i)&&(s=h.width,r=h.minWidth,o=h.maxWidth,h.minWidth=h.maxWidth=h.width=l,l=a.width,h.width=s,h.minWidth=r,h.maxWidth=o)),l}):Y.documentElement.currentStyle&&(ui=function(t){return t.currentStyle},pi=function(t,i,n){var s,r,o,a=n||ui(t),l=a?a[i]:e,h=t.style;return null==l&&h&&h[i]&&(l=h[i]),vi.test(l)&&!mi.test(i)&&(s=h.left,r=t.runtimeStyle,o=r&&r.left,o&&(r.left=t.currentStyle.left),h.left="fontSize"===i?"1em":l,l=h.pixelLeft+"px",h.left=s,o&&(r.left=o)),""===l?"auto":l}),ue.each(["height","width"],function(t,e){ue.cssHooks[e]={get:function(t,i,n){return i?0===t.offsetWidth&&fi.test(ue.css(t,"display"))?ue.swap(t,Oi,function(){return E(t,e,n)}):E(t,e,n):void 0},set:function(t,i,n){var s=n&&ui(t);return S(t,i,n?C(t,e,n,ue.support.boxSizing&&"border-box"===ue.css(t,"boxSizing",!1,s),s):0)}}}),ue.support.opacity||(ue.cssHooks.opacity={get:function(t,e){return di.test((e&&t.currentStyle?t.currentStyle.filter:t.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":e?"1":""},set:function(t,e){var i=t.style,n=t.currentStyle,s=ue.isNumeric(e)?"alpha(opacity="+100*e+")":"",r=n&&n.filter||i.filter||"";i.zoom=1,(e>=1||""===e)&&""===ue.trim(r.replace(ci,""))&&i.removeAttribute&&(i.removeAttribute("filter"),""===e||n&&!n.filter)||(i.filter=ci.test(r)?r.replace(ci,s):r+" "+s)}}),ue(function(){ue.support.reliableMarginRight||(ue.cssHooks.marginRight={get:function(t,e){return e?ue.swap(t,{display:"inline-block"},pi,[t,"marginRight"]):void 0}}),!ue.support.pixelPosition&&ue.fn.position&&ue.each(["top","left"],function(t,e){ue.cssHooks[e]={get:function(t,i){return i?(i=pi(t,e),vi.test(i)?ue(t).position()[e]+"px":i):void 0}}})}),ue.expr&&ue.expr.filters&&(ue.expr.filters.hidden=function(t){return t.offsetWidth<=0&&t.offsetHeight<=0||!ue.support.reliableHiddenOffsets&&"none"===(t.style&&t.style.display||ue.css(t,"display"))},ue.expr.filters.visible=function(t){return!ue.expr.filters.hidden(t)}),ue.each({margin:"",padding:"",border:"Width"},function(t,e){ue.cssHooks[t+e]={expand:function(i){for(var n=0,s={},r="string"==typeof i?i.split(" "):[i];4>n;n++)s[t+wi[n]+e]=r[n]||r[n-2]||r[0];return s}},yi.test(t)||(ue.cssHooks[t+e].set=S)});var Si=/%20/g,Ci=/\[\]$/,Ei=/\r?\n/g,Pi=/^(?:submit|button|image|reset|file)$/i,Mi=/^(?:input|select|textarea|keygen)/i;ue.fn.extend({serialize:function(){return ue.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var t=ue.prop(this,"elements");return t?ue.makeArray(t):this}).filter(function(){var t=this.type;return this.name&&!ue(this).is(":disabled")&&Mi.test(this.nodeName)&&!Pi.test(t)&&(this.checked||!ei.test(t))}).map(function(t,e){var i=ue(this).val();return null==i?null:ue.isArray(i)?ue.map(i,function(t){return{name:e.name,value:t.replace(Ei,"\r\n")}}):{name:e.name,value:i.replace(Ei,"\r\n")}}).get()}}),ue.param=function(t,i){var n,s=[],r=function(t,e){e=ue.isFunction(e)?e():null==e?"":e,s[s.length]=encodeURIComponent(t)+"="+encodeURIComponent(e)};if(i===e&&(i=ue.ajaxSettings&&ue.ajaxSettings.traditional),ue.isArray(t)||t.jquery&&!ue.isPlainObject(t))ue.each(t,function(){r(this.name,this.value)});else for(n in t)N(n,t[n],i,r);return s.join("&").replace(Si,"+")},ue.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(t,e){ue.fn[e]=function(t,i){return arguments.length>0?this.on(e,null,t,i):this.trigger(e)}}),ue.fn.extend({hover:function(t,e){return this.mouseenter(t).mouseleave(e||t)},bind:function(t,e,i){return this.on(t,null,e,i)},unbind:function(t,e){return this.off(t,null,e)},delegate:function(t,e,i,n){return this.on(e,t,i,n)},undelegate:function(t,e,i){return 1===arguments.length?this.off(t,"**"):this.off(e,t||"**",i)}});var Ni,Ti,Ai=ue.now(),ki=/\?/,Di=/#.*$/,Fi=/([?&])_=[^&]*/,Ii=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,Ri=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,zi=/^(?:GET|HEAD)$/,Ui=/^\/\//,Bi=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,Gi=ue.fn.load,ji={},Hi={},Wi="*/".concat("*");try{Ti=$.href}catch(Vi){Ti=Y.createElement("a"),Ti.href="",Ti=Ti.href}Ni=Bi.exec(Ti.toLowerCase())||[],ue.fn.load=function(t,i,n){if("string"!=typeof t&&Gi)return Gi.apply(this,arguments);var s,r,o,a=this,l=t.indexOf(" ");return l>=0&&(s=t.slice(l,t.length),t=t.slice(0,l)),ue.isFunction(i)?(n=i,i=e):i&&"object"==typeof i&&(o="POST"),a.length>0&&ue.ajax({url:t,type:o,dataType:"html",data:i}).done(function(t){r=arguments,a.html(s?ue("<div>").append(ue.parseHTML(t)).find(s):t)}).complete(n&&function(t,e){a.each(n,r||[t.responseText,e,t])}),this},ue.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(t,e){ue.fn[e]=function(t){return this.on(e,t)}}),ue.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Ti,type:"GET",isLocal:Ri.test(Ni[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Wi,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":ue.parseJSON,"text xml":ue.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(t,e){return e?k(k(t,ue.ajaxSettings),e):k(ue.ajaxSettings,t)},ajaxPrefilter:T(ji),ajaxTransport:T(Hi),ajax:function(t,i){function n(t,i,n,s){var r,p,v,L,O,w=i;2!==_&&(_=2,l&&clearTimeout(l),u=e,a=s||"",b.readyState=t>0?4:0,r=t>=200&&300>t||304===t,n&&(L=D(c,b,n)),L=F(c,L,b,r),r?(c.ifModified&&(O=b.getResponseHeader("Last-Modified"),O&&(ue.lastModified[o]=O),O=b.getResponseHeader("etag"),O&&(ue.etag[o]=O)),204===t||"HEAD"===c.type?w="nocontent":304===t?w="notmodified":(w=L.state,p=L.data,v=L.error,r=!v)):(v=w,(t||!w)&&(w="error",0>t&&(t=0))),b.status=t,b.statusText=(i||w)+"",r?f.resolveWith(d,[p,w,b]):f.rejectWith(d,[b,w,v]),b.statusCode(g),g=e,h&&m.trigger(r?"ajaxSuccess":"ajaxError",[b,c,r?p:v]),y.fireWith(d,[b,w]),h&&(m.trigger("ajaxComplete",[b,c]),--ue.active||ue.event.trigger("ajaxStop")))}"object"==typeof t&&(i=t,t=e),i=i||{};var s,r,o,a,l,h,u,p,c=ue.ajaxSetup({},i),d=c.context||c,m=c.context&&(d.nodeType||d.jquery)?ue(d):ue.event,f=ue.Deferred(),y=ue.Callbacks("once memory"),g=c.statusCode||{},v={},L={},_=0,O="canceled",b={readyState:0,getResponseHeader:function(t){var e;if(2===_){if(!p)for(p={};e=Ii.exec(a);)p[e[1].toLowerCase()]=e[2];e=p[t.toLowerCase()]}return null==e?null:e},getAllResponseHeaders:function(){return 2===_?a:null},setRequestHeader:function(t,e){var i=t.toLowerCase();return _||(t=L[i]=L[i]||t,v[t]=e),this},overrideMimeType:function(t){return _||(c.mimeType=t),this},statusCode:function(t){var e;if(t)if(2>_)for(e in t)g[e]=[g[e],t[e]];else b.always(t[b.status]);return this},abort:function(t){var e=t||O;return u&&u.abort(e),n(0,e),this}};if(f.promise(b).complete=y.add,b.success=b.done,b.error=b.fail,c.url=((t||c.url||Ti)+"").replace(Di,"").replace(Ui,Ni[1]+"//"),c.type=i.method||i.type||c.method||c.type,c.dataTypes=ue.trim(c.dataType||"*").toLowerCase().match(ce)||[""],null==c.crossDomain&&(s=Bi.exec(c.url.toLowerCase()),c.crossDomain=!(!s||s[1]===Ni[1]&&s[2]===Ni[2]&&(s[3]||("http:"===s[1]?"80":"443"))===(Ni[3]||("http:"===Ni[1]?"80":"443")))),c.data&&c.processData&&"string"!=typeof c.data&&(c.data=ue.param(c.data,c.traditional)),A(ji,c,i,b),2===_)return b;h=c.global,h&&0===ue.active++&&ue.event.trigger("ajaxStart"),c.type=c.type.toUpperCase(),c.hasContent=!zi.test(c.type),o=c.url,c.hasContent||(c.data&&(o=c.url+=(ki.test(o)?"&":"?")+c.data,delete c.data),c.cache===!1&&(c.url=Fi.test(o)?o.replace(Fi,"$1_="+Ai++):o+(ki.test(o)?"&":"?")+"_="+Ai++)),c.ifModified&&(ue.lastModified[o]&&b.setRequestHeader("If-Modified-Since",ue.lastModified[o]),ue.etag[o]&&b.setRequestHeader("If-None-Match",ue.etag[o])),(c.data&&c.hasContent&&c.contentType!==!1||i.contentType)&&b.setRequestHeader("Content-Type",c.contentType),b.setRequestHeader("Accept",c.dataTypes[0]&&c.accepts[c.dataTypes[0]]?c.accepts[c.dataTypes[0]]+("*"!==c.dataTypes[0]?", "+Wi+"; q=0.01":""):c.accepts["*"]);for(r in c.headers)b.setRequestHeader(r,c.headers[r]);if(c.beforeSend&&(c.beforeSend.call(d,b,c)===!1||2===_))return b.abort();O="abort";for(r in{success:1,error:1,complete:1})b[r](c[r]);if(u=A(Hi,c,i,b)){b.readyState=1,h&&m.trigger("ajaxSend",[b,c]),c.async&&c.timeout>0&&(l=setTimeout(function(){b.abort("timeout")},c.timeout));try{_=1,u.send(v,n)}catch(w){if(!(2>_))throw w;n(-1,w)}}else n(-1,"No Transport");return b},getJSON:function(t,e,i){return ue.get(t,e,i,"json")},getScript:function(t,i){return ue.get(t,e,i,"script")}}),ue.each(["get","post"],function(t,i){ue[i]=function(t,n,s,r){return ue.isFunction(n)&&(r=r||s,s=n,n=e),ue.ajax({url:t,type:i,dataType:r,data:n,success:s})}}),ue.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(t){return ue.globalEval(t),t}}}),ue.ajaxPrefilter("script",function(t){t.cache===e&&(t.cache=!1),t.crossDomain&&(t.type="GET",t.global=!1)}),ue.ajaxTransport("script",function(t){if(t.crossDomain){var i,n=Y.head||ue("head")[0]||Y.documentElement;return{send:function(e,s){i=Y.createElement("script"),i.async=!0,t.scriptCharset&&(i.charset=t.scriptCharset),i.src=t.url,i.onload=i.onreadystatechange=function(t,e){(e||!i.readyState||/loaded|complete/.test(i.readyState))&&(i.onload=i.onreadystatechange=null,i.parentNode&&i.parentNode.removeChild(i),i=null,e||s(200,"success"))},n.insertBefore(i,n.firstChild)},abort:function(){i&&i.onload(e,!0)}}}});var qi=[],Zi=/(=)\?(?=&|$)|\?\?/;ue.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var t=qi.pop()||ue.expando+"_"+Ai++;return this[t]=!0,t}}),ue.ajaxPrefilter("json jsonp",function(i,n,s){var r,o,a,l=i.jsonp!==!1&&(Zi.test(i.url)?"url":"string"==typeof i.data&&!(i.contentType||"").indexOf("application/x-www-form-urlencoded")&&Zi.test(i.data)&&"data");return l||"jsonp"===i.dataTypes[0]?(r=i.jsonpCallback=ue.isFunction(i.jsonpCallback)?i.jsonpCallback():i.jsonpCallback,l?i[l]=i[l].replace(Zi,"$1"+r):i.jsonp!==!1&&(i.url+=(ki.test(i.url)?"&":"?")+i.jsonp+"="+r),i.converters["script json"]=function(){return a||ue.error(r+" was not called"),a[0]},i.dataTypes[0]="json",o=t[r],t[r]=function(){a=arguments},s.always(function(){t[r]=o,i[r]&&(i.jsonpCallback=n.jsonpCallback,qi.push(r)),a&&ue.isFunction(o)&&o(a[0]),a=o=e}),"script"):void 0});var Xi,$i,Yi=0,Ki=t.ActiveXObject&&function(){var t;for(t in Xi)Xi[t](e,!0)};ue.ajaxSettings.xhr=t.ActiveXObject?function(){return!this.isLocal&&I()||R()}:I,$i=ue.ajaxSettings.xhr(),ue.support.cors=!!$i&&"withCredentials"in $i,$i=ue.support.ajax=!!$i,$i&&ue.ajaxTransport(function(i){if(!i.crossDomain||ue.support.cors){var n;return{send:function(s,r){var o,a,l=i.xhr();if(i.username?l.open(i.type,i.url,i.async,i.username,i.password):l.open(i.type,i.url,i.async),i.xhrFields)for(a in i.xhrFields)l[a]=i.xhrFields[a];i.mimeType&&l.overrideMimeType&&l.overrideMimeType(i.mimeType),i.crossDomain||s["X-Requested-With"]||(s["X-Requested-With"]="XMLHttpRequest");try{for(a in s)l.setRequestHeader(a,s[a])}catch(h){}l.send(i.hasContent&&i.data||null),n=function(t,s){var a,h,u,p;try{if(n&&(s||4===l.readyState))if(n=e,o&&(l.onreadystatechange=ue.noop,Ki&&delete Xi[o]),s)4!==l.readyState&&l.abort();else{p={},a=l.status,h=l.getAllResponseHeaders(),"string"==typeof l.responseText&&(p.text=l.responseText);try{u=l.statusText}catch(c){u=""}a||!i.isLocal||i.crossDomain?1223===a&&(a=204):a=p.text?200:404}}catch(d){s||r(-1,d)}p&&r(a,u,p,h)},i.async?4===l.readyState?setTimeout(n):(o=++Yi,Ki&&(Xi||(Xi={},ue(t).unload(Ki)),Xi[o]=n),l.onreadystatechange=n):n()},abort:function(){n&&n(e,!0)}}}});var Ji,Qi,tn=/^(?:toggle|show|hide)$/,en=new RegExp("^(?:([+-])=|)("+pe+")([a-z%]*)$","i"),nn=/queueHooks$/,sn=[j],rn={"*":[function(t,e){var i=this.createTween(t,e),n=i.cur(),s=en.exec(e),r=s&&s[3]||(ue.cssNumber[t]?"":"px"),o=(ue.cssNumber[t]||"px"!==r&&+n)&&en.exec(ue.css(i.elem,t)),a=1,l=20;if(o&&o[3]!==r){r=r||o[3],s=s||[],o=+n||1;do a=a||".5",o/=a,ue.style(i.elem,t,o+r);while(a!==(a=i.cur()/n)&&1!==a&&--l)}return s&&(o=i.start=+o||+n||0,i.unit=r,i.end=s[1]?o+(s[1]+1)*s[2]:+s[2]),i}]};ue.Animation=ue.extend(B,{tweener:function(t,e){ue.isFunction(t)?(e=t,t=["*"]):t=t.split(" ");for(var i,n=0,s=t.length;s>n;n++)i=t[n],rn[i]=rn[i]||[],rn[i].unshift(e)},prefilter:function(t,e){e?sn.unshift(t):sn.push(t)}}),ue.Tween=H,H.prototype={constructor:H,init:function(t,e,i,n,s,r){this.elem=t,this.prop=i,this.easing=s||"swing",this.options=e,this.start=this.now=this.cur(),this.end=n,this.unit=r||(ue.cssNumber[i]?"":"px")},cur:function(){var t=H.propHooks[this.prop];return t&&t.get?t.get(this):H.propHooks._default.get(this)},run:function(t){var e,i=H.propHooks[this.prop];
return this.pos=e=this.options.duration?ue.easing[this.easing](t,this.options.duration*t,0,1,this.options.duration):t,this.now=(this.end-this.start)*e+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),i&&i.set?i.set(this):H.propHooks._default.set(this),this}},H.prototype.init.prototype=H.prototype,H.propHooks={_default:{get:function(t){var e;return null==t.elem[t.prop]||t.elem.style&&null!=t.elem.style[t.prop]?(e=ue.css(t.elem,t.prop,""),e&&"auto"!==e?e:0):t.elem[t.prop]},set:function(t){ue.fx.step[t.prop]?ue.fx.step[t.prop](t):t.elem.style&&(null!=t.elem.style[ue.cssProps[t.prop]]||ue.cssHooks[t.prop])?ue.style(t.elem,t.prop,t.now+t.unit):t.elem[t.prop]=t.now}}},H.propHooks.scrollTop=H.propHooks.scrollLeft={set:function(t){t.elem.nodeType&&t.elem.parentNode&&(t.elem[t.prop]=t.now)}},ue.each(["toggle","show","hide"],function(t,e){var i=ue.fn[e];ue.fn[e]=function(t,n,s){return null==t||"boolean"==typeof t?i.apply(this,arguments):this.animate(W(e,!0),t,n,s)}}),ue.fn.extend({fadeTo:function(t,e,i,n){return this.filter(w).css("opacity",0).show().end().animate({opacity:e},t,i,n)},animate:function(t,e,i,n){var s=ue.isEmptyObject(t),r=ue.speed(e,i,n),o=function(){var e=B(this,ue.extend({},t),r);(s||ue._data(this,"finish"))&&e.stop(!0)};return o.finish=o,s||r.queue===!1?this.each(o):this.queue(r.queue,o)},stop:function(t,i,n){var s=function(t){var e=t.stop;delete t.stop,e(n)};return"string"!=typeof t&&(n=i,i=t,t=e),i&&t!==!1&&this.queue(t||"fx",[]),this.each(function(){var e=!0,i=null!=t&&t+"queueHooks",r=ue.timers,o=ue._data(this);if(i)o[i]&&o[i].stop&&s(o[i]);else for(i in o)o[i]&&o[i].stop&&nn.test(i)&&s(o[i]);for(i=r.length;i--;)r[i].elem!==this||null!=t&&r[i].queue!==t||(r[i].anim.stop(n),e=!1,r.splice(i,1));(e||!n)&&ue.dequeue(this,t)})},finish:function(t){return t!==!1&&(t=t||"fx"),this.each(function(){var e,i=ue._data(this),n=i[t+"queue"],s=i[t+"queueHooks"],r=ue.timers,o=n?n.length:0;for(i.finish=!0,ue.queue(this,t,[]),s&&s.stop&&s.stop.call(this,!0),e=r.length;e--;)r[e].elem===this&&r[e].queue===t&&(r[e].anim.stop(!0),r.splice(e,1));for(e=0;o>e;e++)n[e]&&n[e].finish&&n[e].finish.call(this);delete i.finish})}}),ue.each({slideDown:W("show"),slideUp:W("hide"),slideToggle:W("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(t,e){ue.fn[t]=function(t,i,n){return this.animate(e,t,i,n)}}),ue.speed=function(t,e,i){var n=t&&"object"==typeof t?ue.extend({},t):{complete:i||!i&&e||ue.isFunction(t)&&t,duration:t,easing:i&&e||e&&!ue.isFunction(e)&&e};return n.duration=ue.fx.off?0:"number"==typeof n.duration?n.duration:n.duration in ue.fx.speeds?ue.fx.speeds[n.duration]:ue.fx.speeds._default,(null==n.queue||n.queue===!0)&&(n.queue="fx"),n.old=n.complete,n.complete=function(){ue.isFunction(n.old)&&n.old.call(this),n.queue&&ue.dequeue(this,n.queue)},n},ue.easing={linear:function(t){return t},swing:function(t){return.5-Math.cos(t*Math.PI)/2}},ue.timers=[],ue.fx=H.prototype.init,ue.fx.tick=function(){var t,i=ue.timers,n=0;for(Ji=ue.now();n<i.length;n++)t=i[n],t()||i[n]!==t||i.splice(n--,1);i.length||ue.fx.stop(),Ji=e},ue.fx.timer=function(t){t()&&ue.timers.push(t)&&ue.fx.start()},ue.fx.interval=13,ue.fx.start=function(){Qi||(Qi=setInterval(ue.fx.tick,ue.fx.interval))},ue.fx.stop=function(){clearInterval(Qi),Qi=null},ue.fx.speeds={slow:600,fast:200,_default:400},ue.fx.step={},ue.expr&&ue.expr.filters&&(ue.expr.filters.animated=function(t){return ue.grep(ue.timers,function(e){return t===e.elem}).length}),ue.fn.offset=function(t){if(arguments.length)return t===e?this:this.each(function(e){ue.offset.setOffset(this,t,e)});var i,n,s={top:0,left:0},r=this[0],o=r&&r.ownerDocument;if(o)return i=o.documentElement,ue.contains(i,r)?(typeof r.getBoundingClientRect!==X&&(s=r.getBoundingClientRect()),n=V(o),{top:s.top+(n.pageYOffset||i.scrollTop)-(i.clientTop||0),left:s.left+(n.pageXOffset||i.scrollLeft)-(i.clientLeft||0)}):s},ue.offset={setOffset:function(t,e,i){var n=ue.css(t,"position");"static"===n&&(t.style.position="relative");var s,r,o=ue(t),a=o.offset(),l=ue.css(t,"top"),h=ue.css(t,"left"),u=("absolute"===n||"fixed"===n)&&ue.inArray("auto",[l,h])>-1,p={},c={};u?(c=o.position(),s=c.top,r=c.left):(s=parseFloat(l)||0,r=parseFloat(h)||0),ue.isFunction(e)&&(e=e.call(t,i,a)),null!=e.top&&(p.top=e.top-a.top+s),null!=e.left&&(p.left=e.left-a.left+r),"using"in e?e.using.call(t,p):o.css(p)}},ue.fn.extend({position:function(){if(this[0]){var t,e,i={top:0,left:0},n=this[0];return"fixed"===ue.css(n,"position")?e=n.getBoundingClientRect():(t=this.offsetParent(),e=this.offset(),ue.nodeName(t[0],"html")||(i=t.offset()),i.top+=ue.css(t[0],"borderTopWidth",!0),i.left+=ue.css(t[0],"borderLeftWidth",!0)),{top:e.top-i.top-ue.css(n,"marginTop",!0),left:e.left-i.left-ue.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var t=this.offsetParent||K;t&&!ue.nodeName(t,"html")&&"static"===ue.css(t,"position");)t=t.offsetParent;return t||K})}}),ue.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,i){var n=/Y/.test(i);ue.fn[t]=function(s){return ue.access(this,function(t,s,r){var o=V(t);return r===e?o?i in o?o[i]:o.document.documentElement[s]:t[s]:void(o?o.scrollTo(n?ue(o).scrollLeft():r,n?r:ue(o).scrollTop()):t[s]=r)},t,s,arguments.length,null)}}),ue.each({Height:"height",Width:"width"},function(t,i){ue.each({padding:"inner"+t,content:i,"":"outer"+t},function(n,s){ue.fn[s]=function(s,r){var o=arguments.length&&(n||"boolean"!=typeof s),a=n||(s===!0||r===!0?"margin":"border");return ue.access(this,function(i,n,s){var r;return ue.isWindow(i)?i.document.documentElement["client"+t]:9===i.nodeType?(r=i.documentElement,Math.max(i.body["scroll"+t],r["scroll"+t],i.body["offset"+t],r["offset"+t],r["client"+t])):s===e?ue.css(i,n,a):ue.style(i,n,s,a)},i,o?s:e,o,null)}})}),ue.fn.size=function(){return this.length},ue.fn.andSelf=ue.fn.addBack,"object"==typeof module&&module&&"object"==typeof module.exports?module.exports=ue:(t.jQuery=t.$=ue,"function"==typeof define&&define.amd&&define("jquery",[],function(){return ue}))}(window),"undefined"==typeof jQuery)throw new Error("Bootstrap requires jQuery");+function(t){"use strict";function e(){var t=document.createElement("bootstrap"),e={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var i in e)if(void 0!==t.style[i])return{end:e[i]}}t.fn.emulateTransitionEnd=function(e){var i=!1,n=this;t(this).one(t.support.transition.end,function(){i=!0});var s=function(){i||t(n).trigger(t.support.transition.end)};return setTimeout(s,e),this},t(function(){t.support.transition=e()})}(jQuery),+function(t){"use strict";var e='[data-dismiss="alert"]',i=function(i){t(i).on("click",e,this.close)};i.prototype.close=function(e){function i(){r.trigger("closed.bs.alert").remove()}var n=t(this),s=n.attr("data-target");s||(s=n.attr("href"),s=s&&s.replace(/.*(?=#[^\s]*$)/,""));var r=t(s);e&&e.preventDefault(),r.length||(r=n.hasClass("alert")?n:n.parent()),r.trigger(e=t.Event("close.bs.alert")),e.isDefaultPrevented()||(r.removeClass("in"),t.support.transition&&r.hasClass("fade")?r.one(t.support.transition.end,i).emulateTransitionEnd(150):i())};var n=t.fn.alert;t.fn.alert=function(e){return this.each(function(){var n=t(this),s=n.data("bs.alert");s||n.data("bs.alert",s=new i(this)),"string"==typeof e&&s[e].call(n)})},t.fn.alert.Constructor=i,t.fn.alert.noConflict=function(){return t.fn.alert=n,this},t(document).on("click.bs.alert.data-api",e,i.prototype.close)}(jQuery),+function(t){"use strict";var e=function(i,n){this.$element=t(i),this.options=t.extend({},e.DEFAULTS,n)};e.DEFAULTS={loadingText:"loading..."},e.prototype.setState=function(t){var e="disabled",i=this.$element,n=i.is("input")?"val":"html",s=i.data();t+="Text",s.resetText||i.data("resetText",i[n]()),i[n](s[t]||this.options[t]),setTimeout(function(){"loadingText"==t?i.addClass(e).attr(e,e):i.removeClass(e).removeAttr(e)},0)},e.prototype.toggle=function(){var t=this.$element.closest('[data-toggle="buttons"]');if(t.length){var e=this.$element.find("input").prop("checked",!this.$element.hasClass("active")).trigger("change");"radio"===e.prop("type")&&t.find(".active").removeClass("active")}this.$element.toggleClass("active")};var i=t.fn.button;t.fn.button=function(i){return this.each(function(){var n=t(this),s=n.data("bs.button"),r="object"==typeof i&&i;s||n.data("bs.button",s=new e(this,r)),"toggle"==i?s.toggle():i&&s.setState(i)})},t.fn.button.Constructor=e,t.fn.button.noConflict=function(){return t.fn.button=i,this},t(document).on("click.bs.button.data-api","[data-toggle^=button]",function(e){var i=t(e.target);i.hasClass("btn")||(i=i.closest(".btn")),i.button("toggle"),e.preventDefault()})}(jQuery),+function(t){"use strict";var e=function(e,i){this.$element=t(e),this.$indicators=this.$element.find(".carousel-indicators"),this.options=i,this.paused=this.sliding=this.interval=this.$active=this.$items=null,"hover"==this.options.pause&&this.$element.on("mouseenter",t.proxy(this.pause,this)).on("mouseleave",t.proxy(this.cycle,this))};e.DEFAULTS={interval:5e3,pause:"hover",wrap:!0},e.prototype.cycle=function(e){return e||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&(this.interval=setInterval(t.proxy(this.next,this),this.options.interval)),this},e.prototype.getActiveIndex=function(){return this.$active=this.$element.find(".item.active"),this.$items=this.$active.parent().children(),this.$items.index(this.$active)},e.prototype.to=function(e){var i=this,n=this.getActiveIndex();return e>this.$items.length-1||0>e?void 0:this.sliding?this.$element.one("slid",function(){i.to(e)}):n==e?this.pause().cycle():this.slide(e>n?"next":"prev",t(this.$items[e]))},e.prototype.pause=function(e){return e||(this.paused=!0),this.$element.find(".next, .prev").length&&t.support.transition.end&&(this.$element.trigger(t.support.transition.end),this.cycle(!0)),this.interval=clearInterval(this.interval),this},e.prototype.next=function(){return this.sliding?void 0:this.slide("next")},e.prototype.prev=function(){return this.sliding?void 0:this.slide("prev")},e.prototype.slide=function(e,i){var n=this.$element.find(".item.active"),s=i||n[e](),r=this.interval,o="next"==e?"left":"right",a="next"==e?"first":"last",l=this;if(!s.length){if(!this.options.wrap)return;s=this.$element.find(".item")[a]()}this.sliding=!0,r&&this.pause();var h=t.Event("slide.bs.carousel",{relatedTarget:s[0],direction:o});if(!s.hasClass("active")){if(this.$indicators.length&&(this.$indicators.find(".active").removeClass("active"),this.$element.one("slid",function(){var e=t(l.$indicators.children()[l.getActiveIndex()]);e&&e.addClass("active")})),t.support.transition&&this.$element.hasClass("slide")){if(this.$element.trigger(h),h.isDefaultPrevented())return;s.addClass(e),s[0].offsetWidth,n.addClass(o),s.addClass(o),n.one(t.support.transition.end,function(){s.removeClass([e,o].join(" ")).addClass("active"),n.removeClass(["active",o].join(" ")),l.sliding=!1,setTimeout(function(){l.$element.trigger("slid")},0)}).emulateTransitionEnd(600)}else{if(this.$element.trigger(h),h.isDefaultPrevented())return;n.removeClass("active"),s.addClass("active"),this.sliding=!1,this.$element.trigger("slid")}return r&&this.cycle(),this}};var i=t.fn.carousel;t.fn.carousel=function(i){return this.each(function(){var n=t(this),s=n.data("bs.carousel"),r=t.extend({},e.DEFAULTS,n.data(),"object"==typeof i&&i),o="string"==typeof i?i:r.slide;s||n.data("bs.carousel",s=new e(this,r)),"number"==typeof i?s.to(i):o?s[o]():r.interval&&s.pause().cycle()})},t.fn.carousel.Constructor=e,t.fn.carousel.noConflict=function(){return t.fn.carousel=i,this},t(document).on("click.bs.carousel.data-api","[data-slide], [data-slide-to]",function(e){var i,n=t(this),s=t(n.attr("data-target")||(i=n.attr("href"))&&i.replace(/.*(?=#[^\s]+$)/,"")),r=t.extend({},s.data(),n.data()),o=n.attr("data-slide-to");o&&(r.interval=!1),s.carousel(r),(o=n.attr("data-slide-to"))&&s.data("bs.carousel").to(o),e.preventDefault()}),t(window).on("load",function(){t('[data-ride="carousel"]').each(function(){var e=t(this);e.carousel(e.data())})})}(jQuery),+function(t){"use strict";var e=function(i,n){this.$element=t(i),this.options=t.extend({},e.DEFAULTS,n),this.transitioning=null,this.options.parent&&(this.$parent=t(this.options.parent)),this.options.toggle&&this.toggle()};e.DEFAULTS={toggle:!0},e.prototype.dimension=function(){var t=this.$element.hasClass("width");return t?"width":"height"},e.prototype.show=function(){if(!this.transitioning&&!this.$element.hasClass("in")){var e=t.Event("show.bs.collapse");if(this.$element.trigger(e),!e.isDefaultPrevented()){var i=this.$parent&&this.$parent.find("> .panel > .in");if(i&&i.length){var n=i.data("bs.collapse");if(n&&n.transitioning)return;i.collapse("hide"),n||i.data("bs.collapse",null)}var s=this.dimension();this.$element.removeClass("collapse").addClass("collapsing")[s](0),this.transitioning=1;var r=function(){this.$element.removeClass("collapsing").addClass("in")[s]("auto"),this.transitioning=0,this.$element.trigger("shown.bs.collapse")};if(!t.support.transition)return r.call(this);var o=t.camelCase(["scroll",s].join("-"));this.$element.one(t.support.transition.end,t.proxy(r,this)).emulateTransitionEnd(350)[s](this.$element[0][o])}}},e.prototype.hide=function(){if(!this.transitioning&&this.$element.hasClass("in")){var e=t.Event("hide.bs.collapse");if(this.$element.trigger(e),!e.isDefaultPrevented()){var i=this.dimension();this.$element[i](this.$element[i]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse").removeClass("in"),this.transitioning=1;var n=function(){this.transitioning=0,this.$element.trigger("hidden.bs.collapse").removeClass("collapsing").addClass("collapse")};return t.support.transition?void this.$element[i](0).one(t.support.transition.end,t.proxy(n,this)).emulateTransitionEnd(350):n.call(this)}}},e.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()};var i=t.fn.collapse;t.fn.collapse=function(i){return this.each(function(){var n=t(this),s=n.data("bs.collapse"),r=t.extend({},e.DEFAULTS,n.data(),"object"==typeof i&&i);s||n.data("bs.collapse",s=new e(this,r)),"string"==typeof i&&s[i]()})},t.fn.collapse.Constructor=e,t.fn.collapse.noConflict=function(){return t.fn.collapse=i,this},t(document).on("click.bs.collapse.data-api","[data-toggle=collapse]",function(e){var i,n=t(this),s=n.attr("data-target")||e.preventDefault()||(i=n.attr("href"))&&i.replace(/.*(?=#[^\s]+$)/,""),r=t(s),o=r.data("bs.collapse"),a=o?"toggle":n.data(),l=n.attr("data-parent"),h=l&&t(l);o&&o.transitioning||(h&&h.find('[data-toggle=collapse][data-parent="'+l+'"]').not(n).addClass("collapsed"),n[r.hasClass("in")?"addClass":"removeClass"]("collapsed")),r.collapse(a)})}(jQuery),+function(t){"use strict";function e(){t(n).remove(),t(s).each(function(e){var n=i(t(this));n.hasClass("open")&&(n.trigger(e=t.Event("hide.bs.dropdown")),e.isDefaultPrevented()||n.removeClass("open").trigger("hidden.bs.dropdown"))})}function i(e){var i=e.attr("data-target");i||(i=e.attr("href"),i=i&&/#/.test(i)&&i.replace(/.*(?=#[^\s]*$)/,""));var n=i&&t(i);return n&&n.length?n:e.parent()}var n=".dropdown-backdrop",s="[data-toggle=dropdown]",r=function(e){t(e).on("click.bs.dropdown",this.toggle)};r.prototype.toggle=function(n){var s=t(this);if(!s.is(".disabled, :disabled")){var r=i(s),o=r.hasClass("open");if(e(),!o){if("ontouchstart"in document.documentElement&&!r.closest(".navbar-nav").length&&t('<div class="dropdown-backdrop"/>').insertAfter(t(this)).on("click",e),r.trigger(n=t.Event("show.bs.dropdown")),n.isDefaultPrevented())return;r.toggleClass("open").trigger("shown.bs.dropdown"),s.focus()}return!1}},r.prototype.keydown=function(e){if(/(38|40|27)/.test(e.keyCode)){var n=t(this);if(e.preventDefault(),e.stopPropagation(),!n.is(".disabled, :disabled")){var r=i(n),o=r.hasClass("open");if(!o||o&&27==e.keyCode)return 27==e.which&&r.find(s).focus(),n.click();var a=t("[role=menu] li:not(.divider):visible a",r);if(a.length){var l=a.index(a.filter(":focus"));38==e.keyCode&&l>0&&l--,40==e.keyCode&&l<a.length-1&&l++,~l||(l=0),a.eq(l).focus()}}}};var o=t.fn.dropdown;t.fn.dropdown=function(e){return this.each(function(){var i=t(this),n=i.data("dropdown");n||i.data("dropdown",n=new r(this)),"string"==typeof e&&n[e].call(i)})},t.fn.dropdown.Constructor=r,t.fn.dropdown.noConflict=function(){return t.fn.dropdown=o,this},t(document).on("click.bs.dropdown.data-api",e).on("click.bs.dropdown.data-api",".dropdown form",function(t){t.stopPropagation()}).on("click.bs.dropdown.data-api",s,r.prototype.toggle).on("keydown.bs.dropdown.data-api",s+", [role=menu]",r.prototype.keydown)}(jQuery),+function(t){"use strict";var e=function(e,i){this.options=i,this.$element=t(e),this.$backdrop=this.isShown=null,this.options.remote&&this.$element.load(this.options.remote)};e.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},e.prototype.toggle=function(t){return this[this.isShown?"hide":"show"](t)},e.prototype.show=function(e){var i=this,n=t.Event("show.bs.modal",{relatedTarget:e});this.$element.trigger(n),this.isShown||n.isDefaultPrevented()||(this.isShown=!0,this.escape(),this.$element.on("click.dismiss.modal",'[data-dismiss="modal"]',t.proxy(this.hide,this)),this.backdrop(function(){var n=t.support.transition&&i.$element.hasClass("fade");i.$element.parent().length||i.$element.appendTo(document.body),i.$element.show(),n&&i.$element[0].offsetWidth,i.$element.addClass("in").attr("aria-hidden",!1),i.enforceFocus();var s=t.Event("shown.bs.modal",{relatedTarget:e});n?i.$element.find(".modal-dialog").one(t.support.transition.end,function(){i.$element.focus().trigger(s)}).emulateTransitionEnd(300):i.$element.focus().trigger(s)}))},e.prototype.hide=function(e){e&&e.preventDefault(),e=t.Event("hide.bs.modal"),this.$element.trigger(e),this.isShown&&!e.isDefaultPrevented()&&(this.isShown=!1,this.escape(),t(document).off("focusin.bs.modal"),this.$element.removeClass("in").attr("aria-hidden",!0).off("click.dismiss.modal"),t.support.transition&&this.$element.hasClass("fade")?this.$element.one(t.support.transition.end,t.proxy(this.hideModal,this)).emulateTransitionEnd(300):this.hideModal())},e.prototype.enforceFocus=function(){t(document).off("focusin.bs.modal").on("focusin.bs.modal",t.proxy(function(t){this.$element[0]===t.target||this.$element.has(t.target).length||this.$element.focus()},this))},e.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keyup.dismiss.bs.modal",t.proxy(function(t){27==t.which&&this.hide()},this)):this.isShown||this.$element.off("keyup.dismiss.bs.modal")},e.prototype.hideModal=function(){var t=this;this.$element.hide(),this.backdrop(function(){t.removeBackdrop(),t.$element.trigger("hidden.bs.modal")})},e.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},e.prototype.backdrop=function(e){var i=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var n=t.support.transition&&i;if(this.$backdrop=t('<div class="modal-backdrop '+i+'" />').appendTo(document.body),this.$element.on("click.dismiss.modal",t.proxy(function(t){t.target===t.currentTarget&&("static"==this.options.backdrop?this.$element[0].focus.call(this.$element[0]):this.hide.call(this))},this)),n&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!e)return;n?this.$backdrop.one(t.support.transition.end,e).emulateTransitionEnd(150):e()}else!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("in"),t.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one(t.support.transition.end,e).emulateTransitionEnd(150):e()):e&&e()};var i=t.fn.modal;t.fn.modal=function(i,n){return this.each(function(){var s=t(this),r=s.data("bs.modal"),o=t.extend({},e.DEFAULTS,s.data(),"object"==typeof i&&i);r||s.data("bs.modal",r=new e(this,o)),"string"==typeof i?r[i](n):o.show&&r.show(n)})},t.fn.modal.Constructor=e,t.fn.modal.noConflict=function(){return t.fn.modal=i,this},t(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',function(e){var i=t(this),n=i.attr("href"),s=t(i.attr("data-target")||n&&n.replace(/.*(?=#[^\s]+$)/,"")),r=s.data("modal")?"toggle":t.extend({remote:!/#/.test(n)&&n},s.data(),i.data());e.preventDefault(),s.modal(r,this).one("hide",function(){i.is(":visible")&&i.focus()})}),t(document).on("show.bs.modal",".modal",function(){t(document.body).addClass("modal-open")}).on("hidden.bs.modal",".modal",function(){t(document.body).removeClass("modal-open")})}(jQuery),+function(t){"use strict";var e=function(t,e){this.type=this.options=this.enabled=this.timeout=this.hoverState=this.$element=null,this.init("tooltip",t,e)};e.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1},e.prototype.init=function(e,i,n){this.enabled=!0,this.type=e,this.$element=t(i),this.options=this.getOptions(n);for(var s=this.options.trigger.split(" "),r=s.length;r--;){var o=s[r];if("click"==o)this.$element.on("click."+this.type,this.options.selector,t.proxy(this.toggle,this));else if("manual"!=o){var a="hover"==o?"mouseenter":"focus",l="hover"==o?"mouseleave":"blur";this.$element.on(a+"."+this.type,this.options.selector,t.proxy(this.enter,this)),this.$element.on(l+"."+this.type,this.options.selector,t.proxy(this.leave,this))}}this.options.selector?this._options=t.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},e.prototype.getDefaults=function(){return e.DEFAULTS},e.prototype.getOptions=function(e){return e=t.extend({},this.getDefaults(),this.$element.data(),e),e.delay&&"number"==typeof e.delay&&(e.delay={show:e.delay,hide:e.delay}),e},e.prototype.getDelegateOptions=function(){var e={},i=this.getDefaults();return this._options&&t.each(this._options,function(t,n){i[t]!=n&&(e[t]=n)}),e},e.prototype.enter=function(e){var i=e instanceof this.constructor?e:t(e.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type);return clearTimeout(i.timeout),i.hoverState="in",i.options.delay&&i.options.delay.show?void(i.timeout=setTimeout(function(){"in"==i.hoverState&&i.show()},i.options.delay.show)):i.show()},e.prototype.leave=function(e){var i=e instanceof this.constructor?e:t(e.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type);return clearTimeout(i.timeout),i.hoverState="out",i.options.delay&&i.options.delay.hide?void(i.timeout=setTimeout(function(){"out"==i.hoverState&&i.hide()},i.options.delay.hide)):i.hide()},e.prototype.show=function(){var e=t.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){if(this.$element.trigger(e),e.isDefaultPrevented())return;var i=this.tip();this.setContent(),this.options.animation&&i.addClass("fade");var n="function"==typeof this.options.placement?this.options.placement.call(this,i[0],this.$element[0]):this.options.placement,s=/\s?auto?\s?/i,r=s.test(n);r&&(n=n.replace(s,"")||"top"),i.detach().css({top:0,left:0,display:"block"}).addClass(n),this.options.container?i.appendTo(this.options.container):i.insertAfter(this.$element);var o=this.getPosition(),a=i[0].offsetWidth,l=i[0].offsetHeight;if(r){var h=this.$element.parent(),u=n,p=document.documentElement.scrollTop||document.body.scrollTop,c="body"==this.options.container?window.innerWidth:h.outerWidth(),d="body"==this.options.container?window.innerHeight:h.outerHeight(),m="body"==this.options.container?0:h.offset().left;n="bottom"==n&&o.top+o.height+l-p>d?"top":"top"==n&&o.top-p-l<0?"bottom":"right"==n&&o.right+a>c?"left":"left"==n&&o.left-a<m?"right":n,i.removeClass(u).addClass(n)}var f=this.getCalculatedOffset(n,o,a,l);this.applyPlacement(f,n),this.$element.trigger("shown.bs."+this.type)}},e.prototype.applyPlacement=function(t,e){var i,n=this.tip(),s=n[0].offsetWidth,r=n[0].offsetHeight,o=parseInt(n.css("margin-top"),10),a=parseInt(n.css("margin-left"),10);isNaN(o)&&(o=0),isNaN(a)&&(a=0),t.top=t.top+o,t.left=t.left+a,n.offset(t).addClass("in");var l=n[0].offsetWidth,h=n[0].offsetHeight;if("top"==e&&h!=r&&(i=!0,t.top=t.top+r-h),/bottom|top/.test(e)){var u=0;t.left<0&&(u=-2*t.left,t.left=0,n.offset(t),l=n[0].offsetWidth,h=n[0].offsetHeight),this.replaceArrow(u-s+l,l,"left")}else this.replaceArrow(h-r,h,"top");i&&n.offset(t)},e.prototype.replaceArrow=function(t,e,i){this.arrow().css(i,t?50*(1-t/e)+"%":"")},e.prototype.setContent=function(){var t=this.tip(),e=this.getTitle();t.find(".tooltip-inner")[this.options.html?"html":"text"](e),t.removeClass("fade in top bottom left right")},e.prototype.hide=function(){function e(){"in"!=i.hoverState&&n.detach()}var i=this,n=this.tip(),s=t.Event("hide.bs."+this.type);return this.$element.trigger(s),s.isDefaultPrevented()?void 0:(n.removeClass("in"),t.support.transition&&this.$tip.hasClass("fade")?n.one(t.support.transition.end,e).emulateTransitionEnd(150):e(),this.$element.trigger("hidden.bs."+this.type),this)},e.prototype.fixTitle=function(){var t=this.$element;(t.attr("title")||"string"!=typeof t.attr("data-original-title"))&&t.attr("data-original-title",t.attr("title")||"").attr("title","")},e.prototype.hasContent=function(){return this.getTitle()},e.prototype.getPosition=function(){var e=this.$element[0];return t.extend({},"function"==typeof e.getBoundingClientRect?e.getBoundingClientRect():{width:e.offsetWidth,height:e.offsetHeight},this.$element.offset())},e.prototype.getCalculatedOffset=function(t,e,i,n){return"bottom"==t?{top:e.top+e.height,left:e.left+e.width/2-i/2}:"top"==t?{top:e.top-n,left:e.left+e.width/2-i/2}:"left"==t?{top:e.top+e.height/2-n/2,left:e.left-i}:{top:e.top+e.height/2-n/2,left:e.left+e.width}},e.prototype.getTitle=function(){var t,e=this.$element,i=this.options;return t=e.attr("data-original-title")||("function"==typeof i.title?i.title.call(e[0]):i.title)},e.prototype.tip=function(){return this.$tip=this.$tip||t(this.options.template)},e.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},e.prototype.validate=function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},e.prototype.enable=function(){this.enabled=!0},e.prototype.disable=function(){this.enabled=!1},e.prototype.toggleEnabled=function(){this.enabled=!this.enabled},e.prototype.toggle=function(e){var i=e?t(e.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type):this;i.tip().hasClass("in")?i.leave(i):i.enter(i)},e.prototype.destroy=function(){this.hide().$element.off("."+this.type).removeData("bs."+this.type)};var i=t.fn.tooltip;t.fn.tooltip=function(i){return this.each(function(){var n=t(this),s=n.data("bs.tooltip"),r="object"==typeof i&&i;s||n.data("bs.tooltip",s=new e(this,r)),"string"==typeof i&&s[i]()})},t.fn.tooltip.Constructor=e,t.fn.tooltip.noConflict=function(){return t.fn.tooltip=i,this}}(jQuery),+function(t){"use strict";var e=function(t,e){this.init("popover",t,e)};if(!t.fn.tooltip)throw new Error("Popover requires tooltip.js");e.DEFAULTS=t.extend({},t.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="popover"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),e.prototype=t.extend({},t.fn.tooltip.Constructor.prototype),e.prototype.constructor=e,e.prototype.getDefaults=function(){return e.DEFAULTS},e.prototype.setContent=function(){var t=this.tip(),e=this.getTitle(),i=this.getContent();t.find(".popover-title")[this.options.html?"html":"text"](e),t.find(".popover-content")[this.options.html?"html":"text"](i),t.removeClass("fade top bottom left right in"),t.find(".popover-title").html()||t.find(".popover-title").hide()},e.prototype.hasContent=function(){return this.getTitle()||this.getContent()},e.prototype.getContent=function(){var t=this.$element,e=this.options;return t.attr("data-content")||("function"==typeof e.content?e.content.call(t[0]):e.content)},e.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow")},e.prototype.tip=function(){return this.$tip||(this.$tip=t(this.options.template)),this.$tip};var i=t.fn.popover;t.fn.popover=function(i){return this.each(function(){var n=t(this),s=n.data("bs.popover"),r="object"==typeof i&&i;s||n.data("bs.popover",s=new e(this,r)),"string"==typeof i&&s[i]()})},t.fn.popover.Constructor=e,t.fn.popover.noConflict=function(){return t.fn.popover=i,this}}(jQuery),+function(t){"use strict";function e(i,n){var s,r=t.proxy(this.process,this);this.$element=t(t(i).is("body")?window:i),this.$body=t("body"),this.$scrollElement=this.$element.on("scroll.bs.scroll-spy.data-api",r),this.options=t.extend({},e.DEFAULTS,n),this.selector=(this.options.target||(s=t(i).attr("href"))&&s.replace(/.*(?=#[^\s]+$)/,"")||"")+" .nav li > a",this.offsets=t([]),this.targets=t([]),this.activeTarget=null,this.refresh(),this.process()}e.DEFAULTS={offset:10},e.prototype.refresh=function(){var e=this.$element[0]==window?"offset":"position";this.offsets=t([]),this.targets=t([]);{var i=this;this.$body.find(this.selector).map(function(){var n=t(this),s=n.data("target")||n.attr("href"),r=/^#\w/.test(s)&&t(s);return r&&r.length&&[[r[e]().top+(!t.isWindow(i.$scrollElement.get(0))&&i.$scrollElement.scrollTop()),s]]||null}).sort(function(t,e){return t[0]-e[0]}).each(function(){i.offsets.push(this[0]),i.targets.push(this[1])})}},e.prototype.process=function(){var t,e=this.$scrollElement.scrollTop()+this.options.offset,i=this.$scrollElement[0].scrollHeight||this.$body[0].scrollHeight,n=i-this.$scrollElement.height(),s=this.offsets,r=this.targets,o=this.activeTarget;if(e>=n)return o!=(t=r.last()[0])&&this.activate(t);for(t=s.length;t--;)o!=r[t]&&e>=s[t]&&(!s[t+1]||e<=s[t+1])&&this.activate(r[t])},e.prototype.activate=function(e){this.activeTarget=e,t(this.selector).parents(".active").removeClass("active");var i=this.selector+'[data-target="'+e+'"],'+this.selector+'[href="'+e+'"]',n=t(i).parents("li").addClass("active");n.parent(".dropdown-menu").length&&(n=n.closest("li.dropdown").addClass("active")),n.trigger("activate")};var i=t.fn.scrollspy;t.fn.scrollspy=function(i){return this.each(function(){var n=t(this),s=n.data("bs.scrollspy"),r="object"==typeof i&&i;s||n.data("bs.scrollspy",s=new e(this,r)),"string"==typeof i&&s[i]()})},t.fn.scrollspy.Constructor=e,t.fn.scrollspy.noConflict=function(){return t.fn.scrollspy=i,this},t(window).on("load",function(){t('[data-spy="scroll"]').each(function(){var e=t(this);e.scrollspy(e.data())})})}(jQuery),+function(t){"use strict";var e=function(e){this.element=t(e)};e.prototype.show=function(){var e=this.element,i=e.closest("ul:not(.dropdown-menu)"),n=e.data("target");if(n||(n=e.attr("href"),n=n&&n.replace(/.*(?=#[^\s]*$)/,"")),!e.parent("li").hasClass("active")){var s=i.find(".active:last a")[0],r=t.Event("show.bs.tab",{relatedTarget:s});if(e.trigger(r),!r.isDefaultPrevented()){var o=t(n);this.activate(e.parent("li"),i),this.activate(o,o.parent(),function(){e.trigger({type:"shown.bs.tab",relatedTarget:s})})}}},e.prototype.activate=function(e,i,n){function s(){r.removeClass("active").find("> .dropdown-menu > .active").removeClass("active"),e.addClass("active"),o?(e[0].offsetWidth,e.addClass("in")):e.removeClass("fade"),e.parent(".dropdown-menu")&&e.closest("li.dropdown").addClass("active"),n&&n()}var r=i.find("> .active"),o=n&&t.support.transition&&r.hasClass("fade");o?r.one(t.support.transition.end,s).emulateTransitionEnd(150):s(),r.removeClass("in")};var i=t.fn.tab;t.fn.tab=function(i){return this.each(function(){var n=t(this),s=n.data("bs.tab");s||n.data("bs.tab",s=new e(this)),"string"==typeof i&&s[i]()})},t.fn.tab.Constructor=e,t.fn.tab.noConflict=function(){return t.fn.tab=i,this},t(document).on("click.bs.tab.data-api",'[data-toggle="tab"], [data-toggle="pill"]',function(e){e.preventDefault(),t(this).tab("show")})}(jQuery),+function(t){"use strict";var e=function(i,n){this.options=t.extend({},e.DEFAULTS,n),this.$window=t(window).on("scroll.bs.affix.data-api",t.proxy(this.checkPosition,this)).on("click.bs.affix.data-api",t.proxy(this.checkPositionWithEventLoop,this)),this.$element=t(i),this.affixed=this.unpin=null,this.checkPosition()
};e.RESET="affix affix-top affix-bottom",e.DEFAULTS={offset:0},e.prototype.checkPositionWithEventLoop=function(){setTimeout(t.proxy(this.checkPosition,this),1)},e.prototype.checkPosition=function(){if(this.$element.is(":visible")){var i=t(document).height(),n=this.$window.scrollTop(),s=this.$element.offset(),r=this.options.offset,o=r.top,a=r.bottom;"object"!=typeof r&&(a=o=r),"function"==typeof o&&(o=r.top()),"function"==typeof a&&(a=r.bottom());var l=null!=this.unpin&&n+this.unpin<=s.top?!1:null!=a&&s.top+this.$element.height()>=i-a?"bottom":null!=o&&o>=n?"top":!1;this.affixed!==l&&(this.unpin&&this.$element.css("top",""),this.affixed=l,this.unpin="bottom"==l?s.top-n:null,this.$element.removeClass(e.RESET).addClass("affix"+(l?"-"+l:"")),"bottom"==l&&this.$element.offset({top:document.body.offsetHeight-a-this.$element.height()}))}};var i=t.fn.affix;t.fn.affix=function(i){return this.each(function(){var n=t(this),s=n.data("bs.affix"),r="object"==typeof i&&i;s||n.data("bs.affix",s=new e(this,r)),"string"==typeof i&&s[i]()})},t.fn.affix.Constructor=e,t.fn.affix.noConflict=function(){return t.fn.affix=i,this},t(window).on("load",function(){t('[data-spy="affix"]').each(function(){var e=t(this),i=e.data();i.offset=i.offset||{},i.offsetBottom&&(i.offset.bottom=i.offsetBottom),i.offsetTop&&(i.offset.top=i.offsetTop),e.affix(i)})})}(jQuery),function(t,e,i){var n=t.L,s={};s.version="0.7.3","object"==typeof module&&"object"==typeof module.exports?module.exports=s:"function"==typeof define&&define.amd&&define(s),s.noConflict=function(){return t.L=n,this},t.L=s,s.Util={extend:function(t){var e,i,n,s,r=Array.prototype.slice.call(arguments,1);for(i=0,n=r.length;n>i;i++){s=r[i]||{};for(e in s)s.hasOwnProperty(e)&&(t[e]=s[e])}return t},bind:function(t,e){var i=arguments.length>2?Array.prototype.slice.call(arguments,2):null;return function(){return t.apply(e,i||arguments)}},stamp:function(){var t=0,e="_leaflet_id";return function(i){return i[e]=i[e]||++t,i[e]}}(),invokeEach:function(t,e,i){var n,s;if("object"==typeof t){s=Array.prototype.slice.call(arguments,3);for(n in t)e.apply(i,[n,t[n]].concat(s));return!0}return!1},limitExecByInterval:function(t,e,i){var n,s;return function r(){var o=arguments;return n?void(s=!0):(n=!0,setTimeout(function(){n=!1,s&&(r.apply(i,o),s=!1)},e),void t.apply(i,o))}},falseFn:function(){return!1},formatNum:function(t,e){var i=Math.pow(10,e||5);return Math.round(t*i)/i},trim:function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")},splitWords:function(t){return s.Util.trim(t).split(/\s+/)},setOptions:function(t,e){return t.options=s.extend({},t.options,e),t.options},getParamString:function(t,e,i){var n=[];for(var s in t)n.push(encodeURIComponent(i?s.toUpperCase():s)+"="+encodeURIComponent(t[s]));return(e&&-1!==e.indexOf("?")?"&":"?")+n.join("&")},template:function(t,e){return t.replace(/\{ *([\w_]+) *\}/g,function(t,n){var s=e[n];if(s===i)throw new Error("No value provided for variable "+t);return"function"==typeof s&&(s=s(e)),s})},isArray:Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},emptyImageUrl:"data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs="},function(){function e(e){var i,n,s=["webkit","moz","o","ms"];for(i=0;i<s.length&&!n;i++)n=t[s[i]+e];return n}function i(e){var i=+new Date,s=Math.max(0,16-(i-n));return n=i+s,t.setTimeout(e,s)}var n=0,r=t.requestAnimationFrame||e("RequestAnimationFrame")||i,o=t.cancelAnimationFrame||e("CancelAnimationFrame")||e("CancelRequestAnimationFrame")||function(e){t.clearTimeout(e)};s.Util.requestAnimFrame=function(e,n,o,a){return e=s.bind(e,n),o&&r===i?void e():r.call(t,e,a)},s.Util.cancelAnimFrame=function(e){e&&o.call(t,e)}}(),s.extend=s.Util.extend,s.bind=s.Util.bind,s.stamp=s.Util.stamp,s.setOptions=s.Util.setOptions,s.Class=function(){},s.Class.extend=function(t){var e=function(){this.initialize&&this.initialize.apply(this,arguments),this._initHooks&&this.callInitHooks()},i=function(){};i.prototype=this.prototype;var n=new i;n.constructor=e,e.prototype=n;for(var r in this)this.hasOwnProperty(r)&&"prototype"!==r&&(e[r]=this[r]);t.statics&&(s.extend(e,t.statics),delete t.statics),t.includes&&(s.Util.extend.apply(null,[n].concat(t.includes)),delete t.includes),t.options&&n.options&&(t.options=s.extend({},n.options,t.options)),s.extend(n,t),n._initHooks=[];var o=this;return e.__super__=o.prototype,n.callInitHooks=function(){if(!this._initHooksCalled){o.prototype.callInitHooks&&o.prototype.callInitHooks.call(this),this._initHooksCalled=!0;for(var t=0,e=n._initHooks.length;e>t;t++)n._initHooks[t].call(this)}},e},s.Class.include=function(t){s.extend(this.prototype,t)},s.Class.mergeOptions=function(t){s.extend(this.prototype.options,t)},s.Class.addInitHook=function(t){var e=Array.prototype.slice.call(arguments,1),i="function"==typeof t?t:function(){this[t].apply(this,e)};this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(i)};var r="_leaflet_events";s.Mixin={},s.Mixin.Events={addEventListener:function(t,e,i){if(s.Util.invokeEach(t,this.addEventListener,this,e,i))return this;var n,o,a,l,h,u,p,c=this[r]=this[r]||{},d=i&&i!==this&&s.stamp(i);for(t=s.Util.splitWords(t),n=0,o=t.length;o>n;n++)a={action:e,context:i||this},l=t[n],d?(h=l+"_idx",u=h+"_len",p=c[h]=c[h]||{},p[d]||(p[d]=[],c[u]=(c[u]||0)+1),p[d].push(a)):(c[l]=c[l]||[],c[l].push(a));return this},hasEventListeners:function(t){var e=this[r];return!!e&&(t in e&&e[t].length>0||t+"_idx"in e&&e[t+"_idx_len"]>0)},removeEventListener:function(t,e,i){if(!this[r])return this;if(!t)return this.clearAllEventListeners();if(s.Util.invokeEach(t,this.removeEventListener,this,e,i))return this;var n,o,a,l,h,u,p,c,d,m=this[r],f=i&&i!==this&&s.stamp(i);for(t=s.Util.splitWords(t),n=0,o=t.length;o>n;n++)if(a=t[n],u=a+"_idx",p=u+"_len",c=m[u],e){if(l=f&&c?c[f]:m[a]){for(h=l.length-1;h>=0;h--)l[h].action!==e||i&&l[h].context!==i||(d=l.splice(h,1),d[0].action=s.Util.falseFn);i&&c&&0===l.length&&(delete c[f],m[p]--)}}else delete m[a],delete m[u],delete m[p];return this},clearAllEventListeners:function(){return delete this[r],this},fireEvent:function(t,e){if(!this.hasEventListeners(t))return this;var i,n,o,a,l,h=s.Util.extend({},e,{type:t,target:this}),u=this[r];if(u[t])for(i=u[t].slice(),n=0,o=i.length;o>n;n++)i[n].action.call(i[n].context,h);a=u[t+"_idx"];for(l in a)if(i=a[l].slice())for(n=0,o=i.length;o>n;n++)i[n].action.call(i[n].context,h);return this},addOneTimeEventListener:function(t,e,i){if(s.Util.invokeEach(t,this.addOneTimeEventListener,this,e,i))return this;var n=s.bind(function(){this.removeEventListener(t,e,i).removeEventListener(t,n,i)},this);return this.addEventListener(t,e,i).addEventListener(t,n,i)}},s.Mixin.Events.on=s.Mixin.Events.addEventListener,s.Mixin.Events.off=s.Mixin.Events.removeEventListener,s.Mixin.Events.once=s.Mixin.Events.addOneTimeEventListener,s.Mixin.Events.fire=s.Mixin.Events.fireEvent,function(){var n="ActiveXObject"in t,r=n&&!e.addEventListener,o=navigator.userAgent.toLowerCase(),a=-1!==o.indexOf("webkit"),l=-1!==o.indexOf("chrome"),h=-1!==o.indexOf("phantom"),u=-1!==o.indexOf("android"),p=-1!==o.search("android [23]"),c=-1!==o.indexOf("gecko"),d=typeof orientation!=i+"",m=t.navigator&&t.navigator.msPointerEnabled&&t.navigator.msMaxTouchPoints&&!t.PointerEvent,f=t.PointerEvent&&t.navigator.pointerEnabled&&t.navigator.maxTouchPoints||m,y="devicePixelRatio"in t&&t.devicePixelRatio>1||"matchMedia"in t&&t.matchMedia("(min-resolution:144dpi)")&&t.matchMedia("(min-resolution:144dpi)").matches,g=e.documentElement,v=n&&"transition"in g.style,L="WebKitCSSMatrix"in t&&"m11"in new t.WebKitCSSMatrix&&!p,_="MozPerspective"in g.style,O="OTransition"in g.style,b=!t.L_DISABLE_3D&&(v||L||_||O)&&!h,w=!t.L_NO_TOUCH&&!h&&function(){var t="ontouchstart";if(f||t in g)return!0;var i=e.createElement("div"),n=!1;return i.setAttribute?(i.setAttribute(t,"return;"),"function"==typeof i[t]&&(n=!0),i.removeAttribute(t),i=null,n):!1}();s.Browser={ie:n,ielt9:r,webkit:a,gecko:c&&!a&&!t.opera&&!n,android:u,android23:p,chrome:l,ie3d:v,webkit3d:L,gecko3d:_,opera3d:O,any3d:b,mobile:d,mobileWebkit:d&&a,mobileWebkit3d:d&&L,mobileOpera:d&&t.opera,touch:w,msPointer:m,pointer:f,retina:y}}(),s.Point=function(t,e,i){this.x=i?Math.round(t):t,this.y=i?Math.round(e):e},s.Point.prototype={clone:function(){return new s.Point(this.x,this.y)},add:function(t){return this.clone()._add(s.point(t))},_add:function(t){return this.x+=t.x,this.y+=t.y,this},subtract:function(t){return this.clone()._subtract(s.point(t))},_subtract:function(t){return this.x-=t.x,this.y-=t.y,this},divideBy:function(t){return this.clone()._divideBy(t)},_divideBy:function(t){return this.x/=t,this.y/=t,this},multiplyBy:function(t){return this.clone()._multiplyBy(t)},_multiplyBy:function(t){return this.x*=t,this.y*=t,this},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},distanceTo:function(t){t=s.point(t);var e=t.x-this.x,i=t.y-this.y;return Math.sqrt(e*e+i*i)},equals:function(t){return t=s.point(t),t.x===this.x&&t.y===this.y},contains:function(t){return t=s.point(t),Math.abs(t.x)<=Math.abs(this.x)&&Math.abs(t.y)<=Math.abs(this.y)},toString:function(){return"Point("+s.Util.formatNum(this.x)+", "+s.Util.formatNum(this.y)+")"}},s.point=function(t,e,n){return t instanceof s.Point?t:s.Util.isArray(t)?new s.Point(t[0],t[1]):t===i||null===t?t:new s.Point(t,e,n)},s.Bounds=function(t,e){if(t)for(var i=e?[t,e]:t,n=0,s=i.length;s>n;n++)this.extend(i[n])},s.Bounds.prototype={extend:function(t){return t=s.point(t),this.min||this.max?(this.min.x=Math.min(t.x,this.min.x),this.max.x=Math.max(t.x,this.max.x),this.min.y=Math.min(t.y,this.min.y),this.max.y=Math.max(t.y,this.max.y)):(this.min=t.clone(),this.max=t.clone()),this},getCenter:function(t){return new s.Point((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,t)},getBottomLeft:function(){return new s.Point(this.min.x,this.max.y)},getTopRight:function(){return new s.Point(this.max.x,this.min.y)},getSize:function(){return this.max.subtract(this.min)},contains:function(t){var e,i;return t="number"==typeof t[0]||t instanceof s.Point?s.point(t):s.bounds(t),t instanceof s.Bounds?(e=t.min,i=t.max):e=i=t,e.x>=this.min.x&&i.x<=this.max.x&&e.y>=this.min.y&&i.y<=this.max.y},intersects:function(t){t=s.bounds(t);var e=this.min,i=this.max,n=t.min,r=t.max,o=r.x>=e.x&&n.x<=i.x,a=r.y>=e.y&&n.y<=i.y;return o&&a},isValid:function(){return!(!this.min||!this.max)}},s.bounds=function(t,e){return!t||t instanceof s.Bounds?t:new s.Bounds(t,e)},s.Transformation=function(t,e,i,n){this._a=t,this._b=e,this._c=i,this._d=n},s.Transformation.prototype={transform:function(t,e){return this._transform(t.clone(),e)},_transform:function(t,e){return e=e||1,t.x=e*(this._a*t.x+this._b),t.y=e*(this._c*t.y+this._d),t},untransform:function(t,e){return e=e||1,new s.Point((t.x/e-this._b)/this._a,(t.y/e-this._d)/this._c)}},s.DomUtil={get:function(t){return"string"==typeof t?e.getElementById(t):t},getStyle:function(t,i){var n=t.style[i];if(!n&&t.currentStyle&&(n=t.currentStyle[i]),(!n||"auto"===n)&&e.defaultView){var s=e.defaultView.getComputedStyle(t,null);n=s?s[i]:null}return"auto"===n?null:n},getViewportOffset:function(t){var i,n=0,r=0,o=t,a=e.body,l=e.documentElement;do{if(n+=o.offsetTop||0,r+=o.offsetLeft||0,n+=parseInt(s.DomUtil.getStyle(o,"borderTopWidth"),10)||0,r+=parseInt(s.DomUtil.getStyle(o,"borderLeftWidth"),10)||0,i=s.DomUtil.getStyle(o,"position"),o.offsetParent===a&&"absolute"===i)break;if("fixed"===i){n+=a.scrollTop||l.scrollTop||0,r+=a.scrollLeft||l.scrollLeft||0;break}if("relative"===i&&!o.offsetLeft){var h=s.DomUtil.getStyle(o,"width"),u=s.DomUtil.getStyle(o,"max-width"),p=o.getBoundingClientRect();("none"!==h||"none"!==u)&&(r+=p.left+o.clientLeft),n+=p.top+(a.scrollTop||l.scrollTop||0);break}o=o.offsetParent}while(o);o=t;do{if(o===a)break;n-=o.scrollTop||0,r-=o.scrollLeft||0,o=o.parentNode}while(o);return new s.Point(r,n)},documentIsLtr:function(){return s.DomUtil._docIsLtrCached||(s.DomUtil._docIsLtrCached=!0,s.DomUtil._docIsLtr="ltr"===s.DomUtil.getStyle(e.body,"direction")),s.DomUtil._docIsLtr},create:function(t,i,n){var s=e.createElement(t);return s.className=i,n&&n.appendChild(s),s},hasClass:function(t,e){if(t.classList!==i)return t.classList.contains(e);var n=s.DomUtil._getClass(t);return n.length>0&&new RegExp("(^|\\s)"+e+"(\\s|$)").test(n)},addClass:function(t,e){if(t.classList!==i)for(var n=s.Util.splitWords(e),r=0,o=n.length;o>r;r++)t.classList.add(n[r]);else if(!s.DomUtil.hasClass(t,e)){var a=s.DomUtil._getClass(t);s.DomUtil._setClass(t,(a?a+" ":"")+e)}},removeClass:function(t,e){t.classList!==i?t.classList.remove(e):s.DomUtil._setClass(t,s.Util.trim((" "+s.DomUtil._getClass(t)+" ").replace(" "+e+" "," ")))},_setClass:function(t,e){t.className.baseVal===i?t.className=e:t.className.baseVal=e},_getClass:function(t){return t.className.baseVal===i?t.className:t.className.baseVal},setOpacity:function(t,e){if("opacity"in t.style)t.style.opacity=e;else if("filter"in t.style){var i=!1,n="DXImageTransform.Microsoft.Alpha";try{i=t.filters.item(n)}catch(s){if(1===e)return}e=Math.round(100*e),i?(i.Enabled=100!==e,i.Opacity=e):t.style.filter+=" progid:"+n+"(opacity="+e+")"}},testProp:function(t){for(var i=e.documentElement.style,n=0;n<t.length;n++)if(t[n]in i)return t[n];return!1},getTranslateString:function(t){var e=s.Browser.webkit3d,i="translate"+(e?"3d":"")+"(",n=(e?",0":"")+")";return i+t.x+"px,"+t.y+"px"+n},getScaleString:function(t,e){var i=s.DomUtil.getTranslateString(e.add(e.multiplyBy(-1*t))),n=" scale("+t+") ";return i+n},setPosition:function(t,e,i){t._leaflet_pos=e,!i&&s.Browser.any3d?t.style[s.DomUtil.TRANSFORM]=s.DomUtil.getTranslateString(e):(t.style.left=e.x+"px",t.style.top=e.y+"px")},getPosition:function(t){return t._leaflet_pos}},s.DomUtil.TRANSFORM=s.DomUtil.testProp(["transform","WebkitTransform","OTransform","MozTransform","msTransform"]),s.DomUtil.TRANSITION=s.DomUtil.testProp(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),s.DomUtil.TRANSITION_END="webkitTransition"===s.DomUtil.TRANSITION||"OTransition"===s.DomUtil.TRANSITION?s.DomUtil.TRANSITION+"End":"transitionend",function(){if("onselectstart"in e)s.extend(s.DomUtil,{disableTextSelection:function(){s.DomEvent.on(t,"selectstart",s.DomEvent.preventDefault)},enableTextSelection:function(){s.DomEvent.off(t,"selectstart",s.DomEvent.preventDefault)}});else{var i=s.DomUtil.testProp(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);s.extend(s.DomUtil,{disableTextSelection:function(){if(i){var t=e.documentElement.style;this._userSelect=t[i],t[i]="none"}},enableTextSelection:function(){i&&(e.documentElement.style[i]=this._userSelect,delete this._userSelect)}})}s.extend(s.DomUtil,{disableImageDrag:function(){s.DomEvent.on(t,"dragstart",s.DomEvent.preventDefault)},enableImageDrag:function(){s.DomEvent.off(t,"dragstart",s.DomEvent.preventDefault)}})}(),s.LatLng=function(t,e,n){if(t=parseFloat(t),e=parseFloat(e),isNaN(t)||isNaN(e))throw new Error("Invalid LatLng object: ("+t+", "+e+")");this.lat=t,this.lng=e,n!==i&&(this.alt=parseFloat(n))},s.extend(s.LatLng,{DEG_TO_RAD:Math.PI/180,RAD_TO_DEG:180/Math.PI,MAX_MARGIN:1e-9}),s.LatLng.prototype={equals:function(t){if(!t)return!1;t=s.latLng(t);var e=Math.max(Math.abs(this.lat-t.lat),Math.abs(this.lng-t.lng));return e<=s.LatLng.MAX_MARGIN},toString:function(t){return"LatLng("+s.Util.formatNum(this.lat,t)+", "+s.Util.formatNum(this.lng,t)+")"},distanceTo:function(t){t=s.latLng(t);var e=6378137,i=s.LatLng.DEG_TO_RAD,n=(t.lat-this.lat)*i,r=(t.lng-this.lng)*i,o=this.lat*i,a=t.lat*i,l=Math.sin(n/2),h=Math.sin(r/2),u=l*l+h*h*Math.cos(o)*Math.cos(a);return 2*e*Math.atan2(Math.sqrt(u),Math.sqrt(1-u))},wrap:function(t,e){var i=this.lng;return t=t||-180,e=e||180,i=(i+e)%(e-t)+(t>i||i===e?e:t),new s.LatLng(this.lat,i)}},s.latLng=function(t,e){return t instanceof s.LatLng?t:s.Util.isArray(t)?"number"==typeof t[0]||"string"==typeof t[0]?new s.LatLng(t[0],t[1],t[2]):null:t===i||null===t?t:"object"==typeof t&&"lat"in t?new s.LatLng(t.lat,"lng"in t?t.lng:t.lon):e===i?null:new s.LatLng(t,e)},s.LatLngBounds=function(t,e){if(t)for(var i=e?[t,e]:t,n=0,s=i.length;s>n;n++)this.extend(i[n])},s.LatLngBounds.prototype={extend:function(t){if(!t)return this;var e=s.latLng(t);return t=null!==e?e:s.latLngBounds(t),t instanceof s.LatLng?this._southWest||this._northEast?(this._southWest.lat=Math.min(t.lat,this._southWest.lat),this._southWest.lng=Math.min(t.lng,this._southWest.lng),this._northEast.lat=Math.max(t.lat,this._northEast.lat),this._northEast.lng=Math.max(t.lng,this._northEast.lng)):(this._southWest=new s.LatLng(t.lat,t.lng),this._northEast=new s.LatLng(t.lat,t.lng)):t instanceof s.LatLngBounds&&(this.extend(t._southWest),this.extend(t._northEast)),this},pad:function(t){var e=this._southWest,i=this._northEast,n=Math.abs(e.lat-i.lat)*t,r=Math.abs(e.lng-i.lng)*t;return new s.LatLngBounds(new s.LatLng(e.lat-n,e.lng-r),new s.LatLng(i.lat+n,i.lng+r))},getCenter:function(){return new s.LatLng((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new s.LatLng(this.getNorth(),this.getWest())},getSouthEast:function(){return new s.LatLng(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(t){t="number"==typeof t[0]||t instanceof s.LatLng?s.latLng(t):s.latLngBounds(t);var e,i,n=this._southWest,r=this._northEast;return t instanceof s.LatLngBounds?(e=t.getSouthWest(),i=t.getNorthEast()):e=i=t,e.lat>=n.lat&&i.lat<=r.lat&&e.lng>=n.lng&&i.lng<=r.lng},intersects:function(t){t=s.latLngBounds(t);var e=this._southWest,i=this._northEast,n=t.getSouthWest(),r=t.getNorthEast(),o=r.lat>=e.lat&&n.lat<=i.lat,a=r.lng>=e.lng&&n.lng<=i.lng;return o&&a},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(t){return t?(t=s.latLngBounds(t),this._southWest.equals(t.getSouthWest())&&this._northEast.equals(t.getNorthEast())):!1},isValid:function(){return!(!this._southWest||!this._northEast)}},s.latLngBounds=function(t,e){return!t||t instanceof s.LatLngBounds?t:new s.LatLngBounds(t,e)},s.Projection={},s.Projection.SphericalMercator={MAX_LATITUDE:85.0511287798,project:function(t){var e=s.LatLng.DEG_TO_RAD,i=this.MAX_LATITUDE,n=Math.max(Math.min(i,t.lat),-i),r=t.lng*e,o=n*e;return o=Math.log(Math.tan(Math.PI/4+o/2)),new s.Point(r,o)},unproject:function(t){var e=s.LatLng.RAD_TO_DEG,i=t.x*e,n=(2*Math.atan(Math.exp(t.y))-Math.PI/2)*e;return new s.LatLng(n,i)}},s.Projection.LonLat={project:function(t){return new s.Point(t.lng,t.lat)},unproject:function(t){return new s.LatLng(t.y,t.x)}},s.CRS={latLngToPoint:function(t,e){var i=this.projection.project(t),n=this.scale(e);return this.transformation._transform(i,n)},pointToLatLng:function(t,e){var i=this.scale(e),n=this.transformation.untransform(t,i);return this.projection.unproject(n)},project:function(t){return this.projection.project(t)},scale:function(t){return 256*Math.pow(2,t)},getSize:function(t){var e=this.scale(t);return s.point(e,e)}},s.CRS.Simple=s.extend({},s.CRS,{projection:s.Projection.LonLat,transformation:new s.Transformation(1,0,-1,0),scale:function(t){return Math.pow(2,t)}}),s.CRS.EPSG3857=s.extend({},s.CRS,{code:"EPSG:3857",projection:s.Projection.SphericalMercator,transformation:new s.Transformation(.5/Math.PI,.5,-.5/Math.PI,.5),project:function(t){var e=this.projection.project(t),i=6378137;return e.multiplyBy(i)}}),s.CRS.EPSG900913=s.extend({},s.CRS.EPSG3857,{code:"EPSG:900913"}),s.CRS.EPSG4326=s.extend({},s.CRS,{code:"EPSG:4326",projection:s.Projection.LonLat,transformation:new s.Transformation(1/360,.5,-1/360,.5)}),s.Map=s.Class.extend({includes:s.Mixin.Events,options:{crs:s.CRS.EPSG3857,fadeAnimation:s.DomUtil.TRANSITION&&!s.Browser.android23,trackResize:!0,markerZoomAnimation:s.DomUtil.TRANSITION&&s.Browser.any3d},initialize:function(t,e){e=s.setOptions(this,e),this._initContainer(t),this._initLayout(),this._onResize=s.bind(this._onResize,this),this._initEvents(),e.maxBounds&&this.setMaxBounds(e.maxBounds),e.center&&e.zoom!==i&&this.setView(s.latLng(e.center),e.zoom,{reset:!0}),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._tileLayersNum=0,this.callInitHooks(),this._addLayers(e.layers)},setView:function(t,e){return e=e===i?this.getZoom():e,this._resetView(s.latLng(t),this._limitZoom(e)),this},setZoom:function(t,e){return this._loaded?this.setView(this.getCenter(),t,{zoom:e}):(this._zoom=this._limitZoom(t),this)},zoomIn:function(t,e){return this.setZoom(this._zoom+(t||1),e)},zoomOut:function(t,e){return this.setZoom(this._zoom-(t||1),e)},setZoomAround:function(t,e,i){var n=this.getZoomScale(e),r=this.getSize().divideBy(2),o=t instanceof s.Point?t:this.latLngToContainerPoint(t),a=o.subtract(r).multiplyBy(1-1/n),l=this.containerPointToLatLng(r.add(a));return this.setView(l,e,{zoom:i})},fitBounds:function(t,e){e=e||{},t=t.getBounds?t.getBounds():s.latLngBounds(t);var i=s.point(e.paddingTopLeft||e.padding||[0,0]),n=s.point(e.paddingBottomRight||e.padding||[0,0]),r=this.getBoundsZoom(t,!1,i.add(n)),o=n.subtract(i).divideBy(2),a=this.project(t.getSouthWest(),r),l=this.project(t.getNorthEast(),r),h=this.unproject(a.add(l).divideBy(2).add(o),r);return r=e&&e.maxZoom?Math.min(e.maxZoom,r):r,this.setView(h,r,e)},fitWorld:function(t){return this.fitBounds([[-90,-180],[90,180]],t)},panTo:function(t,e){return this.setView(t,this._zoom,{pan:e})},panBy:function(t){return this.fire("movestart"),this._rawPanBy(s.point(t)),this.fire("move"),this.fire("moveend")},setMaxBounds:function(t){return t=s.latLngBounds(t),this.options.maxBounds=t,t?(this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds,this)):this.off("moveend",this._panInsideMaxBounds,this)},panInsideBounds:function(t,e){var i=this.getCenter(),n=this._limitCenter(i,this._zoom,t);return i.equals(n)?this:this.panTo(n,e)},addLayer:function(t){var e=s.stamp(t);return this._layers[e]?this:(this._layers[e]=t,!t.options||isNaN(t.options.maxZoom)&&isNaN(t.options.minZoom)||(this._zoomBoundLayers[e]=t,this._updateZoomLevels()),this.options.zoomAnimation&&s.TileLayer&&t instanceof s.TileLayer&&(this._tileLayersNum++,this._tileLayersToLoad++,t.on("load",this._onTileLayerLoad,this)),this._loaded&&this._layerAdd(t),this)},removeLayer:function(t){var e=s.stamp(t);return this._layers[e]?(this._loaded&&t.onRemove(this),delete this._layers[e],this._loaded&&this.fire("layerremove",{layer:t}),this._zoomBoundLayers[e]&&(delete this._zoomBoundLayers[e],this._updateZoomLevels()),this.options.zoomAnimation&&s.TileLayer&&t instanceof s.TileLayer&&(this._tileLayersNum--,this._tileLayersToLoad--,t.off("load",this._onTileLayerLoad,this)),this):this},hasLayer:function(t){return t?s.stamp(t)in this._layers:!1},eachLayer:function(t,e){for(var i in this._layers)t.call(e,this._layers[i]);return this},invalidateSize:function(t){if(!this._loaded)return this;t=s.extend({animate:!1,pan:!0},t===!0?{animate:!0}:t);var e=this.getSize();this._sizeChanged=!0,this._initialCenter=null;var i=this.getSize(),n=e.divideBy(2).round(),r=i.divideBy(2).round(),o=n.subtract(r);return o.x||o.y?(t.animate&&t.pan?this.panBy(o):(t.pan&&this._rawPanBy(o),this.fire("move"),t.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(s.bind(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:e,newSize:i})):this},addHandler:function(t,e){if(!e)return this;var i=this[t]=new e(this);return this._handlers.push(i),this.options[t]&&i.enable(),this},remove:function(){this._loaded&&this.fire("unload"),this._initEvents("off");try{delete this._container._leaflet}catch(t){this._container._leaflet=i}return this._clearPanes(),this._clearControlPos&&this._clearControlPos(),this._clearHandlers(),this},getCenter:function(){return this._checkIfLoaded(),this._initialCenter&&!this._moved()?this._initialCenter:this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var t=this.getPixelBounds(),e=this.unproject(t.getBottomLeft()),i=this.unproject(t.getTopRight());return new s.LatLngBounds(e,i)},getMinZoom:function(){return this.options.minZoom===i?this._layersMinZoom===i?0:this._layersMinZoom:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===i?this._layersMaxZoom===i?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(t,e,i){t=s.latLngBounds(t);var n,r=this.getMinZoom()-(e?1:0),o=this.getMaxZoom(),a=this.getSize(),l=t.getNorthWest(),h=t.getSouthEast(),u=!0;i=s.point(i||[0,0]);do r++,n=this.project(h,r).subtract(this.project(l,r)).add(i),u=e?n.x<a.x||n.y<a.y:a.contains(n);while(u&&o>=r);return u&&e?null:e?r:r-1},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new s.Point(this._container.clientWidth,this._container.clientHeight),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(){var t=this._getTopLeftPoint();return new s.Bounds(t,t.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._initialTopLeftPoint},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(t){var e=this.options.crs;return e.scale(t)/e.scale(this._zoom)},getScaleZoom:function(t){return this._zoom+Math.log(t)/Math.LN2},project:function(t,e){return e=e===i?this._zoom:e,this.options.crs.latLngToPoint(s.latLng(t),e)},unproject:function(t,e){return e=e===i?this._zoom:e,this.options.crs.pointToLatLng(s.point(t),e)},layerPointToLatLng:function(t){var e=s.point(t).add(this.getPixelOrigin());return this.unproject(e)},latLngToLayerPoint:function(t){var e=this.project(s.latLng(t))._round();return e._subtract(this.getPixelOrigin())},containerPointToLayerPoint:function(t){return s.point(t).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(t){return s.point(t).add(this._getMapPanePos())},containerPointToLatLng:function(t){var e=this.containerPointToLayerPoint(s.point(t));return this.layerPointToLatLng(e)},latLngToContainerPoint:function(t){return this.layerPointToContainerPoint(this.latLngToLayerPoint(s.latLng(t)))},mouseEventToContainerPoint:function(t){return s.DomEvent.getMousePosition(t,this._container)},mouseEventToLayerPoint:function(t){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(t))},mouseEventToLatLng:function(t){return this.layerPointToLatLng(this.mouseEventToLayerPoint(t))},_initContainer:function(t){var e=this._container=s.DomUtil.get(t);if(!e)throw new Error("Map container not found.");if(e._leaflet)throw new Error("Map container is already initialized.");e._leaflet=!0},_initLayout:function(){var t=this._container;s.DomUtil.addClass(t,"leaflet-container"+(s.Browser.touch?" leaflet-touch":"")+(s.Browser.retina?" leaflet-retina":"")+(s.Browser.ielt9?" leaflet-oldie":"")+(this.options.fadeAnimation?" leaflet-fade-anim":""));var e=s.DomUtil.getStyle(t,"position");"absolute"!==e&&"relative"!==e&&"fixed"!==e&&(t.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var t=this._panes={};this._mapPane=t.mapPane=this._createPane("leaflet-map-pane",this._container),this._tilePane=t.tilePane=this._createPane("leaflet-tile-pane",this._mapPane),t.objectsPane=this._createPane("leaflet-objects-pane",this._mapPane),t.shadowPane=this._createPane("leaflet-shadow-pane"),t.overlayPane=this._createPane("leaflet-overlay-pane"),t.markerPane=this._createPane("leaflet-marker-pane"),t.popupPane=this._createPane("leaflet-popup-pane");var e=" leaflet-zoom-hide";this.options.markerZoomAnimation||(s.DomUtil.addClass(t.markerPane,e),s.DomUtil.addClass(t.shadowPane,e),s.DomUtil.addClass(t.popupPane,e))},_createPane:function(t,e){return s.DomUtil.create("div",t,e||this._panes.objectsPane)},_clearPanes:function(){this._container.removeChild(this._mapPane)},_addLayers:function(t){t=t?s.Util.isArray(t)?t:[t]:[];for(var e=0,i=t.length;i>e;e++)this.addLayer(t[e])},_resetView:function(t,e,i,n){var r=this._zoom!==e;n||(this.fire("movestart"),r&&this.fire("zoomstart")),this._zoom=e,this._initialCenter=t,this._initialTopLeftPoint=this._getNewTopLeftPoint(t),i?this._initialTopLeftPoint._add(this._getMapPanePos()):s.DomUtil.setPosition(this._mapPane,new s.Point(0,0)),this._tileLayersToLoad=this._tileLayersNum;var o=!this._loaded;this._loaded=!0,this.fire("viewreset",{hard:!i}),o&&(this.fire("load"),this.eachLayer(this._layerAdd,this)),this.fire("move"),(r||n)&&this.fire("zoomend"),this.fire("moveend",{hard:!i})},_rawPanBy:function(t){s.DomUtil.setPosition(this._mapPane,this._getMapPanePos().subtract(t))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_updateZoomLevels:function(){var t,e=1/0,n=-1/0,s=this._getZoomSpan();for(t in this._zoomBoundLayers){var r=this._zoomBoundLayers[t];isNaN(r.options.minZoom)||(e=Math.min(e,r.options.minZoom)),isNaN(r.options.maxZoom)||(n=Math.max(n,r.options.maxZoom))}t===i?this._layersMaxZoom=this._layersMinZoom=i:(this._layersMaxZoom=n,this._layersMinZoom=e),s!==this._getZoomSpan()&&this.fire("zoomlevelschange")},_panInsideMaxBounds:function(){this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(e){if(s.DomEvent){e=e||"on",s.DomEvent[e](this._container,"click",this._onMouseClick,this);var i,n,r=["dblclick","mousedown","mouseup","mouseenter","mouseleave","mousemove","contextmenu"];for(i=0,n=r.length;n>i;i++)s.DomEvent[e](this._container,r[i],this._fireMouseEvent,this);this.options.trackResize&&s.DomEvent[e](t,"resize",this._onResize,this)}},_onResize:function(){s.Util.cancelAnimFrame(this._resizeRequest),this._resizeRequest=s.Util.requestAnimFrame(function(){this.invalidateSize({debounceMoveend:!0})},this,!1,this._container)},_onMouseClick:function(t){!this._loaded||!t._simulated&&(this.dragging&&this.dragging.moved()||this.boxZoom&&this.boxZoom.moved())||s.DomEvent._skipped(t)||(this.fire("preclick"),this._fireMouseEvent(t))},_fireMouseEvent:function(t){if(this._loaded&&!s.DomEvent._skipped(t)){var e=t.type;if(e="mouseenter"===e?"mouseover":"mouseleave"===e?"mouseout":e,this.hasEventListeners(e)){"contextmenu"===e&&s.DomEvent.preventDefault(t);var i=this.mouseEventToContainerPoint(t),n=this.containerPointToLayerPoint(i),r=this.layerPointToLatLng(n);this.fire(e,{latlng:r,layerPoint:n,containerPoint:i,originalEvent:t})}}},_onTileLayerLoad:function(){this._tileLayersToLoad--,this._tileLayersNum&&!this._tileLayersToLoad&&this.fire("tilelayersload")},_clearHandlers:function(){for(var t=0,e=this._handlers.length;e>t;t++)this._handlers[t].disable()},whenReady:function(t,e){return this._loaded?t.call(e||this,this):this.on("load",t,e),this},_layerAdd:function(t){t.onAdd(this),this.fire("layeradd",{layer:t})},_getMapPanePos:function(){return s.DomUtil.getPosition(this._mapPane)},_moved:function(){var t=this._getMapPanePos();return t&&!t.equals([0,0])},_getTopLeftPoint:function(){return this.getPixelOrigin().subtract(this._getMapPanePos())},_getNewTopLeftPoint:function(t,e){var i=this.getSize()._divideBy(2);return this.project(t,e)._subtract(i)._round()},_latLngToNewLayerPoint:function(t,e,i){var n=this._getNewTopLeftPoint(i,e).add(this._getMapPanePos());return this.project(t,e)._subtract(n)},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(t){return this.latLngToLayerPoint(t).subtract(this._getCenterLayerPoint())},_limitCenter:function(t,e,i){if(!i)return t;
var n=this.project(t,e),r=this.getSize().divideBy(2),o=new s.Bounds(n.subtract(r),n.add(r)),a=this._getBoundsOffset(o,i,e);return this.unproject(n.add(a),e)},_limitOffset:function(t,e){if(!e)return t;var i=this.getPixelBounds(),n=new s.Bounds(i.min.add(t),i.max.add(t));return t.add(this._getBoundsOffset(n,e))},_getBoundsOffset:function(t,e,i){var n=this.project(e.getNorthWest(),i).subtract(t.min),r=this.project(e.getSouthEast(),i).subtract(t.max),o=this._rebound(n.x,-r.x),a=this._rebound(n.y,-r.y);return new s.Point(o,a)},_rebound:function(t,e){return t+e>0?Math.round(t-e)/2:Math.max(0,Math.ceil(t))-Math.max(0,Math.floor(e))},_limitZoom:function(t){var e=this.getMinZoom(),i=this.getMaxZoom();return Math.max(e,Math.min(i,t))}}),s.map=function(t,e){return new s.Map(t,e)},s.Projection.Mercator={MAX_LATITUDE:85.0840591556,R_MINOR:6356752.314245179,R_MAJOR:6378137,project:function(t){var e=s.LatLng.DEG_TO_RAD,i=this.MAX_LATITUDE,n=Math.max(Math.min(i,t.lat),-i),r=this.R_MAJOR,o=this.R_MINOR,a=t.lng*e*r,l=n*e,h=o/r,u=Math.sqrt(1-h*h),p=u*Math.sin(l);p=Math.pow((1-p)/(1+p),.5*u);var c=Math.tan(.5*(.5*Math.PI-l))/p;return l=-r*Math.log(c),new s.Point(a,l)},unproject:function(t){for(var e,i=s.LatLng.RAD_TO_DEG,n=this.R_MAJOR,r=this.R_MINOR,o=t.x*i/n,a=r/n,l=Math.sqrt(1-a*a),h=Math.exp(-t.y/n),u=Math.PI/2-2*Math.atan(h),p=15,c=1e-7,d=p,m=.1;Math.abs(m)>c&&--d>0;)e=l*Math.sin(u),m=Math.PI/2-2*Math.atan(h*Math.pow((1-e)/(1+e),.5*l))-u,u+=m;return new s.LatLng(u*i,o)}},s.CRS.EPSG3395=s.extend({},s.CRS,{code:"EPSG:3395",projection:s.Projection.Mercator,transformation:function(){var t=s.Projection.Mercator,e=t.R_MAJOR,i=.5/(Math.PI*e);return new s.Transformation(i,.5,-i,.5)}()}),s.TileLayer=s.Class.extend({includes:s.Mixin.Events,options:{minZoom:0,maxZoom:18,tileSize:256,subdomains:"abc",errorTileUrl:"",attribution:"",zoomOffset:0,opacity:1,unloadInvisibleTiles:s.Browser.mobile,updateWhenIdle:s.Browser.mobile},initialize:function(t,e){e=s.setOptions(this,e),e.detectRetina&&s.Browser.retina&&e.maxZoom>0&&(e.tileSize=Math.floor(e.tileSize/2),e.zoomOffset++,e.minZoom>0&&e.minZoom--,this.options.maxZoom--),e.bounds&&(e.bounds=s.latLngBounds(e.bounds)),this._url=t;var i=this.options.subdomains;"string"==typeof i&&(this.options.subdomains=i.split(""))},onAdd:function(t){this._map=t,this._animated=t._zoomAnimated,this._initContainer(),t.on({viewreset:this._reset,moveend:this._update},this),this._animated&&t.on({zoomanim:this._animateZoom,zoomend:this._endZoomAnim},this),this.options.updateWhenIdle||(this._limitedUpdate=s.Util.limitExecByInterval(this._update,150,this),t.on("move",this._limitedUpdate,this)),this._reset(),this._update()},addTo:function(t){return t.addLayer(this),this},onRemove:function(t){this._container.parentNode.removeChild(this._container),t.off({viewreset:this._reset,moveend:this._update},this),this._animated&&t.off({zoomanim:this._animateZoom,zoomend:this._endZoomAnim},this),this.options.updateWhenIdle||t.off("move",this._limitedUpdate,this),this._container=null,this._map=null},bringToFront:function(){var t=this._map._panes.tilePane;return this._container&&(t.appendChild(this._container),this._setAutoZIndex(t,Math.max)),this},bringToBack:function(){var t=this._map._panes.tilePane;return this._container&&(t.insertBefore(this._container,t.firstChild),this._setAutoZIndex(t,Math.min)),this},getAttribution:function(){return this.options.attribution},getContainer:function(){return this._container},setOpacity:function(t){return this.options.opacity=t,this._map&&this._updateOpacity(),this},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},setUrl:function(t,e){return this._url=t,e||this.redraw(),this},redraw:function(){return this._map&&(this._reset({hard:!0}),this._update()),this},_updateZIndex:function(){this._container&&this.options.zIndex!==i&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(t,e){var i,n,s,r=t.children,o=-e(1/0,-1/0);for(n=0,s=r.length;s>n;n++)r[n]!==this._container&&(i=parseInt(r[n].style.zIndex,10),isNaN(i)||(o=e(o,i)));this.options.zIndex=this._container.style.zIndex=(isFinite(o)?o:0)+e(1,-1)},_updateOpacity:function(){var t,e=this._tiles;if(s.Browser.ielt9)for(t in e)s.DomUtil.setOpacity(e[t],this.options.opacity);else s.DomUtil.setOpacity(this._container,this.options.opacity)},_initContainer:function(){var t=this._map._panes.tilePane;if(!this._container){if(this._container=s.DomUtil.create("div","leaflet-layer"),this._updateZIndex(),this._animated){var e="leaflet-tile-container";this._bgBuffer=s.DomUtil.create("div",e,this._container),this._tileContainer=s.DomUtil.create("div",e,this._container)}else this._tileContainer=this._container;t.appendChild(this._container),this.options.opacity<1&&this._updateOpacity()}},_reset:function(t){for(var e in this._tiles)this.fire("tileunload",{tile:this._tiles[e]});this._tiles={},this._tilesToLoad=0,this.options.reuseTiles&&(this._unusedTiles=[]),this._tileContainer.innerHTML="",this._animated&&t&&t.hard&&this._clearBgBuffer(),this._initContainer()},_getTileSize:function(){var t=this._map,e=t.getZoom()+this.options.zoomOffset,i=this.options.maxNativeZoom,n=this.options.tileSize;return i&&e>i&&(n=Math.round(t.getZoomScale(e)/t.getZoomScale(i)*n)),n},_update:function(){if(this._map){var t=this._map,e=t.getPixelBounds(),i=t.getZoom(),n=this._getTileSize();if(!(i>this.options.maxZoom||i<this.options.minZoom)){var r=s.bounds(e.min.divideBy(n)._floor(),e.max.divideBy(n)._floor());this._addTilesFromCenterOut(r),(this.options.unloadInvisibleTiles||this.options.reuseTiles)&&this._removeOtherTiles(r)}}},_addTilesFromCenterOut:function(t){var i,n,r,o=[],a=t.getCenter();for(i=t.min.y;i<=t.max.y;i++)for(n=t.min.x;n<=t.max.x;n++)r=new s.Point(n,i),this._tileShouldBeLoaded(r)&&o.push(r);var l=o.length;if(0!==l){o.sort(function(t,e){return t.distanceTo(a)-e.distanceTo(a)});var h=e.createDocumentFragment();for(this._tilesToLoad||this.fire("loading"),this._tilesToLoad+=l,n=0;l>n;n++)this._addTile(o[n],h);this._tileContainer.appendChild(h)}},_tileShouldBeLoaded:function(t){if(t.x+":"+t.y in this._tiles)return!1;var e=this.options;if(!e.continuousWorld){var i=this._getWrapTileNum();if(e.noWrap&&(t.x<0||t.x>=i.x)||t.y<0||t.y>=i.y)return!1}if(e.bounds){var n=e.tileSize,s=t.multiplyBy(n),r=s.add([n,n]),o=this._map.unproject(s),a=this._map.unproject(r);if(e.continuousWorld||e.noWrap||(o=o.wrap(),a=a.wrap()),!e.bounds.intersects([o,a]))return!1}return!0},_removeOtherTiles:function(t){var e,i,n,s;for(s in this._tiles)e=s.split(":"),i=parseInt(e[0],10),n=parseInt(e[1],10),(i<t.min.x||i>t.max.x||n<t.min.y||n>t.max.y)&&this._removeTile(s)},_removeTile:function(t){var e=this._tiles[t];this.fire("tileunload",{tile:e,url:e.src}),this.options.reuseTiles?(s.DomUtil.removeClass(e,"leaflet-tile-loaded"),this._unusedTiles.push(e)):e.parentNode===this._tileContainer&&this._tileContainer.removeChild(e),s.Browser.android||(e.onload=null,e.src=s.Util.emptyImageUrl),delete this._tiles[t]},_addTile:function(t,e){var i=this._getTilePos(t),n=this._getTile();s.DomUtil.setPosition(n,i,s.Browser.chrome),this._tiles[t.x+":"+t.y]=n,this._loadTile(n,t),n.parentNode!==this._tileContainer&&e.appendChild(n)},_getZoomForUrl:function(){var t=this.options,e=this._map.getZoom();return t.zoomReverse&&(e=t.maxZoom-e),e+=t.zoomOffset,t.maxNativeZoom?Math.min(e,t.maxNativeZoom):e},_getTilePos:function(t){var e=this._map.getPixelOrigin(),i=this._getTileSize();return t.multiplyBy(i).subtract(e)},getTileUrl:function(t){return s.Util.template(this._url,s.extend({s:this._getSubdomain(t),z:t.z,x:t.x,y:t.y},this.options))},_getWrapTileNum:function(){var t=this._map.options.crs,e=t.getSize(this._map.getZoom());return e.divideBy(this._getTileSize())._floor()},_adjustTilePoint:function(t){var e=this._getWrapTileNum();this.options.continuousWorld||this.options.noWrap||(t.x=(t.x%e.x+e.x)%e.x),this.options.tms&&(t.y=e.y-t.y-1),t.z=this._getZoomForUrl()},_getSubdomain:function(t){var e=Math.abs(t.x+t.y)%this.options.subdomains.length;return this.options.subdomains[e]},_getTile:function(){if(this.options.reuseTiles&&this._unusedTiles.length>0){var t=this._unusedTiles.pop();return this._resetTile(t),t}return this._createTile()},_resetTile:function(){},_createTile:function(){var t=s.DomUtil.create("img","leaflet-tile");return t.style.width=t.style.height=this._getTileSize()+"px",t.galleryimg="no",t.onselectstart=t.onmousemove=s.Util.falseFn,s.Browser.ielt9&&this.options.opacity!==i&&s.DomUtil.setOpacity(t,this.options.opacity),s.Browser.mobileWebkit3d&&(t.style.WebkitBackfaceVisibility="hidden"),t},_loadTile:function(t,e){t._layer=this,t.onload=this._tileOnLoad,t.onerror=this._tileOnError,this._adjustTilePoint(e),t.src=this.getTileUrl(e),this.fire("tileloadstart",{tile:t,url:t.src})},_tileLoaded:function(){this._tilesToLoad--,this._animated&&s.DomUtil.addClass(this._tileContainer,"leaflet-zoom-animated"),this._tilesToLoad||(this.fire("load"),this._animated&&(clearTimeout(this._clearBgBufferTimer),this._clearBgBufferTimer=setTimeout(s.bind(this._clearBgBuffer,this),500)))},_tileOnLoad:function(){var t=this._layer;this.src!==s.Util.emptyImageUrl&&(s.DomUtil.addClass(this,"leaflet-tile-loaded"),t.fire("tileload",{tile:this,url:this.src})),t._tileLoaded()},_tileOnError:function(){var t=this._layer;t.fire("tileerror",{tile:this,url:this.src});var e=t.options.errorTileUrl;e&&(this.src=e),t._tileLoaded()}}),s.tileLayer=function(t,e){return new s.TileLayer(t,e)},s.TileLayer.WMS=s.TileLayer.extend({defaultWmsParams:{service:"WMS",request:"GetMap",version:"1.1.1",layers:"",styles:"",format:"image/jpeg",transparent:!1},initialize:function(t,e){this._url=t;var i=s.extend({},this.defaultWmsParams),n=e.tileSize||this.options.tileSize;i.width=i.height=e.detectRetina&&s.Browser.retina?2*n:n;for(var r in e)this.options.hasOwnProperty(r)||"crs"===r||(i[r]=e[r]);this.wmsParams=i,s.setOptions(this,e)},onAdd:function(t){this._crs=this.options.crs||t.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var e=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[e]=this._crs.code,s.TileLayer.prototype.onAdd.call(this,t)},getTileUrl:function(t){var e=this._map,i=this.options.tileSize,n=t.multiplyBy(i),r=n.add([i,i]),o=this._crs.project(e.unproject(n,t.z)),a=this._crs.project(e.unproject(r,t.z)),l=this._wmsVersion>=1.3&&this._crs===s.CRS.EPSG4326?[a.y,o.x,o.y,a.x].join(","):[o.x,a.y,a.x,o.y].join(","),h=s.Util.template(this._url,{s:this._getSubdomain(t)});return h+s.Util.getParamString(this.wmsParams,h,!0)+"&BBOX="+l},setParams:function(t,e){return s.extend(this.wmsParams,t),e||this.redraw(),this}}),s.tileLayer.wms=function(t,e){return new s.TileLayer.WMS(t,e)},s.TileLayer.Canvas=s.TileLayer.extend({options:{async:!1},initialize:function(t){s.setOptions(this,t)},redraw:function(){this._map&&(this._reset({hard:!0}),this._update());for(var t in this._tiles)this._redrawTile(this._tiles[t]);return this},_redrawTile:function(t){this.drawTile(t,t._tilePoint,this._map._zoom)},_createTile:function(){var t=s.DomUtil.create("canvas","leaflet-tile");return t.width=t.height=this.options.tileSize,t.onselectstart=t.onmousemove=s.Util.falseFn,t},_loadTile:function(t,e){t._layer=this,t._tilePoint=e,this._redrawTile(t),this.options.async||this.tileDrawn(t)},drawTile:function(){},tileDrawn:function(t){this._tileOnLoad.call(t)}}),s.tileLayer.canvas=function(t){return new s.TileLayer.Canvas(t)},s.ImageOverlay=s.Class.extend({includes:s.Mixin.Events,options:{opacity:1},initialize:function(t,e,i){this._url=t,this._bounds=s.latLngBounds(e),s.setOptions(this,i)},onAdd:function(t){this._map=t,this._image||this._initImage(),t._panes.overlayPane.appendChild(this._image),t.on("viewreset",this._reset,this),t.options.zoomAnimation&&s.Browser.any3d&&t.on("zoomanim",this._animateZoom,this),this._reset()},onRemove:function(t){t.getPanes().overlayPane.removeChild(this._image),t.off("viewreset",this._reset,this),t.options.zoomAnimation&&t.off("zoomanim",this._animateZoom,this)},addTo:function(t){return t.addLayer(this),this},setOpacity:function(t){return this.options.opacity=t,this._updateOpacity(),this},bringToFront:function(){return this._image&&this._map._panes.overlayPane.appendChild(this._image),this},bringToBack:function(){var t=this._map._panes.overlayPane;return this._image&&t.insertBefore(this._image,t.firstChild),this},setUrl:function(t){this._url=t,this._image.src=this._url},getAttribution:function(){return this.options.attribution},_initImage:function(){this._image=s.DomUtil.create("img","leaflet-image-layer"),this._map.options.zoomAnimation&&s.Browser.any3d?s.DomUtil.addClass(this._image,"leaflet-zoom-animated"):s.DomUtil.addClass(this._image,"leaflet-zoom-hide"),this._updateOpacity(),s.extend(this._image,{galleryimg:"no",onselectstart:s.Util.falseFn,onmousemove:s.Util.falseFn,onload:s.bind(this._onImageLoad,this),src:this._url})},_animateZoom:function(t){var e=this._map,i=this._image,n=e.getZoomScale(t.zoom),r=this._bounds.getNorthWest(),o=this._bounds.getSouthEast(),a=e._latLngToNewLayerPoint(r,t.zoom,t.center),l=e._latLngToNewLayerPoint(o,t.zoom,t.center)._subtract(a),h=a._add(l._multiplyBy(.5*(1-1/n)));i.style[s.DomUtil.TRANSFORM]=s.DomUtil.getTranslateString(h)+" scale("+n+") "},_reset:function(){var t=this._image,e=this._map.latLngToLayerPoint(this._bounds.getNorthWest()),i=this._map.latLngToLayerPoint(this._bounds.getSouthEast())._subtract(e);s.DomUtil.setPosition(t,e),t.style.width=i.x+"px",t.style.height=i.y+"px"},_onImageLoad:function(){this.fire("load")},_updateOpacity:function(){s.DomUtil.setOpacity(this._image,this.options.opacity)}}),s.imageOverlay=function(t,e,i){return new s.ImageOverlay(t,e,i)},s.Icon=s.Class.extend({options:{className:""},initialize:function(t){s.setOptions(this,t)},createIcon:function(t){return this._createIcon("icon",t)},createShadow:function(t){return this._createIcon("shadow",t)},_createIcon:function(t,e){var i=this._getIconUrl(t);if(!i){if("icon"===t)throw new Error("iconUrl not set in Icon options (see the docs).");return null}var n;return n=e&&"IMG"===e.tagName?this._createImg(i,e):this._createImg(i),this._setIconStyles(n,t),n},_setIconStyles:function(t,e){var i,n=this.options,r=s.point(n[e+"Size"]);i=s.point("shadow"===e?n.shadowAnchor||n.iconAnchor:n.iconAnchor),!i&&r&&(i=r.divideBy(2,!0)),t.className="leaflet-marker-"+e+" "+n.className,i&&(t.style.marginLeft=-i.x+"px",t.style.marginTop=-i.y+"px"),r&&(t.style.width=r.x+"px",t.style.height=r.y+"px")},_createImg:function(t,i){return i=i||e.createElement("img"),i.src=t,i},_getIconUrl:function(t){return s.Browser.retina&&this.options[t+"RetinaUrl"]?this.options[t+"RetinaUrl"]:this.options[t+"Url"]}}),s.icon=function(t){return new s.Icon(t)},s.Icon.Default=s.Icon.extend({options:{iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]},_getIconUrl:function(t){var e=t+"Url";if(this.options[e])return this.options[e];s.Browser.retina&&"icon"===t&&(t+="-2x");var i=s.Icon.Default.imagePath;if(!i)throw new Error("Couldn't autodetect L.Icon.Default.imagePath, set it manually.");return i+"/marker-"+t+".png"}}),s.Icon.Default.imagePath=function(){var t,i,n,s,r,o=e.getElementsByTagName("script"),a=/[\/^]leaflet[\-\._]?([\w\-\._]*)\.js\??/;for(t=0,i=o.length;i>t;t++)if(n=o[t].src,s=n.match(a))return r=n.split(a)[0],(r?r+"/":"")+"images"}(),s.Marker=s.Class.extend({includes:s.Mixin.Events,options:{icon:new s.Icon.Default,title:"",alt:"",clickable:!0,draggable:!1,keyboard:!0,zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250},initialize:function(t,e){s.setOptions(this,e),this._latlng=s.latLng(t)},onAdd:function(t){this._map=t,t.on("viewreset",this.update,this),this._initIcon(),this.update(),this.fire("add"),t.options.zoomAnimation&&t.options.markerZoomAnimation&&t.on("zoomanim",this._animateZoom,this)},addTo:function(t){return t.addLayer(this),this},onRemove:function(t){this.dragging&&this.dragging.disable(),this._removeIcon(),this._removeShadow(),this.fire("remove"),t.off({viewreset:this.update,zoomanim:this._animateZoom},this),this._map=null},getLatLng:function(){return this._latlng},setLatLng:function(t){return this._latlng=s.latLng(t),this.update(),this.fire("move",{latlng:this._latlng})},setZIndexOffset:function(t){return this.options.zIndexOffset=t,this.update(),this},setIcon:function(t){return this.options.icon=t,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup),this},update:function(){if(this._icon){var t=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(t)}return this},_initIcon:function(){var t=this.options,e=this._map,i=e.options.zoomAnimation&&e.options.markerZoomAnimation,n=i?"leaflet-zoom-animated":"leaflet-zoom-hide",r=t.icon.createIcon(this._icon),o=!1;r!==this._icon&&(this._icon&&this._removeIcon(),o=!0,t.title&&(r.title=t.title),t.alt&&(r.alt=t.alt)),s.DomUtil.addClass(r,n),t.keyboard&&(r.tabIndex="0"),this._icon=r,this._initInteraction(),t.riseOnHover&&s.DomEvent.on(r,"mouseover",this._bringToFront,this).on(r,"mouseout",this._resetZIndex,this);var a=t.icon.createShadow(this._shadow),l=!1;a!==this._shadow&&(this._removeShadow(),l=!0),a&&s.DomUtil.addClass(a,n),this._shadow=a,t.opacity<1&&this._updateOpacity();var h=this._map._panes;o&&h.markerPane.appendChild(this._icon),a&&l&&h.shadowPane.appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&s.DomEvent.off(this._icon,"mouseover",this._bringToFront).off(this._icon,"mouseout",this._resetZIndex),this._map._panes.markerPane.removeChild(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&this._map._panes.shadowPane.removeChild(this._shadow),this._shadow=null},_setPos:function(t){s.DomUtil.setPosition(this._icon,t),this._shadow&&s.DomUtil.setPosition(this._shadow,t),this._zIndex=t.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(t){this._icon.style.zIndex=this._zIndex+t},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center).round();this._setPos(e)},_initInteraction:function(){if(this.options.clickable){var t=this._icon,e=["dblclick","mousedown","mouseover","mouseout","contextmenu"];s.DomUtil.addClass(t,"leaflet-clickable"),s.DomEvent.on(t,"click",this._onMouseClick,this),s.DomEvent.on(t,"keypress",this._onKeyPress,this);for(var i=0;i<e.length;i++)s.DomEvent.on(t,e[i],this._fireMouseEvent,this);s.Handler.MarkerDrag&&(this.dragging=new s.Handler.MarkerDrag(this),this.options.draggable&&this.dragging.enable())}},_onMouseClick:function(t){var e=this.dragging&&this.dragging.moved();(this.hasEventListeners(t.type)||e)&&s.DomEvent.stopPropagation(t),e||(this.dragging&&this.dragging._enabled||!this._map.dragging||!this._map.dragging.moved())&&this.fire(t.type,{originalEvent:t,latlng:this._latlng})},_onKeyPress:function(t){13===t.keyCode&&this.fire("click",{originalEvent:t,latlng:this._latlng})},_fireMouseEvent:function(t){this.fire(t.type,{originalEvent:t,latlng:this._latlng}),"contextmenu"===t.type&&this.hasEventListeners(t.type)&&s.DomEvent.preventDefault(t),"mousedown"!==t.type?s.DomEvent.stopPropagation(t):s.DomEvent.preventDefault(t)},setOpacity:function(t){return this.options.opacity=t,this._map&&this._updateOpacity(),this},_updateOpacity:function(){s.DomUtil.setOpacity(this._icon,this.options.opacity),this._shadow&&s.DomUtil.setOpacity(this._shadow,this.options.opacity)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)}}),s.marker=function(t,e){return new s.Marker(t,e)},s.DivIcon=s.Icon.extend({options:{iconSize:[12,12],className:"leaflet-div-icon",html:!1},createIcon:function(t){var i=t&&"DIV"===t.tagName?t:e.createElement("div"),n=this.options;return i.innerHTML=n.html!==!1?n.html:"",n.bgPos&&(i.style.backgroundPosition=-n.bgPos.x+"px "+-n.bgPos.y+"px"),this._setIconStyles(i,"icon"),i},createShadow:function(){return null}}),s.divIcon=function(t){return new s.DivIcon(t)},s.Map.mergeOptions({closePopupOnClick:!0}),s.Popup=s.Class.extend({includes:s.Mixin.Events,options:{minWidth:50,maxWidth:300,autoPan:!0,closeButton:!0,offset:[0,7],autoPanPadding:[5,5],keepInView:!1,className:"",zoomAnimation:!0},initialize:function(t,e){s.setOptions(this,t),this._source=e,this._animated=s.Browser.any3d&&this.options.zoomAnimation,this._isOpen=!1},onAdd:function(t){this._map=t,this._container||this._initLayout();var e=t.options.fadeAnimation;e&&s.DomUtil.setOpacity(this._container,0),t._panes.popupPane.appendChild(this._container),t.on(this._getEvents(),this),this.update(),e&&s.DomUtil.setOpacity(this._container,1),this.fire("open"),t.fire("popupopen",{popup:this}),this._source&&this._source.fire("popupopen",{popup:this})},addTo:function(t){return t.addLayer(this),this},openOn:function(t){return t.openPopup(this),this},onRemove:function(t){t._panes.popupPane.removeChild(this._container),s.Util.falseFn(this._container.offsetWidth),t.off(this._getEvents(),this),t.options.fadeAnimation&&s.DomUtil.setOpacity(this._container,0),this._map=null,this.fire("close"),t.fire("popupclose",{popup:this}),this._source&&this._source.fire("popupclose",{popup:this})},getLatLng:function(){return this._latlng},setLatLng:function(t){return this._latlng=s.latLng(t),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(t){return this._content=t,this.update(),this},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},_getEvents:function(){var t={viewreset:this._updatePosition};return this._animated&&(t.zoomanim=this._zoomAnimation),("closeOnClick"in this.options?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(t.preclick=this._close),this.options.keepInView&&(t.moveend=this._adjustPan),t},_close:function(){this._map&&this._map.closePopup(this)},_initLayout:function(){var t,e="leaflet-popup",i=e+" "+this.options.className+" leaflet-zoom-"+(this._animated?"animated":"hide"),n=this._container=s.DomUtil.create("div",i);this.options.closeButton&&(t=this._closeButton=s.DomUtil.create("a",e+"-close-button",n),t.href="#close",t.innerHTML="&#215;",s.DomEvent.disableClickPropagation(t),s.DomEvent.on(t,"click",this._onCloseButtonClick,this));var r=this._wrapper=s.DomUtil.create("div",e+"-content-wrapper",n);s.DomEvent.disableClickPropagation(r),this._contentNode=s.DomUtil.create("div",e+"-content",r),s.DomEvent.disableScrollPropagation(this._contentNode),s.DomEvent.on(r,"contextmenu",s.DomEvent.stopPropagation),this._tipContainer=s.DomUtil.create("div",e+"-tip-container",n),this._tip=s.DomUtil.create("div",e+"-tip",this._tipContainer)},_updateContent:function(){if(this._content){if("string"==typeof this._content)this._contentNode.innerHTML=this._content;else{for(;this._contentNode.hasChildNodes();)this._contentNode.removeChild(this._contentNode.firstChild);this._contentNode.appendChild(this._content)}this.fire("contentupdate")}},_updateLayout:function(){var t=this._contentNode,e=t.style;e.width="",e.whiteSpace="nowrap";var i=t.offsetWidth;i=Math.min(i,this.options.maxWidth),i=Math.max(i,this.options.minWidth),e.width=i+1+"px",e.whiteSpace="",e.height="";var n=t.offsetHeight,r=this.options.maxHeight,o="leaflet-popup-scrolled";r&&n>r?(e.height=r+"px",s.DomUtil.addClass(t,o)):s.DomUtil.removeClass(t,o),this._containerWidth=this._container.offsetWidth},_updatePosition:function(){if(this._map){var t=this._map.latLngToLayerPoint(this._latlng),e=this._animated,i=s.point(this.options.offset);e&&s.DomUtil.setPosition(this._container,t),this._containerBottom=-i.y-(e?0:t.y),this._containerLeft=-Math.round(this._containerWidth/2)+i.x+(e?0:t.x),this._container.style.bottom=this._containerBottom+"px",this._container.style.left=this._containerLeft+"px"}},_zoomAnimation:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center);s.DomUtil.setPosition(this._container,e)},_adjustPan:function(){if(this.options.autoPan){var t=this._map,e=this._container.offsetHeight,i=this._containerWidth,n=new s.Point(this._containerLeft,-e-this._containerBottom);this._animated&&n._add(s.DomUtil.getPosition(this._container));var r=t.layerPointToContainerPoint(n),o=s.point(this.options.autoPanPadding),a=s.point(this.options.autoPanPaddingTopLeft||o),l=s.point(this.options.autoPanPaddingBottomRight||o),h=t.getSize(),u=0,p=0;r.x+i+l.x>h.x&&(u=r.x+i-h.x+l.x),r.x-u-a.x<0&&(u=r.x-a.x),r.y+e+l.y>h.y&&(p=r.y+e-h.y+l.y),r.y-p-a.y<0&&(p=r.y-a.y),(u||p)&&t.fire("autopanstart").panBy([u,p])}},_onCloseButtonClick:function(t){this._close(),s.DomEvent.stop(t)}}),s.popup=function(t,e){return new s.Popup(t,e)},s.Map.include({openPopup:function(t,e,i){if(this.closePopup(),!(t instanceof s.Popup)){var n=t;t=new s.Popup(i).setLatLng(e).setContent(n)}return t._isOpen=!0,this._popup=t,this.addLayer(t)},closePopup:function(t){return t&&t!==this._popup||(t=this._popup,this._popup=null),t&&(this.removeLayer(t),t._isOpen=!1),this}}),s.Marker.include({openPopup:function(){return this._popup&&this._map&&!this._map.hasLayer(this._popup)&&(this._popup.setLatLng(this._latlng),this._map.openPopup(this._popup)),this},closePopup:function(){return this._popup&&this._popup._close(),this},togglePopup:function(){return this._popup&&(this._popup._isOpen?this.closePopup():this.openPopup()),this},bindPopup:function(t,e){var i=s.point(this.options.icon.options.popupAnchor||[0,0]);return i=i.add(s.Popup.prototype.options.offset),e&&e.offset&&(i=i.add(e.offset)),e=s.extend({offset:i},e),this._popupHandlersAdded||(this.on("click",this.togglePopup,this).on("remove",this.closePopup,this).on("move",this._movePopup,this),this._popupHandlersAdded=!0),t instanceof s.Popup?(s.setOptions(t,e),this._popup=t):this._popup=new s.Popup(e,this).setContent(t),this},setPopupContent:function(t){return this._popup&&this._popup.setContent(t),this},unbindPopup:function(){return this._popup&&(this._popup=null,this.off("click",this.togglePopup,this).off("remove",this.closePopup,this).off("move",this._movePopup,this),this._popupHandlersAdded=!1),this},getPopup:function(){return this._popup},_movePopup:function(t){this._popup.setLatLng(t.latlng)}}),s.LayerGroup=s.Class.extend({initialize:function(t){this._layers={};var e,i;if(t)for(e=0,i=t.length;i>e;e++)this.addLayer(t[e])},addLayer:function(t){var e=this.getLayerId(t);return this._layers[e]=t,this._map&&this._map.addLayer(t),this},removeLayer:function(t){var e=t in this._layers?t:this.getLayerId(t);return this._map&&this._layers[e]&&this._map.removeLayer(this._layers[e]),delete this._layers[e],this},hasLayer:function(t){return t?t in this._layers||this.getLayerId(t)in this._layers:!1},clearLayers:function(){return this.eachLayer(this.removeLayer,this),this},invoke:function(t){var e,i,n=Array.prototype.slice.call(arguments,1);for(e in this._layers)i=this._layers[e],i[t]&&i[t].apply(i,n);return this},onAdd:function(t){this._map=t,this.eachLayer(t.addLayer,t)},onRemove:function(t){this.eachLayer(t.removeLayer,t),this._map=null},addTo:function(t){return t.addLayer(this),this},eachLayer:function(t,e){for(var i in this._layers)t.call(e,this._layers[i]);return this},getLayer:function(t){return this._layers[t]},getLayers:function(){var t=[];for(var e in this._layers)t.push(this._layers[e]);return t},setZIndex:function(t){return this.invoke("setZIndex",t)},getLayerId:function(t){return s.stamp(t)}}),s.layerGroup=function(t){return new s.LayerGroup(t)},s.FeatureGroup=s.LayerGroup.extend({includes:s.Mixin.Events,statics:{EVENTS:"click dblclick mouseover mouseout mousemove contextmenu popupopen popupclose"},addLayer:function(t){return this.hasLayer(t)?this:("on"in t&&t.on(s.FeatureGroup.EVENTS,this._propagateEvent,this),s.LayerGroup.prototype.addLayer.call(this,t),this._popupContent&&t.bindPopup&&t.bindPopup(this._popupContent,this._popupOptions),this.fire("layeradd",{layer:t}))},removeLayer:function(t){return this.hasLayer(t)?(t in this._layers&&(t=this._layers[t]),t.off(s.FeatureGroup.EVENTS,this._propagateEvent,this),s.LayerGroup.prototype.removeLayer.call(this,t),this._popupContent&&this.invoke("unbindPopup"),this.fire("layerremove",{layer:t})):this},bindPopup:function(t,e){return this._popupContent=t,this._popupOptions=e,this.invoke("bindPopup",t,e)},openPopup:function(t){for(var e in this._layers){this._layers[e].openPopup(t);break}return this},setStyle:function(t){return this.invoke("setStyle",t)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var t=new s.LatLngBounds;return this.eachLayer(function(e){t.extend(e instanceof s.Marker?e.getLatLng():e.getBounds())}),t},_propagateEvent:function(t){t=s.extend({layer:t.target,target:this},t),this.fire(t.type,t)}}),s.featureGroup=function(t){return new s.FeatureGroup(t)},s.Path=s.Class.extend({includes:[s.Mixin.Events],statics:{CLIP_PADDING:function(){var e=s.Browser.mobile?1280:2e3,i=(e/Math.max(t.outerWidth,t.outerHeight)-1)/2;return Math.max(0,Math.min(.5,i))}()},options:{stroke:!0,color:"#0033ff",dashArray:null,lineCap:null,lineJoin:null,weight:5,opacity:.5,fill:!1,fillColor:null,fillOpacity:.2,clickable:!0},initialize:function(t){s.setOptions(this,t)},onAdd:function(t){this._map=t,this._container||(this._initElements(),this._initEvents()),this.projectLatlngs(),this._updatePath(),this._container&&this._map._pathRoot.appendChild(this._container),this.fire("add"),t.on({viewreset:this.projectLatlngs,moveend:this._updatePath},this)},addTo:function(t){return t.addLayer(this),this},onRemove:function(t){t._pathRoot.removeChild(this._container),this.fire("remove"),this._map=null,s.Browser.vml&&(this._container=null,this._stroke=null,this._fill=null),t.off({viewreset:this.projectLatlngs,moveend:this._updatePath},this)},projectLatlngs:function(){},setStyle:function(t){return s.setOptions(this,t),this._container&&this._updateStyle(),this},redraw:function(){return this._map&&(this.projectLatlngs(),this._updatePath()),this}}),s.Map.include({_updatePathViewport:function(){var t=s.Path.CLIP_PADDING,e=this.getSize(),i=s.DomUtil.getPosition(this._mapPane),n=i.multiplyBy(-1)._subtract(e.multiplyBy(t)._round()),r=n.add(e.multiplyBy(1+2*t)._round());this._pathViewport=new s.Bounds(n,r)}}),s.Path.SVG_NS="http://www.w3.org/2000/svg",s.Browser.svg=!(!e.createElementNS||!e.createElementNS(s.Path.SVG_NS,"svg").createSVGRect),s.Path=s.Path.extend({statics:{SVG:s.Browser.svg},bringToFront:function(){var t=this._map._pathRoot,e=this._container;return e&&t.lastChild!==e&&t.appendChild(e),this},bringToBack:function(){var t=this._map._pathRoot,e=this._container,i=t.firstChild;return e&&i!==e&&t.insertBefore(e,i),this},getPathString:function(){},_createElement:function(t){return e.createElementNS(s.Path.SVG_NS,t)},_initElements:function(){this._map._initPathRoot(),this._initPath(),this._initStyle()},_initPath:function(){this._container=this._createElement("g"),this._path=this._createElement("path"),this.options.className&&s.DomUtil.addClass(this._path,this.options.className),this._container.appendChild(this._path)},_initStyle:function(){this.options.stroke&&(this._path.setAttribute("stroke-linejoin","round"),this._path.setAttribute("stroke-linecap","round")),this.options.fill&&this._path.setAttribute("fill-rule","evenodd"),this.options.pointerEvents&&this._path.setAttribute("pointer-events",this.options.pointerEvents),this.options.clickable||this.options.pointerEvents||this._path.setAttribute("pointer-events","none"),this._updateStyle()},_updateStyle:function(){this.options.stroke?(this._path.setAttribute("stroke",this.options.color),this._path.setAttribute("stroke-opacity",this.options.opacity),this._path.setAttribute("stroke-width",this.options.weight),this.options.dashArray?this._path.setAttribute("stroke-dasharray",this.options.dashArray):this._path.removeAttribute("stroke-dasharray"),this.options.lineCap&&this._path.setAttribute("stroke-linecap",this.options.lineCap),this.options.lineJoin&&this._path.setAttribute("stroke-linejoin",this.options.lineJoin)):this._path.setAttribute("stroke","none"),this.options.fill?(this._path.setAttribute("fill",this.options.fillColor||this.options.color),this._path.setAttribute("fill-opacity",this.options.fillOpacity)):this._path.setAttribute("fill","none")
},_updatePath:function(){var t=this.getPathString();t||(t="M0 0"),this._path.setAttribute("d",t)},_initEvents:function(){if(this.options.clickable){(s.Browser.svg||!s.Browser.vml)&&s.DomUtil.addClass(this._path,"leaflet-clickable"),s.DomEvent.on(this._container,"click",this._onMouseClick,this);for(var t=["dblclick","mousedown","mouseover","mouseout","mousemove","contextmenu"],e=0;e<t.length;e++)s.DomEvent.on(this._container,t[e],this._fireMouseEvent,this)}},_onMouseClick:function(t){this._map.dragging&&this._map.dragging.moved()||this._fireMouseEvent(t)},_fireMouseEvent:function(t){if(this.hasEventListeners(t.type)){var e=this._map,i=e.mouseEventToContainerPoint(t),n=e.containerPointToLayerPoint(i),r=e.layerPointToLatLng(n);this.fire(t.type,{latlng:r,layerPoint:n,containerPoint:i,originalEvent:t}),"contextmenu"===t.type&&s.DomEvent.preventDefault(t),"mousemove"!==t.type&&s.DomEvent.stopPropagation(t)}}}),s.Map.include({_initPathRoot:function(){this._pathRoot||(this._pathRoot=s.Path.prototype._createElement("svg"),this._panes.overlayPane.appendChild(this._pathRoot),this.options.zoomAnimation&&s.Browser.any3d?(s.DomUtil.addClass(this._pathRoot,"leaflet-zoom-animated"),this.on({zoomanim:this._animatePathZoom,zoomend:this._endPathZoom})):s.DomUtil.addClass(this._pathRoot,"leaflet-zoom-hide"),this.on("moveend",this._updateSvgViewport),this._updateSvgViewport())},_animatePathZoom:function(t){var e=this.getZoomScale(t.zoom),i=this._getCenterOffset(t.center)._multiplyBy(-e)._add(this._pathViewport.min);this._pathRoot.style[s.DomUtil.TRANSFORM]=s.DomUtil.getTranslateString(i)+" scale("+e+") ",this._pathZooming=!0},_endPathZoom:function(){this._pathZooming=!1},_updateSvgViewport:function(){if(!this._pathZooming){this._updatePathViewport();var t=this._pathViewport,e=t.min,i=t.max,n=i.x-e.x,r=i.y-e.y,o=this._pathRoot,a=this._panes.overlayPane;s.Browser.mobileWebkit&&a.removeChild(o),s.DomUtil.setPosition(o,e),o.setAttribute("width",n),o.setAttribute("height",r),o.setAttribute("viewBox",[e.x,e.y,n,r].join(" ")),s.Browser.mobileWebkit&&a.appendChild(o)}}}),s.Path.include({bindPopup:function(t,e){return t instanceof s.Popup?this._popup=t:((!this._popup||e)&&(this._popup=new s.Popup(e,this)),this._popup.setContent(t)),this._popupHandlersAdded||(this.on("click",this._openPopup,this).on("remove",this.closePopup,this),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this._popup=null,this.off("click",this._openPopup).off("remove",this.closePopup),this._popupHandlersAdded=!1),this},openPopup:function(t){return this._popup&&(t=t||this._latlng||this._latlngs[Math.floor(this._latlngs.length/2)],this._openPopup({latlng:t})),this},closePopup:function(){return this._popup&&this._popup._close(),this},_openPopup:function(t){this._popup.setLatLng(t.latlng),this._map.openPopup(this._popup)}}),s.Browser.vml=!s.Browser.svg&&function(){try{var t=e.createElement("div");t.innerHTML='<v:shape adj="1"/>';var i=t.firstChild;return i.style.behavior="url(#default#VML)",i&&"object"==typeof i.adj}catch(n){return!1}}(),s.Path=s.Browser.svg||!s.Browser.vml?s.Path:s.Path.extend({statics:{VML:!0,CLIP_PADDING:.02},_createElement:function(){try{return e.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(t){return e.createElement("<lvml:"+t+' class="lvml">')}}catch(t){return function(t){return e.createElement("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}}(),_initPath:function(){var t=this._container=this._createElement("shape");s.DomUtil.addClass(t,"leaflet-vml-shape"+(this.options.className?" "+this.options.className:"")),this.options.clickable&&s.DomUtil.addClass(t,"leaflet-clickable"),t.coordsize="1 1",this._path=this._createElement("path"),t.appendChild(this._path),this._map._pathRoot.appendChild(t)},_initStyle:function(){this._updateStyle()},_updateStyle:function(){var t=this._stroke,e=this._fill,i=this.options,n=this._container;n.stroked=i.stroke,n.filled=i.fill,i.stroke?(t||(t=this._stroke=this._createElement("stroke"),t.endcap="round",n.appendChild(t)),t.weight=i.weight+"px",t.color=i.color,t.opacity=i.opacity,t.dashStyle=i.dashArray?s.Util.isArray(i.dashArray)?i.dashArray.join(" "):i.dashArray.replace(/( *, *)/g," "):"",i.lineCap&&(t.endcap=i.lineCap.replace("butt","flat")),i.lineJoin&&(t.joinstyle=i.lineJoin)):t&&(n.removeChild(t),this._stroke=null),i.fill?(e||(e=this._fill=this._createElement("fill"),n.appendChild(e)),e.color=i.fillColor||i.color,e.opacity=i.fillOpacity):e&&(n.removeChild(e),this._fill=null)},_updatePath:function(){var t=this._container.style;t.display="none",this._path.v=this.getPathString()+" ",t.display=""}}),s.Map.include(s.Browser.svg||!s.Browser.vml?{}:{_initPathRoot:function(){if(!this._pathRoot){var t=this._pathRoot=e.createElement("div");t.className="leaflet-vml-container",this._panes.overlayPane.appendChild(t),this.on("moveend",this._updatePathViewport),this._updatePathViewport()}}}),s.Browser.canvas=function(){return!!e.createElement("canvas").getContext}(),s.Path=s.Path.SVG&&!t.L_PREFER_CANVAS||!s.Browser.canvas?s.Path:s.Path.extend({statics:{CANVAS:!0,SVG:!1},redraw:function(){return this._map&&(this.projectLatlngs(),this._requestUpdate()),this},setStyle:function(t){return s.setOptions(this,t),this._map&&(this._updateStyle(),this._requestUpdate()),this},onRemove:function(t){t.off("viewreset",this.projectLatlngs,this).off("moveend",this._updatePath,this),this.options.clickable&&(this._map.off("click",this._onClick,this),this._map.off("mousemove",this._onMouseMove,this)),this._requestUpdate(),this.fire("remove"),this._map=null},_requestUpdate:function(){this._map&&!s.Path._updateRequest&&(s.Path._updateRequest=s.Util.requestAnimFrame(this._fireMapMoveEnd,this._map))},_fireMapMoveEnd:function(){s.Path._updateRequest=null,this.fire("moveend")},_initElements:function(){this._map._initPathRoot(),this._ctx=this._map._canvasCtx},_updateStyle:function(){var t=this.options;t.stroke&&(this._ctx.lineWidth=t.weight,this._ctx.strokeStyle=t.color),t.fill&&(this._ctx.fillStyle=t.fillColor||t.color)},_drawPath:function(){var t,e,i,n,r,o;for(this._ctx.beginPath(),t=0,i=this._parts.length;i>t;t++){for(e=0,n=this._parts[t].length;n>e;e++)r=this._parts[t][e],o=(0===e?"move":"line")+"To",this._ctx[o](r.x,r.y);this instanceof s.Polygon&&this._ctx.closePath()}},_checkIfEmpty:function(){return!this._parts.length},_updatePath:function(){if(!this._checkIfEmpty()){var t=this._ctx,e=this.options;this._drawPath(),t.save(),this._updateStyle(),e.fill&&(t.globalAlpha=e.fillOpacity,t.fill()),e.stroke&&(t.globalAlpha=e.opacity,t.stroke()),t.restore()}},_initEvents:function(){this.options.clickable&&(this._map.on("mousemove",this._onMouseMove,this),this._map.on("click",this._onClick,this))},_onClick:function(t){this._containsPoint(t.layerPoint)&&this.fire("click",t)},_onMouseMove:function(t){this._map&&!this._map._animatingZoom&&(this._containsPoint(t.layerPoint)?(this._ctx.canvas.style.cursor="pointer",this._mouseInside=!0,this.fire("mouseover",t)):this._mouseInside&&(this._ctx.canvas.style.cursor="",this._mouseInside=!1,this.fire("mouseout",t)))}}),s.Map.include(s.Path.SVG&&!t.L_PREFER_CANVAS||!s.Browser.canvas?{}:{_initPathRoot:function(){var t,i=this._pathRoot;i||(i=this._pathRoot=e.createElement("canvas"),i.style.position="absolute",t=this._canvasCtx=i.getContext("2d"),t.lineCap="round",t.lineJoin="round",this._panes.overlayPane.appendChild(i),this.options.zoomAnimation&&(this._pathRoot.className="leaflet-zoom-animated",this.on("zoomanim",this._animatePathZoom),this.on("zoomend",this._endPathZoom)),this.on("moveend",this._updateCanvasViewport),this._updateCanvasViewport())},_updateCanvasViewport:function(){if(!this._pathZooming){this._updatePathViewport();var t=this._pathViewport,e=t.min,i=t.max.subtract(e),n=this._pathRoot;s.DomUtil.setPosition(n,e),n.width=i.x,n.height=i.y,n.getContext("2d").translate(-e.x,-e.y)}}}),s.LineUtil={simplify:function(t,e){if(!e||!t.length)return t.slice();var i=e*e;return t=this._reducePoints(t,i),t=this._simplifyDP(t,i)},pointToSegmentDistance:function(t,e,i){return Math.sqrt(this._sqClosestPointOnSegment(t,e,i,!0))},closestPointOnSegment:function(t,e,i){return this._sqClosestPointOnSegment(t,e,i)},_simplifyDP:function(t,e){var n=t.length,s=typeof Uint8Array!=i+""?Uint8Array:Array,r=new s(n);r[0]=r[n-1]=1,this._simplifyDPStep(t,r,e,0,n-1);var o,a=[];for(o=0;n>o;o++)r[o]&&a.push(t[o]);return a},_simplifyDPStep:function(t,e,i,n,s){var r,o,a,l=0;for(o=n+1;s-1>=o;o++)a=this._sqClosestPointOnSegment(t[o],t[n],t[s],!0),a>l&&(r=o,l=a);l>i&&(e[r]=1,this._simplifyDPStep(t,e,i,n,r),this._simplifyDPStep(t,e,i,r,s))},_reducePoints:function(t,e){for(var i=[t[0]],n=1,s=0,r=t.length;r>n;n++)this._sqDist(t[n],t[s])>e&&(i.push(t[n]),s=n);return r-1>s&&i.push(t[r-1]),i},clipSegment:function(t,e,i,n){var s,r,o,a=n?this._lastCode:this._getBitCode(t,i),l=this._getBitCode(e,i);for(this._lastCode=l;;){if(!(a|l))return[t,e];if(a&l)return!1;s=a||l,r=this._getEdgeIntersection(t,e,s,i),o=this._getBitCode(r,i),s===a?(t=r,a=o):(e=r,l=o)}},_getEdgeIntersection:function(t,e,i,n){var r=e.x-t.x,o=e.y-t.y,a=n.min,l=n.max;return 8&i?new s.Point(t.x+r*(l.y-t.y)/o,l.y):4&i?new s.Point(t.x+r*(a.y-t.y)/o,a.y):2&i?new s.Point(l.x,t.y+o*(l.x-t.x)/r):1&i?new s.Point(a.x,t.y+o*(a.x-t.x)/r):void 0},_getBitCode:function(t,e){var i=0;return t.x<e.min.x?i|=1:t.x>e.max.x&&(i|=2),t.y<e.min.y?i|=4:t.y>e.max.y&&(i|=8),i},_sqDist:function(t,e){var i=e.x-t.x,n=e.y-t.y;return i*i+n*n},_sqClosestPointOnSegment:function(t,e,i,n){var r,o=e.x,a=e.y,l=i.x-o,h=i.y-a,u=l*l+h*h;return u>0&&(r=((t.x-o)*l+(t.y-a)*h)/u,r>1?(o=i.x,a=i.y):r>0&&(o+=l*r,a+=h*r)),l=t.x-o,h=t.y-a,n?l*l+h*h:new s.Point(o,a)}},s.Polyline=s.Path.extend({initialize:function(t,e){s.Path.prototype.initialize.call(this,e),this._latlngs=this._convertLatLngs(t)},options:{smoothFactor:1,noClip:!1},projectLatlngs:function(){this._originalPoints=[];for(var t=0,e=this._latlngs.length;e>t;t++)this._originalPoints[t]=this._map.latLngToLayerPoint(this._latlngs[t])},getPathString:function(){for(var t=0,e=this._parts.length,i="";e>t;t++)i+=this._getPathPartStr(this._parts[t]);return i},getLatLngs:function(){return this._latlngs},setLatLngs:function(t){return this._latlngs=this._convertLatLngs(t),this.redraw()},addLatLng:function(t){return this._latlngs.push(s.latLng(t)),this.redraw()},spliceLatLngs:function(){var t=[].splice.apply(this._latlngs,arguments);return this._convertLatLngs(this._latlngs,!0),this.redraw(),t},closestLayerPoint:function(t){for(var e,i,n=1/0,r=this._parts,o=null,a=0,l=r.length;l>a;a++)for(var h=r[a],u=1,p=h.length;p>u;u++){e=h[u-1],i=h[u];var c=s.LineUtil._sqClosestPointOnSegment(t,e,i,!0);n>c&&(n=c,o=s.LineUtil._sqClosestPointOnSegment(t,e,i))}return o&&(o.distance=Math.sqrt(n)),o},getBounds:function(){return new s.LatLngBounds(this.getLatLngs())},_convertLatLngs:function(t,e){var i,n,r=e?t:[];for(i=0,n=t.length;n>i;i++){if(s.Util.isArray(t[i])&&"number"!=typeof t[i][0])return;r[i]=s.latLng(t[i])}return r},_initEvents:function(){s.Path.prototype._initEvents.call(this)},_getPathPartStr:function(t){for(var e,i=s.Path.VML,n=0,r=t.length,o="";r>n;n++)e=t[n],i&&e._round(),o+=(n?"L":"M")+e.x+" "+e.y;return o},_clipPoints:function(){var t,e,i,n=this._originalPoints,r=n.length;if(this.options.noClip)return void(this._parts=[n]);this._parts=[];var o=this._parts,a=this._map._pathViewport,l=s.LineUtil;for(t=0,e=0;r-1>t;t++)i=l.clipSegment(n[t],n[t+1],a,t),i&&(o[e]=o[e]||[],o[e].push(i[0]),(i[1]!==n[t+1]||t===r-2)&&(o[e].push(i[1]),e++))},_simplifyPoints:function(){for(var t=this._parts,e=s.LineUtil,i=0,n=t.length;n>i;i++)t[i]=e.simplify(t[i],this.options.smoothFactor)},_updatePath:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),s.Path.prototype._updatePath.call(this))}}),s.polyline=function(t,e){return new s.Polyline(t,e)},s.PolyUtil={},s.PolyUtil.clipPolygon=function(t,e){var i,n,r,o,a,l,h,u,p,c=[1,4,2,8],d=s.LineUtil;for(n=0,h=t.length;h>n;n++)t[n]._code=d._getBitCode(t[n],e);for(o=0;4>o;o++){for(u=c[o],i=[],n=0,h=t.length,r=h-1;h>n;r=n++)a=t[n],l=t[r],a._code&u?l._code&u||(p=d._getEdgeIntersection(l,a,u,e),p._code=d._getBitCode(p,e),i.push(p)):(l._code&u&&(p=d._getEdgeIntersection(l,a,u,e),p._code=d._getBitCode(p,e),i.push(p)),i.push(a));t=i}return t},s.Polygon=s.Polyline.extend({options:{fill:!0},initialize:function(t,e){s.Polyline.prototype.initialize.call(this,t,e),this._initWithHoles(t)},_initWithHoles:function(t){var e,i,n;if(t&&s.Util.isArray(t[0])&&"number"!=typeof t[0][0])for(this._latlngs=this._convertLatLngs(t[0]),this._holes=t.slice(1),e=0,i=this._holes.length;i>e;e++)n=this._holes[e]=this._convertLatLngs(this._holes[e]),n[0].equals(n[n.length-1])&&n.pop();t=this._latlngs,t.length>=2&&t[0].equals(t[t.length-1])&&t.pop()},projectLatlngs:function(){if(s.Polyline.prototype.projectLatlngs.call(this),this._holePoints=[],this._holes){var t,e,i,n;for(t=0,i=this._holes.length;i>t;t++)for(this._holePoints[t]=[],e=0,n=this._holes[t].length;n>e;e++)this._holePoints[t][e]=this._map.latLngToLayerPoint(this._holes[t][e])}},setLatLngs:function(t){return t&&s.Util.isArray(t[0])&&"number"!=typeof t[0][0]?(this._initWithHoles(t),this.redraw()):s.Polyline.prototype.setLatLngs.call(this,t)},_clipPoints:function(){var t=this._originalPoints,e=[];if(this._parts=[t].concat(this._holePoints),!this.options.noClip){for(var i=0,n=this._parts.length;n>i;i++){var r=s.PolyUtil.clipPolygon(this._parts[i],this._map._pathViewport);r.length&&e.push(r)}this._parts=e}},_getPathPartStr:function(t){var e=s.Polyline.prototype._getPathPartStr.call(this,t);return e+(s.Browser.svg?"z":"x")}}),s.polygon=function(t,e){return new s.Polygon(t,e)},function(){function t(t){return s.FeatureGroup.extend({initialize:function(t,e){this._layers={},this._options=e,this.setLatLngs(t)},setLatLngs:function(e){var i=0,n=e.length;for(this.eachLayer(function(t){n>i?t.setLatLngs(e[i++]):this.removeLayer(t)},this);n>i;)this.addLayer(new t(e[i++],this._options));return this},getLatLngs:function(){var t=[];return this.eachLayer(function(e){t.push(e.getLatLngs())}),t}})}s.MultiPolyline=t(s.Polyline),s.MultiPolygon=t(s.Polygon),s.multiPolyline=function(t,e){return new s.MultiPolyline(t,e)},s.multiPolygon=function(t,e){return new s.MultiPolygon(t,e)}}(),s.Rectangle=s.Polygon.extend({initialize:function(t,e){s.Polygon.prototype.initialize.call(this,this._boundsToLatLngs(t),e)},setBounds:function(t){this.setLatLngs(this._boundsToLatLngs(t))},_boundsToLatLngs:function(t){return t=s.latLngBounds(t),[t.getSouthWest(),t.getNorthWest(),t.getNorthEast(),t.getSouthEast()]}}),s.rectangle=function(t,e){return new s.Rectangle(t,e)},s.Circle=s.Path.extend({initialize:function(t,e,i){s.Path.prototype.initialize.call(this,i),this._latlng=s.latLng(t),this._mRadius=e},options:{fill:!0},setLatLng:function(t){return this._latlng=s.latLng(t),this.redraw()},setRadius:function(t){return this._mRadius=t,this.redraw()},projectLatlngs:function(){var t=this._getLngRadius(),e=this._latlng,i=this._map.latLngToLayerPoint([e.lat,e.lng-t]);this._point=this._map.latLngToLayerPoint(e),this._radius=Math.max(this._point.x-i.x,1)},getBounds:function(){var t=this._getLngRadius(),e=this._mRadius/40075017*360,i=this._latlng;return new s.LatLngBounds([i.lat-e,i.lng-t],[i.lat+e,i.lng+t])},getLatLng:function(){return this._latlng},getPathString:function(){var t=this._point,e=this._radius;return this._checkIfEmpty()?"":s.Browser.svg?"M"+t.x+","+(t.y-e)+"A"+e+","+e+",0,1,1,"+(t.x-.1)+","+(t.y-e)+" z":(t._round(),e=Math.round(e),"AL "+t.x+","+t.y+" "+e+","+e+" 0,23592600")},getRadius:function(){return this._mRadius},_getLatRadius:function(){return this._mRadius/40075017*360},_getLngRadius:function(){return this._getLatRadius()/Math.cos(s.LatLng.DEG_TO_RAD*this._latlng.lat)},_checkIfEmpty:function(){if(!this._map)return!1;var t=this._map._pathViewport,e=this._radius,i=this._point;return i.x-e>t.max.x||i.y-e>t.max.y||i.x+e<t.min.x||i.y+e<t.min.y}}),s.circle=function(t,e,i){return new s.Circle(t,e,i)},s.CircleMarker=s.Circle.extend({options:{radius:10,weight:2},initialize:function(t,e){s.Circle.prototype.initialize.call(this,t,null,e),this._radius=this.options.radius},projectLatlngs:function(){this._point=this._map.latLngToLayerPoint(this._latlng)},_updateStyle:function(){s.Circle.prototype._updateStyle.call(this),this.setRadius(this.options.radius)},setLatLng:function(t){return s.Circle.prototype.setLatLng.call(this,t),this._popup&&this._popup._isOpen&&this._popup.setLatLng(t),this},setRadius:function(t){return this.options.radius=this._radius=t,this.redraw()},getRadius:function(){return this._radius}}),s.circleMarker=function(t,e){return new s.CircleMarker(t,e)},s.Polyline.include(s.Path.CANVAS?{_containsPoint:function(t,e){var i,n,r,o,a,l,h,u=this.options.weight/2;for(s.Browser.touch&&(u+=10),i=0,o=this._parts.length;o>i;i++)for(h=this._parts[i],n=0,a=h.length,r=a-1;a>n;r=n++)if((e||0!==n)&&(l=s.LineUtil.pointToSegmentDistance(t,h[r],h[n]),u>=l))return!0;return!1}}:{}),s.Polygon.include(s.Path.CANVAS?{_containsPoint:function(t){var e,i,n,r,o,a,l,h,u=!1;if(s.Polyline.prototype._containsPoint.call(this,t,!0))return!0;for(r=0,l=this._parts.length;l>r;r++)for(e=this._parts[r],o=0,h=e.length,a=h-1;h>o;a=o++)i=e[o],n=e[a],i.y>t.y!=n.y>t.y&&t.x<(n.x-i.x)*(t.y-i.y)/(n.y-i.y)+i.x&&(u=!u);return u}}:{}),s.Circle.include(s.Path.CANVAS?{_drawPath:function(){var t=this._point;this._ctx.beginPath(),this._ctx.arc(t.x,t.y,this._radius,0,2*Math.PI,!1)},_containsPoint:function(t){var e=this._point,i=this.options.stroke?this.options.weight/2:0;return t.distanceTo(e)<=this._radius+i}}:{}),s.CircleMarker.include(s.Path.CANVAS?{_updateStyle:function(){s.Path.prototype._updateStyle.call(this)}}:{}),s.GeoJSON=s.FeatureGroup.extend({initialize:function(t,e){s.setOptions(this,e),this._layers={},t&&this.addData(t)},addData:function(t){var e,i,n,r=s.Util.isArray(t)?t:t.features;if(r){for(e=0,i=r.length;i>e;e++)n=r[e],(n.geometries||n.geometry||n.features||n.coordinates)&&this.addData(r[e]);return this}var o=this.options;if(!o.filter||o.filter(t)){var a=s.GeoJSON.geometryToLayer(t,o.pointToLayer,o.coordsToLatLng,o);return a.feature=s.GeoJSON.asFeature(t),a.defaultOptions=a.options,this.resetStyle(a),o.onEachFeature&&o.onEachFeature(t,a),this.addLayer(a)}},resetStyle:function(t){var e=this.options.style;e&&(s.Util.extend(t.options,t.defaultOptions),this._setLayerStyle(t,e))},setStyle:function(t){this.eachLayer(function(e){this._setLayerStyle(e,t)},this)},_setLayerStyle:function(t,e){"function"==typeof e&&(e=e(t.feature)),t.setStyle&&t.setStyle(e)}}),s.extend(s.GeoJSON,{geometryToLayer:function(t,e,i,n){var r,o,a,l,h="Feature"===t.type?t.geometry:t,u=h.coordinates,p=[];switch(i=i||this.coordsToLatLng,h.type){case"Point":return r=i(u),e?e(t,r):new s.Marker(r);case"MultiPoint":for(a=0,l=u.length;l>a;a++)r=i(u[a]),p.push(e?e(t,r):new s.Marker(r));return new s.FeatureGroup(p);case"LineString":return o=this.coordsToLatLngs(u,0,i),new s.Polyline(o,n);case"Polygon":if(2===u.length&&!u[1].length)throw new Error("Invalid GeoJSON object.");return o=this.coordsToLatLngs(u,1,i),new s.Polygon(o,n);case"MultiLineString":return o=this.coordsToLatLngs(u,1,i),new s.MultiPolyline(o,n);case"MultiPolygon":return o=this.coordsToLatLngs(u,2,i),new s.MultiPolygon(o,n);case"GeometryCollection":for(a=0,l=h.geometries.length;l>a;a++)p.push(this.geometryToLayer({geometry:h.geometries[a],type:"Feature",properties:t.properties},e,i,n));return new s.FeatureGroup(p);default:throw new Error("Invalid GeoJSON object.")}},coordsToLatLng:function(t){return new s.LatLng(t[1],t[0],t[2])},coordsToLatLngs:function(t,e,i){var n,s,r,o=[];for(s=0,r=t.length;r>s;s++)n=e?this.coordsToLatLngs(t[s],e-1,i):(i||this.coordsToLatLng)(t[s]),o.push(n);return o},latLngToCoords:function(t){var e=[t.lng,t.lat];return t.alt!==i&&e.push(t.alt),e},latLngsToCoords:function(t){for(var e=[],i=0,n=t.length;n>i;i++)e.push(s.GeoJSON.latLngToCoords(t[i]));return e},getFeature:function(t,e){return t.feature?s.extend({},t.feature,{geometry:e}):s.GeoJSON.asFeature(e)},asFeature:function(t){return"Feature"===t.type?t:{type:"Feature",properties:{},geometry:t}}});var o={toGeoJSON:function(){return s.GeoJSON.getFeature(this,{type:"Point",coordinates:s.GeoJSON.latLngToCoords(this.getLatLng())})}};s.Marker.include(o),s.Circle.include(o),s.CircleMarker.include(o),s.Polyline.include({toGeoJSON:function(){return s.GeoJSON.getFeature(this,{type:"LineString",coordinates:s.GeoJSON.latLngsToCoords(this.getLatLngs())})}}),s.Polygon.include({toGeoJSON:function(){var t,e,i,n=[s.GeoJSON.latLngsToCoords(this.getLatLngs())];if(n[0].push(n[0][0]),this._holes)for(t=0,e=this._holes.length;e>t;t++)i=s.GeoJSON.latLngsToCoords(this._holes[t]),i.push(i[0]),n.push(i);return s.GeoJSON.getFeature(this,{type:"Polygon",coordinates:n})}}),function(){function t(t){return function(){var e=[];return this.eachLayer(function(t){e.push(t.toGeoJSON().geometry.coordinates)}),s.GeoJSON.getFeature(this,{type:t,coordinates:e})}}s.MultiPolyline.include({toGeoJSON:t("MultiLineString")}),s.MultiPolygon.include({toGeoJSON:t("MultiPolygon")}),s.LayerGroup.include({toGeoJSON:function(){var e,i=this.feature&&this.feature.geometry,n=[];if(i&&"MultiPoint"===i.type)return t("MultiPoint").call(this);var r=i&&"GeometryCollection"===i.type;return this.eachLayer(function(t){t.toGeoJSON&&(e=t.toGeoJSON(),n.push(r?e.geometry:s.GeoJSON.asFeature(e)))}),r?s.GeoJSON.getFeature(this,{geometries:n,type:"GeometryCollection"}):{type:"FeatureCollection",features:n}}})}(),s.geoJson=function(t,e){return new s.GeoJSON(t,e)},s.DomEvent={addListener:function(t,e,i,n){var r,o,a,l=s.stamp(i),h="_leaflet_"+e+l;return t[h]?this:(r=function(e){return i.call(n||t,e||s.DomEvent._getEvent())},s.Browser.pointer&&0===e.indexOf("touch")?this.addPointerListener(t,e,r,l):(s.Browser.touch&&"dblclick"===e&&this.addDoubleTapListener&&this.addDoubleTapListener(t,r,l),"addEventListener"in t?"mousewheel"===e?(t.addEventListener("DOMMouseScroll",r,!1),t.addEventListener(e,r,!1)):"mouseenter"===e||"mouseleave"===e?(o=r,a="mouseenter"===e?"mouseover":"mouseout",r=function(e){return s.DomEvent._checkMouse(t,e)?o(e):void 0},t.addEventListener(a,r,!1)):"click"===e&&s.Browser.android?(o=r,r=function(t){return s.DomEvent._filterClick(t,o)},t.addEventListener(e,r,!1)):t.addEventListener(e,r,!1):"attachEvent"in t&&t.attachEvent("on"+e,r),t[h]=r,this))},removeListener:function(t,e,i){var n=s.stamp(i),r="_leaflet_"+e+n,o=t[r];return o?(s.Browser.pointer&&0===e.indexOf("touch")?this.removePointerListener(t,e,n):s.Browser.touch&&"dblclick"===e&&this.removeDoubleTapListener?this.removeDoubleTapListener(t,n):"removeEventListener"in t?"mousewheel"===e?(t.removeEventListener("DOMMouseScroll",o,!1),t.removeEventListener(e,o,!1)):"mouseenter"===e||"mouseleave"===e?t.removeEventListener("mouseenter"===e?"mouseover":"mouseout",o,!1):t.removeEventListener(e,o,!1):"detachEvent"in t&&t.detachEvent("on"+e,o),t[r]=null,this):this},stopPropagation:function(t){return t.stopPropagation?t.stopPropagation():t.cancelBubble=!0,s.DomEvent._skipped(t),this},disableScrollPropagation:function(t){var e=s.DomEvent.stopPropagation;return s.DomEvent.on(t,"mousewheel",e).on(t,"MozMousePixelScroll",e)},disableClickPropagation:function(t){for(var e=s.DomEvent.stopPropagation,i=s.Draggable.START.length-1;i>=0;i--)s.DomEvent.on(t,s.Draggable.START[i],e);return s.DomEvent.on(t,"click",s.DomEvent._fakeStop).on(t,"dblclick",e)},preventDefault:function(t){return t.preventDefault?t.preventDefault():t.returnValue=!1,this},stop:function(t){return s.DomEvent.preventDefault(t).stopPropagation(t)},getMousePosition:function(t,e){if(!e)return new s.Point(t.clientX,t.clientY);var i=e.getBoundingClientRect();return new s.Point(t.clientX-i.left-e.clientLeft,t.clientY-i.top-e.clientTop)},getWheelDelta:function(t){var e=0;return t.wheelDelta&&(e=t.wheelDelta/120),t.detail&&(e=-t.detail/3),e},_skipEvents:{},_fakeStop:function(t){s.DomEvent._skipEvents[t.type]=!0},_skipped:function(t){var e=this._skipEvents[t.type];return this._skipEvents[t.type]=!1,e},_checkMouse:function(t,e){var i=e.relatedTarget;if(!i)return!0;try{for(;i&&i!==t;)i=i.parentNode}catch(n){return!1}return i!==t},_getEvent:function(){var e=t.event;if(!e)for(var i=arguments.callee.caller;i&&(e=i.arguments[0],!e||t.Event!==e.constructor);)i=i.caller;return e},_filterClick:function(t,e){var i=t.timeStamp||t.originalEvent.timeStamp,n=s.DomEvent._lastClick&&i-s.DomEvent._lastClick;return n&&n>100&&500>n||t.target._simulatedClick&&!t._simulated?void s.DomEvent.stop(t):(s.DomEvent._lastClick=i,e(t))}},s.DomEvent.on=s.DomEvent.addListener,s.DomEvent.off=s.DomEvent.removeListener,s.Draggable=s.Class.extend({includes:s.Mixin.Events,statics:{START:s.Browser.touch?["touchstart","mousedown"]:["mousedown"],END:{mousedown:"mouseup",touchstart:"touchend",pointerdown:"touchend",MSPointerDown:"touchend"},MOVE:{mousedown:"mousemove",touchstart:"touchmove",pointerdown:"touchmove",MSPointerDown:"touchmove"}},initialize:function(t,e){this._element=t,this._dragStartTarget=e||t},enable:function(){if(!this._enabled){for(var t=s.Draggable.START.length-1;t>=0;t--)s.DomEvent.on(this._dragStartTarget,s.Draggable.START[t],this._onDown,this);this._enabled=!0}},disable:function(){if(this._enabled){for(var t=s.Draggable.START.length-1;t>=0;t--)s.DomEvent.off(this._dragStartTarget,s.Draggable.START[t],this._onDown,this);this._enabled=!1,this._moved=!1}},_onDown:function(t){if(this._moved=!1,!(t.shiftKey||1!==t.which&&1!==t.button&&!t.touches||(s.DomEvent.stopPropagation(t),s.Draggable._disabled||(s.DomUtil.disableImageDrag(),s.DomUtil.disableTextSelection(),this._moving)))){var i=t.touches?t.touches[0]:t;this._startPoint=new s.Point(i.clientX,i.clientY),this._startPos=this._newPos=s.DomUtil.getPosition(this._element),s.DomEvent.on(e,s.Draggable.MOVE[t.type],this._onMove,this).on(e,s.Draggable.END[t.type],this._onUp,this)}},_onMove:function(t){if(t.touches&&t.touches.length>1)return void(this._moved=!0);var i=t.touches&&1===t.touches.length?t.touches[0]:t,n=new s.Point(i.clientX,i.clientY),r=n.subtract(this._startPoint);(r.x||r.y)&&(s.Browser.touch&&Math.abs(r.x)+Math.abs(r.y)<3||(s.DomEvent.preventDefault(t),this._moved||(this.fire("dragstart"),this._moved=!0,this._startPos=s.DomUtil.getPosition(this._element).subtract(r),s.DomUtil.addClass(e.body,"leaflet-dragging"),this._lastTarget=t.target||t.srcElement,s.DomUtil.addClass(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(r),this._moving=!0,s.Util.cancelAnimFrame(this._animRequest),this._animRequest=s.Util.requestAnimFrame(this._updatePosition,this,!0,this._dragStartTarget)))},_updatePosition:function(){this.fire("predrag"),s.DomUtil.setPosition(this._element,this._newPos),this.fire("drag")},_onUp:function(){s.DomUtil.removeClass(e.body,"leaflet-dragging"),this._lastTarget&&(s.DomUtil.removeClass(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null);for(var t in s.Draggable.MOVE)s.DomEvent.off(e,s.Draggable.MOVE[t],this._onMove).off(e,s.Draggable.END[t],this._onUp);s.DomUtil.enableImageDrag(),s.DomUtil.enableTextSelection(),this._moved&&this._moving&&(s.Util.cancelAnimFrame(this._animRequest),this.fire("dragend",{distance:this._newPos.distanceTo(this._startPos)})),this._moving=!1}}),s.Handler=s.Class.extend({initialize:function(t){this._map=t},enable:function(){this._enabled||(this._enabled=!0,this.addHooks())},disable:function(){this._enabled&&(this._enabled=!1,this.removeHooks())},enabled:function(){return!!this._enabled}}),s.Map.mergeOptions({dragging:!0,inertia:!s.Browser.android23,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,inertiaThreshold:s.Browser.touch?32:18,easeLinearity:.25,worldCopyJump:!1}),s.Map.Drag=s.Handler.extend({addHooks:function(){if(!this._draggable){var t=this._map;this._draggable=new s.Draggable(t._mapPane,t._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),t.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDrag,this),t.on("viewreset",this._onViewReset,this),t.whenReady(this._onViewReset,this))}this._draggable.enable()},removeHooks:function(){this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},_onDragStart:function(){var t=this._map;t._panAnim&&t._panAnim.stop(),t.fire("movestart").fire("dragstart"),t.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(){if(this._map.options.inertia){var t=this._lastTime=+new Date,e=this._lastPos=this._draggable._newPos;this._positions.push(e),this._times.push(t),t-this._times[0]>200&&(this._positions.shift(),this._times.shift())}this._map.fire("move").fire("drag")},_onViewReset:function(){var t=this._map.getSize()._divideBy(2),e=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=e.subtract(t).x,this._worldWidth=this._map.project([0,180]).x},_onPreDrag:function(){var t=this._worldWidth,e=Math.round(t/2),i=this._initialWorldOffset,n=this._draggable._newPos.x,s=(n-e+i)%t+e-i,r=(n+e+i)%t-e-i,o=Math.abs(s+i)<Math.abs(r+i)?s:r;this._draggable._newPos.x=o},_onDragEnd:function(t){var e=this._map,i=e.options,n=+new Date-this._lastTime,r=!i.inertia||n>i.inertiaThreshold||!this._positions[0];if(e.fire("dragend",t),r)e.fire("moveend");else{var o=this._lastPos.subtract(this._positions[0]),a=(this._lastTime+n-this._times[0])/1e3,l=i.easeLinearity,h=o.multiplyBy(l/a),u=h.distanceTo([0,0]),p=Math.min(i.inertiaMaxSpeed,u),c=h.multiplyBy(p/u),d=p/(i.inertiaDeceleration*l),m=c.multiplyBy(-d/2).round();m.x&&m.y?(m=e._limitOffset(m,e.options.maxBounds),s.Util.requestAnimFrame(function(){e.panBy(m,{duration:d,easeLinearity:l,noMoveStart:!0})})):e.fire("moveend")}}}),s.Map.addInitHook("addHandler","dragging",s.Map.Drag),s.Map.mergeOptions({doubleClickZoom:!0}),s.Map.DoubleClickZoom=s.Handler.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(t){var e=this._map,i=e.getZoom()+(t.originalEvent.shiftKey?-1:1);"center"===e.options.doubleClickZoom?e.setZoom(i):e.setZoomAround(t.containerPoint,i)}}),s.Map.addInitHook("addHandler","doubleClickZoom",s.Map.DoubleClickZoom),s.Map.mergeOptions({scrollWheelZoom:!0}),s.Map.ScrollWheelZoom=s.Handler.extend({addHooks:function(){s.DomEvent.on(this._map._container,"mousewheel",this._onWheelScroll,this),s.DomEvent.on(this._map._container,"MozMousePixelScroll",s.DomEvent.preventDefault),this._delta=0},removeHooks:function(){s.DomEvent.off(this._map._container,"mousewheel",this._onWheelScroll),s.DomEvent.off(this._map._container,"MozMousePixelScroll",s.DomEvent.preventDefault)},_onWheelScroll:function(t){var e=s.DomEvent.getWheelDelta(t);this._delta+=e,this._lastMousePos=this._map.mouseEventToContainerPoint(t),this._startTime||(this._startTime=+new Date);var i=Math.max(40-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(s.bind(this._performZoom,this),i),s.DomEvent.preventDefault(t),s.DomEvent.stopPropagation(t)},_performZoom:function(){var t=this._map,e=this._delta,i=t.getZoom();e=e>0?Math.ceil(e):Math.floor(e),e=Math.max(Math.min(e,4),-4),e=t._limitZoom(i+e)-i,this._delta=0,this._startTime=null,e&&("center"===t.options.scrollWheelZoom?t.setZoom(i+e):t.setZoomAround(this._lastMousePos,i+e))}}),s.Map.addInitHook("addHandler","scrollWheelZoom",s.Map.ScrollWheelZoom),s.extend(s.DomEvent,{_touchstart:s.Browser.msPointer?"MSPointerDown":s.Browser.pointer?"pointerdown":"touchstart",_touchend:s.Browser.msPointer?"MSPointerUp":s.Browser.pointer?"pointerup":"touchend",addDoubleTapListener:function(t,i,n){function r(t){var e;if(s.Browser.pointer?(m.push(t.pointerId),e=m.length):e=t.touches.length,!(e>1)){var i=Date.now(),n=i-(a||i);l=t.touches?t.touches[0]:t,h=n>0&&u>=n,a=i}}function o(t){if(s.Browser.pointer){var e=m.indexOf(t.pointerId);if(-1===e)return;m.splice(e,1)}if(h){if(s.Browser.pointer){var n,r={};for(var o in l)n=l[o],r[o]="function"==typeof n?n.bind(l):n;l=r}l.type="dblclick",i(l),a=null
}}var a,l,h=!1,u=250,p="_leaflet_",c=this._touchstart,d=this._touchend,m=[];t[p+c+n]=r,t[p+d+n]=o;var f=s.Browser.pointer?e.documentElement:t;return t.addEventListener(c,r,!1),f.addEventListener(d,o,!1),s.Browser.pointer&&f.addEventListener(s.DomEvent.POINTER_CANCEL,o,!1),this},removeDoubleTapListener:function(t,i){var n="_leaflet_";return t.removeEventListener(this._touchstart,t[n+this._touchstart+i],!1),(s.Browser.pointer?e.documentElement:t).removeEventListener(this._touchend,t[n+this._touchend+i],!1),s.Browser.pointer&&e.documentElement.removeEventListener(s.DomEvent.POINTER_CANCEL,t[n+this._touchend+i],!1),this}}),s.extend(s.DomEvent,{POINTER_DOWN:s.Browser.msPointer?"MSPointerDown":"pointerdown",POINTER_MOVE:s.Browser.msPointer?"MSPointerMove":"pointermove",POINTER_UP:s.Browser.msPointer?"MSPointerUp":"pointerup",POINTER_CANCEL:s.Browser.msPointer?"MSPointerCancel":"pointercancel",_pointers:[],_pointerDocumentListener:!1,addPointerListener:function(t,e,i,n){switch(e){case"touchstart":return this.addPointerListenerStart(t,e,i,n);case"touchend":return this.addPointerListenerEnd(t,e,i,n);case"touchmove":return this.addPointerListenerMove(t,e,i,n);default:throw"Unknown touch event type"}},addPointerListenerStart:function(t,i,n,r){var o="_leaflet_",a=this._pointers,l=function(t){s.DomEvent.preventDefault(t);for(var e=!1,i=0;i<a.length;i++)if(a[i].pointerId===t.pointerId){e=!0;break}e||a.push(t),t.touches=a.slice(),t.changedTouches=[t],n(t)};if(t[o+"touchstart"+r]=l,t.addEventListener(this.POINTER_DOWN,l,!1),!this._pointerDocumentListener){var h=function(t){for(var e=0;e<a.length;e++)if(a[e].pointerId===t.pointerId){a.splice(e,1);break}};e.documentElement.addEventListener(this.POINTER_UP,h,!1),e.documentElement.addEventListener(this.POINTER_CANCEL,h,!1),this._pointerDocumentListener=!0}return this},addPointerListenerMove:function(t,e,i,n){function s(t){if(t.pointerType!==t.MSPOINTER_TYPE_MOUSE&&"mouse"!==t.pointerType||0!==t.buttons){for(var e=0;e<o.length;e++)if(o[e].pointerId===t.pointerId){o[e]=t;break}t.touches=o.slice(),t.changedTouches=[t],i(t)}}var r="_leaflet_",o=this._pointers;return t[r+"touchmove"+n]=s,t.addEventListener(this.POINTER_MOVE,s,!1),this},addPointerListenerEnd:function(t,e,i,n){var s="_leaflet_",r=this._pointers,o=function(t){for(var e=0;e<r.length;e++)if(r[e].pointerId===t.pointerId){r.splice(e,1);break}t.touches=r.slice(),t.changedTouches=[t],i(t)};return t[s+"touchend"+n]=o,t.addEventListener(this.POINTER_UP,o,!1),t.addEventListener(this.POINTER_CANCEL,o,!1),this},removePointerListener:function(t,e,i){var n="_leaflet_",s=t[n+e+i];switch(e){case"touchstart":t.removeEventListener(this.POINTER_DOWN,s,!1);break;case"touchmove":t.removeEventListener(this.POINTER_MOVE,s,!1);break;case"touchend":t.removeEventListener(this.POINTER_UP,s,!1),t.removeEventListener(this.POINTER_CANCEL,s,!1)}return this}}),s.Map.mergeOptions({touchZoom:s.Browser.touch&&!s.Browser.android23,bounceAtZoomLimits:!0}),s.Map.TouchZoom=s.Handler.extend({addHooks:function(){s.DomEvent.on(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){s.DomEvent.off(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(t){var i=this._map;if(t.touches&&2===t.touches.length&&!i._animatingZoom&&!this._zooming){var n=i.mouseEventToLayerPoint(t.touches[0]),r=i.mouseEventToLayerPoint(t.touches[1]),o=i._getCenterLayerPoint();this._startCenter=n.add(r)._divideBy(2),this._startDist=n.distanceTo(r),this._moved=!1,this._zooming=!0,this._centerOffset=o.subtract(this._startCenter),i._panAnim&&i._panAnim.stop(),s.DomEvent.on(e,"touchmove",this._onTouchMove,this).on(e,"touchend",this._onTouchEnd,this),s.DomEvent.preventDefault(t)}},_onTouchMove:function(t){var e=this._map;if(t.touches&&2===t.touches.length&&this._zooming){var i=e.mouseEventToLayerPoint(t.touches[0]),n=e.mouseEventToLayerPoint(t.touches[1]);this._scale=i.distanceTo(n)/this._startDist,this._delta=i._add(n)._divideBy(2)._subtract(this._startCenter),1!==this._scale&&(e.options.bounceAtZoomLimits||!(e.getZoom()===e.getMinZoom()&&this._scale<1||e.getZoom()===e.getMaxZoom()&&this._scale>1))&&(this._moved||(s.DomUtil.addClass(e._mapPane,"leaflet-touching"),e.fire("movestart").fire("zoomstart"),this._moved=!0),s.Util.cancelAnimFrame(this._animRequest),this._animRequest=s.Util.requestAnimFrame(this._updateOnMove,this,!0,this._map._container),s.DomEvent.preventDefault(t))}},_updateOnMove:function(){var t=this._map,e=this._getScaleOrigin(),i=t.layerPointToLatLng(e),n=t.getScaleZoom(this._scale);t._animateZoom(i,n,this._startCenter,this._scale,this._delta,!1,!0)},_onTouchEnd:function(){if(!this._moved||!this._zooming)return void(this._zooming=!1);var t=this._map;this._zooming=!1,s.DomUtil.removeClass(t._mapPane,"leaflet-touching"),s.Util.cancelAnimFrame(this._animRequest),s.DomEvent.off(e,"touchmove",this._onTouchMove).off(e,"touchend",this._onTouchEnd);var i=this._getScaleOrigin(),n=t.layerPointToLatLng(i),r=t.getZoom(),o=t.getScaleZoom(this._scale)-r,a=o>0?Math.ceil(o):Math.floor(o),l=t._limitZoom(r+a),h=t.getZoomScale(l)/this._scale;t._animateZoom(n,l,i,h)},_getScaleOrigin:function(){var t=this._centerOffset.subtract(this._delta).divideBy(this._scale);return this._startCenter.add(t)}}),s.Map.addInitHook("addHandler","touchZoom",s.Map.TouchZoom),s.Map.mergeOptions({tap:!0,tapTolerance:15}),s.Map.Tap=s.Handler.extend({addHooks:function(){s.DomEvent.on(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){s.DomEvent.off(this._map._container,"touchstart",this._onDown,this)},_onDown:function(t){if(t.touches){if(s.DomEvent.preventDefault(t),this._fireClick=!0,t.touches.length>1)return this._fireClick=!1,void clearTimeout(this._holdTimeout);var i=t.touches[0],n=i.target;this._startPos=this._newPos=new s.Point(i.clientX,i.clientY),n.tagName&&"a"===n.tagName.toLowerCase()&&s.DomUtil.addClass(n,"leaflet-active"),this._holdTimeout=setTimeout(s.bind(function(){this._isTapValid()&&(this._fireClick=!1,this._onUp(),this._simulateEvent("contextmenu",i))},this),1e3),s.DomEvent.on(e,"touchmove",this._onMove,this).on(e,"touchend",this._onUp,this)}},_onUp:function(t){if(clearTimeout(this._holdTimeout),s.DomEvent.off(e,"touchmove",this._onMove,this).off(e,"touchend",this._onUp,this),this._fireClick&&t&&t.changedTouches){var i=t.changedTouches[0],n=i.target;n&&n.tagName&&"a"===n.tagName.toLowerCase()&&s.DomUtil.removeClass(n,"leaflet-active"),this._isTapValid()&&this._simulateEvent("click",i)}},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_onMove:function(t){var e=t.touches[0];this._newPos=new s.Point(e.clientX,e.clientY)},_simulateEvent:function(i,n){var s=e.createEvent("MouseEvents");s._simulated=!0,n.target._simulatedClick=!0,s.initMouseEvent(i,!0,!0,t,1,n.screenX,n.screenY,n.clientX,n.clientY,!1,!1,!1,!1,0,null),n.target.dispatchEvent(s)}}),s.Browser.touch&&!s.Browser.pointer&&s.Map.addInitHook("addHandler","tap",s.Map.Tap),s.Map.mergeOptions({boxZoom:!0}),s.Map.BoxZoom=s.Handler.extend({initialize:function(t){this._map=t,this._container=t._container,this._pane=t._panes.overlayPane,this._moved=!1},addHooks:function(){s.DomEvent.on(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){s.DomEvent.off(this._container,"mousedown",this._onMouseDown),this._moved=!1},moved:function(){return this._moved},_onMouseDown:function(t){return this._moved=!1,!t.shiftKey||1!==t.which&&1!==t.button?!1:(s.DomUtil.disableTextSelection(),s.DomUtil.disableImageDrag(),this._startLayerPoint=this._map.mouseEventToLayerPoint(t),void s.DomEvent.on(e,"mousemove",this._onMouseMove,this).on(e,"mouseup",this._onMouseUp,this).on(e,"keydown",this._onKeyDown,this))},_onMouseMove:function(t){this._moved||(this._box=s.DomUtil.create("div","leaflet-zoom-box",this._pane),s.DomUtil.setPosition(this._box,this._startLayerPoint),this._container.style.cursor="crosshair",this._map.fire("boxzoomstart"));var e=this._startLayerPoint,i=this._box,n=this._map.mouseEventToLayerPoint(t),r=n.subtract(e),o=new s.Point(Math.min(n.x,e.x),Math.min(n.y,e.y));s.DomUtil.setPosition(i,o),this._moved=!0,i.style.width=Math.max(0,Math.abs(r.x)-4)+"px",i.style.height=Math.max(0,Math.abs(r.y)-4)+"px"},_finish:function(){this._moved&&(this._pane.removeChild(this._box),this._container.style.cursor=""),s.DomUtil.enableTextSelection(),s.DomUtil.enableImageDrag(),s.DomEvent.off(e,"mousemove",this._onMouseMove).off(e,"mouseup",this._onMouseUp).off(e,"keydown",this._onKeyDown)},_onMouseUp:function(t){this._finish();var e=this._map,i=e.mouseEventToLayerPoint(t);if(!this._startLayerPoint.equals(i)){var n=new s.LatLngBounds(e.layerPointToLatLng(this._startLayerPoint),e.layerPointToLatLng(i));e.fitBounds(n),e.fire("boxzoomend",{boxZoomBounds:n})}},_onKeyDown:function(t){27===t.keyCode&&this._finish()}}),s.Map.addInitHook("addHandler","boxZoom",s.Map.BoxZoom),s.Map.mergeOptions({keyboard:!0,keyboardPanOffset:80,keyboardZoomOffset:1}),s.Map.Keyboard=s.Handler.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,173]},initialize:function(t){this._map=t,this._setPanOffset(t.options.keyboardPanOffset),this._setZoomOffset(t.options.keyboardZoomOffset)},addHooks:function(){var t=this._map._container;-1===t.tabIndex&&(t.tabIndex="0"),s.DomEvent.on(t,"focus",this._onFocus,this).on(t,"blur",this._onBlur,this).on(t,"mousedown",this._onMouseDown,this),this._map.on("focus",this._addHooks,this).on("blur",this._removeHooks,this)},removeHooks:function(){this._removeHooks();var t=this._map._container;s.DomEvent.off(t,"focus",this._onFocus,this).off(t,"blur",this._onBlur,this).off(t,"mousedown",this._onMouseDown,this),this._map.off("focus",this._addHooks,this).off("blur",this._removeHooks,this)},_onMouseDown:function(){if(!this._focused){var i=e.body,n=e.documentElement,s=i.scrollTop||n.scrollTop,r=i.scrollLeft||n.scrollLeft;this._map._container.focus(),t.scrollTo(r,s)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanOffset:function(t){var e,i,n=this._panKeys={},s=this.keyCodes;for(e=0,i=s.left.length;i>e;e++)n[s.left[e]]=[-1*t,0];for(e=0,i=s.right.length;i>e;e++)n[s.right[e]]=[t,0];for(e=0,i=s.down.length;i>e;e++)n[s.down[e]]=[0,t];for(e=0,i=s.up.length;i>e;e++)n[s.up[e]]=[0,-1*t]},_setZoomOffset:function(t){var e,i,n=this._zoomKeys={},s=this.keyCodes;for(e=0,i=s.zoomIn.length;i>e;e++)n[s.zoomIn[e]]=t;for(e=0,i=s.zoomOut.length;i>e;e++)n[s.zoomOut[e]]=-t},_addHooks:function(){s.DomEvent.on(e,"keydown",this._onKeyDown,this)},_removeHooks:function(){s.DomEvent.off(e,"keydown",this._onKeyDown,this)},_onKeyDown:function(t){var e=t.keyCode,i=this._map;if(e in this._panKeys){if(i._panAnim&&i._panAnim._inProgress)return;i.panBy(this._panKeys[e]),i.options.maxBounds&&i.panInsideBounds(i.options.maxBounds)}else{if(!(e in this._zoomKeys))return;i.setZoom(i.getZoom()+this._zoomKeys[e])}s.DomEvent.stop(t)}}),s.Map.addInitHook("addHandler","keyboard",s.Map.Keyboard),s.Handler.MarkerDrag=s.Handler.extend({initialize:function(t){this._marker=t},addHooks:function(){var t=this._marker._icon;this._draggable||(this._draggable=new s.Draggable(t,t)),this._draggable.on("dragstart",this._onDragStart,this).on("drag",this._onDrag,this).on("dragend",this._onDragEnd,this),this._draggable.enable(),s.DomUtil.addClass(this._marker._icon,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off("dragstart",this._onDragStart,this).off("drag",this._onDrag,this).off("dragend",this._onDragEnd,this),this._draggable.disable(),s.DomUtil.removeClass(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_onDragStart:function(){this._marker.closePopup().fire("movestart").fire("dragstart")},_onDrag:function(){var t=this._marker,e=t._shadow,i=s.DomUtil.getPosition(t._icon),n=t._map.layerPointToLatLng(i);e&&s.DomUtil.setPosition(e,i),t._latlng=n,t.fire("move",{latlng:n}).fire("drag")},_onDragEnd:function(t){this._marker.fire("moveend").fire("dragend",t)}}),s.Control=s.Class.extend({options:{position:"topright"},initialize:function(t){s.setOptions(this,t)},getPosition:function(){return this.options.position},setPosition:function(t){var e=this._map;return e&&e.removeControl(this),this.options.position=t,e&&e.addControl(this),this},getContainer:function(){return this._container},addTo:function(t){this._map=t;var e=this._container=this.onAdd(t),i=this.getPosition(),n=t._controlCorners[i];return s.DomUtil.addClass(e,"leaflet-control"),-1!==i.indexOf("bottom")?n.insertBefore(e,n.firstChild):n.appendChild(e),this},removeFrom:function(t){var e=this.getPosition(),i=t._controlCorners[e];return i.removeChild(this._container),this._map=null,this.onRemove&&this.onRemove(t),this},_refocusOnMap:function(){this._map&&this._map.getContainer().focus()}}),s.control=function(t){return new s.Control(t)},s.Map.include({addControl:function(t){return t.addTo(this),this},removeControl:function(t){return t.removeFrom(this),this},_initControlPos:function(){function t(t,r){var o=i+t+" "+i+r;e[t+r]=s.DomUtil.create("div",o,n)}var e=this._controlCorners={},i="leaflet-",n=this._controlContainer=s.DomUtil.create("div",i+"control-container",this._container);t("top","left"),t("top","right"),t("bottom","left"),t("bottom","right")},_clearControlPos:function(){this._container.removeChild(this._controlContainer)}}),s.Control.Zoom=s.Control.extend({options:{position:"topleft",zoomInText:"+",zoomInTitle:"Zoom in",zoomOutText:"-",zoomOutTitle:"Zoom out"},onAdd:function(t){var e="leaflet-control-zoom",i=s.DomUtil.create("div",e+" leaflet-bar");return this._map=t,this._zoomInButton=this._createButton(this.options.zoomInText,this.options.zoomInTitle,e+"-in",i,this._zoomIn,this),this._zoomOutButton=this._createButton(this.options.zoomOutText,this.options.zoomOutTitle,e+"-out",i,this._zoomOut,this),this._updateDisabled(),t.on("zoomend zoomlevelschange",this._updateDisabled,this),i},onRemove:function(t){t.off("zoomend zoomlevelschange",this._updateDisabled,this)},_zoomIn:function(t){this._map.zoomIn(t.shiftKey?3:1)},_zoomOut:function(t){this._map.zoomOut(t.shiftKey?3:1)},_createButton:function(t,e,i,n,r,o){var a=s.DomUtil.create("a",i,n);a.innerHTML=t,a.href="#",a.title=e;var l=s.DomEvent.stopPropagation;return s.DomEvent.on(a,"click",l).on(a,"mousedown",l).on(a,"dblclick",l).on(a,"click",s.DomEvent.preventDefault).on(a,"click",r,o).on(a,"click",this._refocusOnMap,o),a},_updateDisabled:function(){var t=this._map,e="leaflet-disabled";s.DomUtil.removeClass(this._zoomInButton,e),s.DomUtil.removeClass(this._zoomOutButton,e),t._zoom===t.getMinZoom()&&s.DomUtil.addClass(this._zoomOutButton,e),t._zoom===t.getMaxZoom()&&s.DomUtil.addClass(this._zoomInButton,e)}}),s.Map.mergeOptions({zoomControl:!0}),s.Map.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new s.Control.Zoom,this.addControl(this.zoomControl))}),s.control.zoom=function(t){return new s.Control.Zoom(t)},s.Control.Attribution=s.Control.extend({options:{position:"bottomright",prefix:'<a href="http://leafletjs.com" title="A JS library for interactive maps">Leaflet</a>'},initialize:function(t){s.setOptions(this,t),this._attributions={}},onAdd:function(t){this._container=s.DomUtil.create("div","leaflet-control-attribution"),s.DomEvent.disableClickPropagation(this._container);for(var e in t._layers)t._layers[e].getAttribution&&this.addAttribution(t._layers[e].getAttribution());return t.on("layeradd",this._onLayerAdd,this).on("layerremove",this._onLayerRemove,this),this._update(),this._container},onRemove:function(t){t.off("layeradd",this._onLayerAdd).off("layerremove",this._onLayerRemove)},setPrefix:function(t){return this.options.prefix=t,this._update(),this},addAttribution:function(t){return t?(this._attributions[t]||(this._attributions[t]=0),this._attributions[t]++,this._update(),this):void 0},removeAttribution:function(t){return t?(this._attributions[t]&&(this._attributions[t]--,this._update()),this):void 0},_update:function(){if(this._map){var t=[];for(var e in this._attributions)this._attributions[e]&&t.push(e);var i=[];this.options.prefix&&i.push(this.options.prefix),t.length&&i.push(t.join(", ")),this._container.innerHTML=i.join(" | ")}},_onLayerAdd:function(t){t.layer.getAttribution&&this.addAttribution(t.layer.getAttribution())},_onLayerRemove:function(t){t.layer.getAttribution&&this.removeAttribution(t.layer.getAttribution())}}),s.Map.mergeOptions({attributionControl:!0}),s.Map.addInitHook(function(){this.options.attributionControl&&(this.attributionControl=(new s.Control.Attribution).addTo(this))}),s.control.attribution=function(t){return new s.Control.Attribution(t)},s.Control.Scale=s.Control.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0,updateWhenIdle:!1},onAdd:function(t){this._map=t;var e="leaflet-control-scale",i=s.DomUtil.create("div",e),n=this.options;return this._addScales(n,e,i),t.on(n.updateWhenIdle?"moveend":"move",this._update,this),t.whenReady(this._update,this),i},onRemove:function(t){t.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(t,e,i){t.metric&&(this._mScale=s.DomUtil.create("div",e+"-line",i)),t.imperial&&(this._iScale=s.DomUtil.create("div",e+"-line",i))},_update:function(){var t=this._map.getBounds(),e=t.getCenter().lat,i=6378137*Math.PI*Math.cos(e*Math.PI/180),n=i*(t.getNorthEast().lng-t.getSouthWest().lng)/180,s=this._map.getSize(),r=this.options,o=0;s.x>0&&(o=n*(r.maxWidth/s.x)),this._updateScales(r,o)},_updateScales:function(t,e){t.metric&&e&&this._updateMetric(e),t.imperial&&e&&this._updateImperial(e)},_updateMetric:function(t){var e=this._getRoundNum(t);this._mScale.style.width=this._getScaleWidth(e/t)+"px",this._mScale.innerHTML=1e3>e?e+" m":e/1e3+" km"},_updateImperial:function(t){var e,i,n,s=3.2808399*t,r=this._iScale;s>5280?(e=s/5280,i=this._getRoundNum(e),r.style.width=this._getScaleWidth(i/e)+"px",r.innerHTML=i+" mi"):(n=this._getRoundNum(s),r.style.width=this._getScaleWidth(n/s)+"px",r.innerHTML=n+" ft")},_getScaleWidth:function(t){return Math.round(this.options.maxWidth*t)-10},_getRoundNum:function(t){var e=Math.pow(10,(Math.floor(t)+"").length-1),i=t/e;return i=i>=10?10:i>=5?5:i>=3?3:i>=2?2:1,e*i}}),s.control.scale=function(t){return new s.Control.Scale(t)},s.Control.Layers=s.Control.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0},initialize:function(t,e,i){s.setOptions(this,i),this._layers={},this._lastZIndex=0,this._handlingClick=!1;for(var n in t)this._addLayer(t[n],n);for(n in e)this._addLayer(e[n],n,!0)},onAdd:function(t){return this._initLayout(),this._update(),t.on("layeradd",this._onLayerChange,this).on("layerremove",this._onLayerChange,this),this._container},onRemove:function(t){t.off("layeradd",this._onLayerChange,this).off("layerremove",this._onLayerChange,this)},addBaseLayer:function(t,e){return this._addLayer(t,e),this._update(),this},addOverlay:function(t,e){return this._addLayer(t,e,!0),this._update(),this},removeLayer:function(t){var e=s.stamp(t);return delete this._layers[e],this._update(),this},_initLayout:function(){var t="leaflet-control-layers",e=this._container=s.DomUtil.create("div",t);e.setAttribute("aria-haspopup",!0),s.Browser.touch?s.DomEvent.on(e,"click",s.DomEvent.stopPropagation):s.DomEvent.disableClickPropagation(e).disableScrollPropagation(e);var i=this._form=s.DomUtil.create("form",t+"-list");if(this.options.collapsed){s.Browser.android||s.DomEvent.on(e,"mouseover",this._expand,this).on(e,"mouseout",this._collapse,this);var n=this._layersLink=s.DomUtil.create("a",t+"-toggle",e);n.href="#",n.title="Layers",s.Browser.touch?s.DomEvent.on(n,"click",s.DomEvent.stop).on(n,"click",this._expand,this):s.DomEvent.on(n,"focus",this._expand,this),s.DomEvent.on(i,"click",function(){setTimeout(s.bind(this._onInputClick,this),0)},this),this._map.on("click",this._collapse,this)}else this._expand();this._baseLayersList=s.DomUtil.create("div",t+"-base",i),this._separator=s.DomUtil.create("div",t+"-separator",i),this._overlaysList=s.DomUtil.create("div",t+"-overlays",i),e.appendChild(i)},_addLayer:function(t,e,i){var n=s.stamp(t);this._layers[n]={layer:t,name:e,overlay:i},this.options.autoZIndex&&t.setZIndex&&(this._lastZIndex++,t.setZIndex(this._lastZIndex))},_update:function(){if(this._container){this._baseLayersList.innerHTML="",this._overlaysList.innerHTML="";var t,e,i=!1,n=!1;for(t in this._layers)e=this._layers[t],this._addItem(e),n=n||e.overlay,i=i||!e.overlay;this._separator.style.display=n&&i?"":"none"}},_onLayerChange:function(t){var e=this._layers[s.stamp(t.layer)];if(e){this._handlingClick||this._update();var i=e.overlay?"layeradd"===t.type?"overlayadd":"overlayremove":"layeradd"===t.type?"baselayerchange":null;i&&this._map.fire(i,e)}},_createRadioElement:function(t,i){var n='<input type="radio" class="leaflet-control-layers-selector" name="'+t+'"';i&&(n+=' checked="checked"'),n+="/>";var s=e.createElement("div");return s.innerHTML=n,s.firstChild},_addItem:function(t){var i,n=e.createElement("label"),r=this._map.hasLayer(t.layer);t.overlay?(i=e.createElement("input"),i.type="checkbox",i.className="leaflet-control-layers-selector",i.defaultChecked=r):i=this._createRadioElement("leaflet-base-layers",r),i.layerId=s.stamp(t.layer),s.DomEvent.on(i,"click",this._onInputClick,this);var o=e.createElement("span");o.innerHTML=" "+t.name,n.appendChild(i),n.appendChild(o);var a=t.overlay?this._overlaysList:this._baseLayersList;return a.appendChild(n),n},_onInputClick:function(){var t,e,i,n=this._form.getElementsByTagName("input"),s=n.length;for(this._handlingClick=!0,t=0;s>t;t++)e=n[t],i=this._layers[e.layerId],e.checked&&!this._map.hasLayer(i.layer)?this._map.addLayer(i.layer):!e.checked&&this._map.hasLayer(i.layer)&&this._map.removeLayer(i.layer);this._handlingClick=!1,this._refocusOnMap()},_expand:function(){s.DomUtil.addClass(this._container,"leaflet-control-layers-expanded")},_collapse:function(){this._container.className=this._container.className.replace(" leaflet-control-layers-expanded","")}}),s.control.layers=function(t,e,i){return new s.Control.Layers(t,e,i)},s.PosAnimation=s.Class.extend({includes:s.Mixin.Events,run:function(t,e,i,n){this.stop(),this._el=t,this._inProgress=!0,this._newPos=e,this.fire("start"),t.style[s.DomUtil.TRANSITION]="all "+(i||.25)+"s cubic-bezier(0,0,"+(n||.5)+",1)",s.DomEvent.on(t,s.DomUtil.TRANSITION_END,this._onTransitionEnd,this),s.DomUtil.setPosition(t,e),s.Util.falseFn(t.offsetWidth),this._stepTimer=setInterval(s.bind(this._onStep,this),50)},stop:function(){this._inProgress&&(s.DomUtil.setPosition(this._el,this._getPos()),this._onTransitionEnd(),s.Util.falseFn(this._el.offsetWidth))},_onStep:function(){var t=this._getPos();return t?(this._el._leaflet_pos=t,void this.fire("step")):void this._onTransitionEnd()},_transformRe:/([-+]?(?:\d*\.)?\d+)\D*, ([-+]?(?:\d*\.)?\d+)\D*\)/,_getPos:function(){var e,i,n,r=this._el,o=t.getComputedStyle(r);if(s.Browser.any3d){if(n=o[s.DomUtil.TRANSFORM].match(this._transformRe),!n)return;e=parseFloat(n[1]),i=parseFloat(n[2])}else e=parseFloat(o.left),i=parseFloat(o.top);return new s.Point(e,i,!0)},_onTransitionEnd:function(){s.DomEvent.off(this._el,s.DomUtil.TRANSITION_END,this._onTransitionEnd,this),this._inProgress&&(this._inProgress=!1,this._el.style[s.DomUtil.TRANSITION]="",this._el._leaflet_pos=this._newPos,clearInterval(this._stepTimer),this.fire("step").fire("end"))}}),s.Map.include({setView:function(t,e,n){if(e=e===i?this._zoom:this._limitZoom(e),t=this._limitCenter(s.latLng(t),e,this.options.maxBounds),n=n||{},this._panAnim&&this._panAnim.stop(),this._loaded&&!n.reset&&n!==!0){n.animate!==i&&(n.zoom=s.extend({animate:n.animate},n.zoom),n.pan=s.extend({animate:n.animate},n.pan));var r=this._zoom!==e?this._tryAnimatedZoom&&this._tryAnimatedZoom(t,e,n.zoom):this._tryAnimatedPan(t,n.pan);if(r)return clearTimeout(this._sizeTimer),this}return this._resetView(t,e),this},panBy:function(t,e){if(t=s.point(t).round(),e=e||{},!t.x&&!t.y)return this;if(this._panAnim||(this._panAnim=new s.PosAnimation,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),e.noMoveStart||this.fire("movestart"),e.animate!==!1){s.DomUtil.addClass(this._mapPane,"leaflet-pan-anim");var i=this._getMapPanePos().subtract(t);this._panAnim.run(this._mapPane,i,e.duration||.25,e.easeLinearity)}else this._rawPanBy(t),this.fire("move").fire("moveend");return this},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){s.DomUtil.removeClass(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(t,e){var i=this._getCenterOffset(t)._floor();return(e&&e.animate)===!0||this.getSize().contains(i)?(this.panBy(i,e),!0):!1}}),s.PosAnimation=s.DomUtil.TRANSITION?s.PosAnimation:s.PosAnimation.extend({run:function(t,e,i,n){this.stop(),this._el=t,this._inProgress=!0,this._duration=i||.25,this._easeOutPower=1/Math.max(n||.5,.2),this._startPos=s.DomUtil.getPosition(t),this._offset=e.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(),this._complete())},_animate:function(){this._animId=s.Util.requestAnimFrame(this._animate,this),this._step()},_step:function(){var t=+new Date-this._startTime,e=1e3*this._duration;e>t?this._runFrame(this._easeOut(t/e)):(this._runFrame(1),this._complete())},_runFrame:function(t){var e=this._startPos.add(this._offset.multiplyBy(t));s.DomUtil.setPosition(this._el,e),this.fire("step")},_complete:function(){s.Util.cancelAnimFrame(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(t){return 1-Math.pow(1-t,this._easeOutPower)}}),s.Map.mergeOptions({zoomAnimation:!0,zoomAnimationThreshold:4}),s.DomUtil.TRANSITION&&s.Map.addInitHook(function(){this._zoomAnimated=this.options.zoomAnimation&&s.DomUtil.TRANSITION&&s.Browser.any3d&&!s.Browser.android23&&!s.Browser.mobileOpera,this._zoomAnimated&&s.DomEvent.on(this._mapPane,s.DomUtil.TRANSITION_END,this._catchTransitionEnd,this)}),s.Map.include(s.DomUtil.TRANSITION?{_catchTransitionEnd:function(t){this._animatingZoom&&t.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(t,e,i){if(this._animatingZoom)return!0;if(i=i||{},!this._zoomAnimated||i.animate===!1||this._nothingToAnimate()||Math.abs(e-this._zoom)>this.options.zoomAnimationThreshold)return!1;var n=this.getZoomScale(e),s=this._getCenterOffset(t)._divideBy(1-1/n),r=this._getCenterLayerPoint()._add(s);return i.animate===!0||this.getSize().contains(s)?(this.fire("movestart").fire("zoomstart"),this._animateZoom(t,e,r,n,null,!0),!0):!1},_animateZoom:function(t,e,i,n,r,o,a){a||(this._animatingZoom=!0),s.DomUtil.addClass(this._mapPane,"leaflet-zoom-anim"),this._animateToCenter=t,this._animateToZoom=e,s.Draggable&&(s.Draggable._disabled=!0),s.Util.requestAnimFrame(function(){this.fire("zoomanim",{center:t,zoom:e,origin:i,scale:n,delta:r,backwards:o})},this)},_onZoomTransitionEnd:function(){this._animatingZoom=!1,s.DomUtil.removeClass(this._mapPane,"leaflet-zoom-anim"),this._resetView(this._animateToCenter,this._animateToZoom,!0,!0),s.Draggable&&(s.Draggable._disabled=!1)}}:{}),s.TileLayer.include({_animateZoom:function(t){this._animating||(this._animating=!0,this._prepareBgBuffer());var e=this._bgBuffer,i=s.DomUtil.TRANSFORM,n=t.delta?s.DomUtil.getTranslateString(t.delta):e.style[i],r=s.DomUtil.getScaleString(t.scale,t.origin);e.style[i]=t.backwards?r+" "+n:n+" "+r},_endZoomAnim:function(){var t=this._tileContainer,e=this._bgBuffer;t.style.visibility="",t.parentNode.appendChild(t),s.Util.falseFn(e.offsetWidth),this._animating=!1},_clearBgBuffer:function(){var t=this._map;!t||t._animatingZoom||t.touchZoom._zooming||(this._bgBuffer.innerHTML="",this._bgBuffer.style[s.DomUtil.TRANSFORM]="")},_prepareBgBuffer:function(){var t=this._tileContainer,e=this._bgBuffer,i=this._getLoadedTilesPercentage(e),n=this._getLoadedTilesPercentage(t);return e&&i>.5&&.5>n?(t.style.visibility="hidden",void this._stopLoadingImages(t)):(e.style.visibility="hidden",e.style[s.DomUtil.TRANSFORM]="",this._tileContainer=e,e=this._bgBuffer=t,this._stopLoadingImages(e),void clearTimeout(this._clearBgBufferTimer))},_getLoadedTilesPercentage:function(t){var e,i,n=t.getElementsByTagName("img"),s=0;for(e=0,i=n.length;i>e;e++)n[e].complete&&s++;return s/i},_stopLoadingImages:function(t){var e,i,n,r=Array.prototype.slice.call(t.getElementsByTagName("img"));for(e=0,i=r.length;i>e;e++)n=r[e],n.complete||(n.onload=s.Util.falseFn,n.onerror=s.Util.falseFn,n.src=s.Util.emptyImageUrl,n.parentNode.removeChild(n))}}),s.Map.include({_defaultLocateOptions:{watch:!1,setView:!1,maxZoom:1/0,timeout:1e4,maximumAge:0,enableHighAccuracy:!1},locate:function(t){if(t=this._locateOptions=s.extend(this._defaultLocateOptions,t),!navigator.geolocation)return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var e=s.bind(this._handleGeolocationResponse,this),i=s.bind(this._handleGeolocationError,this);return t.watch?this._locationWatchId=navigator.geolocation.watchPosition(e,i,t):navigator.geolocation.getCurrentPosition(e,i,t),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(t){var e=t.code,i=t.message||(1===e?"permission denied":2===e?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:e,message:"Geolocation error: "+i+"."})},_handleGeolocationResponse:function(t){var e=t.coords.latitude,i=t.coords.longitude,n=new s.LatLng(e,i),r=180*t.coords.accuracy/40075017,o=r/Math.cos(s.LatLng.DEG_TO_RAD*e),a=s.latLngBounds([e-r,i-o],[e+r,i+o]),l=this._locateOptions;if(l.setView){var h=Math.min(this.getBoundsZoom(a),l.maxZoom);this.setView(n,h)}var u={latlng:n,bounds:a,timestamp:t.timestamp};for(var p in t.coords)"number"==typeof t.coords[p]&&(u[p]=t.coords[p]);this.fire("locationfound",u)}})}(window,document),!function(t,e,i){var n=t.L,s={};s.version="0.7.3","object"==typeof module&&"object"==typeof module.exports?module.exports=s:"function"==typeof define&&define.amd&&define(s),s.noConflict=function(){return t.L=n,this},t.L=s,s.Util={extend:function(t){var e,i,n,s,r=Array.prototype.slice.call(arguments,1);for(i=0,n=r.length;n>i;i++){s=r[i]||{};for(e in s)s.hasOwnProperty(e)&&(t[e]=s[e])}return t},bind:function(t,e){var i=arguments.length>2?Array.prototype.slice.call(arguments,2):null;return function(){return t.apply(e,i||arguments)}},stamp:function(){var t=0,e="_leaflet_id";return function(i){return i[e]=i[e]||++t,i[e]}}(),invokeEach:function(t,e,i){var n,s;if("object"==typeof t){s=Array.prototype.slice.call(arguments,3);for(n in t)e.apply(i,[n,t[n]].concat(s));return!0}return!1},limitExecByInterval:function(t,e,i){var n,s;return function r(){var o=arguments;return n?void(s=!0):(n=!0,setTimeout(function(){n=!1,s&&(r.apply(i,o),s=!1)},e),void t.apply(i,o))}},falseFn:function(){return!1},formatNum:function(t,e){var i=Math.pow(10,e||5);return Math.round(t*i)/i},trim:function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")},splitWords:function(t){return s.Util.trim(t).split(/\s+/)},setOptions:function(t,e){return t.options=s.extend({},t.options,e),t.options},getParamString:function(t,e,i){var n=[];for(var s in t)n.push(encodeURIComponent(i?s.toUpperCase():s)+"="+encodeURIComponent(t[s]));return(e&&-1!==e.indexOf("?")?"&":"?")+n.join("&")},template:function(t,e){return t.replace(/\{ *([\w_]+) *\}/g,function(t,n){var s=e[n];if(s===i)throw new Error("No value provided for variable "+t);return"function"==typeof s&&(s=s(e)),s})},isArray:Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},emptyImageUrl:"data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs="},function(){function e(e){var i,n,s=["webkit","moz","o","ms"];
for(i=0;i<s.length&&!n;i++)n=t[s[i]+e];return n}function i(e){var i=+new Date,s=Math.max(0,16-(i-n));return n=i+s,t.setTimeout(e,s)}var n=0,r=t.requestAnimationFrame||e("RequestAnimationFrame")||i,o=t.cancelAnimationFrame||e("CancelAnimationFrame")||e("CancelRequestAnimationFrame")||function(e){t.clearTimeout(e)};s.Util.requestAnimFrame=function(e,n,o,a){return e=s.bind(e,n),o&&r===i?void e():r.call(t,e,a)},s.Util.cancelAnimFrame=function(e){e&&o.call(t,e)}}(),s.extend=s.Util.extend,s.bind=s.Util.bind,s.stamp=s.Util.stamp,s.setOptions=s.Util.setOptions,s.Class=function(){},s.Class.extend=function(t){var e=function(){this.initialize&&this.initialize.apply(this,arguments),this._initHooks&&this.callInitHooks()},i=function(){};i.prototype=this.prototype;var n=new i;n.constructor=e,e.prototype=n;for(var r in this)this.hasOwnProperty(r)&&"prototype"!==r&&(e[r]=this[r]);t.statics&&(s.extend(e,t.statics),delete t.statics),t.includes&&(s.Util.extend.apply(null,[n].concat(t.includes)),delete t.includes),t.options&&n.options&&(t.options=s.extend({},n.options,t.options)),s.extend(n,t),n._initHooks=[];var o=this;return e.__super__=o.prototype,n.callInitHooks=function(){if(!this._initHooksCalled){o.prototype.callInitHooks&&o.prototype.callInitHooks.call(this),this._initHooksCalled=!0;for(var t=0,e=n._initHooks.length;e>t;t++)n._initHooks[t].call(this)}},e},s.Class.include=function(t){s.extend(this.prototype,t)},s.Class.mergeOptions=function(t){s.extend(this.prototype.options,t)},s.Class.addInitHook=function(t){var e=Array.prototype.slice.call(arguments,1),i="function"==typeof t?t:function(){this[t].apply(this,e)};this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(i)};var r="_leaflet_events";s.Mixin={},s.Mixin.Events={addEventListener:function(t,e,i){if(s.Util.invokeEach(t,this.addEventListener,this,e,i))return this;var n,o,a,l,h,u,p,c=this[r]=this[r]||{},d=i&&i!==this&&s.stamp(i);for(t=s.Util.splitWords(t),n=0,o=t.length;o>n;n++)a={action:e,context:i||this},l=t[n],d?(h=l+"_idx",u=h+"_len",p=c[h]=c[h]||{},p[d]||(p[d]=[],c[u]=(c[u]||0)+1),p[d].push(a)):(c[l]=c[l]||[],c[l].push(a));return this},hasEventListeners:function(t){var e=this[r];return!!e&&(t in e&&e[t].length>0||t+"_idx"in e&&e[t+"_idx_len"]>0)},removeEventListener:function(t,e,i){if(!this[r])return this;if(!t)return this.clearAllEventListeners();if(s.Util.invokeEach(t,this.removeEventListener,this,e,i))return this;var n,o,a,l,h,u,p,c,d,m=this[r],f=i&&i!==this&&s.stamp(i);for(t=s.Util.splitWords(t),n=0,o=t.length;o>n;n++)if(a=t[n],u=a+"_idx",p=u+"_len",c=m[u],e){if(l=f&&c?c[f]:m[a]){for(h=l.length-1;h>=0;h--)l[h].action!==e||i&&l[h].context!==i||(d=l.splice(h,1),d[0].action=s.Util.falseFn);i&&c&&0===l.length&&(delete c[f],m[p]--)}}else delete m[a],delete m[u],delete m[p];return this},clearAllEventListeners:function(){return delete this[r],this},fireEvent:function(t,e){if(!this.hasEventListeners(t))return this;var i,n,o,a,l,h=s.Util.extend({},e,{type:t,target:this}),u=this[r];if(u[t])for(i=u[t].slice(),n=0,o=i.length;o>n;n++)i[n].action.call(i[n].context,h);a=u[t+"_idx"];for(l in a)if(i=a[l].slice())for(n=0,o=i.length;o>n;n++)i[n].action.call(i[n].context,h);return this},addOneTimeEventListener:function(t,e,i){if(s.Util.invokeEach(t,this.addOneTimeEventListener,this,e,i))return this;var n=s.bind(function(){this.removeEventListener(t,e,i).removeEventListener(t,n,i)},this);return this.addEventListener(t,e,i).addEventListener(t,n,i)}},s.Mixin.Events.on=s.Mixin.Events.addEventListener,s.Mixin.Events.off=s.Mixin.Events.removeEventListener,s.Mixin.Events.once=s.Mixin.Events.addOneTimeEventListener,s.Mixin.Events.fire=s.Mixin.Events.fireEvent,function(){var n="ActiveXObject"in t,r=n&&!e.addEventListener,o=navigator.userAgent.toLowerCase(),a=-1!==o.indexOf("webkit"),l=-1!==o.indexOf("chrome"),h=-1!==o.indexOf("phantom"),u=-1!==o.indexOf("android"),p=-1!==o.search("android [23]"),c=-1!==o.indexOf("gecko"),d=typeof orientation!=i+"",m=t.navigator&&t.navigator.msPointerEnabled&&t.navigator.msMaxTouchPoints&&!t.PointerEvent,f=t.PointerEvent&&t.navigator.pointerEnabled&&t.navigator.maxTouchPoints||m,y="devicePixelRatio"in t&&t.devicePixelRatio>1||"matchMedia"in t&&t.matchMedia("(min-resolution:144dpi)")&&t.matchMedia("(min-resolution:144dpi)").matches,g=e.documentElement,v=n&&"transition"in g.style,L="WebKitCSSMatrix"in t&&"m11"in new t.WebKitCSSMatrix&&!p,_="MozPerspective"in g.style,O="OTransition"in g.style,b=!t.L_DISABLE_3D&&(v||L||_||O)&&!h,w=!t.L_NO_TOUCH&&!h&&function(){var t="ontouchstart";if(f||t in g)return!0;var i=e.createElement("div"),n=!1;return i.setAttribute?(i.setAttribute(t,"return;"),"function"==typeof i[t]&&(n=!0),i.removeAttribute(t),i=null,n):!1}();s.Browser={ie:n,ielt9:r,webkit:a,gecko:c&&!a&&!t.opera&&!n,android:u,android23:p,chrome:l,ie3d:v,webkit3d:L,gecko3d:_,opera3d:O,any3d:b,mobile:d,mobileWebkit:d&&a,mobileWebkit3d:d&&L,mobileOpera:d&&t.opera,touch:w,msPointer:m,pointer:f,retina:y}}(),s.Point=function(t,e,i){this.x=i?Math.round(t):t,this.y=i?Math.round(e):e},s.Point.prototype={clone:function(){return new s.Point(this.x,this.y)},add:function(t){return this.clone()._add(s.point(t))},_add:function(t){return this.x+=t.x,this.y+=t.y,this},subtract:function(t){return this.clone()._subtract(s.point(t))},_subtract:function(t){return this.x-=t.x,this.y-=t.y,this},divideBy:function(t){return this.clone()._divideBy(t)},_divideBy:function(t){return this.x/=t,this.y/=t,this},multiplyBy:function(t){return this.clone()._multiplyBy(t)},_multiplyBy:function(t){return this.x*=t,this.y*=t,this},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},distanceTo:function(t){t=s.point(t);var e=t.x-this.x,i=t.y-this.y;return Math.sqrt(e*e+i*i)},equals:function(t){return t=s.point(t),t.x===this.x&&t.y===this.y},contains:function(t){return t=s.point(t),Math.abs(t.x)<=Math.abs(this.x)&&Math.abs(t.y)<=Math.abs(this.y)},toString:function(){return"Point("+s.Util.formatNum(this.x)+", "+s.Util.formatNum(this.y)+")"}},s.point=function(t,e,n){return t instanceof s.Point?t:s.Util.isArray(t)?new s.Point(t[0],t[1]):t===i||null===t?t:new s.Point(t,e,n)},s.Bounds=function(t,e){if(t)for(var i=e?[t,e]:t,n=0,s=i.length;s>n;n++)this.extend(i[n])},s.Bounds.prototype={extend:function(t){return t=s.point(t),this.min||this.max?(this.min.x=Math.min(t.x,this.min.x),this.max.x=Math.max(t.x,this.max.x),this.min.y=Math.min(t.y,this.min.y),this.max.y=Math.max(t.y,this.max.y)):(this.min=t.clone(),this.max=t.clone()),this},getCenter:function(t){return new s.Point((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,t)},getBottomLeft:function(){return new s.Point(this.min.x,this.max.y)},getTopRight:function(){return new s.Point(this.max.x,this.min.y)},getSize:function(){return this.max.subtract(this.min)},contains:function(t){var e,i;return t="number"==typeof t[0]||t instanceof s.Point?s.point(t):s.bounds(t),t instanceof s.Bounds?(e=t.min,i=t.max):e=i=t,e.x>=this.min.x&&i.x<=this.max.x&&e.y>=this.min.y&&i.y<=this.max.y},intersects:function(t){t=s.bounds(t);var e=this.min,i=this.max,n=t.min,r=t.max,o=r.x>=e.x&&n.x<=i.x,a=r.y>=e.y&&n.y<=i.y;return o&&a},isValid:function(){return!(!this.min||!this.max)}},s.bounds=function(t,e){return!t||t instanceof s.Bounds?t:new s.Bounds(t,e)},s.Transformation=function(t,e,i,n){this._a=t,this._b=e,this._c=i,this._d=n},s.Transformation.prototype={transform:function(t,e){return this._transform(t.clone(),e)},_transform:function(t,e){return e=e||1,t.x=e*(this._a*t.x+this._b),t.y=e*(this._c*t.y+this._d),t},untransform:function(t,e){return e=e||1,new s.Point((t.x/e-this._b)/this._a,(t.y/e-this._d)/this._c)}},s.DomUtil={get:function(t){return"string"==typeof t?e.getElementById(t):t},getStyle:function(t,i){var n=t.style[i];if(!n&&t.currentStyle&&(n=t.currentStyle[i]),(!n||"auto"===n)&&e.defaultView){var s=e.defaultView.getComputedStyle(t,null);n=s?s[i]:null}return"auto"===n?null:n},getViewportOffset:function(t){var i,n=0,r=0,o=t,a=e.body,l=e.documentElement;do{if(n+=o.offsetTop||0,r+=o.offsetLeft||0,n+=parseInt(s.DomUtil.getStyle(o,"borderTopWidth"),10)||0,r+=parseInt(s.DomUtil.getStyle(o,"borderLeftWidth"),10)||0,i=s.DomUtil.getStyle(o,"position"),o.offsetParent===a&&"absolute"===i)break;if("fixed"===i){n+=a.scrollTop||l.scrollTop||0,r+=a.scrollLeft||l.scrollLeft||0;break}if("relative"===i&&!o.offsetLeft){var h=s.DomUtil.getStyle(o,"width"),u=s.DomUtil.getStyle(o,"max-width"),p=o.getBoundingClientRect();("none"!==h||"none"!==u)&&(r+=p.left+o.clientLeft),n+=p.top+(a.scrollTop||l.scrollTop||0);break}o=o.offsetParent}while(o);o=t;do{if(o===a)break;n-=o.scrollTop||0,r-=o.scrollLeft||0,o=o.parentNode}while(o);return new s.Point(r,n)},documentIsLtr:function(){return s.DomUtil._docIsLtrCached||(s.DomUtil._docIsLtrCached=!0,s.DomUtil._docIsLtr="ltr"===s.DomUtil.getStyle(e.body,"direction")),s.DomUtil._docIsLtr},create:function(t,i,n){var s=e.createElement(t);return s.className=i,n&&n.appendChild(s),s},hasClass:function(t,e){if(t.classList!==i)return t.classList.contains(e);var n=s.DomUtil._getClass(t);return n.length>0&&new RegExp("(^|\\s)"+e+"(\\s|$)").test(n)},addClass:function(t,e){if(t.classList!==i)for(var n=s.Util.splitWords(e),r=0,o=n.length;o>r;r++)t.classList.add(n[r]);else if(!s.DomUtil.hasClass(t,e)){var a=s.DomUtil._getClass(t);s.DomUtil._setClass(t,(a?a+" ":"")+e)}},removeClass:function(t,e){t.classList!==i?t.classList.remove(e):s.DomUtil._setClass(t,s.Util.trim((" "+s.DomUtil._getClass(t)+" ").replace(" "+e+" "," ")))},_setClass:function(t,e){t.className.baseVal===i?t.className=e:t.className.baseVal=e},_getClass:function(t){return t.className.baseVal===i?t.className:t.className.baseVal},setOpacity:function(t,e){if("opacity"in t.style)t.style.opacity=e;else if("filter"in t.style){var i=!1,n="DXImageTransform.Microsoft.Alpha";try{i=t.filters.item(n)}catch(s){if(1===e)return}e=Math.round(100*e),i?(i.Enabled=100!==e,i.Opacity=e):t.style.filter+=" progid:"+n+"(opacity="+e+")"}},testProp:function(t){for(var i=e.documentElement.style,n=0;n<t.length;n++)if(t[n]in i)return t[n];return!1},getTranslateString:function(t){var e=s.Browser.webkit3d,i="translate"+(e?"3d":"")+"(",n=(e?",0":"")+")";return i+t.x+"px,"+t.y+"px"+n},getScaleString:function(t,e){var i=s.DomUtil.getTranslateString(e.add(e.multiplyBy(-1*t))),n=" scale("+t+") ";return i+n},setPosition:function(t,e,i){t._leaflet_pos=e,!i&&s.Browser.any3d?t.style[s.DomUtil.TRANSFORM]=s.DomUtil.getTranslateString(e):(t.style.left=e.x+"px",t.style.top=e.y+"px")},getPosition:function(t){return t._leaflet_pos}},s.DomUtil.TRANSFORM=s.DomUtil.testProp(["transform","WebkitTransform","OTransform","MozTransform","msTransform"]),s.DomUtil.TRANSITION=s.DomUtil.testProp(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),s.DomUtil.TRANSITION_END="webkitTransition"===s.DomUtil.TRANSITION||"OTransition"===s.DomUtil.TRANSITION?s.DomUtil.TRANSITION+"End":"transitionend",function(){if("onselectstart"in e)s.extend(s.DomUtil,{disableTextSelection:function(){s.DomEvent.on(t,"selectstart",s.DomEvent.preventDefault)},enableTextSelection:function(){s.DomEvent.off(t,"selectstart",s.DomEvent.preventDefault)}});else{var i=s.DomUtil.testProp(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);s.extend(s.DomUtil,{disableTextSelection:function(){if(i){var t=e.documentElement.style;this._userSelect=t[i],t[i]="none"}},enableTextSelection:function(){i&&(e.documentElement.style[i]=this._userSelect,delete this._userSelect)}})}s.extend(s.DomUtil,{disableImageDrag:function(){s.DomEvent.on(t,"dragstart",s.DomEvent.preventDefault)},enableImageDrag:function(){s.DomEvent.off(t,"dragstart",s.DomEvent.preventDefault)}})}(),s.LatLng=function(t,e,n){if(t=parseFloat(t),e=parseFloat(e),isNaN(t)||isNaN(e))throw new Error("Invalid LatLng object: ("+t+", "+e+")");this.lat=t,this.lng=e,n!==i&&(this.alt=parseFloat(n))},s.extend(s.LatLng,{DEG_TO_RAD:Math.PI/180,RAD_TO_DEG:180/Math.PI,MAX_MARGIN:1e-9}),s.LatLng.prototype={equals:function(t){if(!t)return!1;t=s.latLng(t);var e=Math.max(Math.abs(this.lat-t.lat),Math.abs(this.lng-t.lng));return e<=s.LatLng.MAX_MARGIN},toString:function(t){return"LatLng("+s.Util.formatNum(this.lat,t)+", "+s.Util.formatNum(this.lng,t)+")"},distanceTo:function(t){t=s.latLng(t);var e=6378137,i=s.LatLng.DEG_TO_RAD,n=(t.lat-this.lat)*i,r=(t.lng-this.lng)*i,o=this.lat*i,a=t.lat*i,l=Math.sin(n/2),h=Math.sin(r/2),u=l*l+h*h*Math.cos(o)*Math.cos(a);return 2*e*Math.atan2(Math.sqrt(u),Math.sqrt(1-u))},wrap:function(t,e){var i=this.lng;return t=t||-180,e=e||180,i=(i+e)%(e-t)+(t>i||i===e?e:t),new s.LatLng(this.lat,i)}},s.latLng=function(t,e){return t instanceof s.LatLng?t:s.Util.isArray(t)?"number"==typeof t[0]||"string"==typeof t[0]?new s.LatLng(t[0],t[1],t[2]):null:t===i||null===t?t:"object"==typeof t&&"lat"in t?new s.LatLng(t.lat,"lng"in t?t.lng:t.lon):e===i?null:new s.LatLng(t,e)},s.LatLngBounds=function(t,e){if(t)for(var i=e?[t,e]:t,n=0,s=i.length;s>n;n++)this.extend(i[n])},s.LatLngBounds.prototype={extend:function(t){if(!t)return this;var e=s.latLng(t);return t=null!==e?e:s.latLngBounds(t),t instanceof s.LatLng?this._southWest||this._northEast?(this._southWest.lat=Math.min(t.lat,this._southWest.lat),this._southWest.lng=Math.min(t.lng,this._southWest.lng),this._northEast.lat=Math.max(t.lat,this._northEast.lat),this._northEast.lng=Math.max(t.lng,this._northEast.lng)):(this._southWest=new s.LatLng(t.lat,t.lng),this._northEast=new s.LatLng(t.lat,t.lng)):t instanceof s.LatLngBounds&&(this.extend(t._southWest),this.extend(t._northEast)),this},pad:function(t){var e=this._southWest,i=this._northEast,n=Math.abs(e.lat-i.lat)*t,r=Math.abs(e.lng-i.lng)*t;return new s.LatLngBounds(new s.LatLng(e.lat-n,e.lng-r),new s.LatLng(i.lat+n,i.lng+r))},getCenter:function(){return new s.LatLng((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new s.LatLng(this.getNorth(),this.getWest())},getSouthEast:function(){return new s.LatLng(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(t){t="number"==typeof t[0]||t instanceof s.LatLng?s.latLng(t):s.latLngBounds(t);var e,i,n=this._southWest,r=this._northEast;return t instanceof s.LatLngBounds?(e=t.getSouthWest(),i=t.getNorthEast()):e=i=t,e.lat>=n.lat&&i.lat<=r.lat&&e.lng>=n.lng&&i.lng<=r.lng},intersects:function(t){t=s.latLngBounds(t);var e=this._southWest,i=this._northEast,n=t.getSouthWest(),r=t.getNorthEast(),o=r.lat>=e.lat&&n.lat<=i.lat,a=r.lng>=e.lng&&n.lng<=i.lng;return o&&a},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(t){return t?(t=s.latLngBounds(t),this._southWest.equals(t.getSouthWest())&&this._northEast.equals(t.getNorthEast())):!1},isValid:function(){return!(!this._southWest||!this._northEast)}},s.latLngBounds=function(t,e){return!t||t instanceof s.LatLngBounds?t:new s.LatLngBounds(t,e)},s.Projection={},s.Projection.SphericalMercator={MAX_LATITUDE:85.0511287798,project:function(t){var e=s.LatLng.DEG_TO_RAD,i=this.MAX_LATITUDE,n=Math.max(Math.min(i,t.lat),-i),r=t.lng*e,o=n*e;return o=Math.log(Math.tan(Math.PI/4+o/2)),new s.Point(r,o)},unproject:function(t){var e=s.LatLng.RAD_TO_DEG,i=t.x*e,n=(2*Math.atan(Math.exp(t.y))-Math.PI/2)*e;return new s.LatLng(n,i)}},s.Projection.LonLat={project:function(t){return new s.Point(t.lng,t.lat)},unproject:function(t){return new s.LatLng(t.y,t.x)}},s.CRS={latLngToPoint:function(t,e){var i=this.projection.project(t),n=this.scale(e);return this.transformation._transform(i,n)},pointToLatLng:function(t,e){var i=this.scale(e),n=this.transformation.untransform(t,i);return this.projection.unproject(n)},project:function(t){return this.projection.project(t)},scale:function(t){return 256*Math.pow(2,t)},getSize:function(t){var e=this.scale(t);return s.point(e,e)}},s.CRS.Simple=s.extend({},s.CRS,{projection:s.Projection.LonLat,transformation:new s.Transformation(1,0,-1,0),scale:function(t){return Math.pow(2,t)}}),s.CRS.EPSG3857=s.extend({},s.CRS,{code:"EPSG:3857",projection:s.Projection.SphericalMercator,transformation:new s.Transformation(.5/Math.PI,.5,-.5/Math.PI,.5),project:function(t){var e=this.projection.project(t),i=6378137;return e.multiplyBy(i)}}),s.CRS.EPSG900913=s.extend({},s.CRS.EPSG3857,{code:"EPSG:900913"}),s.CRS.EPSG4326=s.extend({},s.CRS,{code:"EPSG:4326",projection:s.Projection.LonLat,transformation:new s.Transformation(1/360,.5,-1/360,.5)}),s.Map=s.Class.extend({includes:s.Mixin.Events,options:{crs:s.CRS.EPSG3857,fadeAnimation:s.DomUtil.TRANSITION&&!s.Browser.android23,trackResize:!0,markerZoomAnimation:s.DomUtil.TRANSITION&&s.Browser.any3d},initialize:function(t,e){e=s.setOptions(this,e),this._initContainer(t),this._initLayout(),this._onResize=s.bind(this._onResize,this),this._initEvents(),e.maxBounds&&this.setMaxBounds(e.maxBounds),e.center&&e.zoom!==i&&this.setView(s.latLng(e.center),e.zoom,{reset:!0}),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._tileLayersNum=0,this.callInitHooks(),this._addLayers(e.layers)},setView:function(t,e){return e=e===i?this.getZoom():e,this._resetView(s.latLng(t),this._limitZoom(e)),this},setZoom:function(t,e){return this._loaded?this.setView(this.getCenter(),t,{zoom:e}):(this._zoom=this._limitZoom(t),this)},zoomIn:function(t,e){return this.setZoom(this._zoom+(t||1),e)},zoomOut:function(t,e){return this.setZoom(this._zoom-(t||1),e)},setZoomAround:function(t,e,i){var n=this.getZoomScale(e),r=this.getSize().divideBy(2),o=t instanceof s.Point?t:this.latLngToContainerPoint(t),a=o.subtract(r).multiplyBy(1-1/n),l=this.containerPointToLatLng(r.add(a));return this.setView(l,e,{zoom:i})},fitBounds:function(t,e){e=e||{},t=t.getBounds?t.getBounds():s.latLngBounds(t);var i=s.point(e.paddingTopLeft||e.padding||[0,0]),n=s.point(e.paddingBottomRight||e.padding||[0,0]),r=this.getBoundsZoom(t,!1,i.add(n)),o=n.subtract(i).divideBy(2),a=this.project(t.getSouthWest(),r),l=this.project(t.getNorthEast(),r),h=this.unproject(a.add(l).divideBy(2).add(o),r);return r=e&&e.maxZoom?Math.min(e.maxZoom,r):r,this.setView(h,r,e)},fitWorld:function(t){return this.fitBounds([[-90,-180],[90,180]],t)},panTo:function(t,e){return this.setView(t,this._zoom,{pan:e})},panBy:function(t){return this.fire("movestart"),this._rawPanBy(s.point(t)),this.fire("move"),this.fire("moveend")},setMaxBounds:function(t){return t=s.latLngBounds(t),this.options.maxBounds=t,t?(this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds,this)):this.off("moveend",this._panInsideMaxBounds,this)},panInsideBounds:function(t,e){var i=this.getCenter(),n=this._limitCenter(i,this._zoom,t);return i.equals(n)?this:this.panTo(n,e)},addLayer:function(t){var e=s.stamp(t);return this._layers[e]?this:(this._layers[e]=t,!t.options||isNaN(t.options.maxZoom)&&isNaN(t.options.minZoom)||(this._zoomBoundLayers[e]=t,this._updateZoomLevels()),this.options.zoomAnimation&&s.TileLayer&&t instanceof s.TileLayer&&(this._tileLayersNum++,this._tileLayersToLoad++,t.on("load",this._onTileLayerLoad,this)),this._loaded&&this._layerAdd(t),this)},removeLayer:function(t){var e=s.stamp(t);return this._layers[e]?(this._loaded&&t.onRemove(this),delete this._layers[e],this._loaded&&this.fire("layerremove",{layer:t}),this._zoomBoundLayers[e]&&(delete this._zoomBoundLayers[e],this._updateZoomLevels()),this.options.zoomAnimation&&s.TileLayer&&t instanceof s.TileLayer&&(this._tileLayersNum--,this._tileLayersToLoad--,t.off("load",this._onTileLayerLoad,this)),this):this},hasLayer:function(t){return t?s.stamp(t)in this._layers:!1},eachLayer:function(t,e){for(var i in this._layers)t.call(e,this._layers[i]);return this},invalidateSize:function(t){if(!this._loaded)return this;t=s.extend({animate:!1,pan:!0},t===!0?{animate:!0}:t);var e=this.getSize();this._sizeChanged=!0,this._initialCenter=null;var i=this.getSize(),n=e.divideBy(2).round(),r=i.divideBy(2).round(),o=n.subtract(r);return o.x||o.y?(t.animate&&t.pan?this.panBy(o):(t.pan&&this._rawPanBy(o),this.fire("move"),t.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(s.bind(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:e,newSize:i})):this},addHandler:function(t,e){if(!e)return this;var i=this[t]=new e(this);return this._handlers.push(i),this.options[t]&&i.enable(),this},remove:function(){this._loaded&&this.fire("unload"),this._initEvents("off");try{delete this._container._leaflet}catch(t){this._container._leaflet=i}return this._clearPanes(),this._clearControlPos&&this._clearControlPos(),this._clearHandlers(),this},getCenter:function(){return this._checkIfLoaded(),this._initialCenter&&!this._moved()?this._initialCenter:this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var t=this.getPixelBounds(),e=this.unproject(t.getBottomLeft()),i=this.unproject(t.getTopRight());return new s.LatLngBounds(e,i)},getMinZoom:function(){return this.options.minZoom===i?this._layersMinZoom===i?0:this._layersMinZoom:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===i?this._layersMaxZoom===i?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(t,e,i){t=s.latLngBounds(t);var n,r=this.getMinZoom()-(e?1:0),o=this.getMaxZoom(),a=this.getSize(),l=t.getNorthWest(),h=t.getSouthEast(),u=!0;i=s.point(i||[0,0]);do r++,n=this.project(h,r).subtract(this.project(l,r)).add(i),u=e?n.x<a.x||n.y<a.y:a.contains(n);while(u&&o>=r);return u&&e?null:e?r:r-1},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new s.Point(this._container.clientWidth,this._container.clientHeight),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(){var t=this._getTopLeftPoint();return new s.Bounds(t,t.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._initialTopLeftPoint},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(t){var e=this.options.crs;return e.scale(t)/e.scale(this._zoom)},getScaleZoom:function(t){return this._zoom+Math.log(t)/Math.LN2},project:function(t,e){return e=e===i?this._zoom:e,this.options.crs.latLngToPoint(s.latLng(t),e)},unproject:function(t,e){return e=e===i?this._zoom:e,this.options.crs.pointToLatLng(s.point(t),e)},layerPointToLatLng:function(t){var e=s.point(t).add(this.getPixelOrigin());return this.unproject(e)},latLngToLayerPoint:function(t){var e=this.project(s.latLng(t))._round();return e._subtract(this.getPixelOrigin())},containerPointToLayerPoint:function(t){return s.point(t).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(t){return s.point(t).add(this._getMapPanePos())},containerPointToLatLng:function(t){var e=this.containerPointToLayerPoint(s.point(t));return this.layerPointToLatLng(e)},latLngToContainerPoint:function(t){return this.layerPointToContainerPoint(this.latLngToLayerPoint(s.latLng(t)))},mouseEventToContainerPoint:function(t){return s.DomEvent.getMousePosition(t,this._container)},mouseEventToLayerPoint:function(t){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(t))},mouseEventToLatLng:function(t){return this.layerPointToLatLng(this.mouseEventToLayerPoint(t))},_initContainer:function(t){var e=this._container=s.DomUtil.get(t);if(!e)throw new Error("Map container not found.");if(e._leaflet)throw new Error("Map container is already initialized.");e._leaflet=!0},_initLayout:function(){var t=this._container;s.DomUtil.addClass(t,"leaflet-container"+(s.Browser.touch?" leaflet-touch":"")+(s.Browser.retina?" leaflet-retina":"")+(s.Browser.ielt9?" leaflet-oldie":"")+(this.options.fadeAnimation?" leaflet-fade-anim":""));var e=s.DomUtil.getStyle(t,"position");"absolute"!==e&&"relative"!==e&&"fixed"!==e&&(t.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var t=this._panes={};this._mapPane=t.mapPane=this._createPane("leaflet-map-pane",this._container),this._tilePane=t.tilePane=this._createPane("leaflet-tile-pane",this._mapPane),t.objectsPane=this._createPane("leaflet-objects-pane",this._mapPane),t.shadowPane=this._createPane("leaflet-shadow-pane"),t.overlayPane=this._createPane("leaflet-overlay-pane"),t.markerPane=this._createPane("leaflet-marker-pane"),t.popupPane=this._createPane("leaflet-popup-pane");var e=" leaflet-zoom-hide";this.options.markerZoomAnimation||(s.DomUtil.addClass(t.markerPane,e),s.DomUtil.addClass(t.shadowPane,e),s.DomUtil.addClass(t.popupPane,e))},_createPane:function(t,e){return s.DomUtil.create("div",t,e||this._panes.objectsPane)},_clearPanes:function(){this._container.removeChild(this._mapPane)},_addLayers:function(t){t=t?s.Util.isArray(t)?t:[t]:[];for(var e=0,i=t.length;i>e;e++)this.addLayer(t[e])},_resetView:function(t,e,i,n){var r=this._zoom!==e;n||(this.fire("movestart"),r&&this.fire("zoomstart")),this._zoom=e,this._initialCenter=t,this._initialTopLeftPoint=this._getNewTopLeftPoint(t),i?this._initialTopLeftPoint._add(this._getMapPanePos()):s.DomUtil.setPosition(this._mapPane,new s.Point(0,0)),this._tileLayersToLoad=this._tileLayersNum;var o=!this._loaded;this._loaded=!0,this.fire("viewreset",{hard:!i}),o&&(this.fire("load"),this.eachLayer(this._layerAdd,this)),this.fire("move"),(r||n)&&this.fire("zoomend"),this.fire("moveend",{hard:!i})},_rawPanBy:function(t){s.DomUtil.setPosition(this._mapPane,this._getMapPanePos().subtract(t))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_updateZoomLevels:function(){var t,e=1/0,n=-1/0,s=this._getZoomSpan();for(t in this._zoomBoundLayers){var r=this._zoomBoundLayers[t];isNaN(r.options.minZoom)||(e=Math.min(e,r.options.minZoom)),isNaN(r.options.maxZoom)||(n=Math.max(n,r.options.maxZoom))}t===i?this._layersMaxZoom=this._layersMinZoom=i:(this._layersMaxZoom=n,this._layersMinZoom=e),s!==this._getZoomSpan()&&this.fire("zoomlevelschange")},_panInsideMaxBounds:function(){this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(e){if(s.DomEvent){e=e||"on",s.DomEvent[e](this._container,"click",this._onMouseClick,this);var i,n,r=["dblclick","mousedown","mouseup","mouseenter","mouseleave","mousemove","contextmenu"];for(i=0,n=r.length;n>i;i++)s.DomEvent[e](this._container,r[i],this._fireMouseEvent,this);this.options.trackResize&&s.DomEvent[e](t,"resize",this._onResize,this)}},_onResize:function(){s.Util.cancelAnimFrame(this._resizeRequest),this._resizeRequest=s.Util.requestAnimFrame(function(){this.invalidateSize({debounceMoveend:!0})},this,!1,this._container)},_onMouseClick:function(t){!this._loaded||!t._simulated&&(this.dragging&&this.dragging.moved()||this.boxZoom&&this.boxZoom.moved())||s.DomEvent._skipped(t)||(this.fire("preclick"),this._fireMouseEvent(t))},_fireMouseEvent:function(t){if(this._loaded&&!s.DomEvent._skipped(t)){var e=t.type;if(e="mouseenter"===e?"mouseover":"mouseleave"===e?"mouseout":e,this.hasEventListeners(e)){"contextmenu"===e&&s.DomEvent.preventDefault(t);var i=this.mouseEventToContainerPoint(t),n=this.containerPointToLayerPoint(i),r=this.layerPointToLatLng(n);this.fire(e,{latlng:r,layerPoint:n,containerPoint:i,originalEvent:t})}}},_onTileLayerLoad:function(){this._tileLayersToLoad--,this._tileLayersNum&&!this._tileLayersToLoad&&this.fire("tilelayersload")},_clearHandlers:function(){for(var t=0,e=this._handlers.length;e>t;t++)this._handlers[t].disable()},whenReady:function(t,e){return this._loaded?t.call(e||this,this):this.on("load",t,e),this},_layerAdd:function(t){t.onAdd(this),this.fire("layeradd",{layer:t})},_getMapPanePos:function(){return s.DomUtil.getPosition(this._mapPane)},_moved:function(){var t=this._getMapPanePos();return t&&!t.equals([0,0])},_getTopLeftPoint:function(){return this.getPixelOrigin().subtract(this._getMapPanePos())},_getNewTopLeftPoint:function(t,e){var i=this.getSize()._divideBy(2);return this.project(t,e)._subtract(i)._round()},_latLngToNewLayerPoint:function(t,e,i){var n=this._getNewTopLeftPoint(i,e).add(this._getMapPanePos());return this.project(t,e)._subtract(n)},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(t){return this.latLngToLayerPoint(t).subtract(this._getCenterLayerPoint())},_limitCenter:function(t,e,i){if(!i)return t;var n=this.project(t,e),r=this.getSize().divideBy(2),o=new s.Bounds(n.subtract(r),n.add(r)),a=this._getBoundsOffset(o,i,e);return this.unproject(n.add(a),e)},_limitOffset:function(t,e){if(!e)return t;var i=this.getPixelBounds(),n=new s.Bounds(i.min.add(t),i.max.add(t));return t.add(this._getBoundsOffset(n,e))},_getBoundsOffset:function(t,e,i){var n=this.project(e.getNorthWest(),i).subtract(t.min),r=this.project(e.getSouthEast(),i).subtract(t.max),o=this._rebound(n.x,-r.x),a=this._rebound(n.y,-r.y);return new s.Point(o,a)},_rebound:function(t,e){return t+e>0?Math.round(t-e)/2:Math.max(0,Math.ceil(t))-Math.max(0,Math.floor(e))},_limitZoom:function(t){var e=this.getMinZoom(),i=this.getMaxZoom();return Math.max(e,Math.min(i,t))}}),s.map=function(t,e){return new s.Map(t,e)},s.Projection.Mercator={MAX_LATITUDE:85.0840591556,R_MINOR:6356752.314245179,R_MAJOR:6378137,project:function(t){var e=s.LatLng.DEG_TO_RAD,i=this.MAX_LATITUDE,n=Math.max(Math.min(i,t.lat),-i),r=this.R_MAJOR,o=this.R_MINOR,a=t.lng*e*r,l=n*e,h=o/r,u=Math.sqrt(1-h*h),p=u*Math.sin(l);p=Math.pow((1-p)/(1+p),.5*u);var c=Math.tan(.5*(.5*Math.PI-l))/p;return l=-r*Math.log(c),new s.Point(a,l)},unproject:function(t){for(var e,i=s.LatLng.RAD_TO_DEG,n=this.R_MAJOR,r=this.R_MINOR,o=t.x*i/n,a=r/n,l=Math.sqrt(1-a*a),h=Math.exp(-t.y/n),u=Math.PI/2-2*Math.atan(h),p=15,c=1e-7,d=p,m=.1;Math.abs(m)>c&&--d>0;)e=l*Math.sin(u),m=Math.PI/2-2*Math.atan(h*Math.pow((1-e)/(1+e),.5*l))-u,u+=m;return new s.LatLng(u*i,o)}},s.CRS.EPSG3395=s.extend({},s.CRS,{code:"EPSG:3395",projection:s.Projection.Mercator,transformation:function(){var t=s.Projection.Mercator,e=t.R_MAJOR,i=.5/(Math.PI*e);return new s.Transformation(i,.5,-i,.5)}()}),s.TileLayer=s.Class.extend({includes:s.Mixin.Events,options:{minZoom:0,maxZoom:18,tileSize:256,subdomains:"abc",errorTileUrl:"",attribution:"",zoomOffset:0,opacity:1,unloadInvisibleTiles:s.Browser.mobile,updateWhenIdle:s.Browser.mobile},initialize:function(t,e){e=s.setOptions(this,e),e.detectRetina&&s.Browser.retina&&e.maxZoom>0&&(e.tileSize=Math.floor(e.tileSize/2),e.zoomOffset++,e.minZoom>0&&e.minZoom--,this.options.maxZoom--),e.bounds&&(e.bounds=s.latLngBounds(e.bounds)),this._url=t;var i=this.options.subdomains;"string"==typeof i&&(this.options.subdomains=i.split(""))},onAdd:function(t){this._map=t,this._animated=t._zoomAnimated,this._initContainer(),t.on({viewreset:this._reset,moveend:this._update},this),this._animated&&t.on({zoomanim:this._animateZoom,zoomend:this._endZoomAnim},this),this.options.updateWhenIdle||(this._limitedUpdate=s.Util.limitExecByInterval(this._update,150,this),t.on("move",this._limitedUpdate,this)),this._reset(),this._update()},addTo:function(t){return t.addLayer(this),this},onRemove:function(t){this._container.parentNode.removeChild(this._container),t.off({viewreset:this._reset,moveend:this._update},this),this._animated&&t.off({zoomanim:this._animateZoom,zoomend:this._endZoomAnim},this),this.options.updateWhenIdle||t.off("move",this._limitedUpdate,this),this._container=null,this._map=null},bringToFront:function(){var t=this._map._panes.tilePane;return this._container&&(t.appendChild(this._container),this._setAutoZIndex(t,Math.max)),this},bringToBack:function(){var t=this._map._panes.tilePane;
return this._container&&(t.insertBefore(this._container,t.firstChild),this._setAutoZIndex(t,Math.min)),this},getAttribution:function(){return this.options.attribution},getContainer:function(){return this._container},setOpacity:function(t){return this.options.opacity=t,this._map&&this._updateOpacity(),this},setZIndex:function(t){return this.options.zIndex=t,this._updateZIndex(),this},setUrl:function(t,e){return this._url=t,e||this.redraw(),this},redraw:function(){return this._map&&(this._reset({hard:!0}),this._update()),this},_updateZIndex:function(){this._container&&this.options.zIndex!==i&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(t,e){var i,n,s,r=t.children,o=-e(1/0,-1/0);for(n=0,s=r.length;s>n;n++)r[n]!==this._container&&(i=parseInt(r[n].style.zIndex,10),isNaN(i)||(o=e(o,i)));this.options.zIndex=this._container.style.zIndex=(isFinite(o)?o:0)+e(1,-1)},_updateOpacity:function(){var t,e=this._tiles;if(s.Browser.ielt9)for(t in e)s.DomUtil.setOpacity(e[t],this.options.opacity);else s.DomUtil.setOpacity(this._container,this.options.opacity)},_initContainer:function(){var t=this._map._panes.tilePane;if(!this._container){if(this._container=s.DomUtil.create("div","leaflet-layer"),this._updateZIndex(),this._animated){var e="leaflet-tile-container";this._bgBuffer=s.DomUtil.create("div",e,this._container),this._tileContainer=s.DomUtil.create("div",e,this._container)}else this._tileContainer=this._container;t.appendChild(this._container),this.options.opacity<1&&this._updateOpacity()}},_reset:function(t){for(var e in this._tiles)this.fire("tileunload",{tile:this._tiles[e]});this._tiles={},this._tilesToLoad=0,this.options.reuseTiles&&(this._unusedTiles=[]),this._tileContainer.innerHTML="",this._animated&&t&&t.hard&&this._clearBgBuffer(),this._initContainer()},_getTileSize:function(){var t=this._map,e=t.getZoom()+this.options.zoomOffset,i=this.options.maxNativeZoom,n=this.options.tileSize;return i&&e>i&&(n=Math.round(t.getZoomScale(e)/t.getZoomScale(i)*n)),n},_update:function(){if(this._map){var t=this._map,e=t.getPixelBounds(),i=t.getZoom(),n=this._getTileSize();if(!(i>this.options.maxZoom||i<this.options.minZoom)){var r=s.bounds(e.min.divideBy(n)._floor(),e.max.divideBy(n)._floor());this._addTilesFromCenterOut(r),(this.options.unloadInvisibleTiles||this.options.reuseTiles)&&this._removeOtherTiles(r)}}},_addTilesFromCenterOut:function(t){var i,n,r,o=[],a=t.getCenter();for(i=t.min.y;i<=t.max.y;i++)for(n=t.min.x;n<=t.max.x;n++)r=new s.Point(n,i),this._tileShouldBeLoaded(r)&&o.push(r);var l=o.length;if(0!==l){o.sort(function(t,e){return t.distanceTo(a)-e.distanceTo(a)});var h=e.createDocumentFragment();for(this._tilesToLoad||this.fire("loading"),this._tilesToLoad+=l,n=0;l>n;n++)this._addTile(o[n],h);this._tileContainer.appendChild(h)}},_tileShouldBeLoaded:function(t){if(t.x+":"+t.y in this._tiles)return!1;var e=this.options;if(!e.continuousWorld){var i=this._getWrapTileNum();if(e.noWrap&&(t.x<0||t.x>=i.x)||t.y<0||t.y>=i.y)return!1}if(e.bounds){var n=e.tileSize,s=t.multiplyBy(n),r=s.add([n,n]),o=this._map.unproject(s),a=this._map.unproject(r);if(e.continuousWorld||e.noWrap||(o=o.wrap(),a=a.wrap()),!e.bounds.intersects([o,a]))return!1}return!0},_removeOtherTiles:function(t){var e,i,n,s;for(s in this._tiles)e=s.split(":"),i=parseInt(e[0],10),n=parseInt(e[1],10),(i<t.min.x||i>t.max.x||n<t.min.y||n>t.max.y)&&this._removeTile(s)},_removeTile:function(t){var e=this._tiles[t];this.fire("tileunload",{tile:e,url:e.src}),this.options.reuseTiles?(s.DomUtil.removeClass(e,"leaflet-tile-loaded"),this._unusedTiles.push(e)):e.parentNode===this._tileContainer&&this._tileContainer.removeChild(e),s.Browser.android||(e.onload=null,e.src=s.Util.emptyImageUrl),delete this._tiles[t]},_addTile:function(t,e){var i=this._getTilePos(t),n=this._getTile();s.DomUtil.setPosition(n,i,s.Browser.chrome),this._tiles[t.x+":"+t.y]=n,this._loadTile(n,t),n.parentNode!==this._tileContainer&&e.appendChild(n)},_getZoomForUrl:function(){var t=this.options,e=this._map.getZoom();return t.zoomReverse&&(e=t.maxZoom-e),e+=t.zoomOffset,t.maxNativeZoom?Math.min(e,t.maxNativeZoom):e},_getTilePos:function(t){var e=this._map.getPixelOrigin(),i=this._getTileSize();return t.multiplyBy(i).subtract(e)},getTileUrl:function(t){return s.Util.template(this._url,s.extend({s:this._getSubdomain(t),z:t.z,x:t.x,y:t.y},this.options))},_getWrapTileNum:function(){var t=this._map.options.crs,e=t.getSize(this._map.getZoom());return e.divideBy(this._getTileSize())._floor()},_adjustTilePoint:function(t){var e=this._getWrapTileNum();this.options.continuousWorld||this.options.noWrap||(t.x=(t.x%e.x+e.x)%e.x),this.options.tms&&(t.y=e.y-t.y-1),t.z=this._getZoomForUrl()},_getSubdomain:function(t){var e=Math.abs(t.x+t.y)%this.options.subdomains.length;return this.options.subdomains[e]},_getTile:function(){if(this.options.reuseTiles&&this._unusedTiles.length>0){var t=this._unusedTiles.pop();return this._resetTile(t),t}return this._createTile()},_resetTile:function(){},_createTile:function(){var t=s.DomUtil.create("img","leaflet-tile");return t.style.width=t.style.height=this._getTileSize()+"px",t.galleryimg="no",t.onselectstart=t.onmousemove=s.Util.falseFn,s.Browser.ielt9&&this.options.opacity!==i&&s.DomUtil.setOpacity(t,this.options.opacity),s.Browser.mobileWebkit3d&&(t.style.WebkitBackfaceVisibility="hidden"),t},_loadTile:function(t,e){t._layer=this,t.onload=this._tileOnLoad,t.onerror=this._tileOnError,this._adjustTilePoint(e),t.src=this.getTileUrl(e),this.fire("tileloadstart",{tile:t,url:t.src})},_tileLoaded:function(){this._tilesToLoad--,this._animated&&s.DomUtil.addClass(this._tileContainer,"leaflet-zoom-animated"),this._tilesToLoad||(this.fire("load"),this._animated&&(clearTimeout(this._clearBgBufferTimer),this._clearBgBufferTimer=setTimeout(s.bind(this._clearBgBuffer,this),500)))},_tileOnLoad:function(){var t=this._layer;this.src!==s.Util.emptyImageUrl&&(s.DomUtil.addClass(this,"leaflet-tile-loaded"),t.fire("tileload",{tile:this,url:this.src})),t._tileLoaded()},_tileOnError:function(){var t=this._layer;t.fire("tileerror",{tile:this,url:this.src});var e=t.options.errorTileUrl;e&&(this.src=e),t._tileLoaded()}}),s.tileLayer=function(t,e){return new s.TileLayer(t,e)},s.TileLayer.WMS=s.TileLayer.extend({defaultWmsParams:{service:"WMS",request:"GetMap",version:"1.1.1",layers:"",styles:"",format:"image/jpeg",transparent:!1},initialize:function(t,e){this._url=t;var i=s.extend({},this.defaultWmsParams),n=e.tileSize||this.options.tileSize;i.width=i.height=e.detectRetina&&s.Browser.retina?2*n:n;for(var r in e)this.options.hasOwnProperty(r)||"crs"===r||(i[r]=e[r]);this.wmsParams=i,s.setOptions(this,e)},onAdd:function(t){this._crs=this.options.crs||t.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var e=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[e]=this._crs.code,s.TileLayer.prototype.onAdd.call(this,t)},getTileUrl:function(t){var e=this._map,i=this.options.tileSize,n=t.multiplyBy(i),r=n.add([i,i]),o=this._crs.project(e.unproject(n,t.z)),a=this._crs.project(e.unproject(r,t.z)),l=this._wmsVersion>=1.3&&this._crs===s.CRS.EPSG4326?[a.y,o.x,o.y,a.x].join(","):[o.x,a.y,a.x,o.y].join(","),h=s.Util.template(this._url,{s:this._getSubdomain(t)});return h+s.Util.getParamString(this.wmsParams,h,!0)+"&BBOX="+l},setParams:function(t,e){return s.extend(this.wmsParams,t),e||this.redraw(),this}}),s.tileLayer.wms=function(t,e){return new s.TileLayer.WMS(t,e)},s.TileLayer.Canvas=s.TileLayer.extend({options:{async:!1},initialize:function(t){s.setOptions(this,t)},redraw:function(){this._map&&(this._reset({hard:!0}),this._update());for(var t in this._tiles)this._redrawTile(this._tiles[t]);return this},_redrawTile:function(t){this.drawTile(t,t._tilePoint,this._map._zoom)},_createTile:function(){var t=s.DomUtil.create("canvas","leaflet-tile");return t.width=t.height=this.options.tileSize,t.onselectstart=t.onmousemove=s.Util.falseFn,t},_loadTile:function(t,e){t._layer=this,t._tilePoint=e,this._redrawTile(t),this.options.async||this.tileDrawn(t)},drawTile:function(){},tileDrawn:function(t){this._tileOnLoad.call(t)}}),s.tileLayer.canvas=function(t){return new s.TileLayer.Canvas(t)},s.ImageOverlay=s.Class.extend({includes:s.Mixin.Events,options:{opacity:1},initialize:function(t,e,i){this._url=t,this._bounds=s.latLngBounds(e),s.setOptions(this,i)},onAdd:function(t){this._map=t,this._image||this._initImage(),t._panes.overlayPane.appendChild(this._image),t.on("viewreset",this._reset,this),t.options.zoomAnimation&&s.Browser.any3d&&t.on("zoomanim",this._animateZoom,this),this._reset()},onRemove:function(t){t.getPanes().overlayPane.removeChild(this._image),t.off("viewreset",this._reset,this),t.options.zoomAnimation&&t.off("zoomanim",this._animateZoom,this)},addTo:function(t){return t.addLayer(this),this},setOpacity:function(t){return this.options.opacity=t,this._updateOpacity(),this},bringToFront:function(){return this._image&&this._map._panes.overlayPane.appendChild(this._image),this},bringToBack:function(){var t=this._map._panes.overlayPane;return this._image&&t.insertBefore(this._image,t.firstChild),this},setUrl:function(t){this._url=t,this._image.src=this._url},getAttribution:function(){return this.options.attribution},_initImage:function(){this._image=s.DomUtil.create("img","leaflet-image-layer"),this._map.options.zoomAnimation&&s.Browser.any3d?s.DomUtil.addClass(this._image,"leaflet-zoom-animated"):s.DomUtil.addClass(this._image,"leaflet-zoom-hide"),this._updateOpacity(),s.extend(this._image,{galleryimg:"no",onselectstart:s.Util.falseFn,onmousemove:s.Util.falseFn,onload:s.bind(this._onImageLoad,this),src:this._url})},_animateZoom:function(t){var e=this._map,i=this._image,n=e.getZoomScale(t.zoom),r=this._bounds.getNorthWest(),o=this._bounds.getSouthEast(),a=e._latLngToNewLayerPoint(r,t.zoom,t.center),l=e._latLngToNewLayerPoint(o,t.zoom,t.center)._subtract(a),h=a._add(l._multiplyBy(.5*(1-1/n)));i.style[s.DomUtil.TRANSFORM]=s.DomUtil.getTranslateString(h)+" scale("+n+") "},_reset:function(){var t=this._image,e=this._map.latLngToLayerPoint(this._bounds.getNorthWest()),i=this._map.latLngToLayerPoint(this._bounds.getSouthEast())._subtract(e);s.DomUtil.setPosition(t,e),t.style.width=i.x+"px",t.style.height=i.y+"px"},_onImageLoad:function(){this.fire("load")},_updateOpacity:function(){s.DomUtil.setOpacity(this._image,this.options.opacity)}}),s.imageOverlay=function(t,e,i){return new s.ImageOverlay(t,e,i)},s.Icon=s.Class.extend({options:{className:""},initialize:function(t){s.setOptions(this,t)},createIcon:function(t){return this._createIcon("icon",t)},createShadow:function(t){return this._createIcon("shadow",t)},_createIcon:function(t,e){var i=this._getIconUrl(t);if(!i){if("icon"===t)throw new Error("iconUrl not set in Icon options (see the docs).");return null}var n;return n=e&&"IMG"===e.tagName?this._createImg(i,e):this._createImg(i),this._setIconStyles(n,t),n},_setIconStyles:function(t,e){var i,n=this.options,r=s.point(n[e+"Size"]);i=s.point("shadow"===e?n.shadowAnchor||n.iconAnchor:n.iconAnchor),!i&&r&&(i=r.divideBy(2,!0)),t.className="leaflet-marker-"+e+" "+n.className,i&&(t.style.marginLeft=-i.x+"px",t.style.marginTop=-i.y+"px"),r&&(t.style.width=r.x+"px",t.style.height=r.y+"px")},_createImg:function(t,i){return i=i||e.createElement("img"),i.src=t,i},_getIconUrl:function(t){return s.Browser.retina&&this.options[t+"RetinaUrl"]?this.options[t+"RetinaUrl"]:this.options[t+"Url"]}}),s.icon=function(t){return new s.Icon(t)},s.Icon.Default=s.Icon.extend({options:{iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]},_getIconUrl:function(t){var e=t+"Url";if(this.options[e])return this.options[e];s.Browser.retina&&"icon"===t&&(t+="-2x");var i=s.Icon.Default.imagePath;if(!i)throw new Error("Couldn't autodetect L.Icon.Default.imagePath, set it manually.");return i+"/marker-"+t+".png"}}),s.Icon.Default.imagePath=function(){var t,i,n,s,r,o=e.getElementsByTagName("script"),a=/[\/^]leaflet[\-\._]?([\w\-\._]*)\.js\??/;for(t=0,i=o.length;i>t;t++)if(n=o[t].src,s=n.match(a))return r=n.split(a)[0],(r?r+"/":"")+"images"}(),s.Marker=s.Class.extend({includes:s.Mixin.Events,options:{icon:new s.Icon.Default,title:"",alt:"",clickable:!0,draggable:!1,keyboard:!0,zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250},initialize:function(t,e){s.setOptions(this,e),this._latlng=s.latLng(t)},onAdd:function(t){this._map=t,t.on("viewreset",this.update,this),this._initIcon(),this.update(),this.fire("add"),t.options.zoomAnimation&&t.options.markerZoomAnimation&&t.on("zoomanim",this._animateZoom,this)},addTo:function(t){return t.addLayer(this),this},onRemove:function(t){this.dragging&&this.dragging.disable(),this._removeIcon(),this._removeShadow(),this.fire("remove"),t.off({viewreset:this.update,zoomanim:this._animateZoom},this),this._map=null},getLatLng:function(){return this._latlng},setLatLng:function(t){return this._latlng=s.latLng(t),this.update(),this.fire("move",{latlng:this._latlng})},setZIndexOffset:function(t){return this.options.zIndexOffset=t,this.update(),this},setIcon:function(t){return this.options.icon=t,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup),this},update:function(){if(this._icon){var t=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(t)}return this},_initIcon:function(){var t=this.options,e=this._map,i=e.options.zoomAnimation&&e.options.markerZoomAnimation,n=i?"leaflet-zoom-animated":"leaflet-zoom-hide",r=t.icon.createIcon(this._icon),o=!1;r!==this._icon&&(this._icon&&this._removeIcon(),o=!0,t.title&&(r.title=t.title),t.alt&&(r.alt=t.alt)),s.DomUtil.addClass(r,n),t.keyboard&&(r.tabIndex="0"),this._icon=r,this._initInteraction(),t.riseOnHover&&s.DomEvent.on(r,"mouseover",this._bringToFront,this).on(r,"mouseout",this._resetZIndex,this);var a=t.icon.createShadow(this._shadow),l=!1;a!==this._shadow&&(this._removeShadow(),l=!0),a&&s.DomUtil.addClass(a,n),this._shadow=a,t.opacity<1&&this._updateOpacity();var h=this._map._panes;o&&h.markerPane.appendChild(this._icon),a&&l&&h.shadowPane.appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&s.DomEvent.off(this._icon,"mouseover",this._bringToFront).off(this._icon,"mouseout",this._resetZIndex),this._map._panes.markerPane.removeChild(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&this._map._panes.shadowPane.removeChild(this._shadow),this._shadow=null},_setPos:function(t){s.DomUtil.setPosition(this._icon,t),this._shadow&&s.DomUtil.setPosition(this._shadow,t),this._zIndex=t.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(t){this._icon.style.zIndex=this._zIndex+t},_animateZoom:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center).round();this._setPos(e)},_initInteraction:function(){if(this.options.clickable){var t=this._icon,e=["dblclick","mousedown","mouseover","mouseout","contextmenu"];s.DomUtil.addClass(t,"leaflet-clickable"),s.DomEvent.on(t,"click",this._onMouseClick,this),s.DomEvent.on(t,"keypress",this._onKeyPress,this);for(var i=0;i<e.length;i++)s.DomEvent.on(t,e[i],this._fireMouseEvent,this);s.Handler.MarkerDrag&&(this.dragging=new s.Handler.MarkerDrag(this),this.options.draggable&&this.dragging.enable())}},_onMouseClick:function(t){var e=this.dragging&&this.dragging.moved();(this.hasEventListeners(t.type)||e)&&s.DomEvent.stopPropagation(t),e||(this.dragging&&this.dragging._enabled||!this._map.dragging||!this._map.dragging.moved())&&this.fire(t.type,{originalEvent:t,latlng:this._latlng})},_onKeyPress:function(t){13===t.keyCode&&this.fire("click",{originalEvent:t,latlng:this._latlng})},_fireMouseEvent:function(t){this.fire(t.type,{originalEvent:t,latlng:this._latlng}),"contextmenu"===t.type&&this.hasEventListeners(t.type)&&s.DomEvent.preventDefault(t),"mousedown"!==t.type?s.DomEvent.stopPropagation(t):s.DomEvent.preventDefault(t)},setOpacity:function(t){return this.options.opacity=t,this._map&&this._updateOpacity(),this},_updateOpacity:function(){s.DomUtil.setOpacity(this._icon,this.options.opacity),this._shadow&&s.DomUtil.setOpacity(this._shadow,this.options.opacity)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)}}),s.marker=function(t,e){return new s.Marker(t,e)},s.DivIcon=s.Icon.extend({options:{iconSize:[12,12],className:"leaflet-div-icon",html:!1},createIcon:function(t){var i=t&&"DIV"===t.tagName?t:e.createElement("div"),n=this.options;return i.innerHTML=n.html!==!1?n.html:"",n.bgPos&&(i.style.backgroundPosition=-n.bgPos.x+"px "+-n.bgPos.y+"px"),this._setIconStyles(i,"icon"),i},createShadow:function(){return null}}),s.divIcon=function(t){return new s.DivIcon(t)},s.Map.mergeOptions({closePopupOnClick:!0}),s.Popup=s.Class.extend({includes:s.Mixin.Events,options:{minWidth:50,maxWidth:300,autoPan:!0,closeButton:!0,offset:[0,7],autoPanPadding:[5,5],keepInView:!1,className:"",zoomAnimation:!0},initialize:function(t,e){s.setOptions(this,t),this._source=e,this._animated=s.Browser.any3d&&this.options.zoomAnimation,this._isOpen=!1},onAdd:function(t){this._map=t,this._container||this._initLayout();var e=t.options.fadeAnimation;e&&s.DomUtil.setOpacity(this._container,0),t._panes.popupPane.appendChild(this._container),t.on(this._getEvents(),this),this.update(),e&&s.DomUtil.setOpacity(this._container,1),this.fire("open"),t.fire("popupopen",{popup:this}),this._source&&this._source.fire("popupopen",{popup:this})},addTo:function(t){return t.addLayer(this),this},openOn:function(t){return t.openPopup(this),this},onRemove:function(t){t._panes.popupPane.removeChild(this._container),s.Util.falseFn(this._container.offsetWidth),t.off(this._getEvents(),this),t.options.fadeAnimation&&s.DomUtil.setOpacity(this._container,0),this._map=null,this.fire("close"),t.fire("popupclose",{popup:this}),this._source&&this._source.fire("popupclose",{popup:this})},getLatLng:function(){return this._latlng},setLatLng:function(t){return this._latlng=s.latLng(t),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(t){return this._content=t,this.update(),this},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},_getEvents:function(){var t={viewreset:this._updatePosition};return this._animated&&(t.zoomanim=this._zoomAnimation),("closeOnClick"in this.options?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(t.preclick=this._close),this.options.keepInView&&(t.moveend=this._adjustPan),t},_close:function(){this._map&&this._map.closePopup(this)},_initLayout:function(){var t,e="leaflet-popup",i=e+" "+this.options.className+" leaflet-zoom-"+(this._animated?"animated":"hide"),n=this._container=s.DomUtil.create("div",i);this.options.closeButton&&(t=this._closeButton=s.DomUtil.create("a",e+"-close-button",n),t.href="#close",t.innerHTML="&#215;",s.DomEvent.disableClickPropagation(t),s.DomEvent.on(t,"click",this._onCloseButtonClick,this));var r=this._wrapper=s.DomUtil.create("div",e+"-content-wrapper",n);s.DomEvent.disableClickPropagation(r),this._contentNode=s.DomUtil.create("div",e+"-content",r),s.DomEvent.disableScrollPropagation(this._contentNode),s.DomEvent.on(r,"contextmenu",s.DomEvent.stopPropagation),this._tipContainer=s.DomUtil.create("div",e+"-tip-container",n),this._tip=s.DomUtil.create("div",e+"-tip",this._tipContainer)},_updateContent:function(){if(this._content){if("string"==typeof this._content)this._contentNode.innerHTML=this._content;else{for(;this._contentNode.hasChildNodes();)this._contentNode.removeChild(this._contentNode.firstChild);this._contentNode.appendChild(this._content)}this.fire("contentupdate")}},_updateLayout:function(){var t=this._contentNode,e=t.style;e.width="",e.whiteSpace="nowrap";var i=t.offsetWidth;i=Math.min(i,this.options.maxWidth),i=Math.max(i,this.options.minWidth),e.width=i+1+"px",e.whiteSpace="",e.height="";var n=t.offsetHeight,r=this.options.maxHeight,o="leaflet-popup-scrolled";r&&n>r?(e.height=r+"px",s.DomUtil.addClass(t,o)):s.DomUtil.removeClass(t,o),this._containerWidth=this._container.offsetWidth},_updatePosition:function(){if(this._map){var t=this._map.latLngToLayerPoint(this._latlng),e=this._animated,i=s.point(this.options.offset);e&&s.DomUtil.setPosition(this._container,t),this._containerBottom=-i.y-(e?0:t.y),this._containerLeft=-Math.round(this._containerWidth/2)+i.x+(e?0:t.x),this._container.style.bottom=this._containerBottom+"px",this._container.style.left=this._containerLeft+"px"}},_zoomAnimation:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center);s.DomUtil.setPosition(this._container,e)},_adjustPan:function(){if(this.options.autoPan){var t=this._map,e=this._container.offsetHeight,i=this._containerWidth,n=new s.Point(this._containerLeft,-e-this._containerBottom);this._animated&&n._add(s.DomUtil.getPosition(this._container));var r=t.layerPointToContainerPoint(n),o=s.point(this.options.autoPanPadding),a=s.point(this.options.autoPanPaddingTopLeft||o),l=s.point(this.options.autoPanPaddingBottomRight||o),h=t.getSize(),u=0,p=0;r.x+i+l.x>h.x&&(u=r.x+i-h.x+l.x),r.x-u-a.x<0&&(u=r.x-a.x),r.y+e+l.y>h.y&&(p=r.y+e-h.y+l.y),r.y-p-a.y<0&&(p=r.y-a.y),(u||p)&&t.fire("autopanstart").panBy([u,p])}},_onCloseButtonClick:function(t){this._close(),s.DomEvent.stop(t)}}),s.popup=function(t,e){return new s.Popup(t,e)},s.Map.include({openPopup:function(t,e,i){if(this.closePopup(),!(t instanceof s.Popup)){var n=t;t=new s.Popup(i).setLatLng(e).setContent(n)}return t._isOpen=!0,this._popup=t,this.addLayer(t)},closePopup:function(t){return t&&t!==this._popup||(t=this._popup,this._popup=null),t&&(this.removeLayer(t),t._isOpen=!1),this}}),s.Marker.include({openPopup:function(){return this._popup&&this._map&&!this._map.hasLayer(this._popup)&&(this._popup.setLatLng(this._latlng),this._map.openPopup(this._popup)),this},closePopup:function(){return this._popup&&this._popup._close(),this},togglePopup:function(){return this._popup&&(this._popup._isOpen?this.closePopup():this.openPopup()),this},bindPopup:function(t,e){var i=s.point(this.options.icon.options.popupAnchor||[0,0]);return i=i.add(s.Popup.prototype.options.offset),e&&e.offset&&(i=i.add(e.offset)),e=s.extend({offset:i},e),this._popupHandlersAdded||(this.on("click",this.togglePopup,this).on("remove",this.closePopup,this).on("move",this._movePopup,this),this._popupHandlersAdded=!0),t instanceof s.Popup?(s.setOptions(t,e),this._popup=t):this._popup=new s.Popup(e,this).setContent(t),this},setPopupContent:function(t){return this._popup&&this._popup.setContent(t),this},unbindPopup:function(){return this._popup&&(this._popup=null,this.off("click",this.togglePopup,this).off("remove",this.closePopup,this).off("move",this._movePopup,this),this._popupHandlersAdded=!1),this},getPopup:function(){return this._popup},_movePopup:function(t){this._popup.setLatLng(t.latlng)}}),s.LayerGroup=s.Class.extend({initialize:function(t){this._layers={};var e,i;if(t)for(e=0,i=t.length;i>e;e++)this.addLayer(t[e])},addLayer:function(t){var e=this.getLayerId(t);return this._layers[e]=t,this._map&&this._map.addLayer(t),this},removeLayer:function(t){var e=t in this._layers?t:this.getLayerId(t);return this._map&&this._layers[e]&&this._map.removeLayer(this._layers[e]),delete this._layers[e],this},hasLayer:function(t){return t?t in this._layers||this.getLayerId(t)in this._layers:!1},clearLayers:function(){return this.eachLayer(this.removeLayer,this),this},invoke:function(t){var e,i,n=Array.prototype.slice.call(arguments,1);for(e in this._layers)i=this._layers[e],i[t]&&i[t].apply(i,n);return this},onAdd:function(t){this._map=t,this.eachLayer(t.addLayer,t)},onRemove:function(t){this.eachLayer(t.removeLayer,t),this._map=null},addTo:function(t){return t.addLayer(this),this},eachLayer:function(t,e){for(var i in this._layers)t.call(e,this._layers[i]);return this},getLayer:function(t){return this._layers[t]},getLayers:function(){var t=[];for(var e in this._layers)t.push(this._layers[e]);return t},setZIndex:function(t){return this.invoke("setZIndex",t)},getLayerId:function(t){return s.stamp(t)}}),s.layerGroup=function(t){return new s.LayerGroup(t)},s.FeatureGroup=s.LayerGroup.extend({includes:s.Mixin.Events,statics:{EVENTS:"click dblclick mouseover mouseout mousemove contextmenu popupopen popupclose"},addLayer:function(t){return this.hasLayer(t)?this:("on"in t&&t.on(s.FeatureGroup.EVENTS,this._propagateEvent,this),s.LayerGroup.prototype.addLayer.call(this,t),this._popupContent&&t.bindPopup&&t.bindPopup(this._popupContent,this._popupOptions),this.fire("layeradd",{layer:t}))},removeLayer:function(t){return this.hasLayer(t)?(t in this._layers&&(t=this._layers[t]),t.off(s.FeatureGroup.EVENTS,this._propagateEvent,this),s.LayerGroup.prototype.removeLayer.call(this,t),this._popupContent&&this.invoke("unbindPopup"),this.fire("layerremove",{layer:t})):this},bindPopup:function(t,e){return this._popupContent=t,this._popupOptions=e,this.invoke("bindPopup",t,e)},openPopup:function(t){for(var e in this._layers){this._layers[e].openPopup(t);break}return this},setStyle:function(t){return this.invoke("setStyle",t)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var t=new s.LatLngBounds;return this.eachLayer(function(e){t.extend(e instanceof s.Marker?e.getLatLng():e.getBounds())}),t},_propagateEvent:function(t){t=s.extend({layer:t.target,target:this},t),this.fire(t.type,t)}}),s.featureGroup=function(t){return new s.FeatureGroup(t)},s.Path=s.Class.extend({includes:[s.Mixin.Events],statics:{CLIP_PADDING:function(){var e=s.Browser.mobile?1280:2e3,i=(e/Math.max(t.outerWidth,t.outerHeight)-1)/2;return Math.max(0,Math.min(.5,i))}()},options:{stroke:!0,color:"#0033ff",dashArray:null,lineCap:null,lineJoin:null,weight:5,opacity:.5,fill:!1,fillColor:null,fillOpacity:.2,clickable:!0},initialize:function(t){s.setOptions(this,t)},onAdd:function(t){this._map=t,this._container||(this._initElements(),this._initEvents()),this.projectLatlngs(),this._updatePath(),this._container&&this._map._pathRoot.appendChild(this._container),this.fire("add"),t.on({viewreset:this.projectLatlngs,moveend:this._updatePath},this)},addTo:function(t){return t.addLayer(this),this},onRemove:function(t){t._pathRoot.removeChild(this._container),this.fire("remove"),this._map=null,s.Browser.vml&&(this._container=null,this._stroke=null,this._fill=null),t.off({viewreset:this.projectLatlngs,moveend:this._updatePath},this)},projectLatlngs:function(){},setStyle:function(t){return s.setOptions(this,t),this._container&&this._updateStyle(),this},redraw:function(){return this._map&&(this.projectLatlngs(),this._updatePath()),this}}),s.Map.include({_updatePathViewport:function(){var t=s.Path.CLIP_PADDING,e=this.getSize(),i=s.DomUtil.getPosition(this._mapPane),n=i.multiplyBy(-1)._subtract(e.multiplyBy(t)._round()),r=n.add(e.multiplyBy(1+2*t)._round());this._pathViewport=new s.Bounds(n,r)}}),s.Path.SVG_NS="http://www.w3.org/2000/svg",s.Browser.svg=!(!e.createElementNS||!e.createElementNS(s.Path.SVG_NS,"svg").createSVGRect),s.Path=s.Path.extend({statics:{SVG:s.Browser.svg},bringToFront:function(){var t=this._map._pathRoot,e=this._container;return e&&t.lastChild!==e&&t.appendChild(e),this},bringToBack:function(){var t=this._map._pathRoot,e=this._container,i=t.firstChild;return e&&i!==e&&t.insertBefore(e,i),this},getPathString:function(){},_createElement:function(t){return e.createElementNS(s.Path.SVG_NS,t)},_initElements:function(){this._map._initPathRoot(),this._initPath(),this._initStyle()},_initPath:function(){this._container=this._createElement("g"),this._path=this._createElement("path"),this.options.className&&s.DomUtil.addClass(this._path,this.options.className),this._container.appendChild(this._path)},_initStyle:function(){this.options.stroke&&(this._path.setAttribute("stroke-linejoin","round"),this._path.setAttribute("stroke-linecap","round")),this.options.fill&&this._path.setAttribute("fill-rule","evenodd"),this.options.pointerEvents&&this._path.setAttribute("pointer-events",this.options.pointerEvents),this.options.clickable||this.options.pointerEvents||this._path.setAttribute("pointer-events","none"),this._updateStyle()},_updateStyle:function(){this.options.stroke?(this._path.setAttribute("stroke",this.options.color),this._path.setAttribute("stroke-opacity",this.options.opacity),this._path.setAttribute("stroke-width",this.options.weight),this.options.dashArray?this._path.setAttribute("stroke-dasharray",this.options.dashArray):this._path.removeAttribute("stroke-dasharray"),this.options.lineCap&&this._path.setAttribute("stroke-linecap",this.options.lineCap),this.options.lineJoin&&this._path.setAttribute("stroke-linejoin",this.options.lineJoin)):this._path.setAttribute("stroke","none"),this.options.fill?(this._path.setAttribute("fill",this.options.fillColor||this.options.color),this._path.setAttribute("fill-opacity",this.options.fillOpacity)):this._path.setAttribute("fill","none")},_updatePath:function(){var t=this.getPathString();t||(t="M0 0"),this._path.setAttribute("d",t)},_initEvents:function(){if(this.options.clickable){(s.Browser.svg||!s.Browser.vml)&&s.DomUtil.addClass(this._path,"leaflet-clickable"),s.DomEvent.on(this._container,"click",this._onMouseClick,this);for(var t=["dblclick","mousedown","mouseover","mouseout","mousemove","contextmenu"],e=0;e<t.length;e++)s.DomEvent.on(this._container,t[e],this._fireMouseEvent,this)}},_onMouseClick:function(t){this._map.dragging&&this._map.dragging.moved()||this._fireMouseEvent(t)},_fireMouseEvent:function(t){if(this.hasEventListeners(t.type)){var e=this._map,i=e.mouseEventToContainerPoint(t),n=e.containerPointToLayerPoint(i),r=e.layerPointToLatLng(n);this.fire(t.type,{latlng:r,layerPoint:n,containerPoint:i,originalEvent:t}),"contextmenu"===t.type&&s.DomEvent.preventDefault(t),"mousemove"!==t.type&&s.DomEvent.stopPropagation(t)}}}),s.Map.include({_initPathRoot:function(){this._pathRoot||(this._pathRoot=s.Path.prototype._createElement("svg"),this._panes.overlayPane.appendChild(this._pathRoot),this.options.zoomAnimation&&s.Browser.any3d?(s.DomUtil.addClass(this._pathRoot,"leaflet-zoom-animated"),this.on({zoomanim:this._animatePathZoom,zoomend:this._endPathZoom})):s.DomUtil.addClass(this._pathRoot,"leaflet-zoom-hide"),this.on("moveend",this._updateSvgViewport),this._updateSvgViewport())},_animatePathZoom:function(t){var e=this.getZoomScale(t.zoom),i=this._getCenterOffset(t.center)._multiplyBy(-e)._add(this._pathViewport.min);this._pathRoot.style[s.DomUtil.TRANSFORM]=s.DomUtil.getTranslateString(i)+" scale("+e+") ",this._pathZooming=!0},_endPathZoom:function(){this._pathZooming=!1},_updateSvgViewport:function(){if(!this._pathZooming){this._updatePathViewport();var t=this._pathViewport,e=t.min,i=t.max,n=i.x-e.x,r=i.y-e.y,o=this._pathRoot,a=this._panes.overlayPane;s.Browser.mobileWebkit&&a.removeChild(o),s.DomUtil.setPosition(o,e),o.setAttribute("width",n),o.setAttribute("height",r),o.setAttribute("viewBox",[e.x,e.y,n,r].join(" ")),s.Browser.mobileWebkit&&a.appendChild(o)}}}),s.Path.include({bindPopup:function(t,e){return t instanceof s.Popup?this._popup=t:((!this._popup||e)&&(this._popup=new s.Popup(e,this)),this._popup.setContent(t)),this._popupHandlersAdded||(this.on("click",this._openPopup,this).on("remove",this.closePopup,this),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this._popup=null,this.off("click",this._openPopup).off("remove",this.closePopup),this._popupHandlersAdded=!1),this},openPopup:function(t){return this._popup&&(t=t||this._latlng||this._latlngs[Math.floor(this._latlngs.length/2)],this._openPopup({latlng:t})),this},closePopup:function(){return this._popup&&this._popup._close(),this},_openPopup:function(t){this._popup.setLatLng(t.latlng),this._map.openPopup(this._popup)}}),s.Browser.vml=!s.Browser.svg&&function(){try{var t=e.createElement("div");
t.innerHTML='<v:shape adj="1"/>';var i=t.firstChild;return i.style.behavior="url(#default#VML)",i&&"object"==typeof i.adj}catch(n){return!1}}(),s.Path=s.Browser.svg||!s.Browser.vml?s.Path:s.Path.extend({statics:{VML:!0,CLIP_PADDING:.02},_createElement:function(){try{return e.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(t){return e.createElement("<lvml:"+t+' class="lvml">')}}catch(t){return function(t){return e.createElement("<"+t+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}}(),_initPath:function(){var t=this._container=this._createElement("shape");s.DomUtil.addClass(t,"leaflet-vml-shape"+(this.options.className?" "+this.options.className:"")),this.options.clickable&&s.DomUtil.addClass(t,"leaflet-clickable"),t.coordsize="1 1",this._path=this._createElement("path"),t.appendChild(this._path),this._map._pathRoot.appendChild(t)},_initStyle:function(){this._updateStyle()},_updateStyle:function(){var t=this._stroke,e=this._fill,i=this.options,n=this._container;n.stroked=i.stroke,n.filled=i.fill,i.stroke?(t||(t=this._stroke=this._createElement("stroke"),t.endcap="round",n.appendChild(t)),t.weight=i.weight+"px",t.color=i.color,t.opacity=i.opacity,t.dashStyle=i.dashArray?s.Util.isArray(i.dashArray)?i.dashArray.join(" "):i.dashArray.replace(/( *, *)/g," "):"",i.lineCap&&(t.endcap=i.lineCap.replace("butt","flat")),i.lineJoin&&(t.joinstyle=i.lineJoin)):t&&(n.removeChild(t),this._stroke=null),i.fill?(e||(e=this._fill=this._createElement("fill"),n.appendChild(e)),e.color=i.fillColor||i.color,e.opacity=i.fillOpacity):e&&(n.removeChild(e),this._fill=null)},_updatePath:function(){var t=this._container.style;t.display="none",this._path.v=this.getPathString()+" ",t.display=""}}),s.Map.include(s.Browser.svg||!s.Browser.vml?{}:{_initPathRoot:function(){if(!this._pathRoot){var t=this._pathRoot=e.createElement("div");t.className="leaflet-vml-container",this._panes.overlayPane.appendChild(t),this.on("moveend",this._updatePathViewport),this._updatePathViewport()}}}),s.Browser.canvas=function(){return!!e.createElement("canvas").getContext}(),s.Path=s.Path.SVG&&!t.L_PREFER_CANVAS||!s.Browser.canvas?s.Path:s.Path.extend({statics:{CANVAS:!0,SVG:!1},redraw:function(){return this._map&&(this.projectLatlngs(),this._requestUpdate()),this},setStyle:function(t){return s.setOptions(this,t),this._map&&(this._updateStyle(),this._requestUpdate()),this},onRemove:function(t){t.off("viewreset",this.projectLatlngs,this).off("moveend",this._updatePath,this),this.options.clickable&&(this._map.off("click",this._onClick,this),this._map.off("mousemove",this._onMouseMove,this)),this._requestUpdate(),this.fire("remove"),this._map=null},_requestUpdate:function(){this._map&&!s.Path._updateRequest&&(s.Path._updateRequest=s.Util.requestAnimFrame(this._fireMapMoveEnd,this._map))},_fireMapMoveEnd:function(){s.Path._updateRequest=null,this.fire("moveend")},_initElements:function(){this._map._initPathRoot(),this._ctx=this._map._canvasCtx},_updateStyle:function(){var t=this.options;t.stroke&&(this._ctx.lineWidth=t.weight,this._ctx.strokeStyle=t.color),t.fill&&(this._ctx.fillStyle=t.fillColor||t.color)},_drawPath:function(){var t,e,i,n,r,o;for(this._ctx.beginPath(),t=0,i=this._parts.length;i>t;t++){for(e=0,n=this._parts[t].length;n>e;e++)r=this._parts[t][e],o=(0===e?"move":"line")+"To",this._ctx[o](r.x,r.y);this instanceof s.Polygon&&this._ctx.closePath()}},_checkIfEmpty:function(){return!this._parts.length},_updatePath:function(){if(!this._checkIfEmpty()){var t=this._ctx,e=this.options;this._drawPath(),t.save(),this._updateStyle(),e.fill&&(t.globalAlpha=e.fillOpacity,t.fill()),e.stroke&&(t.globalAlpha=e.opacity,t.stroke()),t.restore()}},_initEvents:function(){this.options.clickable&&(this._map.on("mousemove",this._onMouseMove,this),this._map.on("click",this._onClick,this))},_onClick:function(t){this._containsPoint(t.layerPoint)&&this.fire("click",t)},_onMouseMove:function(t){this._map&&!this._map._animatingZoom&&(this._containsPoint(t.layerPoint)?(this._ctx.canvas.style.cursor="pointer",this._mouseInside=!0,this.fire("mouseover",t)):this._mouseInside&&(this._ctx.canvas.style.cursor="",this._mouseInside=!1,this.fire("mouseout",t)))}}),s.Map.include(s.Path.SVG&&!t.L_PREFER_CANVAS||!s.Browser.canvas?{}:{_initPathRoot:function(){var t,i=this._pathRoot;i||(i=this._pathRoot=e.createElement("canvas"),i.style.position="absolute",t=this._canvasCtx=i.getContext("2d"),t.lineCap="round",t.lineJoin="round",this._panes.overlayPane.appendChild(i),this.options.zoomAnimation&&(this._pathRoot.className="leaflet-zoom-animated",this.on("zoomanim",this._animatePathZoom),this.on("zoomend",this._endPathZoom)),this.on("moveend",this._updateCanvasViewport),this._updateCanvasViewport())},_updateCanvasViewport:function(){if(!this._pathZooming){this._updatePathViewport();var t=this._pathViewport,e=t.min,i=t.max.subtract(e),n=this._pathRoot;s.DomUtil.setPosition(n,e),n.width=i.x,n.height=i.y,n.getContext("2d").translate(-e.x,-e.y)}}}),s.LineUtil={simplify:function(t,e){if(!e||!t.length)return t.slice();var i=e*e;return t=this._reducePoints(t,i),t=this._simplifyDP(t,i)},pointToSegmentDistance:function(t,e,i){return Math.sqrt(this._sqClosestPointOnSegment(t,e,i,!0))},closestPointOnSegment:function(t,e,i){return this._sqClosestPointOnSegment(t,e,i)},_simplifyDP:function(t,e){var n=t.length,s=typeof Uint8Array!=i+""?Uint8Array:Array,r=new s(n);r[0]=r[n-1]=1,this._simplifyDPStep(t,r,e,0,n-1);var o,a=[];for(o=0;n>o;o++)r[o]&&a.push(t[o]);return a},_simplifyDPStep:function(t,e,i,n,s){var r,o,a,l=0;for(o=n+1;s-1>=o;o++)a=this._sqClosestPointOnSegment(t[o],t[n],t[s],!0),a>l&&(r=o,l=a);l>i&&(e[r]=1,this._simplifyDPStep(t,e,i,n,r),this._simplifyDPStep(t,e,i,r,s))},_reducePoints:function(t,e){for(var i=[t[0]],n=1,s=0,r=t.length;r>n;n++)this._sqDist(t[n],t[s])>e&&(i.push(t[n]),s=n);return r-1>s&&i.push(t[r-1]),i},clipSegment:function(t,e,i,n){var s,r,o,a=n?this._lastCode:this._getBitCode(t,i),l=this._getBitCode(e,i);for(this._lastCode=l;;){if(!(a|l))return[t,e];if(a&l)return!1;s=a||l,r=this._getEdgeIntersection(t,e,s,i),o=this._getBitCode(r,i),s===a?(t=r,a=o):(e=r,l=o)}},_getEdgeIntersection:function(t,e,i,n){var r=e.x-t.x,o=e.y-t.y,a=n.min,l=n.max;return 8&i?new s.Point(t.x+r*(l.y-t.y)/o,l.y):4&i?new s.Point(t.x+r*(a.y-t.y)/o,a.y):2&i?new s.Point(l.x,t.y+o*(l.x-t.x)/r):1&i?new s.Point(a.x,t.y+o*(a.x-t.x)/r):void 0},_getBitCode:function(t,e){var i=0;return t.x<e.min.x?i|=1:t.x>e.max.x&&(i|=2),t.y<e.min.y?i|=4:t.y>e.max.y&&(i|=8),i},_sqDist:function(t,e){var i=e.x-t.x,n=e.y-t.y;return i*i+n*n},_sqClosestPointOnSegment:function(t,e,i,n){var r,o=e.x,a=e.y,l=i.x-o,h=i.y-a,u=l*l+h*h;return u>0&&(r=((t.x-o)*l+(t.y-a)*h)/u,r>1?(o=i.x,a=i.y):r>0&&(o+=l*r,a+=h*r)),l=t.x-o,h=t.y-a,n?l*l+h*h:new s.Point(o,a)}},s.Polyline=s.Path.extend({initialize:function(t,e){s.Path.prototype.initialize.call(this,e),this._latlngs=this._convertLatLngs(t)},options:{smoothFactor:1,noClip:!1},projectLatlngs:function(){this._originalPoints=[];for(var t=0,e=this._latlngs.length;e>t;t++)this._originalPoints[t]=this._map.latLngToLayerPoint(this._latlngs[t])},getPathString:function(){for(var t=0,e=this._parts.length,i="";e>t;t++)i+=this._getPathPartStr(this._parts[t]);return i},getLatLngs:function(){return this._latlngs},setLatLngs:function(t){return this._latlngs=this._convertLatLngs(t),this.redraw()},addLatLng:function(t){return this._latlngs.push(s.latLng(t)),this.redraw()},spliceLatLngs:function(){var t=[].splice.apply(this._latlngs,arguments);return this._convertLatLngs(this._latlngs,!0),this.redraw(),t},closestLayerPoint:function(t){for(var e,i,n=1/0,r=this._parts,o=null,a=0,l=r.length;l>a;a++)for(var h=r[a],u=1,p=h.length;p>u;u++){e=h[u-1],i=h[u];var c=s.LineUtil._sqClosestPointOnSegment(t,e,i,!0);n>c&&(n=c,o=s.LineUtil._sqClosestPointOnSegment(t,e,i))}return o&&(o.distance=Math.sqrt(n)),o},getBounds:function(){return new s.LatLngBounds(this.getLatLngs())},_convertLatLngs:function(t,e){var i,n,r=e?t:[];for(i=0,n=t.length;n>i;i++){if(s.Util.isArray(t[i])&&"number"!=typeof t[i][0])return;r[i]=s.latLng(t[i])}return r},_initEvents:function(){s.Path.prototype._initEvents.call(this)},_getPathPartStr:function(t){for(var e,i=s.Path.VML,n=0,r=t.length,o="";r>n;n++)e=t[n],i&&e._round(),o+=(n?"L":"M")+e.x+" "+e.y;return o},_clipPoints:function(){var t,e,i,n=this._originalPoints,r=n.length;if(this.options.noClip)return void(this._parts=[n]);this._parts=[];var o=this._parts,a=this._map._pathViewport,l=s.LineUtil;for(t=0,e=0;r-1>t;t++)i=l.clipSegment(n[t],n[t+1],a,t),i&&(o[e]=o[e]||[],o[e].push(i[0]),(i[1]!==n[t+1]||t===r-2)&&(o[e].push(i[1]),e++))},_simplifyPoints:function(){for(var t=this._parts,e=s.LineUtil,i=0,n=t.length;n>i;i++)t[i]=e.simplify(t[i],this.options.smoothFactor)},_updatePath:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),s.Path.prototype._updatePath.call(this))}}),s.polyline=function(t,e){return new s.Polyline(t,e)},s.PolyUtil={},s.PolyUtil.clipPolygon=function(t,e){var i,n,r,o,a,l,h,u,p,c=[1,4,2,8],d=s.LineUtil;for(n=0,h=t.length;h>n;n++)t[n]._code=d._getBitCode(t[n],e);for(o=0;4>o;o++){for(u=c[o],i=[],n=0,h=t.length,r=h-1;h>n;r=n++)a=t[n],l=t[r],a._code&u?l._code&u||(p=d._getEdgeIntersection(l,a,u,e),p._code=d._getBitCode(p,e),i.push(p)):(l._code&u&&(p=d._getEdgeIntersection(l,a,u,e),p._code=d._getBitCode(p,e),i.push(p)),i.push(a));t=i}return t},s.Polygon=s.Polyline.extend({options:{fill:!0},initialize:function(t,e){s.Polyline.prototype.initialize.call(this,t,e),this._initWithHoles(t)},_initWithHoles:function(t){var e,i,n;if(t&&s.Util.isArray(t[0])&&"number"!=typeof t[0][0])for(this._latlngs=this._convertLatLngs(t[0]),this._holes=t.slice(1),e=0,i=this._holes.length;i>e;e++)n=this._holes[e]=this._convertLatLngs(this._holes[e]),n[0].equals(n[n.length-1])&&n.pop();t=this._latlngs,t.length>=2&&t[0].equals(t[t.length-1])&&t.pop()},projectLatlngs:function(){if(s.Polyline.prototype.projectLatlngs.call(this),this._holePoints=[],this._holes){var t,e,i,n;for(t=0,i=this._holes.length;i>t;t++)for(this._holePoints[t]=[],e=0,n=this._holes[t].length;n>e;e++)this._holePoints[t][e]=this._map.latLngToLayerPoint(this._holes[t][e])}},setLatLngs:function(t){return t&&s.Util.isArray(t[0])&&"number"!=typeof t[0][0]?(this._initWithHoles(t),this.redraw()):s.Polyline.prototype.setLatLngs.call(this,t)},_clipPoints:function(){var t=this._originalPoints,e=[];if(this._parts=[t].concat(this._holePoints),!this.options.noClip){for(var i=0,n=this._parts.length;n>i;i++){var r=s.PolyUtil.clipPolygon(this._parts[i],this._map._pathViewport);r.length&&e.push(r)}this._parts=e}},_getPathPartStr:function(t){var e=s.Polyline.prototype._getPathPartStr.call(this,t);return e+(s.Browser.svg?"z":"x")}}),s.polygon=function(t,e){return new s.Polygon(t,e)},function(){function t(t){return s.FeatureGroup.extend({initialize:function(t,e){this._layers={},this._options=e,this.setLatLngs(t)},setLatLngs:function(e){var i=0,n=e.length;for(this.eachLayer(function(t){n>i?t.setLatLngs(e[i++]):this.removeLayer(t)},this);n>i;)this.addLayer(new t(e[i++],this._options));return this},getLatLngs:function(){var t=[];return this.eachLayer(function(e){t.push(e.getLatLngs())}),t}})}s.MultiPolyline=t(s.Polyline),s.MultiPolygon=t(s.Polygon),s.multiPolyline=function(t,e){return new s.MultiPolyline(t,e)},s.multiPolygon=function(t,e){return new s.MultiPolygon(t,e)}}(),s.Rectangle=s.Polygon.extend({initialize:function(t,e){s.Polygon.prototype.initialize.call(this,this._boundsToLatLngs(t),e)},setBounds:function(t){this.setLatLngs(this._boundsToLatLngs(t))},_boundsToLatLngs:function(t){return t=s.latLngBounds(t),[t.getSouthWest(),t.getNorthWest(),t.getNorthEast(),t.getSouthEast()]}}),s.rectangle=function(t,e){return new s.Rectangle(t,e)},s.Circle=s.Path.extend({initialize:function(t,e,i){s.Path.prototype.initialize.call(this,i),this._latlng=s.latLng(t),this._mRadius=e},options:{fill:!0},setLatLng:function(t){return this._latlng=s.latLng(t),this.redraw()},setRadius:function(t){return this._mRadius=t,this.redraw()},projectLatlngs:function(){var t=this._getLngRadius(),e=this._latlng,i=this._map.latLngToLayerPoint([e.lat,e.lng-t]);this._point=this._map.latLngToLayerPoint(e),this._radius=Math.max(this._point.x-i.x,1)},getBounds:function(){var t=this._getLngRadius(),e=this._mRadius/40075017*360,i=this._latlng;return new s.LatLngBounds([i.lat-e,i.lng-t],[i.lat+e,i.lng+t])},getLatLng:function(){return this._latlng},getPathString:function(){var t=this._point,e=this._radius;return this._checkIfEmpty()?"":s.Browser.svg?"M"+t.x+","+(t.y-e)+"A"+e+","+e+",0,1,1,"+(t.x-.1)+","+(t.y-e)+" z":(t._round(),e=Math.round(e),"AL "+t.x+","+t.y+" "+e+","+e+" 0,23592600")},getRadius:function(){return this._mRadius},_getLatRadius:function(){return this._mRadius/40075017*360},_getLngRadius:function(){return this._getLatRadius()/Math.cos(s.LatLng.DEG_TO_RAD*this._latlng.lat)},_checkIfEmpty:function(){if(!this._map)return!1;var t=this._map._pathViewport,e=this._radius,i=this._point;return i.x-e>t.max.x||i.y-e>t.max.y||i.x+e<t.min.x||i.y+e<t.min.y}}),s.circle=function(t,e,i){return new s.Circle(t,e,i)},s.CircleMarker=s.Circle.extend({options:{radius:10,weight:2},initialize:function(t,e){s.Circle.prototype.initialize.call(this,t,null,e),this._radius=this.options.radius},projectLatlngs:function(){this._point=this._map.latLngToLayerPoint(this._latlng)},_updateStyle:function(){s.Circle.prototype._updateStyle.call(this),this.setRadius(this.options.radius)},setLatLng:function(t){return s.Circle.prototype.setLatLng.call(this,t),this._popup&&this._popup._isOpen&&this._popup.setLatLng(t),this},setRadius:function(t){return this.options.radius=this._radius=t,this.redraw()},getRadius:function(){return this._radius}}),s.circleMarker=function(t,e){return new s.CircleMarker(t,e)},s.Polyline.include(s.Path.CANVAS?{_containsPoint:function(t,e){var i,n,r,o,a,l,h,u=this.options.weight/2;for(s.Browser.touch&&(u+=10),i=0,o=this._parts.length;o>i;i++)for(h=this._parts[i],n=0,a=h.length,r=a-1;a>n;r=n++)if((e||0!==n)&&(l=s.LineUtil.pointToSegmentDistance(t,h[r],h[n]),u>=l))return!0;return!1}}:{}),s.Polygon.include(s.Path.CANVAS?{_containsPoint:function(t){var e,i,n,r,o,a,l,h,u=!1;if(s.Polyline.prototype._containsPoint.call(this,t,!0))return!0;for(r=0,l=this._parts.length;l>r;r++)for(e=this._parts[r],o=0,h=e.length,a=h-1;h>o;a=o++)i=e[o],n=e[a],i.y>t.y!=n.y>t.y&&t.x<(n.x-i.x)*(t.y-i.y)/(n.y-i.y)+i.x&&(u=!u);return u}}:{}),s.Circle.include(s.Path.CANVAS?{_drawPath:function(){var t=this._point;this._ctx.beginPath(),this._ctx.arc(t.x,t.y,this._radius,0,2*Math.PI,!1)},_containsPoint:function(t){var e=this._point,i=this.options.stroke?this.options.weight/2:0;return t.distanceTo(e)<=this._radius+i}}:{}),s.CircleMarker.include(s.Path.CANVAS?{_updateStyle:function(){s.Path.prototype._updateStyle.call(this)}}:{}),s.GeoJSON=s.FeatureGroup.extend({initialize:function(t,e){s.setOptions(this,e),this._layers={},t&&this.addData(t)},addData:function(t){var e,i,n,r=s.Util.isArray(t)?t:t.features;if(r){for(e=0,i=r.length;i>e;e++)n=r[e],(n.geometries||n.geometry||n.features||n.coordinates)&&this.addData(r[e]);return this}var o=this.options;if(!o.filter||o.filter(t)){var a=s.GeoJSON.geometryToLayer(t,o.pointToLayer,o.coordsToLatLng,o);return a.feature=s.GeoJSON.asFeature(t),a.defaultOptions=a.options,this.resetStyle(a),o.onEachFeature&&o.onEachFeature(t,a),this.addLayer(a)}},resetStyle:function(t){var e=this.options.style;e&&(s.Util.extend(t.options,t.defaultOptions),this._setLayerStyle(t,e))},setStyle:function(t){this.eachLayer(function(e){this._setLayerStyle(e,t)},this)},_setLayerStyle:function(t,e){"function"==typeof e&&(e=e(t.feature)),t.setStyle&&t.setStyle(e)}}),s.extend(s.GeoJSON,{geometryToLayer:function(t,e,i,n){var r,o,a,l,h="Feature"===t.type?t.geometry:t,u=h.coordinates,p=[];switch(i=i||this.coordsToLatLng,h.type){case"Point":return r=i(u),e?e(t,r):new s.Marker(r);case"MultiPoint":for(a=0,l=u.length;l>a;a++)r=i(u[a]),p.push(e?e(t,r):new s.Marker(r));return new s.FeatureGroup(p);case"LineString":return o=this.coordsToLatLngs(u,0,i),new s.Polyline(o,n);case"Polygon":if(2===u.length&&!u[1].length)throw new Error("Invalid GeoJSON object.");return o=this.coordsToLatLngs(u,1,i),new s.Polygon(o,n);case"MultiLineString":return o=this.coordsToLatLngs(u,1,i),new s.MultiPolyline(o,n);case"MultiPolygon":return o=this.coordsToLatLngs(u,2,i),new s.MultiPolygon(o,n);case"GeometryCollection":for(a=0,l=h.geometries.length;l>a;a++)p.push(this.geometryToLayer({geometry:h.geometries[a],type:"Feature",properties:t.properties},e,i,n));return new s.FeatureGroup(p);default:throw new Error("Invalid GeoJSON object.")}},coordsToLatLng:function(t){return new s.LatLng(t[1],t[0],t[2])},coordsToLatLngs:function(t,e,i){var n,s,r,o=[];for(s=0,r=t.length;r>s;s++)n=e?this.coordsToLatLngs(t[s],e-1,i):(i||this.coordsToLatLng)(t[s]),o.push(n);return o},latLngToCoords:function(t){var e=[t.lng,t.lat];return t.alt!==i&&e.push(t.alt),e},latLngsToCoords:function(t){for(var e=[],i=0,n=t.length;n>i;i++)e.push(s.GeoJSON.latLngToCoords(t[i]));return e},getFeature:function(t,e){return t.feature?s.extend({},t.feature,{geometry:e}):s.GeoJSON.asFeature(e)},asFeature:function(t){return"Feature"===t.type?t:{type:"Feature",properties:{},geometry:t}}});var o={toGeoJSON:function(){return s.GeoJSON.getFeature(this,{type:"Point",coordinates:s.GeoJSON.latLngToCoords(this.getLatLng())})}};s.Marker.include(o),s.Circle.include(o),s.CircleMarker.include(o),s.Polyline.include({toGeoJSON:function(){return s.GeoJSON.getFeature(this,{type:"LineString",coordinates:s.GeoJSON.latLngsToCoords(this.getLatLngs())})}}),s.Polygon.include({toGeoJSON:function(){var t,e,i,n=[s.GeoJSON.latLngsToCoords(this.getLatLngs())];if(n[0].push(n[0][0]),this._holes)for(t=0,e=this._holes.length;e>t;t++)i=s.GeoJSON.latLngsToCoords(this._holes[t]),i.push(i[0]),n.push(i);return s.GeoJSON.getFeature(this,{type:"Polygon",coordinates:n})}}),function(){function t(t){return function(){var e=[];return this.eachLayer(function(t){e.push(t.toGeoJSON().geometry.coordinates)}),s.GeoJSON.getFeature(this,{type:t,coordinates:e})}}s.MultiPolyline.include({toGeoJSON:t("MultiLineString")}),s.MultiPolygon.include({toGeoJSON:t("MultiPolygon")}),s.LayerGroup.include({toGeoJSON:function(){var e,i=this.feature&&this.feature.geometry,n=[];if(i&&"MultiPoint"===i.type)return t("MultiPoint").call(this);var r=i&&"GeometryCollection"===i.type;return this.eachLayer(function(t){t.toGeoJSON&&(e=t.toGeoJSON(),n.push(r?e.geometry:s.GeoJSON.asFeature(e)))}),r?s.GeoJSON.getFeature(this,{geometries:n,type:"GeometryCollection"}):{type:"FeatureCollection",features:n}}})}(),s.geoJson=function(t,e){return new s.GeoJSON(t,e)},s.DomEvent={addListener:function(t,e,i,n){var r,o,a,l=s.stamp(i),h="_leaflet_"+e+l;return t[h]?this:(r=function(e){return i.call(n||t,e||s.DomEvent._getEvent())},s.Browser.pointer&&0===e.indexOf("touch")?this.addPointerListener(t,e,r,l):(s.Browser.touch&&"dblclick"===e&&this.addDoubleTapListener&&this.addDoubleTapListener(t,r,l),"addEventListener"in t?"mousewheel"===e?(t.addEventListener("DOMMouseScroll",r,!1),t.addEventListener(e,r,!1)):"mouseenter"===e||"mouseleave"===e?(o=r,a="mouseenter"===e?"mouseover":"mouseout",r=function(e){return s.DomEvent._checkMouse(t,e)?o(e):void 0},t.addEventListener(a,r,!1)):"click"===e&&s.Browser.android?(o=r,r=function(t){return s.DomEvent._filterClick(t,o)},t.addEventListener(e,r,!1)):t.addEventListener(e,r,!1):"attachEvent"in t&&t.attachEvent("on"+e,r),t[h]=r,this))},removeListener:function(t,e,i){var n=s.stamp(i),r="_leaflet_"+e+n,o=t[r];return o?(s.Browser.pointer&&0===e.indexOf("touch")?this.removePointerListener(t,e,n):s.Browser.touch&&"dblclick"===e&&this.removeDoubleTapListener?this.removeDoubleTapListener(t,n):"removeEventListener"in t?"mousewheel"===e?(t.removeEventListener("DOMMouseScroll",o,!1),t.removeEventListener(e,o,!1)):"mouseenter"===e||"mouseleave"===e?t.removeEventListener("mouseenter"===e?"mouseover":"mouseout",o,!1):t.removeEventListener(e,o,!1):"detachEvent"in t&&t.detachEvent("on"+e,o),t[r]=null,this):this},stopPropagation:function(t){return t.stopPropagation?t.stopPropagation():t.cancelBubble=!0,s.DomEvent._skipped(t),this},disableScrollPropagation:function(t){var e=s.DomEvent.stopPropagation;return s.DomEvent.on(t,"mousewheel",e).on(t,"MozMousePixelScroll",e)},disableClickPropagation:function(t){for(var e=s.DomEvent.stopPropagation,i=s.Draggable.START.length-1;i>=0;i--)s.DomEvent.on(t,s.Draggable.START[i],e);return s.DomEvent.on(t,"click",s.DomEvent._fakeStop).on(t,"dblclick",e)},preventDefault:function(t){return t.preventDefault?t.preventDefault():t.returnValue=!1,this},stop:function(t){return s.DomEvent.preventDefault(t).stopPropagation(t)},getMousePosition:function(t,e){if(!e)return new s.Point(t.clientX,t.clientY);var i=e.getBoundingClientRect();return new s.Point(t.clientX-i.left-e.clientLeft,t.clientY-i.top-e.clientTop)},getWheelDelta:function(t){var e=0;return t.wheelDelta&&(e=t.wheelDelta/120),t.detail&&(e=-t.detail/3),e},_skipEvents:{},_fakeStop:function(t){s.DomEvent._skipEvents[t.type]=!0},_skipped:function(t){var e=this._skipEvents[t.type];return this._skipEvents[t.type]=!1,e},_checkMouse:function(t,e){var i=e.relatedTarget;if(!i)return!0;try{for(;i&&i!==t;)i=i.parentNode}catch(n){return!1}return i!==t},_getEvent:function(){var e=t.event;if(!e)for(var i=arguments.callee.caller;i&&(e=i.arguments[0],!e||t.Event!==e.constructor);)i=i.caller;return e},_filterClick:function(t,e){var i=t.timeStamp||t.originalEvent.timeStamp,n=s.DomEvent._lastClick&&i-s.DomEvent._lastClick;return n&&n>100&&500>n||t.target._simulatedClick&&!t._simulated?void s.DomEvent.stop(t):(s.DomEvent._lastClick=i,e(t))}},s.DomEvent.on=s.DomEvent.addListener,s.DomEvent.off=s.DomEvent.removeListener,s.Draggable=s.Class.extend({includes:s.Mixin.Events,statics:{START:s.Browser.touch?["touchstart","mousedown"]:["mousedown"],END:{mousedown:"mouseup",touchstart:"touchend",pointerdown:"touchend",MSPointerDown:"touchend"},MOVE:{mousedown:"mousemove",touchstart:"touchmove",pointerdown:"touchmove",MSPointerDown:"touchmove"}},initialize:function(t,e){this._element=t,this._dragStartTarget=e||t},enable:function(){if(!this._enabled){for(var t=s.Draggable.START.length-1;t>=0;t--)s.DomEvent.on(this._dragStartTarget,s.Draggable.START[t],this._onDown,this);this._enabled=!0}},disable:function(){if(this._enabled){for(var t=s.Draggable.START.length-1;t>=0;t--)s.DomEvent.off(this._dragStartTarget,s.Draggable.START[t],this._onDown,this);this._enabled=!1,this._moved=!1}},_onDown:function(t){if(this._moved=!1,!(t.shiftKey||1!==t.which&&1!==t.button&&!t.touches||(s.DomEvent.stopPropagation(t),s.Draggable._disabled||(s.DomUtil.disableImageDrag(),s.DomUtil.disableTextSelection(),this._moving)))){var i=t.touches?t.touches[0]:t;this._startPoint=new s.Point(i.clientX,i.clientY),this._startPos=this._newPos=s.DomUtil.getPosition(this._element),s.DomEvent.on(e,s.Draggable.MOVE[t.type],this._onMove,this).on(e,s.Draggable.END[t.type],this._onUp,this)}},_onMove:function(t){if(t.touches&&t.touches.length>1)return void(this._moved=!0);var i=t.touches&&1===t.touches.length?t.touches[0]:t,n=new s.Point(i.clientX,i.clientY),r=n.subtract(this._startPoint);(r.x||r.y)&&(s.Browser.touch&&Math.abs(r.x)+Math.abs(r.y)<3||(s.DomEvent.preventDefault(t),this._moved||(this.fire("dragstart"),this._moved=!0,this._startPos=s.DomUtil.getPosition(this._element).subtract(r),s.DomUtil.addClass(e.body,"leaflet-dragging"),this._lastTarget=t.target||t.srcElement,s.DomUtil.addClass(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(r),this._moving=!0,s.Util.cancelAnimFrame(this._animRequest),this._animRequest=s.Util.requestAnimFrame(this._updatePosition,this,!0,this._dragStartTarget)))},_updatePosition:function(){this.fire("predrag"),s.DomUtil.setPosition(this._element,this._newPos),this.fire("drag")},_onUp:function(){s.DomUtil.removeClass(e.body,"leaflet-dragging"),this._lastTarget&&(s.DomUtil.removeClass(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null);for(var t in s.Draggable.MOVE)s.DomEvent.off(e,s.Draggable.MOVE[t],this._onMove).off(e,s.Draggable.END[t],this._onUp);s.DomUtil.enableImageDrag(),s.DomUtil.enableTextSelection(),this._moved&&this._moving&&(s.Util.cancelAnimFrame(this._animRequest),this.fire("dragend",{distance:this._newPos.distanceTo(this._startPos)})),this._moving=!1}}),s.Handler=s.Class.extend({initialize:function(t){this._map=t},enable:function(){this._enabled||(this._enabled=!0,this.addHooks())},disable:function(){this._enabled&&(this._enabled=!1,this.removeHooks())},enabled:function(){return!!this._enabled}}),s.Map.mergeOptions({dragging:!0,inertia:!s.Browser.android23,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,inertiaThreshold:s.Browser.touch?32:18,easeLinearity:.25,worldCopyJump:!1}),s.Map.Drag=s.Handler.extend({addHooks:function(){if(!this._draggable){var t=this._map;this._draggable=new s.Draggable(t._mapPane,t._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),t.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDrag,this),t.on("viewreset",this._onViewReset,this),t.whenReady(this._onViewReset,this))}this._draggable.enable()},removeHooks:function(){this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},_onDragStart:function(){var t=this._map;t._panAnim&&t._panAnim.stop(),t.fire("movestart").fire("dragstart"),t.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(){if(this._map.options.inertia){var t=this._lastTime=+new Date,e=this._lastPos=this._draggable._newPos;this._positions.push(e),this._times.push(t),t-this._times[0]>200&&(this._positions.shift(),this._times.shift())}this._map.fire("move").fire("drag")},_onViewReset:function(){var t=this._map.getSize()._divideBy(2),e=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=e.subtract(t).x,this._worldWidth=this._map.project([0,180]).x},_onPreDrag:function(){var t=this._worldWidth,e=Math.round(t/2),i=this._initialWorldOffset,n=this._draggable._newPos.x,s=(n-e+i)%t+e-i,r=(n+e+i)%t-e-i,o=Math.abs(s+i)<Math.abs(r+i)?s:r;this._draggable._newPos.x=o},_onDragEnd:function(t){var e=this._map,i=e.options,n=+new Date-this._lastTime,r=!i.inertia||n>i.inertiaThreshold||!this._positions[0];if(e.fire("dragend",t),r)e.fire("moveend");else{var o=this._lastPos.subtract(this._positions[0]),a=(this._lastTime+n-this._times[0])/1e3,l=i.easeLinearity,h=o.multiplyBy(l/a),u=h.distanceTo([0,0]),p=Math.min(i.inertiaMaxSpeed,u),c=h.multiplyBy(p/u),d=p/(i.inertiaDeceleration*l),m=c.multiplyBy(-d/2).round();m.x&&m.y?(m=e._limitOffset(m,e.options.maxBounds),s.Util.requestAnimFrame(function(){e.panBy(m,{duration:d,easeLinearity:l,noMoveStart:!0})})):e.fire("moveend")}}}),s.Map.addInitHook("addHandler","dragging",s.Map.Drag),s.Map.mergeOptions({doubleClickZoom:!0}),s.Map.DoubleClickZoom=s.Handler.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(t){var e=this._map,i=e.getZoom()+(t.originalEvent.shiftKey?-1:1);"center"===e.options.doubleClickZoom?e.setZoom(i):e.setZoomAround(t.containerPoint,i)}}),s.Map.addInitHook("addHandler","doubleClickZoom",s.Map.DoubleClickZoom),s.Map.mergeOptions({scrollWheelZoom:!0}),s.Map.ScrollWheelZoom=s.Handler.extend({addHooks:function(){s.DomEvent.on(this._map._container,"mousewheel",this._onWheelScroll,this),s.DomEvent.on(this._map._container,"MozMousePixelScroll",s.DomEvent.preventDefault),this._delta=0},removeHooks:function(){s.DomEvent.off(this._map._container,"mousewheel",this._onWheelScroll),s.DomEvent.off(this._map._container,"MozMousePixelScroll",s.DomEvent.preventDefault)},_onWheelScroll:function(t){var e=s.DomEvent.getWheelDelta(t);this._delta+=e,this._lastMousePos=this._map.mouseEventToContainerPoint(t),this._startTime||(this._startTime=+new Date);var i=Math.max(40-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(s.bind(this._performZoom,this),i),s.DomEvent.preventDefault(t),s.DomEvent.stopPropagation(t)},_performZoom:function(){var t=this._map,e=this._delta,i=t.getZoom();e=e>0?Math.ceil(e):Math.floor(e),e=Math.max(Math.min(e,4),-4),e=t._limitZoom(i+e)-i,this._delta=0,this._startTime=null,e&&("center"===t.options.scrollWheelZoom?t.setZoom(i+e):t.setZoomAround(this._lastMousePos,i+e))}}),s.Map.addInitHook("addHandler","scrollWheelZoom",s.Map.ScrollWheelZoom),s.extend(s.DomEvent,{_touchstart:s.Browser.msPointer?"MSPointerDown":s.Browser.pointer?"pointerdown":"touchstart",_touchend:s.Browser.msPointer?"MSPointerUp":s.Browser.pointer?"pointerup":"touchend",addDoubleTapListener:function(t,i,n){function r(t){var e;if(s.Browser.pointer?(m.push(t.pointerId),e=m.length):e=t.touches.length,!(e>1)){var i=Date.now(),n=i-(a||i);l=t.touches?t.touches[0]:t,h=n>0&&u>=n,a=i}}function o(t){if(s.Browser.pointer){var e=m.indexOf(t.pointerId);if(-1===e)return;m.splice(e,1)}if(h){if(s.Browser.pointer){var n,r={};for(var o in l)n=l[o],r[o]="function"==typeof n?n.bind(l):n;l=r}l.type="dblclick",i(l),a=null}}var a,l,h=!1,u=250,p="_leaflet_",c=this._touchstart,d=this._touchend,m=[];t[p+c+n]=r,t[p+d+n]=o;var f=s.Browser.pointer?e.documentElement:t;return t.addEventListener(c,r,!1),f.addEventListener(d,o,!1),s.Browser.pointer&&f.addEventListener(s.DomEvent.POINTER_CANCEL,o,!1),this},removeDoubleTapListener:function(t,i){var n="_leaflet_";return t.removeEventListener(this._touchstart,t[n+this._touchstart+i],!1),(s.Browser.pointer?e.documentElement:t).removeEventListener(this._touchend,t[n+this._touchend+i],!1),s.Browser.pointer&&e.documentElement.removeEventListener(s.DomEvent.POINTER_CANCEL,t[n+this._touchend+i],!1),this}}),s.extend(s.DomEvent,{POINTER_DOWN:s.Browser.msPointer?"MSPointerDown":"pointerdown",POINTER_MOVE:s.Browser.msPointer?"MSPointerMove":"pointermove",POINTER_UP:s.Browser.msPointer?"MSPointerUp":"pointerup",POINTER_CANCEL:s.Browser.msPointer?"MSPointerCancel":"pointercancel",_pointers:[],_pointerDocumentListener:!1,addPointerListener:function(t,e,i,n){switch(e){case"touchstart":return this.addPointerListenerStart(t,e,i,n);case"touchend":return this.addPointerListenerEnd(t,e,i,n);case"touchmove":return this.addPointerListenerMove(t,e,i,n);default:throw"Unknown touch event type"}},addPointerListenerStart:function(t,i,n,r){var o="_leaflet_",a=this._pointers,l=function(t){s.DomEvent.preventDefault(t);for(var e=!1,i=0;i<a.length;i++)if(a[i].pointerId===t.pointerId){e=!0;break}e||a.push(t),t.touches=a.slice(),t.changedTouches=[t],n(t)};if(t[o+"touchstart"+r]=l,t.addEventListener(this.POINTER_DOWN,l,!1),!this._pointerDocumentListener){var h=function(t){for(var e=0;e<a.length;e++)if(a[e].pointerId===t.pointerId){a.splice(e,1);break}};e.documentElement.addEventListener(this.POINTER_UP,h,!1),e.documentElement.addEventListener(this.POINTER_CANCEL,h,!1),this._pointerDocumentListener=!0}return this},addPointerListenerMove:function(t,e,i,n){function s(t){if(t.pointerType!==t.MSPOINTER_TYPE_MOUSE&&"mouse"!==t.pointerType||0!==t.buttons){for(var e=0;e<o.length;e++)if(o[e].pointerId===t.pointerId){o[e]=t;break}t.touches=o.slice(),t.changedTouches=[t],i(t)}}var r="_leaflet_",o=this._pointers;return t[r+"touchmove"+n]=s,t.addEventListener(this.POINTER_MOVE,s,!1),this},addPointerListenerEnd:function(t,e,i,n){var s="_leaflet_",r=this._pointers,o=function(t){for(var e=0;e<r.length;e++)if(r[e].pointerId===t.pointerId){r.splice(e,1);break}t.touches=r.slice(),t.changedTouches=[t],i(t)};return t[s+"touchend"+n]=o,t.addEventListener(this.POINTER_UP,o,!1),t.addEventListener(this.POINTER_CANCEL,o,!1),this},removePointerListener:function(t,e,i){var n="_leaflet_",s=t[n+e+i];switch(e){case"touchstart":t.removeEventListener(this.POINTER_DOWN,s,!1);break;case"touchmove":t.removeEventListener(this.POINTER_MOVE,s,!1);break;case"touchend":t.removeEventListener(this.POINTER_UP,s,!1),t.removeEventListener(this.POINTER_CANCEL,s,!1)}return this}}),s.Map.mergeOptions({touchZoom:s.Browser.touch&&!s.Browser.android23,bounceAtZoomLimits:!0}),s.Map.TouchZoom=s.Handler.extend({addHooks:function(){s.DomEvent.on(this._map._container,"touchstart",this._onTouchStart,this)
},removeHooks:function(){s.DomEvent.off(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(t){var i=this._map;if(t.touches&&2===t.touches.length&&!i._animatingZoom&&!this._zooming){var n=i.mouseEventToLayerPoint(t.touches[0]),r=i.mouseEventToLayerPoint(t.touches[1]),o=i._getCenterLayerPoint();this._startCenter=n.add(r)._divideBy(2),this._startDist=n.distanceTo(r),this._moved=!1,this._zooming=!0,this._centerOffset=o.subtract(this._startCenter),i._panAnim&&i._panAnim.stop(),s.DomEvent.on(e,"touchmove",this._onTouchMove,this).on(e,"touchend",this._onTouchEnd,this),s.DomEvent.preventDefault(t)}},_onTouchMove:function(t){var e=this._map;if(t.touches&&2===t.touches.length&&this._zooming){var i=e.mouseEventToLayerPoint(t.touches[0]),n=e.mouseEventToLayerPoint(t.touches[1]);this._scale=i.distanceTo(n)/this._startDist,this._delta=i._add(n)._divideBy(2)._subtract(this._startCenter),1!==this._scale&&(e.options.bounceAtZoomLimits||!(e.getZoom()===e.getMinZoom()&&this._scale<1||e.getZoom()===e.getMaxZoom()&&this._scale>1))&&(this._moved||(s.DomUtil.addClass(e._mapPane,"leaflet-touching"),e.fire("movestart").fire("zoomstart"),this._moved=!0),s.Util.cancelAnimFrame(this._animRequest),this._animRequest=s.Util.requestAnimFrame(this._updateOnMove,this,!0,this._map._container),s.DomEvent.preventDefault(t))}},_updateOnMove:function(){var t=this._map,e=this._getScaleOrigin(),i=t.layerPointToLatLng(e),n=t.getScaleZoom(this._scale);t._animateZoom(i,n,this._startCenter,this._scale,this._delta,!1,!0)},_onTouchEnd:function(){if(!this._moved||!this._zooming)return void(this._zooming=!1);var t=this._map;this._zooming=!1,s.DomUtil.removeClass(t._mapPane,"leaflet-touching"),s.Util.cancelAnimFrame(this._animRequest),s.DomEvent.off(e,"touchmove",this._onTouchMove).off(e,"touchend",this._onTouchEnd);var i=this._getScaleOrigin(),n=t.layerPointToLatLng(i),r=t.getZoom(),o=t.getScaleZoom(this._scale)-r,a=o>0?Math.ceil(o):Math.floor(o),l=t._limitZoom(r+a),h=t.getZoomScale(l)/this._scale;t._animateZoom(n,l,i,h)},_getScaleOrigin:function(){var t=this._centerOffset.subtract(this._delta).divideBy(this._scale);return this._startCenter.add(t)}}),s.Map.addInitHook("addHandler","touchZoom",s.Map.TouchZoom),s.Map.mergeOptions({tap:!0,tapTolerance:15}),s.Map.Tap=s.Handler.extend({addHooks:function(){s.DomEvent.on(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){s.DomEvent.off(this._map._container,"touchstart",this._onDown,this)},_onDown:function(t){if(t.touches){if(s.DomEvent.preventDefault(t),this._fireClick=!0,t.touches.length>1)return this._fireClick=!1,void clearTimeout(this._holdTimeout);var i=t.touches[0],n=i.target;this._startPos=this._newPos=new s.Point(i.clientX,i.clientY),n.tagName&&"a"===n.tagName.toLowerCase()&&s.DomUtil.addClass(n,"leaflet-active"),this._holdTimeout=setTimeout(s.bind(function(){this._isTapValid()&&(this._fireClick=!1,this._onUp(),this._simulateEvent("contextmenu",i))},this),1e3),s.DomEvent.on(e,"touchmove",this._onMove,this).on(e,"touchend",this._onUp,this)}},_onUp:function(t){if(clearTimeout(this._holdTimeout),s.DomEvent.off(e,"touchmove",this._onMove,this).off(e,"touchend",this._onUp,this),this._fireClick&&t&&t.changedTouches){var i=t.changedTouches[0],n=i.target;n&&n.tagName&&"a"===n.tagName.toLowerCase()&&s.DomUtil.removeClass(n,"leaflet-active"),this._isTapValid()&&this._simulateEvent("click",i)}},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_onMove:function(t){var e=t.touches[0];this._newPos=new s.Point(e.clientX,e.clientY)},_simulateEvent:function(i,n){var s=e.createEvent("MouseEvents");s._simulated=!0,n.target._simulatedClick=!0,s.initMouseEvent(i,!0,!0,t,1,n.screenX,n.screenY,n.clientX,n.clientY,!1,!1,!1,!1,0,null),n.target.dispatchEvent(s)}}),s.Browser.touch&&!s.Browser.pointer&&s.Map.addInitHook("addHandler","tap",s.Map.Tap),s.Map.mergeOptions({boxZoom:!0}),s.Map.BoxZoom=s.Handler.extend({initialize:function(t){this._map=t,this._container=t._container,this._pane=t._panes.overlayPane,this._moved=!1},addHooks:function(){s.DomEvent.on(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){s.DomEvent.off(this._container,"mousedown",this._onMouseDown),this._moved=!1},moved:function(){return this._moved},_onMouseDown:function(t){return this._moved=!1,!t.shiftKey||1!==t.which&&1!==t.button?!1:(s.DomUtil.disableTextSelection(),s.DomUtil.disableImageDrag(),this._startLayerPoint=this._map.mouseEventToLayerPoint(t),void s.DomEvent.on(e,"mousemove",this._onMouseMove,this).on(e,"mouseup",this._onMouseUp,this).on(e,"keydown",this._onKeyDown,this))},_onMouseMove:function(t){this._moved||(this._box=s.DomUtil.create("div","leaflet-zoom-box",this._pane),s.DomUtil.setPosition(this._box,this._startLayerPoint),this._container.style.cursor="crosshair",this._map.fire("boxzoomstart"));var e=this._startLayerPoint,i=this._box,n=this._map.mouseEventToLayerPoint(t),r=n.subtract(e),o=new s.Point(Math.min(n.x,e.x),Math.min(n.y,e.y));s.DomUtil.setPosition(i,o),this._moved=!0,i.style.width=Math.max(0,Math.abs(r.x)-4)+"px",i.style.height=Math.max(0,Math.abs(r.y)-4)+"px"},_finish:function(){this._moved&&(this._pane.removeChild(this._box),this._container.style.cursor=""),s.DomUtil.enableTextSelection(),s.DomUtil.enableImageDrag(),s.DomEvent.off(e,"mousemove",this._onMouseMove).off(e,"mouseup",this._onMouseUp).off(e,"keydown",this._onKeyDown)},_onMouseUp:function(t){this._finish();var e=this._map,i=e.mouseEventToLayerPoint(t);if(!this._startLayerPoint.equals(i)){var n=new s.LatLngBounds(e.layerPointToLatLng(this._startLayerPoint),e.layerPointToLatLng(i));e.fitBounds(n),e.fire("boxzoomend",{boxZoomBounds:n})}},_onKeyDown:function(t){27===t.keyCode&&this._finish()}}),s.Map.addInitHook("addHandler","boxZoom",s.Map.BoxZoom),s.Map.mergeOptions({keyboard:!0,keyboardPanOffset:80,keyboardZoomOffset:1}),s.Map.Keyboard=s.Handler.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,173]},initialize:function(t){this._map=t,this._setPanOffset(t.options.keyboardPanOffset),this._setZoomOffset(t.options.keyboardZoomOffset)},addHooks:function(){var t=this._map._container;-1===t.tabIndex&&(t.tabIndex="0"),s.DomEvent.on(t,"focus",this._onFocus,this).on(t,"blur",this._onBlur,this).on(t,"mousedown",this._onMouseDown,this),this._map.on("focus",this._addHooks,this).on("blur",this._removeHooks,this)},removeHooks:function(){this._removeHooks();var t=this._map._container;s.DomEvent.off(t,"focus",this._onFocus,this).off(t,"blur",this._onBlur,this).off(t,"mousedown",this._onMouseDown,this),this._map.off("focus",this._addHooks,this).off("blur",this._removeHooks,this)},_onMouseDown:function(){if(!this._focused){var i=e.body,n=e.documentElement,s=i.scrollTop||n.scrollTop,r=i.scrollLeft||n.scrollLeft;this._map._container.focus(),t.scrollTo(r,s)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanOffset:function(t){var e,i,n=this._panKeys={},s=this.keyCodes;for(e=0,i=s.left.length;i>e;e++)n[s.left[e]]=[-1*t,0];for(e=0,i=s.right.length;i>e;e++)n[s.right[e]]=[t,0];for(e=0,i=s.down.length;i>e;e++)n[s.down[e]]=[0,t];for(e=0,i=s.up.length;i>e;e++)n[s.up[e]]=[0,-1*t]},_setZoomOffset:function(t){var e,i,n=this._zoomKeys={},s=this.keyCodes;for(e=0,i=s.zoomIn.length;i>e;e++)n[s.zoomIn[e]]=t;for(e=0,i=s.zoomOut.length;i>e;e++)n[s.zoomOut[e]]=-t},_addHooks:function(){s.DomEvent.on(e,"keydown",this._onKeyDown,this)},_removeHooks:function(){s.DomEvent.off(e,"keydown",this._onKeyDown,this)},_onKeyDown:function(t){var e=t.keyCode,i=this._map;if(e in this._panKeys){if(i._panAnim&&i._panAnim._inProgress)return;i.panBy(this._panKeys[e]),i.options.maxBounds&&i.panInsideBounds(i.options.maxBounds)}else{if(!(e in this._zoomKeys))return;i.setZoom(i.getZoom()+this._zoomKeys[e])}s.DomEvent.stop(t)}}),s.Map.addInitHook("addHandler","keyboard",s.Map.Keyboard),s.Handler.MarkerDrag=s.Handler.extend({initialize:function(t){this._marker=t},addHooks:function(){var t=this._marker._icon;this._draggable||(this._draggable=new s.Draggable(t,t)),this._draggable.on("dragstart",this._onDragStart,this).on("drag",this._onDrag,this).on("dragend",this._onDragEnd,this),this._draggable.enable(),s.DomUtil.addClass(this._marker._icon,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off("dragstart",this._onDragStart,this).off("drag",this._onDrag,this).off("dragend",this._onDragEnd,this),this._draggable.disable(),s.DomUtil.removeClass(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_onDragStart:function(){this._marker.closePopup().fire("movestart").fire("dragstart")},_onDrag:function(){var t=this._marker,e=t._shadow,i=s.DomUtil.getPosition(t._icon),n=t._map.layerPointToLatLng(i);e&&s.DomUtil.setPosition(e,i),t._latlng=n,t.fire("move",{latlng:n}).fire("drag")},_onDragEnd:function(t){this._marker.fire("moveend").fire("dragend",t)}}),s.Control=s.Class.extend({options:{position:"topright"},initialize:function(t){s.setOptions(this,t)},getPosition:function(){return this.options.position},setPosition:function(t){var e=this._map;return e&&e.removeControl(this),this.options.position=t,e&&e.addControl(this),this},getContainer:function(){return this._container},addTo:function(t){this._map=t;var e=this._container=this.onAdd(t),i=this.getPosition(),n=t._controlCorners[i];return s.DomUtil.addClass(e,"leaflet-control"),-1!==i.indexOf("bottom")?n.insertBefore(e,n.firstChild):n.appendChild(e),this},removeFrom:function(t){var e=this.getPosition(),i=t._controlCorners[e];return i.removeChild(this._container),this._map=null,this.onRemove&&this.onRemove(t),this},_refocusOnMap:function(){this._map&&this._map.getContainer().focus()}}),s.control=function(t){return new s.Control(t)},s.Map.include({addControl:function(t){return t.addTo(this),this},removeControl:function(t){return t.removeFrom(this),this},_initControlPos:function(){function t(t,r){var o=i+t+" "+i+r;e[t+r]=s.DomUtil.create("div",o,n)}var e=this._controlCorners={},i="leaflet-",n=this._controlContainer=s.DomUtil.create("div",i+"control-container",this._container);t("top","left"),t("top","right"),t("bottom","left"),t("bottom","right")},_clearControlPos:function(){this._container.removeChild(this._controlContainer)}}),s.Control.Zoom=s.Control.extend({options:{position:"topleft",zoomInText:"+",zoomInTitle:"Zoom in",zoomOutText:"-",zoomOutTitle:"Zoom out"},onAdd:function(t){var e="leaflet-control-zoom",i=s.DomUtil.create("div",e+" leaflet-bar");return this._map=t,this._zoomInButton=this._createButton(this.options.zoomInText,this.options.zoomInTitle,e+"-in",i,this._zoomIn,this),this._zoomOutButton=this._createButton(this.options.zoomOutText,this.options.zoomOutTitle,e+"-out",i,this._zoomOut,this),this._updateDisabled(),t.on("zoomend zoomlevelschange",this._updateDisabled,this),i},onRemove:function(t){t.off("zoomend zoomlevelschange",this._updateDisabled,this)},_zoomIn:function(t){this._map.zoomIn(t.shiftKey?3:1)},_zoomOut:function(t){this._map.zoomOut(t.shiftKey?3:1)},_createButton:function(t,e,i,n,r,o){var a=s.DomUtil.create("a",i,n);a.innerHTML=t,a.href="#",a.title=e;var l=s.DomEvent.stopPropagation;return s.DomEvent.on(a,"click",l).on(a,"mousedown",l).on(a,"dblclick",l).on(a,"click",s.DomEvent.preventDefault).on(a,"click",r,o).on(a,"click",this._refocusOnMap,o),a},_updateDisabled:function(){var t=this._map,e="leaflet-disabled";s.DomUtil.removeClass(this._zoomInButton,e),s.DomUtil.removeClass(this._zoomOutButton,e),t._zoom===t.getMinZoom()&&s.DomUtil.addClass(this._zoomOutButton,e),t._zoom===t.getMaxZoom()&&s.DomUtil.addClass(this._zoomInButton,e)}}),s.Map.mergeOptions({zoomControl:!0}),s.Map.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new s.Control.Zoom,this.addControl(this.zoomControl))}),s.control.zoom=function(t){return new s.Control.Zoom(t)},s.Control.Attribution=s.Control.extend({options:{position:"bottomright",prefix:'<a href="http://leafletjs.com" title="A JS library for interactive maps">Leaflet</a>'},initialize:function(t){s.setOptions(this,t),this._attributions={}},onAdd:function(t){this._container=s.DomUtil.create("div","leaflet-control-attribution"),s.DomEvent.disableClickPropagation(this._container);for(var e in t._layers)t._layers[e].getAttribution&&this.addAttribution(t._layers[e].getAttribution());return t.on("layeradd",this._onLayerAdd,this).on("layerremove",this._onLayerRemove,this),this._update(),this._container},onRemove:function(t){t.off("layeradd",this._onLayerAdd).off("layerremove",this._onLayerRemove)},setPrefix:function(t){return this.options.prefix=t,this._update(),this},addAttribution:function(t){return t?(this._attributions[t]||(this._attributions[t]=0),this._attributions[t]++,this._update(),this):void 0},removeAttribution:function(t){return t?(this._attributions[t]&&(this._attributions[t]--,this._update()),this):void 0},_update:function(){if(this._map){var t=[];for(var e in this._attributions)this._attributions[e]&&t.push(e);var i=[];this.options.prefix&&i.push(this.options.prefix),t.length&&i.push(t.join(", ")),this._container.innerHTML=i.join(" | ")}},_onLayerAdd:function(t){t.layer.getAttribution&&this.addAttribution(t.layer.getAttribution())},_onLayerRemove:function(t){t.layer.getAttribution&&this.removeAttribution(t.layer.getAttribution())}}),s.Map.mergeOptions({attributionControl:!0}),s.Map.addInitHook(function(){this.options.attributionControl&&(this.attributionControl=(new s.Control.Attribution).addTo(this))}),s.control.attribution=function(t){return new s.Control.Attribution(t)},s.Control.Scale=s.Control.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0,updateWhenIdle:!1},onAdd:function(t){this._map=t;var e="leaflet-control-scale",i=s.DomUtil.create("div",e),n=this.options;return this._addScales(n,e,i),t.on(n.updateWhenIdle?"moveend":"move",this._update,this),t.whenReady(this._update,this),i},onRemove:function(t){t.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(t,e,i){t.metric&&(this._mScale=s.DomUtil.create("div",e+"-line",i)),t.imperial&&(this._iScale=s.DomUtil.create("div",e+"-line",i))},_update:function(){var t=this._map.getBounds(),e=t.getCenter().lat,i=6378137*Math.PI*Math.cos(e*Math.PI/180),n=i*(t.getNorthEast().lng-t.getSouthWest().lng)/180,s=this._map.getSize(),r=this.options,o=0;s.x>0&&(o=n*(r.maxWidth/s.x)),this._updateScales(r,o)},_updateScales:function(t,e){t.metric&&e&&this._updateMetric(e),t.imperial&&e&&this._updateImperial(e)},_updateMetric:function(t){var e=this._getRoundNum(t);this._mScale.style.width=this._getScaleWidth(e/t)+"px",this._mScale.innerHTML=1e3>e?e+" m":e/1e3+" km"},_updateImperial:function(t){var e,i,n,s=3.2808399*t,r=this._iScale;s>5280?(e=s/5280,i=this._getRoundNum(e),r.style.width=this._getScaleWidth(i/e)+"px",r.innerHTML=i+" mi"):(n=this._getRoundNum(s),r.style.width=this._getScaleWidth(n/s)+"px",r.innerHTML=n+" ft")},_getScaleWidth:function(t){return Math.round(this.options.maxWidth*t)-10},_getRoundNum:function(t){var e=Math.pow(10,(Math.floor(t)+"").length-1),i=t/e;return i=i>=10?10:i>=5?5:i>=3?3:i>=2?2:1,e*i}}),s.control.scale=function(t){return new s.Control.Scale(t)},s.Control.Layers=s.Control.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0},initialize:function(t,e,i){s.setOptions(this,i),this._layers={},this._lastZIndex=0,this._handlingClick=!1;for(var n in t)this._addLayer(t[n],n);for(n in e)this._addLayer(e[n],n,!0)},onAdd:function(t){return this._initLayout(),this._update(),t.on("layeradd",this._onLayerChange,this).on("layerremove",this._onLayerChange,this),this._container},onRemove:function(t){t.off("layeradd",this._onLayerChange,this).off("layerremove",this._onLayerChange,this)},addBaseLayer:function(t,e){return this._addLayer(t,e),this._update(),this},addOverlay:function(t,e){return this._addLayer(t,e,!0),this._update(),this},removeLayer:function(t){var e=s.stamp(t);return delete this._layers[e],this._update(),this},_initLayout:function(){var t="leaflet-control-layers",e=this._container=s.DomUtil.create("div",t);e.setAttribute("aria-haspopup",!0),s.Browser.touch?s.DomEvent.on(e,"click",s.DomEvent.stopPropagation):s.DomEvent.disableClickPropagation(e).disableScrollPropagation(e);var i=this._form=s.DomUtil.create("form",t+"-list");if(this.options.collapsed){s.Browser.android||s.DomEvent.on(e,"mouseover",this._expand,this).on(e,"mouseout",this._collapse,this);var n=this._layersLink=s.DomUtil.create("a",t+"-toggle",e);n.href="#",n.title="Layers",s.Browser.touch?s.DomEvent.on(n,"click",s.DomEvent.stop).on(n,"click",this._expand,this):s.DomEvent.on(n,"focus",this._expand,this),s.DomEvent.on(i,"click",function(){setTimeout(s.bind(this._onInputClick,this),0)},this),this._map.on("click",this._collapse,this)}else this._expand();this._baseLayersList=s.DomUtil.create("div",t+"-base",i),this._separator=s.DomUtil.create("div",t+"-separator",i),this._overlaysList=s.DomUtil.create("div",t+"-overlays",i),e.appendChild(i)},_addLayer:function(t,e,i){var n=s.stamp(t);this._layers[n]={layer:t,name:e,overlay:i},this.options.autoZIndex&&t.setZIndex&&(this._lastZIndex++,t.setZIndex(this._lastZIndex))},_update:function(){if(this._container){this._baseLayersList.innerHTML="",this._overlaysList.innerHTML="";var t,e,i=!1,n=!1;for(t in this._layers)e=this._layers[t],this._addItem(e),n=n||e.overlay,i=i||!e.overlay;this._separator.style.display=n&&i?"":"none"}},_onLayerChange:function(t){var e=this._layers[s.stamp(t.layer)];if(e){this._handlingClick||this._update();var i=e.overlay?"layeradd"===t.type?"overlayadd":"overlayremove":"layeradd"===t.type?"baselayerchange":null;i&&this._map.fire(i,e)}},_createRadioElement:function(t,i){var n='<input type="radio" class="leaflet-control-layers-selector" name="'+t+'"';i&&(n+=' checked="checked"'),n+="/>";var s=e.createElement("div");return s.innerHTML=n,s.firstChild},_addItem:function(t){var i,n=e.createElement("label"),r=this._map.hasLayer(t.layer);t.overlay?(i=e.createElement("input"),i.type="checkbox",i.className="leaflet-control-layers-selector",i.defaultChecked=r):i=this._createRadioElement("leaflet-base-layers",r),i.layerId=s.stamp(t.layer),s.DomEvent.on(i,"click",this._onInputClick,this);var o=e.createElement("span");o.innerHTML=" "+t.name,n.appendChild(i),n.appendChild(o);var a=t.overlay?this._overlaysList:this._baseLayersList;return a.appendChild(n),n},_onInputClick:function(){var t,e,i,n=this._form.getElementsByTagName("input"),s=n.length;for(this._handlingClick=!0,t=0;s>t;t++)e=n[t],i=this._layers[e.layerId],e.checked&&!this._map.hasLayer(i.layer)?this._map.addLayer(i.layer):!e.checked&&this._map.hasLayer(i.layer)&&this._map.removeLayer(i.layer);this._handlingClick=!1,this._refocusOnMap()},_expand:function(){s.DomUtil.addClass(this._container,"leaflet-control-layers-expanded")},_collapse:function(){this._container.className=this._container.className.replace(" leaflet-control-layers-expanded","")}}),s.control.layers=function(t,e,i){return new s.Control.Layers(t,e,i)},s.PosAnimation=s.Class.extend({includes:s.Mixin.Events,run:function(t,e,i,n){this.stop(),this._el=t,this._inProgress=!0,this._newPos=e,this.fire("start"),t.style[s.DomUtil.TRANSITION]="all "+(i||.25)+"s cubic-bezier(0,0,"+(n||.5)+",1)",s.DomEvent.on(t,s.DomUtil.TRANSITION_END,this._onTransitionEnd,this),s.DomUtil.setPosition(t,e),s.Util.falseFn(t.offsetWidth),this._stepTimer=setInterval(s.bind(this._onStep,this),50)},stop:function(){this._inProgress&&(s.DomUtil.setPosition(this._el,this._getPos()),this._onTransitionEnd(),s.Util.falseFn(this._el.offsetWidth))},_onStep:function(){var t=this._getPos();return t?(this._el._leaflet_pos=t,void this.fire("step")):void this._onTransitionEnd()},_transformRe:/([-+]?(?:\d*\.)?\d+)\D*, ([-+]?(?:\d*\.)?\d+)\D*\)/,_getPos:function(){var e,i,n,r=this._el,o=t.getComputedStyle(r);if(s.Browser.any3d){if(n=o[s.DomUtil.TRANSFORM].match(this._transformRe),!n)return;e=parseFloat(n[1]),i=parseFloat(n[2])}else e=parseFloat(o.left),i=parseFloat(o.top);return new s.Point(e,i,!0)},_onTransitionEnd:function(){s.DomEvent.off(this._el,s.DomUtil.TRANSITION_END,this._onTransitionEnd,this),this._inProgress&&(this._inProgress=!1,this._el.style[s.DomUtil.TRANSITION]="",this._el._leaflet_pos=this._newPos,clearInterval(this._stepTimer),this.fire("step").fire("end"))}}),s.Map.include({setView:function(t,e,n){if(e=e===i?this._zoom:this._limitZoom(e),t=this._limitCenter(s.latLng(t),e,this.options.maxBounds),n=n||{},this._panAnim&&this._panAnim.stop(),this._loaded&&!n.reset&&n!==!0){n.animate!==i&&(n.zoom=s.extend({animate:n.animate},n.zoom),n.pan=s.extend({animate:n.animate},n.pan));var r=this._zoom!==e?this._tryAnimatedZoom&&this._tryAnimatedZoom(t,e,n.zoom):this._tryAnimatedPan(t,n.pan);if(r)return clearTimeout(this._sizeTimer),this}return this._resetView(t,e),this},panBy:function(t,e){if(t=s.point(t).round(),e=e||{},!t.x&&!t.y)return this;if(this._panAnim||(this._panAnim=new s.PosAnimation,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),e.noMoveStart||this.fire("movestart"),e.animate!==!1){s.DomUtil.addClass(this._mapPane,"leaflet-pan-anim");var i=this._getMapPanePos().subtract(t);this._panAnim.run(this._mapPane,i,e.duration||.25,e.easeLinearity)}else this._rawPanBy(t),this.fire("move").fire("moveend");return this},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){s.DomUtil.removeClass(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(t,e){var i=this._getCenterOffset(t)._floor();return(e&&e.animate)===!0||this.getSize().contains(i)?(this.panBy(i,e),!0):!1}}),s.PosAnimation=s.DomUtil.TRANSITION?s.PosAnimation:s.PosAnimation.extend({run:function(t,e,i,n){this.stop(),this._el=t,this._inProgress=!0,this._duration=i||.25,this._easeOutPower=1/Math.max(n||.5,.2),this._startPos=s.DomUtil.getPosition(t),this._offset=e.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(),this._complete())},_animate:function(){this._animId=s.Util.requestAnimFrame(this._animate,this),this._step()},_step:function(){var t=+new Date-this._startTime,e=1e3*this._duration;e>t?this._runFrame(this._easeOut(t/e)):(this._runFrame(1),this._complete())},_runFrame:function(t){var e=this._startPos.add(this._offset.multiplyBy(t));s.DomUtil.setPosition(this._el,e),this.fire("step")},_complete:function(){s.Util.cancelAnimFrame(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(t){return 1-Math.pow(1-t,this._easeOutPower)}}),s.Map.mergeOptions({zoomAnimation:!0,zoomAnimationThreshold:4}),s.DomUtil.TRANSITION&&s.Map.addInitHook(function(){this._zoomAnimated=this.options.zoomAnimation&&s.DomUtil.TRANSITION&&s.Browser.any3d&&!s.Browser.android23&&!s.Browser.mobileOpera,this._zoomAnimated&&s.DomEvent.on(this._mapPane,s.DomUtil.TRANSITION_END,this._catchTransitionEnd,this)}),s.Map.include(s.DomUtil.TRANSITION?{_catchTransitionEnd:function(t){this._animatingZoom&&t.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(t,e,i){if(this._animatingZoom)return!0;if(i=i||{},!this._zoomAnimated||i.animate===!1||this._nothingToAnimate()||Math.abs(e-this._zoom)>this.options.zoomAnimationThreshold)return!1;var n=this.getZoomScale(e),s=this._getCenterOffset(t)._divideBy(1-1/n),r=this._getCenterLayerPoint()._add(s);return i.animate===!0||this.getSize().contains(s)?(this.fire("movestart").fire("zoomstart"),this._animateZoom(t,e,r,n,null,!0),!0):!1},_animateZoom:function(t,e,i,n,r,o,a){a||(this._animatingZoom=!0),s.DomUtil.addClass(this._mapPane,"leaflet-zoom-anim"),this._animateToCenter=t,this._animateToZoom=e,s.Draggable&&(s.Draggable._disabled=!0),s.Util.requestAnimFrame(function(){this.fire("zoomanim",{center:t,zoom:e,origin:i,scale:n,delta:r,backwards:o})},this)},_onZoomTransitionEnd:function(){this._animatingZoom=!1,s.DomUtil.removeClass(this._mapPane,"leaflet-zoom-anim"),this._resetView(this._animateToCenter,this._animateToZoom,!0,!0),s.Draggable&&(s.Draggable._disabled=!1)}}:{}),s.TileLayer.include({_animateZoom:function(t){this._animating||(this._animating=!0,this._prepareBgBuffer());var e=this._bgBuffer,i=s.DomUtil.TRANSFORM,n=t.delta?s.DomUtil.getTranslateString(t.delta):e.style[i],r=s.DomUtil.getScaleString(t.scale,t.origin);e.style[i]=t.backwards?r+" "+n:n+" "+r},_endZoomAnim:function(){var t=this._tileContainer,e=this._bgBuffer;t.style.visibility="",t.parentNode.appendChild(t),s.Util.falseFn(e.offsetWidth),this._animating=!1},_clearBgBuffer:function(){var t=this._map;!t||t._animatingZoom||t.touchZoom._zooming||(this._bgBuffer.innerHTML="",this._bgBuffer.style[s.DomUtil.TRANSFORM]="")},_prepareBgBuffer:function(){var t=this._tileContainer,e=this._bgBuffer,i=this._getLoadedTilesPercentage(e),n=this._getLoadedTilesPercentage(t);return e&&i>.5&&.5>n?(t.style.visibility="hidden",void this._stopLoadingImages(t)):(e.style.visibility="hidden",e.style[s.DomUtil.TRANSFORM]="",this._tileContainer=e,e=this._bgBuffer=t,this._stopLoadingImages(e),void clearTimeout(this._clearBgBufferTimer))},_getLoadedTilesPercentage:function(t){var e,i,n=t.getElementsByTagName("img"),s=0;for(e=0,i=n.length;i>e;e++)n[e].complete&&s++;return s/i},_stopLoadingImages:function(t){var e,i,n,r=Array.prototype.slice.call(t.getElementsByTagName("img"));for(e=0,i=r.length;i>e;e++)n=r[e],n.complete||(n.onload=s.Util.falseFn,n.onerror=s.Util.falseFn,n.src=s.Util.emptyImageUrl,n.parentNode.removeChild(n))}}),s.Map.include({_defaultLocateOptions:{watch:!1,setView:!1,maxZoom:1/0,timeout:1e4,maximumAge:0,enableHighAccuracy:!1},locate:function(t){if(t=this._locateOptions=s.extend(this._defaultLocateOptions,t),!navigator.geolocation)return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var e=s.bind(this._handleGeolocationResponse,this),i=s.bind(this._handleGeolocationError,this);return t.watch?this._locationWatchId=navigator.geolocation.watchPosition(e,i,t):navigator.geolocation.getCurrentPosition(e,i,t),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(t){var e=t.code,i=t.message||(1===e?"permission denied":2===e?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:e,message:"Geolocation error: "+i+"."})},_handleGeolocationResponse:function(t){var e=t.coords.latitude,i=t.coords.longitude,n=new s.LatLng(e,i),r=180*t.coords.accuracy/40075017,o=r/Math.cos(s.LatLng.DEG_TO_RAD*e),a=s.latLngBounds([e-r,i-o],[e+r,i+o]),l=this._locateOptions;if(l.setView){var h=Math.min(this.getBoundsZoom(a),l.maxZoom);this.setView(n,h)}var u={latlng:n,bounds:a,timestamp:t.timestamp};for(var p in t.coords)"number"==typeof t.coords[p]&&(u[p]=t.coords[p]);this.fire("locationfound",u)}})}(window,document),function(t,e,i){"function"==typeof define&&define.amd?define(["jquery"],function(n){return i(n,t,e),n.mobile}):i(t.jQuery,t,e)}(this,document,function(t,e,i){!function(t){t.extend(t.support,{orientation:"orientation"in e&&"onorientationchange"in e})}(t),function(t){t.event.special.throttledresize={setup:function(){t(this).bind("resize",r)},teardown:function(){t(this).unbind("resize",r)}};var e,i,n,s=250,r=function(){i=(new Date).getTime(),n=i-o,n>=s?(o=i,t(this).trigger("throttledresize")):(e&&clearTimeout(e),e=setTimeout(r,s-n))},o=0}(t),function(t,e){function n(){var t=s();t!==r&&(r=t,p.trigger(c))}var s,r,o,a,l,h,u,p=t(e),c="orientationchange",d={0:!0,180:!0};t.support.orientation&&(l=e.innerWidth||p.width(),h=e.innerHeight||p.height(),u=50,o=l>h&&l-h>u,a=d[e.orientation],(o&&a||!o&&!a)&&(d={"-90":!0,90:!0})),t.event.special.orientationchange=t.extend({},t.event.special.orientationchange,{setup:function(){return t.support.orientation&&!t.event.special.orientationchange.disabled?!1:(r=s(),void p.bind("throttledresize",n))},teardown:function(){return t.support.orientation&&!t.event.special.orientationchange.disabled?!1:void p.unbind("throttledresize",n)},add:function(t){var e=t.handler;t.handler=function(t){return t.orientation=s(),e.apply(this,arguments)}}}),t.event.special.orientationchange.orientation=s=function(){var n=!0,s=i.documentElement;return n=t.support.orientation?d[e.orientation]:s&&s.clientWidth/s.clientHeight<1.1,n?"portrait":"landscape"},t.fn[c]=function(t){return t?this.bind(c,t):this.trigger(c)},t.attrFn&&(t.attrFn[c]=!0)}(t,this),function(t,e,i,n){function s(t){for(;t&&"undefined"!=typeof t.originalEvent;)t=t.originalEvent;return t}function r(e,i){var r,o,a,l,h,u,p,c,d,m=e.type;if(e=t.Event(e),e.type=i,r=e.originalEvent,o=t.event.props,m.search(/^(mouse|click)/)>-1&&(o=N),r)for(p=o.length,l;p;)l=o[--p],e[l]=r[l];if(m.search(/mouse(down|up)|click/)>-1&&!e.which&&(e.which=1),-1!==m.search(/^touch/)&&(a=s(r),m=a.touches,h=a.changedTouches,u=m&&m.length?m[0]:h&&h.length?h[0]:n,u))for(c=0,d=P.length;d>c;c++)l=P[c],e[l]=u[l];return e}function o(e){for(var i,n,s={};e;){i=t.data(e,S);for(n in i)i[n]&&(s[n]=s.hasVirtualBinding=!0);e=e.parentNode}return s}function a(e,i){for(var n;e;){if(n=t.data(e,S),n&&(!i||n[i]))return e;e=e.parentNode}return null}function l(){z=!1}function h(){z=!0}function u(){j=0,I.length=0,R=!1,h()}function p(){l()}function c(){d(),A=setTimeout(function(){A=0,u()},t.vmouse.resetTimerDuration)}function d(){A&&(clearTimeout(A),A=0)}function m(e,i,n){var s;return(n&&n[e]||!n&&a(i.target,e))&&(s=r(i,e),t(i.target).trigger(s)),s}function f(e){var i,n=t.data(e.target,C);!R&&(!j||j!==n)&&(i=m("v"+e.type,e),i&&(i.isDefaultPrevented()&&e.preventDefault(),i.isPropagationStopped()&&e.stopPropagation(),i.isImmediatePropagationStopped()&&e.stopImmediatePropagation()))}function y(e){var i,n,r,a=s(e).touches;a&&1===a.length&&(i=e.target,n=o(i),n.hasVirtualBinding&&(j=G++,t.data(i,C,j),d(),p(),F=!1,r=s(e).touches[0],k=r.pageX,D=r.pageY,m("vmouseover",e,n),m("vmousedown",e,n)))}function g(t){z||(F||m("vmousecancel",t,o(t.target)),F=!0,c())}function v(e){if(!z){var i=s(e).touches[0],n=F,r=t.vmouse.moveDistanceThreshold,a=o(e.target);F=F||Math.abs(i.pageX-k)>r||Math.abs(i.pageY-D)>r,F&&!n&&m("vmousecancel",e,a),m("vmousemove",e,a),c()}}function L(t){if(!z){h();var e,i,n=o(t.target);m("vmouseup",t,n),F||(e=m("vclick",t,n),e&&e.isDefaultPrevented()&&(i=s(t).changedTouches[0],I.push({touchID:j,x:i.clientX,y:i.clientY}),R=!0)),m("vmouseout",t,n),F=!1,c()}}function _(e){var i,n=t.data(e,S);if(n)for(i in n)if(n[i])return!0;return!1}function O(){}function b(e){var i=e.substr(1);return{setup:function(){_(this)||t.data(this,S,{});var n=t.data(this,S);n[e]=!0,T[e]=(T[e]||0)+1,1===T[e]&&B.bind(i,f),t(this).bind(i,O),U&&(T.touchstart=(T.touchstart||0)+1,1===T.touchstart&&B.bind("touchstart",y).bind("touchend",L).bind("touchmove",v).bind("scroll",g))},teardown:function(){--T[e],T[e]||B.unbind(i,f),U&&(--T.touchstart,T.touchstart||B.unbind("touchstart",y).unbind("touchmove",v).unbind("touchend",L).unbind("scroll",g));var n=t(this),s=t.data(this,S);s&&(s[e]=!1),n.unbind(i,O),_(this)||n.removeData(S)}}}var w,x,S="virtualMouseBindings",C="virtualTouchID",E="vmouseover vmousedown vmousemove vmouseup vclick vmouseout vmousecancel".split(" "),P="clientX clientY pageX pageY screenX screenY".split(" "),M=t.event.mouseHooks?t.event.mouseHooks.props:[],N=t.event.props.concat(M),T={},A=0,k=0,D=0,F=!1,I=[],R=!1,z=!1,U="addEventListener"in i,B=t(i),G=1,j=0;for(t.vmouse={moveDistanceThreshold:10,clickDistanceThreshold:10,resetTimerDuration:1500},x=0;x<E.length;x++)t.event.special[E[x]]=b(E[x]);U&&i.addEventListener("click",function(e){var i,n,s,r,o,a,l=I.length,h=e.target;if(l)for(i=e.clientX,n=e.clientY,w=t.vmouse.clickDistanceThreshold,s=h;s;){for(r=0;l>r;r++)if(o=I[r],a=0,s===h&&Math.abs(o.x-i)<w&&Math.abs(o.y-n)<w||t.data(s,C)===o.touchID)return e.preventDefault(),void e.stopPropagation();
s=s.parentNode}},!0)}(t,e,i),function(t){t.mobile={}}(t),function(t){var e={touch:"ontouchend"in i};t.mobile.support=t.mobile.support||{},t.extend(t.support,e),t.extend(t.mobile.support,e)}(t),function(t){function e(e,i,n){var s=n.type;n.type=i,t.event.dispatch.call(e,n),n.type=s}var n=t(i),s=t.mobile.support.touch,r="touchmove scroll",o=s?"touchstart":"mousedown",a=s?"touchend":"mouseup",l=s?"touchmove":"mousemove";t.each("touchstart touchmove touchend tap taphold swipe swipeleft swiperight scrollstart scrollstop".split(" "),function(e,i){t.fn[i]=function(t){return t?this.bind(i,t):this.trigger(i)},t.attrFn&&(t.attrFn[i]=!0)}),t.event.special.scrollstart={enabled:!0,setup:function(){function i(t,i){n=i,e(o,n?"scrollstart":"scrollstop",t)}var n,s,o=this,a=t(o);a.bind(r,function(e){t.event.special.scrollstart.enabled&&(n||i(e,!0),clearTimeout(s),s=setTimeout(function(){i(e,!1)},50))})},teardown:function(){t(this).unbind(r)}},t.event.special.tap={tapholdThreshold:750,emitTapOnTaphold:!0,setup:function(){var i=this,s=t(i),r=!1;s.bind("vmousedown",function(o){function a(){clearTimeout(u)}function l(){a(),s.unbind("vclick",h).unbind("vmouseup",a),n.unbind("vmousecancel",l)}function h(t){l(),r||p!==t.target?r&&t.stopPropagation():e(i,"tap",t)}if(r=!1,o.which&&1!==o.which)return!1;var u,p=o.target;s.bind("vmouseup",a).bind("vclick",h),n.bind("vmousecancel",l),u=setTimeout(function(){t.event.special.tap.emitTapOnTaphold||(r=!0),e(i,"taphold",t.Event("taphold",{target:p}))},t.event.special.tap.tapholdThreshold)})},teardown:function(){t(this).unbind("vmousedown").unbind("vclick").unbind("vmouseup"),n.unbind("vmousecancel")}},t.event.special.swipe={scrollSupressionThreshold:30,durationThreshold:1e3,horizontalDistanceThreshold:30,verticalDistanceThreshold:75,start:function(e){var i=e.originalEvent.touches?e.originalEvent.touches[0]:e;return{time:(new Date).getTime(),coords:[i.pageX,i.pageY],origin:t(e.target)}},stop:function(t){var e=t.originalEvent.touches?t.originalEvent.touches[0]:t;return{time:(new Date).getTime(),coords:[e.pageX,e.pageY]}},handleSwipe:function(i,n,s,r){if(n.time-i.time<t.event.special.swipe.durationThreshold&&Math.abs(i.coords[0]-n.coords[0])>t.event.special.swipe.horizontalDistanceThreshold&&Math.abs(i.coords[1]-n.coords[1])<t.event.special.swipe.verticalDistanceThreshold){var o=i.coords[0]>n.coords[0]?"swipeleft":"swiperight";return e(s,"swipe",t.Event("swipe",{target:r,swipestart:i,swipestop:n})),e(s,o,t.Event(o,{target:r,swipestart:i,swipestop:n})),!0}return!1},setup:function(){var e=this,i=t(e);i.bind(o,function(n){function s(i){o&&(r=t.event.special.swipe.stop(i),u||(u=t.event.special.swipe.handleSwipe(o,r,e,h)),Math.abs(o.coords[0]-r.coords[0])>t.event.special.swipe.scrollSupressionThreshold&&i.preventDefault())}var r,o=t.event.special.swipe.start(n),h=n.target,u=!1;i.bind(l,s).one(a,function(){u=!0,i.unbind(l,s)})})},teardown:function(){t(this).unbind(o).unbind(l).unbind(a)}},t.each({scrollstop:"scrollstart",taphold:"tap",swipeleft:"swipe",swiperight:"swipe"},function(e,i){t.event.special[e]={setup:function(){t(this).bind(i,t.noop)},teardown:function(){t(this).unbind(i)}}})}(t,this),function(t){t.extend(t.mobile,{version:"1.4.0",subPageUrlKey:"ui-page",hideUrlBar:!0,keepNative:":jqmData(role='none'), :jqmData(role='nojs')",activePageClass:"ui-page-active",activeBtnClass:"ui-btn-active",focusClass:"ui-focus",ajaxEnabled:!0,hashListeningEnabled:!0,linkBindingEnabled:!0,defaultPageTransition:"fade",maxTransitionWidth:!1,minScrollBack:0,defaultDialogTransition:"pop",pageLoadErrorMessage:"Error Loading Page",pageLoadErrorMessageTheme:"a",phonegapNavigationEnabled:!1,autoInitializePage:!0,pushStateEnabled:!0,ignoreContentEnabled:!1,buttonMarkup:{hoverDelay:200},dynamicBaseEnabled:!0,pageContainer:t(),allowCrossDomainPages:!1,dialogHashKey:"&ui-state=dialog"})}(t,this),function(t,e,i){var n={},s=t.find,r=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,o=/:jqmData\(([^)]*)\)/g;t.extend(t.mobile,{ns:"",getAttribute:function(e,i){var n;e=e.jquery?e[0]:e,e&&e.getAttribute&&(n=e.getAttribute("data-"+t.mobile.ns+i));try{n="true"===n?!0:"false"===n?!1:"null"===n?null:+n+""===n?+n:r.test(n)?JSON.parse(n):n}catch(s){}return n},nsNormalizeDict:n,nsNormalize:function(e){return n[e]||(n[e]=t.camelCase(t.mobile.ns+e))},closestPageData:function(t){return t.closest(":jqmData(role='page'), :jqmData(role='dialog')").data("mobile-page")}}),t.fn.jqmData=function(e,n){var s;return"undefined"!=typeof e&&(e&&(e=t.mobile.nsNormalize(e)),s=arguments.length<2||n===i?this.data(e):this.data(e,n)),s},t.jqmData=function(e,i,n){var s;return"undefined"!=typeof i&&(s=t.data(e,i?t.mobile.nsNormalize(i):i,n)),s},t.fn.jqmRemoveData=function(e){return this.removeData(t.mobile.nsNormalize(e))},t.jqmRemoveData=function(e,i){return t.removeData(e,t.mobile.nsNormalize(i))},t.find=function(e,i,n,r){return e.indexOf(":jqmData")>-1&&(e=e.replace(o,"[data-"+(t.mobile.ns||"")+"$1]")),s.call(this,e,i,n,r)},t.extend(t.find,s)}(t,this),function(t,e){function n(e,i){var n,r,o,a=e.nodeName.toLowerCase();return"area"===a?(n=e.parentNode,r=n.name,e.href&&r&&"map"===n.nodeName.toLowerCase()?(o=t("img[usemap=#"+r+"]")[0],!!o&&s(o)):!1):(/input|select|textarea|button|object/.test(a)?!e.disabled:"a"===a?e.href||i:i)&&s(e)}function s(e){return t.expr.filters.visible(e)&&!t(e).parents().addBack().filter(function(){return"hidden"===t.css(this,"visibility")}).length}var r=0,o=/^ui-id-\d+$/;t.ui=t.ui||{},t.extend(t.ui,{version:"c0ab71056b936627e8a7821f03c044aec6280a40",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),t.fn.extend({focus:function(e){return function(i,n){return"number"==typeof i?this.each(function(){var e=this;setTimeout(function(){t(e).focus(),n&&n.call(e)},i)}):e.apply(this,arguments)}}(t.fn.focus),scrollParent:function(){var e;return e=t.ui.ie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?this.parents().filter(function(){return/(relative|absolute|fixed)/.test(t.css(this,"position"))&&/(auto|scroll)/.test(t.css(this,"overflow")+t.css(this,"overflow-y")+t.css(this,"overflow-x"))}).eq(0):this.parents().filter(function(){return/(auto|scroll)/.test(t.css(this,"overflow")+t.css(this,"overflow-y")+t.css(this,"overflow-x"))}).eq(0),/fixed/.test(this.css("position"))||!e.length?t(this[0].ownerDocument||i):e},uniqueId:function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++r)})},removeUniqueId:function(){return this.each(function(){o.test(this.id)&&t(this).removeAttr("id")})}}),t.extend(t.expr[":"],{data:t.expr.createPseudo?t.expr.createPseudo(function(e){return function(i){return!!t.data(i,e)}}):function(e,i,n){return!!t.data(e,n[3])},focusable:function(e){return n(e,!isNaN(t.attr(e,"tabindex")))},tabbable:function(e){var i=t.attr(e,"tabindex"),s=isNaN(i);return(s||i>=0)&&n(e,!s)}}),t("<a>").outerWidth(1).jquery||t.each(["Width","Height"],function(i,n){function s(e,i,n,s){return t.each(r,function(){i-=parseFloat(t.css(e,"padding"+this))||0,n&&(i-=parseFloat(t.css(e,"border"+this+"Width"))||0),s&&(i-=parseFloat(t.css(e,"margin"+this))||0)}),i}var r="Width"===n?["Left","Right"]:["Top","Bottom"],o=n.toLowerCase(),a={innerWidth:t.fn.innerWidth,innerHeight:t.fn.innerHeight,outerWidth:t.fn.outerWidth,outerHeight:t.fn.outerHeight};t.fn["inner"+n]=function(i){return i===e?a["inner"+n].call(this):this.each(function(){t(this).css(o,s(this,i)+"px")})},t.fn["outer"+n]=function(e,i){return"number"!=typeof e?a["outer"+n].call(this,e):this.each(function(){t(this).css(o,s(this,e,!0,i)+"px")})}}),t.fn.addBack||(t.fn.addBack=function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}),t("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(t.fn.removeData=function(e){return function(i){return arguments.length?e.call(this,t.camelCase(i)):e.call(this)}}(t.fn.removeData)),t.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),t.support.selectstart="onselectstart"in i.createElement("div"),t.fn.extend({disableSelection:function(){return this.bind((t.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(t){t.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")},zIndex:function(n){if(n!==e)return this.css("zIndex",n);if(this.length)for(var s,r,o=t(this[0]);o.length&&o[0]!==i;){if(s=o.css("position"),("absolute"===s||"relative"===s||"fixed"===s)&&(r=parseInt(o.css("zIndex"),10),!isNaN(r)&&0!==r))return r;o=o.parent()}return 0}}),t.ui.plugin={add:function(e,i,n){var s,r=t.ui[e].prototype;for(s in n)r.plugins[s]=r.plugins[s]||[],r.plugins[s].push([i,n[s]])},call:function(t,e,i,n){var s,r=t.plugins[e];if(r&&(n||t.element[0].parentNode&&11!==t.element[0].parentNode.nodeType))for(s=0;s<r.length;s++)t.options[r[s][0]]&&r[s][1].apply(t.element,i)}}}(t),function(t,e){t.extend(t.mobile,{window:t(e),document:t(i),keyCode:t.ui.keyCode,behaviors:{},silentScroll:function(i){"number"!==t.type(i)&&(i=t.mobile.defaultHomeScroll),t.event.special.scrollstart.enabled=!1,setTimeout(function(){e.scrollTo(0,i),t.mobile.document.trigger("silentscroll",{x:0,y:i})},20),setTimeout(function(){t.event.special.scrollstart.enabled=!0},150)},getClosestBaseUrl:function(e){var i=t(e).closest(".ui-page").jqmData("url"),n=t.mobile.path.documentBase.hrefNoHash;return t.mobile.dynamicBaseEnabled&&i&&t.mobile.path.isPath(i)||(i=n),t.mobile.path.makeUrlAbsolute(i,n)},removeActiveLinkClass:function(e){!!t.mobile.activeClickedLink&&(!t.mobile.activeClickedLink.closest("."+t.mobile.activePageClass).length||e)&&t.mobile.activeClickedLink.removeClass(t.mobile.activeBtnClass),t.mobile.activeClickedLink=null},getInheritedTheme:function(t,e){for(var i,n,s=t[0],r="",o=/ui-(bar|body|overlay)-([a-z])\b/;s&&(i=s.className||"",!(i&&(n=o.exec(i))&&(r=n[2])));)s=s.parentNode;return r||e||"a"},enhanceable:function(t){return this.haveParents(t,"enhance")},hijackable:function(t){return this.haveParents(t,"ajax")},haveParents:function(e,i){if(!t.mobile.ignoreContentEnabled)return e;var n,s,r,o,a,l=e.length,h=t();for(o=0;l>o;o++){for(s=e.eq(o),r=!1,n=e[o];n;){if(a=n.getAttribute?n.getAttribute("data-"+t.mobile.ns+i):"","false"===a){r=!0;break}n=n.parentNode}r||(h=h.add(s))}return h},getScreenHeight:function(){return e.innerHeight||t.mobile.window.height()},resetActivePageHeight:function(e){var i=t("."+t.mobile.activePageClass),n=i.height(),s=i.outerHeight(!0);e="number"==typeof e?e:t.mobile.getScreenHeight(),i.css("min-height",e-(s-n))},loading:function(){var e=this.loading._widget||t(t.mobile.loader.prototype.defaultHtml).loader(),i=e.loader.apply(e,arguments);return this.loading._widget=e,i}}),t.addDependents=function(e,i){var n=t(e),s=n.jqmData("dependents")||t();n.jqmData("dependents",t(s).add(i))},t.fn.extend({removeWithDependents:function(){t.removeWithDependents(this)},enhanceWithin:function(){var e,i={},n=t.mobile.page.prototype.keepNativeSelector(),s=this;t.mobile.nojs&&t.mobile.nojs(this),t.mobile.links&&t.mobile.links(this),t.mobile.degradeInputsWithin&&t.mobile.degradeInputsWithin(this),t.fn.buttonMarkup&&this.find(t.fn.buttonMarkup.initSelector).not(n).jqmEnhanceable().buttonMarkup(),t.fn.fieldcontain&&this.find(":jqmData(role='fieldcontain')").not(n).jqmEnhanceable().fieldcontain(),t.each(t.mobile.widgets,function(e,r){if(r.initSelector){var o=t.mobile.enhanceable(s.find(r.initSelector));o.length>0&&(o=o.not(n)),o.length>0&&(i[r.prototype.widgetName]=o)}});for(e in i)i[e][e]();return this},addDependents:function(e){t.addDependents(this,e)},getEncodedText:function(){return t("<a>").text(this.text()).html()},jqmEnhanceable:function(){return t.mobile.enhanceable(this)},jqmHijackable:function(){return t.mobile.hijackable(this)}}),t.removeWithDependents=function(e){var i=t(e);(i.jqmData("dependents")||t()).remove(),i.remove()},t.addDependents=function(e,i){var n=t(e),s=n.jqmData("dependents")||t();n.jqmData("dependents",t(s).add(i))},t.find.matches=function(e,i){return t.find(e,null,null,i)},t.find.matchesSelector=function(e,i){return t.find(i,null,null,[e]).length>0}}(t,this),function(t){e.matchMedia=e.matchMedia||function(t){var e,i=t.documentElement,n=i.firstElementChild||i.firstChild,s=t.createElement("body"),r=t.createElement("div");return r.id="mq-test-1",r.style.cssText="position:absolute;top:-100em",s.style.background="none",s.appendChild(r),function(t){return r.innerHTML='&shy;<style media="'+t+'"> #mq-test-1 { width: 42px; }</style>',i.insertBefore(s,n),e=42===r.offsetWidth,i.removeChild(s),{matches:e,media:t}}}(i),t.mobile.media=function(t){return e.matchMedia(t).matches}}(t)}),L.GeoJSON.Custom=L.GeoJSON.extend({CLASS_NAME:"L.GeoJSON.Custom",options:{params:{},style:{},inputCrs:"EPSG:4326",pointToLayer:function(t,e){return L.circleMarker(e,this.style)}},initialize:function(t,e){e=e||{},L.GeoJSON.prototype.initialize.call(this,null,e),t+=$.param(e.params),this.serviceUrl=t;var i=this;this.getFeature(function(){i.addData(i.jsonData)})},getFeature:function(t){var e=this.proxy?this.proxy+encodeURIComponent(this.serviceUrl):this.serviceUrl;this.fire("loading",{layer:this}),this.xhr&&(this.xhr.abort(),this.xhr=null),this.xhr=$.ajax({url:e,type:"POST",data:this.options.params,context:this,success:function(e){e.type&&"FeatureCollection"==e.type&&(this.jsonData=e,"EPSG:4326"!==this.options.inputCrs&&this.toGeographicCoords(this.options.inputCrs),t(),this.fire("load",{layer:this}))},dataType:"json"})},swapCoords:function(t){return t=[t[1],t[0]]},toGeographicCoords:function(t){function e(t,e){var i=e||"EPSG:4326",n="EPSG:4326",s=t[0],r=t[1];return window.proj4(i,n,[s,r])}var i,n,s,r,o,a,l=this.jsonData.features||[];for(r=0,len=l.length;len>r;r++)switch(a=l[r].geometry,a.type){case"Point":i=a.coordinates,this.options.reverseAxis&&(i=this.swapCoords(i)),s=e(i,t),a.coordinates=s;break;case"MultiPoint":for(o=0,len2=a.coordinates.length;len2>o;o++)i=a.coordinates[o],this.options.reverseAxis&&(i=this.swapCoords(i)),s=e(i,t),l[r].geometry.coordinates[o]=s;break;case"MultiLineString":n=[];var h;for(o=0,len2=a.coordinates.length;len2>o;o++){for(n=a.coordinates[o],h=0,len3=n.length;len3>h;h++)i=n[h],this.options.reverseAxis&&(i=this.swapCoords(i)),s=e(i,t),n[h]=s;a.coordinates[o]=n}break;case"Polygon":for(n=a.coordinates[0],o=0,lenP=n.length;lenP>o;o++)i=n[o],this.options.reverseAxis&&(i=this.swapCoords(i)),s=e(i,t),n[o]=s;break;case"MultiPolygon":for(n=a.coordinates[0][0],o=0,lenP=n.length;lenP>o;o++)i=n[o],this.options.reverseAxis&&(i=this.swapCoords(i)),s=e(i,t),n[o]=s}}}),L.GeoJSON.WFS=L.GeoJSON.extend({CLASS_NAME:"L.GeoJSON.WFS",options:{uniqueKey:"",noBindZoom:!1,noBindDrag:!1,xhrType:"POST",params:{typeName:null,service:"WFS",version:"1.1.0",request:"GetFeature",srsName:"EPSG:4326",format:"text/geojson",maxFeatures:1e4,outputFormat:"json"},selectStyle:{weight:5,color:"#00FFFF",opacity:1}},_featureIndexes:[],initialize:function(t,e){e=e||{},e=$.extend(!0,{},this.options,e),L.GeoJSON.prototype.initialize.call(this,null,e),(e.proxy||L.GeoJSON.WFS.proxy)&&(this.proxy=e.proxy||L.GeoJSON.WFS.proxy||null),this._featureIndexes=[],this.getFeatureUrl=t},onAdd:function(t){L.LayerGroup.prototype.onAdd.call(this,t),this._refresh(),this._bindEvents(t)},onRemove:function(t){this.xhr&&(this.xhr.abort(),this.xhr=null,this.fire("loadcancel",{layer:this})),this._unbindEvents(t),L.GeoJSON.prototype.onRemove.call(this,t)},_onZoomEnd:function(){this._prevZoom>this._map.getZoom()&&this._refresh(),this._prevZoom=this._map.getZoom()},_bindEvents:function(t){if(this.__refresh=this.__refresh||$.proxy(this._refresh,this),this.__onZoomEnd=this.__onZoomEnd||$.proxy(this._onZoomEnd,this),this.options.noBindDrag||t.on("dragend",this.__refresh),!this.options.noBindZoom){this._prevZoom=t.getZoom(),t.on("zoomend",this.__onZoomEnd)}},_unbindEvents:function(t){t.off("dragend",this.__refresh),t.off("zoomend",this.__onZoomEnd)},addData:function(t){var e,i,n,s=L.Util.isArray(t)?t:t.features,r=this.options.uniqueKey;if(s){var o=this._featureIndexes,a=this.addData;for(e=0,i=s.length;i>e;e++){n=s[e];var l="";if(r){uniqueKeyArr=r.split(";");var h=n.properties;$.each(uniqueKeyArr,function(t,e){l+=""+h[e]})}else l=n.id;(n.geometries||n.geometry||n.features||n.coordinates)&&-1===$.inArray(l,o)&&this&&(a.call(this,n),o.push(l))}return this}var u=this.options,p=!u.pointToLayer&&t.geometry&&("MultiPoint"===t.geometry.type||"Point"===t.geometry.type);if(p&&!u.pointToLayer&&u.style){var c;c=u.style.icon?function(t,e){return L.marker(e,{icon:L.icon(u.style.icon)})}:function(t,e){return L.circleMarker(e,u.style)},u.pointToLayer=c}var d=L.GeoJSON.geometryToLayer(t,u.pointToLayer,u.coordsToLatLng,u);return d.feature=L.GeoJSON.asFeature(t),d.defaultOptions=d.options,this.resetStyle(d),u.onEachFeature&&u.onEachFeature(t,d),this.addLayer(d)},_refresh:function(t){t=t||!1,t===!0&&(this._featureIndexes=[]);var e=this;if(!this._map)return!1;var i=this._map.getBounds();this.getFeature(i,function(){null===e.options.uniqueKey&&e.clearLayers(),e.addData(e.jsonData)})},_boundsToBbox:function(t,e){var i=6,n=Math.pow(10,i),s=Math.round(t.getWest()*n)/n,r=Math.round(t.getSouth()*n)/n,o=Math.round(t.getEast()*n)/n,a=Math.round(t.getNorth()*n)/n;return e===!0?r+","+s+","+a+","+o:s+","+r+","+o+","+a},_projectBounds:function(t,e,i){this.centerLonLat=null;var n=window.proj4(e,i,[t.getWest(),t.getSouth()]),s=window.proj4(e,i,[t.getEast(),t.getSouth()]),r=window.proj4(e,i,[t.getEast(),t.getNorth()]),o=window.proj4(e,i,[t.getWest(),t.getNorth()]),a=Math.min(n[0],s[0]),l=Math.min(n[1],s[1]),h=Math.max(o[0],r[0]),u=Math.max(o[1],r[1]);return t=L.latLngBounds(L.latLng(l,a),L.latLng(u,h))},getFeature:function(t,e){if(t&&!this.options.params.filter){var i=this.options.hasOwnProperty("reverseAxisBbox")?this.options.reverseAxisBbox:this.options.reverseAxis;this.options.inputCrs&&(t=this._projectBounds(t,"EPSG:4326",this.options.inputCrs),this.options.params.srsName=this.options.inputCrs),this.options.params.bbox=this._boundsToBbox(t,i)}var n,s=null;"GET"===this.options.xhrType?(n=this.proxy?this.proxy+encodeURIComponent(this.getFeatureUrl+"?"+$.param(this.options.params)):this.getFeatureUrl,s=null):(n=this.proxy?this.proxy+encodeURIComponent(this.getFeatureUrl):this.getFeatureUrl,s=this.options.params),this.xhr&&(this.xhr.abort(),this.xhr=null),this.fire("loading",{layer:this}),this.xhr=$.ajax({url:n,type:this.options.xhrType,data:s,context:this,success:function(t){t.type&&"FeatureCollection"==t.type&&(this.jsonData=t,this.toGeographicCoords(this.options.inputCrs||"EPSG:4326"),e(),this.fire("load",{layer:this}))},error:function(){this.fire("loaderror",{layer:this})},dataType:"json"})},swapCoords:function(t){return t=[t[1],t[0]]},toGeographicCoords:function(t){function e(t,e){var i=e||"EPSG:4326",n="EPSG:4326",s=t[0],r=t[1];return window.proj4(i,n,[s,r])}var i,n,s,r,o,a,l=this.jsonData.features||[];for(r=0,len=l.length;len>r;r++)switch(a=l[r].geometry,a.type){case"Point":i=a.coordinates,this.options.reverseAxis&&(i=this.swapCoords(i)),s=e(i,t),a.coordinates=s;break;case"MultiPoint":for(o=0,len2=a.coordinates.length;len2>o;o++)i=a.coordinates[o],this.options.reverseAxis&&(i=this.swapCoords(i)),s=e(i,t),l[r].geometry.coordinates[o]=s;break;case"MultiLineString":n=[];var h;for(o=0,len2=a.coordinates.length;len2>o;o++){for(n=a.coordinates[o],h=0,len3=n.length;len3>h;h++)i=n[h],this.options.reverseAxis&&(i=this.swapCoords(i)),s=e(i,t),n[h]=s;a.coordinates[o]=n}break;case"Polygon":for(n=a.coordinates[0],o=0,lenP=n.length;lenP>o;o++)i=n[o],this.options.reverseAxis&&(i=this.swapCoords(i)),s=e(i,t),n[o]=s;break;case"MultiPolygon":for(n=a.coordinates[0][0],o=0,lenP=n.length;lenP>o;o++)i=n[o],this.options.reverseAxis&&(i=this.swapCoords(i)),s=e(i,t),n[o]=s}}}),L.TileLayer.EsriRest=L.TileLayer.extend({defaultEsriParams:{layers:"",format:"png",transparent:!1,dpi:"92",f:"image"},initialize:function(t,e){this._url=t;var i=L.extend({},this.defaultEsriParams),n=e.tileSize||this.options.tileSize;i.size=e.detectRetina&&L.Browser.retina?[2*n,2*n].join(","):[n,n].join(",");for(var s in e)this.options.hasOwnProperty(s)||(i[s]=e[s]);this.esriParams=i,L.setOptions(this,e)},onAdd:function(t){this.esriParams.bboxSR=t.options.crs.code.substring(5),this.esriParams.imageSR=t.options.crs.code.substring(5),this.esriParams.layers="show:"+this.esriParams.layers,L.TileLayer.prototype.onAdd.call(this,t)},getTileUrl:function(t,e){var i=this._map,n=i.options.crs,s=this.options.tileSize,r=t.multiplyBy(s),o=r.add([s,s]),a=n.project(i.unproject(r,e)),l=n.project(i.unproject(o,e)),h=[a.x,l.y,l.x,a.y].join(","),u=L.Util.template(this._url,{s:this._getSubdomain(t)});return u+"/export"+L.Util.getParamString(this.esriParams,u,!0)+"&bbox="+h},getIdentifyUrl:function(t,e){e=e?e:{};var i={geometryType:"esriGeometryPoint",sr:"4326",layers:this.esriParams.layers.substring(5),tolerance:0,imageDisplay:this.esriParams.size+","+this.esriParams.dpi,returnGeometry:!1,f:"pjson",geometry:[t.x,t.y].join(","),mapExtent:[map.getBounds()._northEast.lng,map.getBounds()._northEast.lat,map.getBounds()._southWest.lng,map.getBounds()._southWest.lat].join(","),showLayers:"visible"};for(var n in i)e.hasOwnProperty(n)||(e[n]=i[n]);return e.layers=e.showLayers+":"+e.layers,url=L.Util.template(this._url,{s:this._getSubdomain(t)}),url+"/identify"+L.Util.getParamString(e,url,!0)},setParams:function(t,e){return L.extend(this.esriParams,t),e||this.redraw(),this}}),L.tileLayer.esri=function(t,e){return new L.TileLayer.ESRI(t,e)},!function(t){"use strict";var e=function(e,i){this.$element=t(e),this.options=t.extend({},t.fn.typeahead.defaults,i),this.matcher=this.options.matcher||this.matcher,this.sorter=this.options.sorter||this.sorter,this.select=this.options.select||this.select,this.autoSelect="boolean"==typeof this.options.autoSelect?this.options.autoSelect:!0,this.highlighter=this.options.highlighter||this.highlighter,this.updater=this.options.updater||this.updater,this.source=this.options.source,this.$menu=t(this.options.menu),this.shown=!1,this.listen(),this.showHintOnFocus="boolean"==typeof this.options.showHintOnFocus?this.options.showHintOnFocus:!1};e.prototype={constructor:e,select:function(){var t=this.$menu.find(".active").attr("data-value");return(this.autoSelect||t)&&this.$element.val(this.updater(t)).change(),this.hide()},updater:function(t){return t},setSource:function(t){this.source=t},show:function(){var e,i=t.extend({},this.$element.position(),{height:this.$element[0].offsetHeight});return e="function"==typeof this.options.scrollHeight?this.options.scrollHeight.call():this.options.scrollHeight,this.$menu.insertAfter(this.$element).css({top:i.top+i.height+e,left:i.left}).show(),this.shown=!0,this},hide:function(){return this.$menu.hide(),this.shown=!1,this},lookup:function(e){var i;return this.query="undefined"!=typeof e&&null!=e?e:this.$element.val()||"",this.query.length<this.options.minLength?this.shown?this.hide():this:(i=t.isFunction(this.source)?this.source(this.query,t.proxy(this.process,this)):this.source,i?this.process(i):this)},process:function(e){var i=this;return e=t.grep(e,function(t){return i.matcher(t)}),e=this.sorter(e),e.length?"all"==this.options.items||0==this.options.minLength&&!this.$element.val()?this.render(e).show():this.render(e.slice(0,this.options.items)).show():this.shown?this.hide():this},matcher:function(t){return~t.toLowerCase().indexOf(this.query.toLowerCase())},sorter:function(t){for(var e,i=[],n=[],s=[];e=t.shift();)e.toLowerCase().indexOf(this.query.toLowerCase())?~e.indexOf(this.query)?n.push(e):s.push(e):i.push(e);return i.concat(n,s)},highlighter:function(t){var e=this.query.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&");return t.replace(new RegExp("("+e+")","ig"),function(t,e){return"<strong>"+e+"</strong>"})},render:function(e){var i=this;return e=t(e).map(function(e,n){return e=t(i.options.item).attr("data-value",n),e.find("a").html(i.highlighter(n)),e[0]}),this.autoSelect&&e.first().addClass("active"),this.$menu.html(e),this},next:function(){var e=this.$menu.find(".active").removeClass("active"),i=e.next();i.length||(i=t(this.$menu.find("li")[0])),i.addClass("active")},prev:function(){var t=this.$menu.find(".active").removeClass("active"),e=t.prev();e.length||(e=this.$menu.find("li").last()),e.addClass("active")},listen:function(){this.$element.on("focus",t.proxy(this.focus,this)).on("blur",t.proxy(this.blur,this)).on("keypress",t.proxy(this.keypress,this)).on("keyup",t.proxy(this.keyup,this)),this.eventSupported("keydown")&&this.$element.on("keydown",t.proxy(this.keydown,this)),this.$menu.on("click",t.proxy(this.click,this)).on("mouseenter","li",t.proxy(this.mouseenter,this)).on("mouseleave","li",t.proxy(this.mouseleave,this))},destroy:function(){this.$element.data("typeahead",null),this.$element.off("focus").off("blur").off("keypress").off("keyup"),this.eventSupported("keydown")&&this.$element.off("keydown"),this.$menu.remove()},eventSupported:function(t){var e=t in this.$element;return e||(this.$element.setAttribute(t,"return;"),e="function"==typeof this.$element[t]),e},move:function(t){if(this.shown){switch(t.keyCode){case 9:case 13:case 27:t.preventDefault();break;case 38:t.preventDefault(),this.prev();break;case 40:t.preventDefault(),this.next()}t.stopPropagation()}},keydown:function(e){this.suppressKeyPressRepeat=~t.inArray(e.keyCode,[40,38,9,13,27]),this.shown||40!=e.keyCode?this.move(e):this.lookup("")},keypress:function(t){this.suppressKeyPressRepeat||this.move(t)},keyup:function(t){switch(t.keyCode){case 40:case 38:case 16:case 17:case 18:break;case 9:case 13:if(!this.shown)return;this.select();break;case 27:if(!this.shown)return;this.hide();break;default:this.lookup()}t.stopPropagation(),t.preventDefault()},focus:function(){console.log("focus"),this.focused||(this.focused=!0,(0==this.options.minLength&&!this.$element.val()||this.options.showHintOnFocus)&&this.lookup())},blur:function(){this.focused=!1,!this.mousedover&&this.shown&&this.hide()},click:function(t){t.stopPropagation(),t.preventDefault(),this.select(),this.$element.focus()},mouseenter:function(e){this.mousedover=!0,this.$menu.find(".active").removeClass("active"),t(e.currentTarget).addClass("active")},mouseleave:function(){this.mousedover=!1,!this.focused&&this.shown&&this.hide()}};var i=t.fn.typeahead;t.fn.typeahead=function(i){var n=arguments;return this.each(function(){var s=t(this),r=s.data("typeahead"),o="object"==typeof i&&i;r||s.data("typeahead",r=new e(this,o)),"string"==typeof i&&(n.length>1?r[i].apply(r,Array.prototype.slice.call(n,1)):r[i]())})},t.fn.typeahead.defaults={source:[],items:8,menu:'<ul class="typeahead dropdown-menu"></ul>',item:'<li><a href="#"></a></li>',minLength:1,scrollHeight:0,autoSelect:!0},t.fn.typeahead.Constructor=e,t.fn.typeahead.noConflict=function(){return t.fn.typeahead=i,this},t(document).on("focus.typeahead.data-api",'[data-provide="typeahead"]',function(){var e=t(this);e.data("typeahead")||e.typeahead(e.data())})}(window.jQuery),function(t,e){"function"==typeof define&&define.amd?define(e):"object"==typeof exports?module.exports=e():t.returnExports=e()}(this,function(){function t(t){try{return t.sentinel=0,0===Object.getOwnPropertyDescriptor(t,"sentinel").value}catch(e){}}function e(t){try{return Object.defineProperty(t,"sentinel",{}),"sentinel"in t}catch(e){}}var i,n,s,r,o=Function.prototype.call,a=Object.prototype,l=o.bind(a.hasOwnProperty),h=l(a,"__defineGetter__");if(h&&(i=o.bind(a.__defineGetter__),n=o.bind(a.__defineSetter__),s=o.bind(a.__lookupGetter__),r=o.bind(a.__lookupSetter__)),Object.getPrototypeOf||(Object.getPrototypeOf=function(t){var e=t.__proto__;return e||null===e?e:t.constructor?t.constructor.prototype:a}),Object.defineProperty){var u=t({}),p="undefined"==typeof document||t(document.createElement("div"));if(!p||!u)var c=Object.getOwnPropertyDescriptor}if(!Object.getOwnPropertyDescriptor||c){var d="Object.getOwnPropertyDescriptor called on a non-object: ";Object.getOwnPropertyDescriptor=function(t,e){if("object"!=typeof t&&"function"!=typeof t||null===t)throw new TypeError(d+t);if(c)try{return c.call(Object,t,e)}catch(i){}if(l(t,e)){var n={enumerable:!0,configurable:!0};if(h){var o=t.__proto__,u=t!==a;u&&(t.__proto__=a);var p=s(t,e),m=r(t,e);if(u&&(t.__proto__=o),p||m)return p&&(n.get=p),m&&(n.set=m),n}return n.value=t[e],n.writable=!0,n}}}if(Object.getOwnPropertyNames||(Object.getOwnPropertyNames=function(t){return Object.keys(t)}),!Object.create){var m,f=!({__proto__:null}instanceof Object);m=f||"undefined"==typeof document?function(){return{__proto__:null}}:function(){function t(){}var e=document.createElement("iframe"),i=document.body||document.documentElement;e.style.display="none",i.appendChild(e),e.src="javascript:";var n=e.contentWindow.Object.prototype;return i.removeChild(e),e=null,delete n.constructor,delete n.hasOwnProperty,delete n.propertyIsEnumerable,delete n.isPrototypeOf,delete n.toLocaleString,delete n.toString,delete n.valueOf,n.__proto__=null,t.prototype=n,m=function(){return new t},new t},Object.create=function(t,e){function i(){}var n;if(null===t)n=m();else{if("object"!=typeof t&&"function"!=typeof t)throw new TypeError("Object prototype may only be an Object or null");i.prototype=t,n=new i,n.__proto__=t}return void 0!==e&&Object.defineProperties(n,e),n}}if(Object.defineProperty){var y=e({}),g="undefined"==typeof document||e(document.createElement("div"));if(!y||!g)var v=Object.defineProperty,L=Object.defineProperties}if(!Object.defineProperty||v){var _="Property description must be an object: ",O="Object.defineProperty called on non-object: ",b="getters & setters can not be defined on this javascript engine";Object.defineProperty=function(t,e,o){if("object"!=typeof t&&"function"!=typeof t||null===t)throw new TypeError(O+t);if("object"!=typeof o&&"function"!=typeof o||null===o)throw new TypeError(_+o);if(v)try{return v.call(Object,t,e,o)}catch(u){}if(l(o,"value"))if(h&&(s(t,e)||r(t,e))){var p=t.__proto__;t.__proto__=a,delete t[e],t[e]=o.value,t.__proto__=p}else t[e]=o.value;else{if(!h)throw new TypeError(b);l(o,"get")&&i(t,e,o.get),l(o,"set")&&n(t,e,o.set)}return t}}(!Object.defineProperties||L)&&(Object.defineProperties=function(t,e){if(L)try{return L.call(Object,t,e)}catch(i){}for(var n in e)l(e,n)&&"__proto__"!==n&&Object.defineProperty(t,n,e[n]);return t}),Object.seal||(Object.seal=function(t){return t}),Object.freeze||(Object.freeze=function(t){return t});try{Object.freeze(function(){})}catch(w){Object.freeze=function(t){return function(e){return"function"==typeof e?e:t(e)}}(Object.freeze)}Object.preventExtensions||(Object.preventExtensions=function(t){return t}),Object.isSealed||(Object.isSealed=function(){return!1}),Object.isFrozen||(Object.isFrozen=function(){return!1}),Object.isExtensible||(Object.isExtensible=function(t){if(Object(t)!==t)throw new TypeError;for(var e="";l(t,e);)e+="?";t[e]=!0;var i=l(t,e);return delete t[e],i})}),function(t,e){"function"==typeof define&&define.amd?define(e):"object"==typeof exports?module.exports=e():t.returnExports=e()}(this,function(){function t(){}function e(t){return t=+t,t!==t?t=0:0!==t&&t!==1/0&&t!==-(1/0)&&(t=(t>0||-1)*Math.floor(Math.abs(t))),t}function i(t){var e=typeof t;return null===t||"undefined"===e||"boolean"===e||"number"===e||"string"===e}function n(t){var e,n,s;if(i(t))return t;if(n=t.valueOf,p(n)&&(e=n.call(t),i(e)))return e;if(s=t.toString,p(s)&&(e=s.call(t),i(e)))return e;throw new TypeError}var s=Function.prototype.call,r=Array.prototype,o=Object.prototype,a=r.slice,l=Array.prototype.splice,h=(Array.prototype.push,Array.prototype.unshift),u=o.toString,p=function(t){return"[object Function]"===o.toString.call(t)},c=function(t){return"[object RegExp]"===o.toString.call(t)},d=function(t){return"[object Array]"===u.call(t)},m=function(t){var e=u.call(t),i="[object Arguments]"===e;return i||(i=!d(e)&&null!==t&&"object"==typeof t&&"number"==typeof t.length&&t.length>=0&&p(t.callee)),i};Function.prototype.bind||(Function.prototype.bind=function(e){var i=this;
if(!p(i))throw new TypeError("Function.prototype.bind called on incompatible "+i);for(var n=a.call(arguments,1),s=function(){if(this instanceof h){var t=i.apply(this,n.concat(a.call(arguments)));return Object(t)===t?t:this}return i.apply(e,n.concat(a.call(arguments)))},r=Math.max(0,i.length-n.length),o=[],l=0;r>l;l++)o.push("$"+l);var h=Function("binder","return function ("+o.join(",")+"){return binder.apply(this,arguments)}")(s);return i.prototype&&(t.prototype=i.prototype,h.prototype=new t,t.prototype=null),h});var f,y,g,v,L,_=s.bind(o.hasOwnProperty);(L=_(o,"__defineGetter__"))&&(f=s.bind(o.__defineGetter__),y=s.bind(o.__defineSetter__),g=s.bind(o.__lookupGetter__),v=s.bind(o.__lookupSetter__));var O=function(){var t={};return Array.prototype.splice.call(t,0,0,1),1===t.length}(),b=0===[1].splice(0).length,w=function(){var t=[1,2],e=t.splice();return 2===t.length&&d(e)&&0===e.length}();w&&(Array.prototype.splice=function(){return 0===arguments.length?[]:l.apply(this,arguments)}),b&&O||(Array.prototype.splice=function(t,i){if(0===arguments.length)return[];var n=arguments;return this.length=Math.max(e(this.length),0),arguments.length>0&&"number"!=typeof i&&(n=a.call(arguments),n.length<2?n.push(e(i)):n[1]=e(i)),l.apply(this,n)}),1!==[].unshift(0)&&(Array.prototype.unshift=function(){return h.apply(this,arguments),this.length}),Array.isArray||(Array.isArray=d);var x=Object("a"),S="a"!==x[0]||!(0 in x),C=function(t){var e=!0,i=!0;return t&&(t.call("foo",function(t,i,n){"object"!=typeof n&&(e=!1)}),t.call([1],function(){"use strict";i="string"==typeof this},"x")),!!t&&e&&i};Array.prototype.forEach&&C(Array.prototype.forEach)||(Array.prototype.forEach=function(t){var e=Y(this),i=S&&"[object String]"===u.call(this)?this.split(""):e,n=arguments[1],s=-1,r=i.length>>>0;if(!p(t))throw new TypeError;for(;++s<r;)s in i&&t.call(n,i[s],s,e)}),Array.prototype.map&&C(Array.prototype.map)||(Array.prototype.map=function(t){var e=Y(this),i=S&&"[object String]"===u.call(this)?this.split(""):e,n=i.length>>>0,s=Array(n),r=arguments[1];if(!p(t))throw new TypeError(t+" is not a function");for(var o=0;n>o;o++)o in i&&(s[o]=t.call(r,i[o],o,e));return s}),Array.prototype.filter&&C(Array.prototype.filter)||(Array.prototype.filter=function(t){var e,i=Y(this),n=S&&"[object String]"===u.call(this)?this.split(""):i,s=n.length>>>0,r=[],o=arguments[1];if(!p(t))throw new TypeError(t+" is not a function");for(var a=0;s>a;a++)a in n&&(e=n[a],t.call(o,e,a,i)&&r.push(e));return r}),Array.prototype.every&&C(Array.prototype.every)||(Array.prototype.every=function(t){var e=Y(this),i=S&&"[object String]"===u.call(this)?this.split(""):e,n=i.length>>>0,s=arguments[1];if(!p(t))throw new TypeError(t+" is not a function");for(var r=0;n>r;r++)if(r in i&&!t.call(s,i[r],r,e))return!1;return!0}),Array.prototype.some&&C(Array.prototype.some)||(Array.prototype.some=function(t){var e=Y(this),i=S&&"[object String]"===u.call(this)?this.split(""):e,n=i.length>>>0,s=arguments[1];if(!p(t))throw new TypeError(t+" is not a function");for(var r=0;n>r;r++)if(r in i&&t.call(s,i[r],r,e))return!0;return!1});var E=!1;Array.prototype.reduce&&(E="object"==typeof Array.prototype.reduce.call("es5",function(t,e,i,n){return n})),Array.prototype.reduce&&E||(Array.prototype.reduce=function(t){var e=Y(this),i=S&&"[object String]"===u.call(this)?this.split(""):e,n=i.length>>>0;if(!p(t))throw new TypeError(t+" is not a function");if(!n&&1===arguments.length)throw new TypeError("reduce of empty array with no initial value");var s,r=0;if(arguments.length>=2)s=arguments[1];else for(;;){if(r in i){s=i[r++];break}if(++r>=n)throw new TypeError("reduce of empty array with no initial value")}for(;n>r;r++)r in i&&(s=t.call(void 0,s,i[r],r,e));return s});var P=!1;Array.prototype.reduceRight&&(P="object"==typeof Array.prototype.reduceRight.call("es5",function(t,e,i,n){return n})),Array.prototype.reduceRight&&P||(Array.prototype.reduceRight=function(t){var e=Y(this),i=S&&"[object String]"===u.call(this)?this.split(""):e,n=i.length>>>0;if(!p(t))throw new TypeError(t+" is not a function");if(!n&&1===arguments.length)throw new TypeError("reduceRight of empty array with no initial value");var s,r=n-1;if(arguments.length>=2)s=arguments[1];else for(;;){if(r in i){s=i[r--];break}if(--r<0)throw new TypeError("reduceRight of empty array with no initial value")}if(0>r)return s;do r in i&&(s=t.call(void 0,s,i[r],r,e));while(r--);return s}),Array.prototype.indexOf&&-1===[0,1].indexOf(1,2)||(Array.prototype.indexOf=function(t){var i=S&&"[object String]"===u.call(this)?this.split(""):Y(this),n=i.length>>>0;if(!n)return-1;var s=0;for(arguments.length>1&&(s=e(arguments[1])),s=s>=0?s:Math.max(0,n+s);n>s;s++)if(s in i&&i[s]===t)return s;return-1}),Array.prototype.lastIndexOf&&-1===[0,1].lastIndexOf(0,-3)||(Array.prototype.lastIndexOf=function(t){var i=S&&"[object String]"===u.call(this)?this.split(""):Y(this),n=i.length>>>0;if(!n)return-1;var s=n-1;for(arguments.length>1&&(s=Math.min(s,e(arguments[1]))),s=s>=0?s:n-Math.abs(s);s>=0;s--)if(s in i&&t===i[s])return s;return-1});var M=Object.keys&&function(){return 2===Object.keys(arguments).length}(1,2);if(Object.keys){if(!M){var N=Object.keys;Object.keys=function(t){return N(m(t)?Array.prototype.slice.call(t):t)}}}else{var T=!{toString:null}.propertyIsEnumerable("toString"),A=function(){}.propertyIsEnumerable("prototype"),k=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],D=k.length;Object.keys=function(t){var e=p(t),i=m(t),n=null!==t&&"object"==typeof t,s=n&&"[object String]"===u.call(t);if(!n&&!e&&!i)throw new TypeError("Object.keys called on a non-object");var r=[],o=A&&e;if(s||i)for(var a=0;a<t.length;++a)r.push(String(a));else for(var l in t)o&&"prototype"===l||!_(t,l)||r.push(String(l));if(T)for(var h=t.constructor,c=h&&h.prototype===t,d=0;D>d;d++){var f=k[d];c&&"constructor"===f||!_(t,f)||r.push(f)}return r}}var F=-621987552e5,I="-000001";Date.prototype.toISOString&&-1!==new Date(F).toISOString().indexOf(I)||(Date.prototype.toISOString=function(){var t,e,i,n,s;if(!isFinite(this))throw new RangeError("Date.prototype.toISOString called on non-finite value.");for(n=this.getUTCFullYear(),s=this.getUTCMonth(),n+=Math.floor(s/12),s=(s%12+12)%12,t=[s+1,this.getUTCDate(),this.getUTCHours(),this.getUTCMinutes(),this.getUTCSeconds()],n=(0>n?"-":n>9999?"+":"")+("00000"+Math.abs(n)).slice(n>=0&&9999>=n?-4:-6),e=t.length;e--;)i=t[e],10>i&&(t[e]="0"+i);return n+"-"+t.slice(0,2).join("-")+"T"+t.slice(2).join(":")+"."+("000"+this.getUTCMilliseconds()).slice(-3)+"Z"});var R=!1;try{R=Date.prototype.toJSON&&null===new Date(0/0).toJSON()&&-1!==new Date(F).toJSON().indexOf(I)&&Date.prototype.toJSON.call({toISOString:function(){return!0}})}catch(z){}R||(Date.prototype.toJSON=function(){var t,e=Object(this),i=n(e);if("number"==typeof i&&!isFinite(i))return null;if(t=e.toISOString,"function"!=typeof t)throw new TypeError("toISOString property is not callable");return t.call(e)});var U=1e15===Date.parse("+033658-09-27T01:46:40.000Z"),B=!isNaN(Date.parse("2012-04-04T24:00:00.500Z"))||!isNaN(Date.parse("2012-11-31T23:59:59.000Z")),G=isNaN(Date.parse("2000-01-01T00:00:00.000Z"));(!Date.parse||G||B||!U)&&(Date=function(t){function e(i,n,s,r,o,a,l){var h=arguments.length;if(this instanceof t){var u=1===h&&String(i)===i?new t(e.parse(i)):h>=7?new t(i,n,s,r,o,a,l):h>=6?new t(i,n,s,r,o,a):h>=5?new t(i,n,s,r,o):h>=4?new t(i,n,s,r):h>=3?new t(i,n,s):h>=2?new t(i,n):h>=1?new t(i):new t;return u.constructor=e,u}return t.apply(this,arguments)}function i(t,e){var i=e>1?1:0;return r[e]+Math.floor((t-1969+i)/4)-Math.floor((t-1901+i)/100)+Math.floor((t-1601+i)/400)+365*(t-1970)}function n(e){return Number(new t(1970,0,1,0,0,0,e))}var s=new RegExp("^(\\d{4}|[+-]\\d{6})(?:-(\\d{2})(?:-(\\d{2})(?:T(\\d{2}):(\\d{2})(?::(\\d{2})(?:(\\.\\d{1,}))?)?(Z|(?:([-+])(\\d{2}):(\\d{2})))?)?)?)?$"),r=[0,31,59,90,120,151,181,212,243,273,304,334,365];for(var o in t)e[o]=t[o];return e.now=t.now,e.UTC=t.UTC,e.prototype=t.prototype,e.prototype.constructor=e,e.parse=function(e){var r=s.exec(e);if(r){var o,a=Number(r[1]),l=Number(r[2]||1)-1,h=Number(r[3]||1)-1,u=Number(r[4]||0),p=Number(r[5]||0),c=Number(r[6]||0),d=Math.floor(1e3*Number(r[7]||0)),m=Boolean(r[4]&&!r[8]),f="-"===r[9]?1:-1,y=Number(r[10]||0),g=Number(r[11]||0);return(p>0||c>0||d>0?24:25)>u&&60>p&&60>c&&1e3>d&&l>-1&&12>l&&24>y&&60>g&&h>-1&&h<i(a,l+1)-i(a,l)&&(o=60*(24*(i(a,l)+h)+u+y*f),o=1e3*(60*(o+p+g*f)+c)+d,m&&(o=n(o)),o>=-864e13&&864e13>=o)?o:0/0}return t.parse.apply(this,arguments)},e}(Date)),Date.now||(Date.now=function(){return(new Date).getTime()}),Number.prototype.toFixed&&"0.000"===8e-5.toFixed(3)&&"0"!==.9.toFixed(0)&&"1.25"===1.255.toFixed(2)&&"1000000000000000128"===0xde0b6b3a7640080.toFixed(0)||!function(){function t(t,e){for(var i=-1;++i<o;)e+=t*a[i],a[i]=e%r,e=Math.floor(e/r)}function e(t){for(var e=o,i=0;--e>=0;)i+=a[e],a[e]=Math.floor(i/t),i=i%t*r}function i(){for(var t=o,e="";--t>=0;)if(""!==e||0===t||0!==a[t]){var i=String(a[t]);""===e?e=i:e+="0000000".slice(0,7-i.length)+i}return e}function n(t,e,i){return 0===e?i:e%2===1?n(t,e-1,i*t):n(t*t,e/2,i)}function s(t){for(var e=0;t>=4096;)e+=12,t/=4096;for(;t>=2;)e+=1,t/=2;return e}var r,o,a;r=1e7,o=6,a=[0,0,0,0,0,0],Number.prototype.toFixed=function(r){var o,a,l,h,u,p,c,d;if(o=Number(r),o=o!==o?0:Math.floor(o),0>o||o>20)throw new RangeError("Number.toFixed called with invalid number of decimals");if(a=Number(this),a!==a)return"NaN";if(-1e21>=a||a>=1e21)return String(a);if(l="",0>a&&(l="-",a=-a),h="0",a>1e-21)if(u=s(a*n(2,69,1))-69,p=0>u?a*n(2,-u,1):a/n(2,u,1),p*=4503599627370496,u=52-u,u>0){for(t(0,p),c=o;c>=7;)t(1e7,0),c-=7;for(t(n(10,c,1),0),c=u-1;c>=23;)e(1<<23),c-=23;e(1<<c),t(1,1),e(2),h=i()}else t(0,p),t(1<<-u,0),h=i()+"0.00000000000000000000".slice(2,2+o);return o>0?(d=h.length,h=o>=d?l+"0.0000000000000000000".slice(0,o-d+2)+h:l+h.slice(0,d-o)+"."+h.slice(d-o)):h=l+h,h}}();var j=String.prototype.split;2!=="ab".split(/(?:ab)*/).length||4!==".".split(/(.?)(.?)/).length||"t"==="tesst".split(/(s)*/)[1]||4!=="test".split(/(?:)/,-1).length||"".split(/.?/).length||".".split(/()()/).length>1?!function(){var t=void 0===/()??/.exec("")[1];String.prototype.split=function(e,i){var n=this;if(void 0===e&&0===i)return[];if("[object RegExp]"!==u.call(e))return j.call(this,e,i);var s,r,o,a,l=[],h=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.extended?"x":"")+(e.sticky?"y":""),p=0;for(e=new RegExp(e.source,h+"g"),n+="",t||(s=new RegExp("^"+e.source+"$(?!\\s)",h)),i=void 0===i?-1>>>0:K(i);(r=e.exec(n))&&(o=r.index+r[0].length,!(o>p&&(l.push(n.slice(p,r.index)),!t&&r.length>1&&r[0].replace(s,function(){for(var t=1;t<arguments.length-2;t++)void 0===arguments[t]&&(r[t]=void 0)}),r.length>1&&r.index<n.length&&Array.prototype.push.apply(l,r.slice(1)),a=r[0].length,p=o,l.length>=i)));)e.lastIndex===r.index&&e.lastIndex++;return p===n.length?(a||!e.test(""))&&l.push(""):l.push(n.slice(p)),l.length>i?l.slice(0,i):l}}():"0".split(void 0,0).length&&(String.prototype.split=function(t,e){return void 0===t&&0===e?[]:j.call(this,t,e)});var H=String.prototype.replace,W=function(){var t=[];return"x".replace(/x(.)?/g,function(e,i){t.push(i)}),1===t.length&&"undefined"==typeof t[0]}();if(W||(String.prototype.replace=function(t,e){var i=p(e),n=c(t)&&/\)[*?]/.test(t.source);if(i&&n){var s=function(i){var n=arguments.length,s=t.lastIndex;t.lastIndex=0;var r=t.exec(i);return t.lastIndex=s,r.push(arguments[n-2],arguments[n-1]),e.apply(this,r)};return H.call(this,t,s)}return H.call(this,t,e)}),"".substr&&"b"!=="0b".substr(-1)){var V=String.prototype.substr;String.prototype.substr=function(t,e){return V.call(this,0>t&&(t=this.length+t)<0?0:t,e)}}var q="	\n\f\r   ᠎             　\u2028\u2029﻿",Z="​";if(!String.prototype.trim||q.trim()||!Z.trim()){q="["+q+"]";var X=new RegExp("^"+q+q+"*"),$=new RegExp(q+q+"*$");String.prototype.trim=function(){if(void 0===this||null===this)throw new TypeError("can't convert "+this+" to object");return String(this).replace(X,"").replace($,"")}}(8!==parseInt(q+"08")||22!==parseInt(q+"0x16"))&&(parseInt=function(t){var e=/^0[xX]/;return function(i,n){return i=String(i).trim(),Number(n)||(n=e.test(i)?16:10),t(i,n)}}(parseInt));var Y=function(t){if(null==t)throw new TypeError("can't convert "+t+" to object");return Object(t)},K=function(t){return t>>>0}}),function(t){t.lvector={VERSION:"1.5.1",noConflict:function(){return t.lvector=this._originallvector,this},_originallvector:t.lvector}}(this),lvector.Layer=L.Class.extend({options:{fields:"",scaleRange:null,map:null,uniqueField:null,visibleAtScale:!0,dynamic:!1,autoUpdate:!1,autoUpdateInterval:null,popupTemplate:null,popupOptions:{},singlePopup:!1,symbology:null,showAll:!1},initialize:function(t){L.Util.setOptions(this,t)},setMap:function(t){if(!t||!this.options.map)if(t){if(this.options.map=t,this.options.scaleRange&&this.options.scaleRange instanceof Array&&2===this.options.scaleRange.length){var t=this.options.map.getZoom(),e=this.options.scaleRange;this.options.visibleAtScale=t>=e[0]&&t<=e[1]}this._show()}else this.options.map&&(this._hide(),this.options.map=t)},getMap:function(){return this.options.map},setOptions:function(){},_show:function(){if(this._addIdleListener(),this.options.scaleRange&&this.options.scaleRange instanceof Array&&2===this.options.scaleRange.length&&this._addZoomChangeListener(),this.options.visibleAtScale){if(this.options.autoUpdate&&this.options.autoUpdateInterval){var t=this;this._autoUpdateInterval=setInterval(function(){t._getFeatures()},this.options.autoUpdateInterval)}this.options.map.fire("moveend").fire("zoomend")}},_hide:function(){this._idleListener&&this.options.map.off("moveend",this._idleListener),this._zoomChangeListener&&this.options.map.off("zoomend",this._zoomChangeListener),this._autoUpdateInterval&&clearInterval(this._autoUpdateInterval),this._clearFeatures(),this._lastQueriedBounds=null,this._gotAll&&(this._gotAll=!1)},_hideVectors:function(){for(var t=0;t<this._vectors.length;t++)if(this._vectors[t].vector&&(this.options.map.removeLayer(this._vectors[t].vector),this._vectors[t].popup?this.options.map.removeLayer(this._vectors[t].popup):this.popup&&this.popup.associatedFeature&&this.popup.associatedFeature==this._vectors[t]&&(this.options.map.removeLayer(this.popup),this.popup=null)),this._vectors[t].vectors&&this._vectors[t].vectors.length)for(var e=0;e<this._vectors[t].vectors.length;e++)this.options.map.removeLayer(this._vectors[t].vectors[e]),this._vectors[t].vectors[e].popup?this.options.map.removeLayer(this._vectors[t].vectors[e].popup):this.popup&&this.popup.associatedFeature&&this.popup.associatedFeature==this._vectors[t]&&(this.options.map.removeLayer(this.popup),this.popup=null)},_showVectors:function(){for(var t=0;t<this._vectors.length;t++)if(this._vectors[t].vector&&this.options.map.addLayer(this._vectors[t].vector),this._vectors[t].vectors&&this._vectors[t].vectors.length)for(var e=0;e<this._vectors[t].vectors.length;e++)this.options.map.addLayer(this._vectors[t].vectors[e])},_clearFeatures:function(){this._hideVectors(),this._vectors=[]},_addZoomChangeListener:function(){this._zoomChangeListener=this._zoomChangeListenerTemplate(),this.options.map.on("zoomend",this._zoomChangeListener,this)},_zoomChangeListenerTemplate:function(){var t=this;return function(){t._checkLayerVisibility()}},_idleListenerTemplate:function(){var t=this;return function(){t.options.visibleAtScale&&(t.options.showAll?t._gotAll||(t._getFeatures(),t._gotAll=!0):t._getFeatures())}},_addIdleListener:function(){this._idleListener=this._idleListenerTemplate(),this.options.map.on("moveend",this._idleListener,this)},_checkLayerVisibility:function(){var t=this.options.visibleAtScale,e=this.options.map.getZoom(),i=this.options.scaleRange;if(this.options.visibleAtScale=e>=i[0]&&e<=i[1],t!==this.options.visibleAtScale&&this[this.options.visibleAtScale?"_showVectors":"_hideVectors"](),t&&!this.options.visibleAtScale&&this._autoUpdateInterval)clearInterval(this._autoUpdateInterval);else if(!t&&this.options.autoUpdate&&this.options.autoUpdateInterval){var n=this;this._autoUpdateInterval=setInterval(function(){n._getFeatures()},this.options.autoUpdateInterval)}},_setPopupContent:function(t){var e,i=t.popupContent,n=t.attributes||t.properties;if("string"==typeof this.options.popupTemplate){e=this.options.popupTemplate;for(var s in n)e=e.replace(RegExp("{"+s+"}","g"),n[s])}else{if("function"!=typeof this.options.popupTemplate)return;e=this.options.popupTemplate(n)}t.popupContent=e,t.popup?t.popupContent!==i&&t.popup.setContent(t.popupContent):this.popup&&this.popup.associatedFeature==t&&t.popupContent!==i&&this.popup.setContent(t.popupContent)},_showPopup:function(t,e){var i=e.latlng;i||L.Util.extend(this.options.popupOptions,{offset:e.target.options.icon.options.popupAnchor});var n;this.options.singlePopup?(this.popup&&(this.options.map.removeLayer(this.popup),this.popup=null),this.popup=new L.Popup(this.options.popupOptions,t.vector),this.popup.associatedFeature=t,n=this):(t.popup=new L.Popup(this.options.popupOptions,t.vector),n=t),n.popup.setLatLng(i?e.latlng:e.target.getLatLng()),n.popup.setContent(t.popupContent),this.options.map.addLayer(n.popup)},_fireClickEvent:function(t,e){this.options.clickEvent(t,e)},_getFeatureVectorOptions:function(t){var e={},t=t.attributes||t.properties;if(this.options.symbology)switch(this.options.symbology.type){case"single":for(var i in this.options.symbology.vectorOptions)if(e[i]=this.options.symbology.vectorOptions[i],e.title)for(var n in t){var s=RegExp("{"+n+"}","g");e.title=e.title.replace(s,t[n])}break;case"unique":for(var r=this.options.symbology.property,o=0,a=this.options.symbology.values.length;a>o;o++)if(t[r]==this.options.symbology.values[o].value)for(i in this.options.symbology.values[o].vectorOptions)if(e[i]=this.options.symbology.values[o].vectorOptions[i],e.title)for(n in t)s=RegExp("{"+n+"}","g"),e.title=e.title.replace(s,t[n]);break;case"range":for(r=this.options.symbology.property,o=0,a=this.options.symbology.ranges.length;a>o;o++)if(t[r]>=this.options.symbology.ranges[o].range[0]&&t[r]<=this.options.symbology.ranges[o].range[1])for(i in this.options.symbology.ranges[o].vectorOptions)if(e[i]=this.options.symbology.ranges[o].vectorOptions[i],e.title)for(n in t)s=RegExp("{"+n+"}","g"),e.title=e.title.replace(s,t[n])}return e},_getPropertiesChanged:function(t,e){var i,n=!1;for(i in t)t[i]!=e[i]&&(n=!0);return n},_getPropertyChanged:function(t,e,i){return t[i]!=e[i]},_getGeometryChanged:function(t,e){var i=!1;return t.coordinates&&t.coordinates instanceof Array?t.coordinates[0]==e.coordinates[0]&&t.coordinates[1]==e.coordinates[1]||(i=!0):t.x==e.x&&t.y==e.y||(i=!0),i},_makeJsonpRequest:function(t){var e=document.getElementsByTagName("head")[0],i=document.createElement("script");i.type="text/javascript",i.src=t,e.appendChild(i)},_processFeatures:function(t){if(this.options.map){var e=this.options.map.getBounds();if(!this._lastQueriedBounds||!this._lastQueriedBounds.equals(e)||this.options.autoUpdate){if(this._lastQueriedBounds=e,featuresHaveIds=t.features&&t.features.length&&t.features[0].id?!0:!1,!this.options.uniqueField&&!featuresHaveIds&&this._clearFeatures(),this instanceof lvector.PRWSF){t.features=t.rows,delete t.rows;for(var e=0,i=t.features.length;i>e;e++){t.features[e].type="Feature",t.features[e].properties={};for(var n in t.features[e].row)"geojson"==n?t.features[e].geometry=t.features[e].row.geojson:t.features[e].properties[n]=t.features[e].row[n];delete t.features[e].row}}if(this instanceof lvector.GISCloud)for(t.features=t.data,delete t.data,e=0,i=t.features.length;i>e;e++)t.features[e].type="Feature",t.features[e].properties=t.features[e].data,t.features[e].properties.id=t.features[e].__id,delete t.features[e].data,t.features[e].geometry=t.features[e].__geometry,delete t.features[e].__geometry;if(t&&t.features&&t.features.length)for(e=0;e<t.features.length;e++){if(this instanceof lvector.EsriJSONLayer&&(t.features[e].properties=t.features[e].attributes,delete t.features[e].attributes),n=!1,i=t.features[e].id?!0:!1,this.options.uniqueField||i)for(var s=0;s<this._vectors.length;s++){var r=this._vectors[s].id?!0:!1;if((i&&r&&t.features[e].id==this._vectors[s].id||this.options.uniqueField&&t.features[e].properties[this.options.uniqueField]==this._vectors[s].properties[this.options.uniqueField])&&(n=!0,this.options.dynamic&&(!this._getGeometryChanged(this._vectors[s].geometry,t.features[e].geometry)||isNaN(t.features[e].geometry.coordinates[0])||isNaN(t.features[e].geometry.coordinates[1])||(this._vectors[s].geometry=t.features[e].geometry,this._vectors[s].vector.setLatLng(new L.LatLng(this._vectors[s].geometry.coordinates[1],this._vectors[s].geometry.coordinates[0]))),this._getPropertiesChanged(this._vectors[s].properties,t.features[e].properties)&&(r=this._getPropertyChanged(this._vectors[s].properties,t.features[e].properties,this.options.symbology.property),this._vectors[s].properties=t.features[e].properties,this.options.popupTemplate&&this._setPopupContent(this._vectors[s]),this.options.symbology&&"single"!=this.options.symbology.type&&r))))if(this._vectors[s].vectors)for(var r=0,o=this._vectors[s].vectors.length;o>r;r++)this._vectors[s].vectors[r].setStyle?this._vectors[s].vectors[r].setStyle(this._getFeatureVectorOptions(this._vectors[s])):this._vectors[s].vectors[r].setIcon&&this._vectors[s].vectors[r].setIcon(this._getFeatureVectorOptions(this._vectors[s]).icon);else this._vectors[s].vector&&(this._vectors[s].vector.setStyle?this._vectors[s].vector.setStyle(this._getFeatureVectorOptions(this._vectors[s])):this._vectors[s].vector.setIcon&&this._vectors[s].vector.setIcon(this._getFeatureVectorOptions(this._vectors[s]).icon))}if(!n){if(this instanceof lvector.GeoJSONLayer?(n=this._geoJsonGeometryToLeaflet(t.features[e].geometry,this._getFeatureVectorOptions(t.features[e])),t.features[e][n instanceof Array?"vectors":"vector"]=n):this instanceof lvector.EsriJSONLayer&&(n=this._esriJsonGeometryToLeaflet(t.features[e].geometry,this._getFeatureVectorOptions(t.features[e])),t.features[e][n instanceof Array?"vectors":"vector"]=n),t.features[e].vector)this.options.map.addLayer(t.features[e].vector);else if(t.features[e].vectors&&t.features[e].vectors.length)for(r=0;r<t.features[e].vectors.length;r++)this.options.map.addLayer(t.features[e].vectors[r]);if(this._vectors.push(t.features[e]),this.options.popupTemplate){var a=this;n=t.features[e],this._setPopupContent(n),function(t){if(t.vector)t.vector.on("click",function(e){a._showPopup(t,e)});else if(t.vectors)for(var e=0,i=t.vectors.length;i>e;e++)t.vectors[e].on("click",function(e){a._showPopup(t,e)})}(n)}this.options.clickEvent&&(a=this,n=t.features[e],function(t){if(t.vector)t.vector.on("click",function(e){a._fireClickEvent(t,e)});else if(t.vectors)for(var e=0,i=t.vectors.length;i>e;e++)t.vectors[e].on("click",function(e){a._fireClickEvent(t,e)})}(n))}}}}}}),lvector.GeoJSONLayer=lvector.Layer.extend({_geoJsonGeometryToLeaflet:function(t,e){var i,n;switch(t.type){case"Point":i=e.circleMarker?new L.CircleMarker(new L.LatLng(t.coordinates[1],t.coordinates[0]),e):new L.Marker(new L.LatLng(t.coordinates[1],t.coordinates[0]),e);break;case"MultiPoint":n=[];for(var s=0,r=t.coordinates.length;r>s;s++)n.push(new L.Marker(new L.LatLng(t.coordinates[s][1],t.coordinates[s][0]),e));break;case"LineString":for(var o=[],s=0,r=t.coordinates.length;r>s;s++)o.push(new L.LatLng(t.coordinates[s][1],t.coordinates[s][0]));i=new L.Polyline(o,e);break;case"MultiLineString":for(n=[],s=0,r=t.coordinates.length;r>s;s++){for(var o=[],a=0,l=t.coordinates[s].length;l>a;a++)o.push(new L.LatLng(t.coordinates[s][a][1],t.coordinates[s][a][0]));n.push(new L.Polyline(o,e))}break;case"Polygon":for(var h=[],s=0,r=t.coordinates.length;r>s;s++){for(o=[],a=0,l=t.coordinates[s].length;l>a;a++)o.push(new L.LatLng(t.coordinates[s][a][1],t.coordinates[s][a][0]));h.push(o)}i=new L.Polygon(h,e);break;case"MultiPolygon":for(n=[],s=0,r=t.coordinates.length;r>s;s++){for(h=[],a=0,l=t.coordinates[s].length;l>a;a++){for(var o=[],u=0,p=t.coordinates[s][a].length;p>u;u++)o.push(new L.LatLng(t.coordinates[s][a][u][1],t.coordinates[s][a][u][0]));h.push(o)}n.push(new L.Polygon(h,e))}break;case"GeometryCollection":for(n=[],s=0,r=t.geometries.length;r>s;s++)n.push(this._geoJsonGeometryToLeaflet(t.geometries[s],e))}return i||n}}),lvector.EsriJSONLayer=lvector.Layer.extend({_esriJsonGeometryToLeaflet:function(t,e){var i,n;if(t.x&&t.y)i=new L.Marker(new L.LatLng(t.y,t.x),e);else if(t.points){n=[];for(var s=0,r=t.points.length;r>s;s++)n.push(new L.Marker(new L.LatLng(t.points[s].y,t.points[s].x),e))}else if(t.paths)if(t.paths.length>1)for(n=[],s=0,r=t.paths.length;r>s;s++){for(var o=[],a=0,l=t.paths[s].length;l>a;a++)o.push(new L.LatLng(t.paths[s][a][1],t.paths[s][a][0]));n.push(new L.Polyline(o,e))}else{for(o=[],s=0,r=t.paths[0].length;r>s;s++)o.push(new L.LatLng(t.paths[0][s][1],t.paths[0][s][0]));i=new L.Polyline(o,e)}else if(t.rings)if(t.rings.length>1)for(n=[],s=0,r=t.rings.length;r>s;s++){for(var h=[],o=[],a=0,l=t.rings[s].length;l>a;a++)o.push(new L.LatLng(t.rings[s][a][1],t.rings[s][a][0]));h.push(o),n.push(new L.Polygon(h,e))}else{for(h=[],o=[],s=0,r=t.rings[0].length;r>s;s++)o.push(new L.LatLng(t.rings[0][s][1],t.rings[0][s][0]));h.push(o),i=new L.Polygon(h,e)}return i||n}}),lvector.AGS=lvector.EsriJSONLayer.extend({initialize:function(t){for(var e=0,i=this._requiredParams.length;i>e;e++)if(!t[this._requiredParams[e]])throw Error('No "'+this._requiredParams[e]+'" parameter found.');if(this._globalPointer="AGS_"+Math.floor(1e5*Math.random()),window[this._globalPointer]=this,"/"!==t.url.substr(t.url.length-1,1)&&(t.url+="/"),this._originalOptions=L.Util.extend({},t),t.esriOptions){if("object"!=typeof t.esriOptions)return void this._getEsriOptions();L.Util.extend(t,this._convertEsriOptions(t.esriOptions))}lvector.Layer.prototype.initialize.call(this,t),this.options.where&&(this.options.where=encodeURIComponent(this.options.where)),this._vectors=[],this.options.map&&(this.options.scaleRange&&this.options.scaleRange instanceof Array&&2===this.options.scaleRange.length&&(t=this.options.map.getZoom(),e=this.options.scaleRange,this.options.visibleAtScale=t>=e[0]&&t<=e[1]),this._show())},options:{where:"1=1",url:null,useEsriOptions:!1},_requiredParams:["url"],_convertEsriOptions:function(t){var e={};if(void 0!=t.minScale&&void 0!=t.maxScale){var i=this._scaleToLevel(t.minScale),n=this._scaleToLevel(t.maxScale);0==n&&(n=20),e.scaleRange=[i,n]}return t.drawingInfo&&t.drawingInfo.renderer&&(e.symbology=this._renderOptionsToSymbology(t.drawingInfo.renderer)),e},_getEsriOptions:function(){this._makeJsonpRequest(this._originalOptions.url+"?f=json&callback="+this._globalPointer+"._processEsriOptions")},_processEsriOptions:function(t){var e=this._originalOptions;e.esriOptions=t,this.initialize(e)},_scaleToLevel:function(t){var e=[591657527.591555,295828763.795777,147914381.897889,73957190.948944,36978595.474472,18489297.737236,9244648.868618,4622324.434309,2311162.217155,1155581.108577,577790.554289,288895.277144,144447.638572,72223.819286,36111.909643,18055.954822,9027.977411,4513.988705,2256.994353,1128.497176,564.248588,282.124294];if(0==t)return 0;for(var i=0,n=0;n<e.length-1;n++){var s=e[n+1];if(t<=e[n]&&t>s){i=n;break}}return i},_renderOptionsToSymbology:function(t){switch(symbology={},t.type){case"simple":symbology.type="single",symbology.vectorOptions=this._parseSymbology(t.symbol);break;case"uniqueValue":symbology.type="unique",symbology.property=t.field1;for(var e=[],i=0;i<t.uniqueValueInfos.length;i++){var n=t.uniqueValueInfos[i],s={};s.value=n.value,s.vectorOptions=this._parseSymbology(n.symbol),s.label=n.label,e.push(s)}symbology.values=e;break;case"classBreaks":for(symbology.type="range",symbology.property=rend.field,e=[],n=t.minValue,i=0;i<t.classBreakInfos.length;i++){var s=t.classBreakInfos[i],r={};r.range=[n,s.classMaxValue],n=s.classMaxValue,r.vectorOptions=this._parseSymbology(s.symbol),r.label=s.label,e.push(r)}symbology.ranges=e}return symbology},_parseSymbology:function(t){var e={};switch(t.type){case"esriSMS":case"esriPMS":t=L.icon({iconUrl:"data:"+t.contentType+";base64,"+t.imageData,shadowUrl:null,iconSize:new L.Point(t.width,t.height),iconAnchor:new L.Point(t.width/2+t.xoffset,t.height/2+t.yoffset),popupAnchor:new L.Point(0,-(t.height/2))}),e.icon=t;break;case"esriSLS":e.weight=t.width,e.color=this._parseColor(t.color),e.opacity=this._parseAlpha(t.color[3]);break;case"esriSFS":t.outline?(e.weight=t.outline.width,e.color=this._parseColor(t.outline.color),e.opacity=this._parseAlpha(t.outline.color[3])):(e.weight=0,e.color="#000000",e.opacity=0),"esriSFSNull"!=t.style?(e.fillColor=this._parseColor(t.color),e.fillOpacity=this._parseAlpha(t.color[3])):(e.fillColor="#000000",e.fillOpacity=0)}return e},_parseColor:function(t){return red=this._normalize(t[0]),green=this._normalize(t[1]),blue=this._normalize(t[2]),"#"+this._pad(red.toString(16))+this._pad(green.toString(16))+this._pad(blue.toString(16))},_normalize:function(t){return 1>t&&t>0?Math.floor(255*t):t},_pad:function(t){return t.length>1?t.toUpperCase():"0"+t.toUpperCase()},_parseAlpha:function(t){return t/255},_getFeatures:function(){var t=this.options.url+"query?returnGeometry=true&outSR=4326&f=json&outFields="+this.options.fields+"&where="+this.options.where+"&callback="+this._globalPointer+"._processFeatures";this.options.showAll||(t+="&inSR=4326&spatialRel=esriSpatialRelIntersects&geometryType=esriGeometryEnvelope&geometry="+this.options.map.getBounds().toBBoxString()),this._makeJsonpRequest(t)}}),lvector.A2E=lvector.AGS.extend({initialize:function(t){for(var e=0,i=this._requiredParams.length;i>e;e++)if(!t[this._requiredParams[e]])throw Error('No "'+this._requiredParams[e]+'" parameter found.');if(this._globalPointer="A2E_"+Math.floor(1e5*Math.random()),window[this._globalPointer]=this,"/"!==t.url.substr(t.url.length-1,1)&&(t.url+="/"),this._originalOptions=L.Util.extend({},t),t.esriOptions){if("object"!=typeof t.esriOptions)return void this._getEsriOptions();L.Util.extend(t,this._convertEsriOptions(t.esriOptions))}if(lvector.Layer.prototype.initialize.call(this,t),this.options.where&&(this.options.where=encodeURIComponent(this.options.where)),this._vectors=[],this.options.map&&(this.options.scaleRange&&this.options.scaleRange instanceof Array&&2===this.options.scaleRange.length&&(t=this.options.map.getZoom(),e=this.options.scaleRange,this.options.visibleAtScale=t>=e[0]&&t<=e[1]),this._show()),this.options.autoUpdate&&this.options.esriOptions.editFeedInfo){this._makeJsonpRequest("http://cdn.pubnub.com/pubnub-3.1.min.js");var n=this;this._pubNubScriptLoaderInterval=setInterval(function(){window.PUBNUB&&n._pubNubScriptLoaded()},200)}},_pubNubScriptLoaded:function(){clearInterval(this._pubNubScriptLoaderInterval),this.pubNub=PUBNUB.init({subscribe_key:this.options.esriOptions.editFeedInfo.pubnubSubscribeKey,ssl:!1,origin:"pubsub.pubnub.com"});var t=this;this.pubNub.subscribe({channel:this.options.esriOptions.editFeedInfo.pubnubChannel,callback:function(){t._getFeatures()},error:function(){}})}}),lvector.GeoIQ=lvector.GeoJSONLayer.extend({initialize:function(t){for(var e=0,i=this._requiredParams.length;i>e;e++)if(!t[this._requiredParams[e]])throw Error('No "'+this._requiredParams[e]+'" parameter found.');lvector.Layer.prototype.initialize.call(this,t),this._globalPointer="GeoIQ_"+Math.floor(1e5*Math.random()),window[this._globalPointer]=this,this._vectors=[],this.options.map&&(this.options.scaleRange&&this.options.scaleRange instanceof Array&&2===this.options.scaleRange.length&&(t=this.options.map.getZoom(),e=this.options.scaleRange,this.options.visibleAtScale=t>=e[0]&&t<=e[1]),this._show())},options:{dataset:null},_requiredParams:["dataset"],_getFeatures:function(){var t="http://geocommons.com/datasets/"+this.options.dataset+"/features.json?geojson=1&callback="+this._globalPointer+"._processFeatures&limit=999";this.options.showAll||(t+="&bbox="+this.options.map.getBounds().toBBoxString()+"&intersect=full"),this._makeJsonpRequest(t)
}}),lvector.CartoDB=lvector.GeoJSONLayer.extend({initialize:function(t){for(var e=0,i=this._requiredParams.length;i>e;e++)if(!t[this._requiredParams[e]])throw Error('No "'+this._requiredParams[e]+'" parameter found.');lvector.Layer.prototype.initialize.call(this,t),this._globalPointer="CartoDB_"+Math.floor(1e5*Math.random()),window[this._globalPointer]=this,this._vectors=[],this.options.map&&(this.options.scaleRange&&this.options.scaleRange instanceof Array&&2===this.options.scaleRange.length&&(t=this.options.map.getZoom(),e=this.options.scaleRange,this.options.visibleAtScale=t>=e[0]&&t<=e[1]),this._show())},options:{version:1,user:null,table:null,fields:"*",where:null,limit:null,uniqueField:"cartodb_id"},_requiredParams:["user","table"],_getFeatures:function(){var t=this.options.where||"";if(!this.options.showAll)for(var e=this.options.map.getBounds(),i=e.getSouthWest(),e=e.getNorthEast(),n=this.options.table.split(",").length,s=0;n>s;s++)t+=(t.length?" AND ":"")+(n>1?this.options.table.split(",")[s].split(".")[0]+".the_geom":"the_geom")+" && st_setsrid(st_makebox2d(st_point("+i.lng+","+i.lat+"),st_point("+e.lng+","+e.lat+")),4326)";this.options.limit&&(t+=(t.length?" ":"")+"limit "+this.options.limit),t=t.length?" "+t:"",this._makeJsonpRequest("http://"+this.options.user+".cartodb.com/api/v"+this.options.version+"/sql?q="+encodeURIComponent("SELECT "+this.options.fields+" FROM "+this.options.table+(t.length?" WHERE "+t:""))+"&format=geojson&callback="+this._globalPointer+"._processFeatures")}}),lvector.PRWSF=lvector.GeoJSONLayer.extend({initialize:function(t){for(var e=0,i=this._requiredParams.length;i>e;e++)if(!t[this._requiredParams[e]])throw Error('No "'+this._requiredParams[e]+'" parameter found.');"/"!==t.url.substr(t.url.length-1,1)&&(t.url+="/"),lvector.Layer.prototype.initialize.call(this,t),this._globalPointer="PRWSF_"+Math.floor(1e5*Math.random()),window[this._globalPointer]=this,this._vectors=[],this.options.map&&(this.options.scaleRange&&this.options.scaleRange instanceof Array&&2===this.options.scaleRange.length&&(t=this.options.map.getZoom(),e=this.options.scaleRange,this.options.visibleAtScale=t>=e[0]&&t<=e[1]),this._show())},options:{geotable:null,srid:null,geomFieldName:"the_geom",geomPrecision:"",fields:"",where:null,limit:null,uniqueField:null},_requiredParams:["url","geotable"],_getFeatures:function(){var t=this.options.where||"";if(!this.options.showAll){var e=this.options.map.getBounds(),i=e.getSouthWest(),e=e.getNorthEast();t+=t.length?" AND ":"",t+=this.options.srid?this.options.geomFieldName+" && transform(st_setsrid(st_makebox2d(st_point("+i.lng+","+i.lat+"),st_point("+e.lng+","+e.lat+")),4326),"+this.options.srid+")":"transform("+this.options.geomFieldName+",4326) && st_setsrid(st_makebox2d(st_point("+i.lng+","+i.lat+"),st_point("+e.lng+","+e.lat+")),4326)"}this.options.limit&&(t+=(t.length?" ":"")+"limit "+this.options.limit),i=(this.options.fields.length?this.options.fields+",":"")+"st_asgeojson(transform("+this.options.geomFieldName+",4326)"+(this.options.geomPrecision?","+this.options.geomPrecision:"")+") as geojson",this._makeJsonpRequest(this.options.url+"v1/ws_geo_attributequery.php?parameters="+encodeURIComponent(t)+"&geotable="+this.options.geotable+"&fields="+encodeURIComponent(i)+"&format=json&callback="+this._globalPointer+"._processFeatures")}}),lvector.GISCloud=lvector.GeoJSONLayer.extend({initialize:function(t){for(var e=0,i=this._requiredParams.length;i>e;e++)if(!t[this._requiredParams[e]])throw Error('No "'+this._requiredParams[e]+'" parameter found.');lvector.Layer.prototype.initialize.call(this,t),this._globalPointer="GISCloud_"+Math.floor(1e5*Math.random()),window[this._globalPointer]=this,this._vectors=[],this.options.map&&(this.options.scaleRange&&this.options.scaleRange instanceof Array&&2===this.options.scaleRange.length&&(t=this.options.map.getZoom(),e=this.options.scaleRange,this.options.visibleAtScale=t>=e[0]&&t<=e[1]),this._show())},options:{mapID:null,layerID:null,uniqueField:"id"},_requiredParams:["mapID","layerID"],_getFeatures:function(){var t="http://api.giscloud.com/1/maps/"+this.options.mapID+"/layers/"+this.options.layerID+"/features.json?geometry=geojson&epsg=4326&callback="+this._globalPointer+"._processFeatures";this.options.showAll||(t+="&bounds="+this.options.map.getBounds().toBBoxString()),this.options.where&&(t+="&where="+encodeURIComponent(this.options.where)),this._makeJsonpRequest(t)}}),lvector.GitSpatial=lvector.GeoJSONLayer.extend({initialize:function(t){for(var e=0,i=this._requiredParams.length;i>e;e++)if(!t[this._requiredParams[e]])throw Error('No "'+this._requiredParams[e]+'" parameter found.');lvector.Layer.prototype.initialize.call(this,t),this._globalPointer="GitSpatial_"+Math.floor(1e5*Math.random()),window[this._globalPointer]=this,this._vectors=[],this.options.map&&(this.options.scaleRange&&this.options.scaleRange instanceof Array&&2===this.options.scaleRange.length&&(t=this.options.map.getZoom(),e=this.options.scaleRange,this.options.visibleAtScale=t>=e[0]&&t<=e[1]),this._show())},options:{},_requiredParams:["user","repo","featureSet"],_getFeatures:function(){var t="http://gitspatial.com/api/v1/"+this.options.user+"/"+this.options.repo+"/"+this.options.featureSet+"?callback="+this._globalPointer+"._processFeatures";this.options.showAll||(t+="&bbox="+this.options.map.getBounds().toBBoxString()),this._makeJsonpRequest(t)}}),function(t,e){"object"==typeof exports?module.exports=e():"function"==typeof define&&define.amd?define(e):t.Spinner=e()}(this,function(){"use strict";function t(t,e){var i,n=document.createElement(t||"div");for(i in e)n[i]=e[i];return n}function e(t){for(var e=1,i=arguments.length;i>e;e++)t.appendChild(arguments[e]);return t}function i(t,e,i,n){var s=["opacity",e,~~(100*t),i,n].join("-"),r=.01+i/n*100,o=Math.max(1-(1-t)/e*(100-r),t),a=h.substring(0,h.indexOf("Animation")).toLowerCase(),l=a&&"-"+a+"-"||"";return p[s]||(c.insertRule("@"+l+"keyframes "+s+"{0%{opacity:"+o+"}"+r+"%{opacity:"+t+"}"+(r+.01)+"%{opacity:1}"+(r+e)%100+"%{opacity:"+t+"}100%{opacity:"+o+"}}",c.cssRules.length),p[s]=1),s}function n(t,e){var i,n,s=t.style;for(e=e.charAt(0).toUpperCase()+e.slice(1),n=0;n<u.length;n++)if(i=u[n]+e,void 0!==s[i])return i;return void 0!==s[e]?e:void 0}function s(t,e){for(var i in e)t.style[n(t,i)||i]=e[i];return t}function r(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)void 0===t[n]&&(t[n]=i[n])}return t}function o(t,e){return"string"==typeof t?t:t[e%t.length]}function a(t){this.opts=r(t||{},a.defaults,d)}function l(){function i(e,i){return t("<"+e+' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">',i)}c.addRule(".spin-vml","behavior:url(#default#VML)"),a.prototype.lines=function(t,n){function r(){return s(i("group",{coordsize:u+" "+u,coordorigin:-h+" "+-h}),{width:u,height:u})}function a(t,a,l){e(c,e(s(r(),{rotation:360/n.lines*t+"deg",left:~~a}),e(s(i("roundrect",{arcsize:n.corners}),{width:h,height:n.width,left:n.radius,top:-n.width>>1,filter:l}),i("fill",{color:o(n.color,t),opacity:n.opacity}),i("stroke",{opacity:0}))))}var l,h=n.length+n.width,u=2*h,p=2*-(n.width+n.length)+"px",c=s(r(),{position:"absolute",top:p,left:p});if(n.shadow)for(l=1;l<=n.lines;l++)a(l,-2,"progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)");for(l=1;l<=n.lines;l++)a(l);return e(t,c)},a.prototype.opacity=function(t,e,i,n){var s=t.firstChild;n=n.shadow&&n.lines||0,s&&e+n<s.childNodes.length&&(s=s.childNodes[e+n],s=s&&s.firstChild,s=s&&s.firstChild,s&&(s.opacity=i))}}var h,u=["webkit","Moz","ms","O"],p={},c=function(){var i=t("style",{type:"text/css"});return e(document.getElementsByTagName("head")[0],i),i.sheet||i.styleSheet}(),d={lines:12,length:7,width:5,radius:10,rotate:0,corners:1,color:"#000",direction:1,speed:1,trail:100,opacity:.25,fps:20,zIndex:2e9,className:"spinner",top:"50%",left:"50%",position:"absolute"};a.defaults={},r(a.prototype,{spin:function(e){this.stop();{var i=this,n=i.opts,r=i.el=s(t(0,{className:n.className}),{position:n.position,width:0,zIndex:n.zIndex});n.radius+n.length+n.width}if(s(r,{left:n.left,top:n.top}),e&&e.insertBefore(r,e.firstChild||null),r.setAttribute("role","progressbar"),i.lines(r,i.opts),!h){var o,a=0,l=(n.lines-1)*(1-n.direction)/2,u=n.fps,p=u/n.speed,c=(1-n.opacity)/(p*n.trail/100),d=p/n.lines;!function m(){a++;for(var t=0;t<n.lines;t++)o=Math.max(1-(a+(n.lines-t)*d)%p*c,n.opacity),i.opacity(r,t*n.direction+l,o,n);i.timeout=i.el&&setTimeout(m,~~(1e3/u))}()}return i},stop:function(){var t=this.el;return t&&(clearTimeout(this.timeout),t.parentNode&&t.parentNode.removeChild(t),this.el=void 0),this},lines:function(n,r){function a(e,i){return s(t(),{position:"absolute",width:r.length+r.width+"px",height:r.width+"px",background:e,boxShadow:i,transformOrigin:"left",transform:"rotate("+~~(360/r.lines*u+r.rotate)+"deg) translate("+r.radius+"px,0)",borderRadius:(r.corners*r.width>>1)+"px"})}for(var l,u=0,p=(r.lines-1)*(1-r.direction)/2;u<r.lines;u++)l=s(t(),{position:"absolute",top:1+~(r.width/2)+"px",transform:r.hwaccel?"translate3d(0,0,0)":"",opacity:r.opacity,animation:h&&i(r.opacity,r.trail,p+u*r.direction,r.lines)+" "+1/r.speed+"s linear infinite"}),r.shadow&&e(l,s(a("#000","0 0 4px #000"),{top:"2px"})),e(n,e(l,a(o(r.color,u),"0 0 1px rgba(0,0,0,.1)")));return n},opacity:function(t,e,i){e<t.childNodes.length&&(t.childNodes[e].style.opacity=i)}});var m=s(t("group"),{behavior:"url(#default#VML)"});return!n(m,"transform")&&m.adj?l():h=n(m,"animation"),a}),function(t,e){"use strict";L.AwesomeMarkers={},L.AwesomeMarkers.version="2.0.1",L.AwesomeMarkers.Icon=L.Icon.extend({options:{iconSize:[35,45],iconAnchor:[17,42],popupAnchor:[1,-32],shadowAnchor:[10,12],shadowSize:[36,16],className:"awesome-marker",prefix:"glyphicon",spinClass:"fa-spin",extraClasses:"",icon:"home",markerColor:"blue",iconColor:"white"},initialize:function(t){t=L.Util.setOptions(this,t)},createIcon:function(){var t=e.createElement("div"),i=this.options;return i.icon&&(t.innerHTML=this._createInner()),i.bgPos&&(t.style.backgroundPosition=-i.bgPos.x+"px "+-i.bgPos.y+"px"),this._setIconStyles(t,"icon-"+i.markerColor),t},_createInner:function(){var t,e="",i="",n="",s=this.options;return t=s.icon.slice(0,s.prefix.length+1)===s.prefix+"-"?s.icon:s.prefix+"-"+s.icon,s.spin&&"string"==typeof s.spinClass&&(e=s.spinClass),s.iconColor&&("white"===s.iconColor||"black"===s.iconColor?i="icon-"+s.iconColor:n="style='color: "+s.iconColor+"' "),"<i "+n+"class='"+s.extraClasses+" "+s.prefix+" "+t+" "+e+" "+i+"'></i>"},_setIconStyles:function(t,e){var i,n=this.options,s=L.point(n["shadow"===e?"shadowSize":"iconSize"]);i=L.point("shadow"===e?n.shadowAnchor||n.iconAnchor:n.iconAnchor),!i&&s&&(i=s.divideBy(2,!0)),t.className="awesome-marker-"+e+" "+n.className,i&&(t.style.marginLeft=-i.x+"px",t.style.marginTop=-i.y+"px"),s&&(t.style.width=s.x+"px",t.style.height=s.y+"px")},createShadow:function(){var t=e.createElement("div");return this._setIconStyles(t,"shadow"),t}}),L.AwesomeMarkers.icon=function(t){return new L.AwesomeMarkers.Icon(t)}}(this,document),function(){L.labelVersion="0.2.1",L.Label=L.Class.extend({includes:L.Mixin.Events,options:{className:"",clickable:!1,direction:"right",noHide:!1,offset:[12,-15],opacity:1,zoomAnimation:!0},initialize:function(t,e){L.setOptions(this,t),this._source=e,this._animated=L.Browser.any3d&&this.options.zoomAnimation,this._isOpen=!1},onAdd:function(t){this._map=t,this._pane=this._source instanceof L.Marker?t._panes.markerPane:t._panes.popupPane,this._container||this._initLayout(),this._pane.appendChild(this._container),this._initInteraction(),this._update(),this.setOpacity(this.options.opacity),t.on("moveend",this._onMoveEnd,this).on("viewreset",this._onViewReset,this),this._animated&&t.on("zoomanim",this._zoomAnimation,this),L.Browser.touch&&!this.options.noHide&&L.DomEvent.on(this._container,"click",this.close,this)},onRemove:function(t){this._pane.removeChild(this._container),t.off({zoomanim:this._zoomAnimation,moveend:this._onMoveEnd,viewreset:this._onViewReset},this),this._removeInteraction(),this._map=null},setLatLng:function(t){return this._latlng=L.latLng(t),this._map&&this._updatePosition(),this},setContent:function(t){return this._previousContent=this._content,this._content=t,this._updateContent(),this},close:function(){var t=this._map;t&&(L.Browser.touch&&!this.options.noHide&&L.DomEvent.off(this._container,"click",this.close),t.removeLayer(this))},updateZIndex:function(t){this._zIndex=t,this._container&&this._zIndex&&(this._container.style.zIndex=t)},setOpacity:function(t){this.options.opacity=t,this._container&&L.DomUtil.setOpacity(this._container,t)},_initLayout:function(){this._container=L.DomUtil.create("div","leaflet-label "+this.options.className+" leaflet-zoom-animated"),this.updateZIndex(this._zIndex)},_update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updatePosition(),this._container.style.visibility="")},_updateContent:function(){this._content&&this._map&&this._prevContent!==this._content&&"string"==typeof this._content&&(this._container.innerHTML=this._content,this._prevContent=this._content,this._labelWidth=this._container.offsetWidth)},_updatePosition:function(){var t=this._map.latLngToLayerPoint(this._latlng);this._setPosition(t)},_setPosition:function(t){var e=this._map,i=this._container,n=e.latLngToContainerPoint(e.getCenter()),s=e.layerPointToContainerPoint(t),r=this.options.direction,o=this._labelWidth,a=L.point(this.options.offset);"right"===r||"auto"===r&&s.x<n.x?(L.DomUtil.addClass(i,"leaflet-label-right"),L.DomUtil.removeClass(i,"leaflet-label-left"),t=t.add(a)):(L.DomUtil.addClass(i,"leaflet-label-left"),L.DomUtil.removeClass(i,"leaflet-label-right"),t=t.add(L.point(-a.x-o,a.y))),L.DomUtil.setPosition(i,t)},_zoomAnimation:function(t){var e=this._map._latLngToNewLayerPoint(this._latlng,t.zoom,t.center).round();this._setPosition(e)},_onMoveEnd:function(){this._animated&&"auto"!==this.options.direction||this._updatePosition()},_onViewReset:function(t){t&&t.hard&&this._update()},_initInteraction:function(){if(this.options.clickable){var t=this._container,e=["dblclick","mousedown","mouseover","mouseout","contextmenu"];L.DomUtil.addClass(t,"leaflet-clickable"),L.DomEvent.on(t,"click",this._onMouseClick,this);for(var i=0;e.length>i;i++)L.DomEvent.on(t,e[i],this._fireMouseEvent,this)}},_removeInteraction:function(){if(this.options.clickable){var t=this._container,e=["dblclick","mousedown","mouseover","mouseout","contextmenu"];L.DomUtil.removeClass(t,"leaflet-clickable"),L.DomEvent.off(t,"click",this._onMouseClick,this);for(var i=0;e.length>i;i++)L.DomEvent.off(t,e[i],this._fireMouseEvent,this)}},_onMouseClick:function(t){this.hasEventListeners(t.type)&&L.DomEvent.stopPropagation(t),this.fire(t.type,{originalEvent:t})},_fireMouseEvent:function(t){this.fire(t.type,{originalEvent:t}),"contextmenu"===t.type&&this.hasEventListeners(t.type)&&L.DomEvent.preventDefault(t),"mousedown"!==t.type?L.DomEvent.stopPropagation(t):L.DomEvent.preventDefault(t)}}),L.BaseMarkerMethods={showLabel:function(){return this.label&&this._map&&(this.label.setLatLng(this._latlng),this._map.showLabel(this.label)),this},hideLabel:function(){return this.label&&this.label.close(),this},setLabelNoHide:function(t){this._labelNoHide!==t&&(this._labelNoHide=t,t?(this._removeLabelRevealHandlers(),this.showLabel()):(this._addLabelRevealHandlers(),this.hideLabel()))},bindLabel:function(t,e){var i=this.options.icon?this.options.icon.options.labelAnchor:this.options.labelAnchor,n=L.point(i)||L.point(0,0);return n=n.add(L.Label.prototype.options.offset),e&&e.offset&&(n=n.add(e.offset)),e=L.Util.extend({offset:n},e),this._labelNoHide=e.noHide,this.label||(this._labelNoHide||this._addLabelRevealHandlers(),this.on("remove",this.hideLabel,this).on("move",this._moveLabel,this).on("add",this._onMarkerAdd,this),this._hasLabelHandlers=!0),this.label=new L.Label(e,this).setContent(t),this},unbindLabel:function(){return this.label&&(this.hideLabel(),this.label=null,this._hasLabelHandlers&&(this._labelNoHide||this._removeLabelRevealHandlers(),this.off("remove",this.hideLabel,this).off("move",this._moveLabel,this).off("add",this._onMarkerAdd,this)),this._hasLabelHandlers=!1),this},updateLabelContent:function(t){this.label&&this.label.setContent(t)},getLabel:function(){return this.label},_onMarkerAdd:function(){this._labelNoHide&&this.showLabel()},_addLabelRevealHandlers:function(){this.on("mouseover",this.showLabel,this).on("mouseout",this.hideLabel,this),L.Browser.touch&&this.on("click",this.showLabel,this)},_removeLabelRevealHandlers:function(){this.off("mouseover",this.showLabel,this).off("mouseout",this.hideLabel,this),L.Browser.touch&&this.off("click",this.showLabel,this)},_moveLabel:function(t){this.label.setLatLng(t.latlng)}},L.Icon.Default.mergeOptions({labelAnchor:new L.Point(9,-20)}),L.Marker.mergeOptions({icon:new L.Icon.Default}),L.Marker.include(L.BaseMarkerMethods),L.Marker.include({_originalUpdateZIndex:L.Marker.prototype._updateZIndex,_updateZIndex:function(t){var e=this._zIndex+t;this._originalUpdateZIndex(t),this.label&&this.label.updateZIndex(e)},_originalSetOpacity:L.Marker.prototype.setOpacity,setOpacity:function(t,e){this.options.labelHasSemiTransparency=e,this._originalSetOpacity(t)},_originalUpdateOpacity:L.Marker.prototype._updateOpacity,_updateOpacity:function(){var t=0===this.options.opacity?0:1;this._originalUpdateOpacity(),this.label&&this.label.setOpacity(this.options.labelHasSemiTransparency?this.options.opacity:t)},_originalSetLatLng:L.Marker.prototype.setLatLng,setLatLng:function(t){return this.label&&!this._labelNoHide&&this.hideLabel(),this._originalSetLatLng(t)}}),L.CircleMarker.mergeOptions({labelAnchor:new L.Point(0,0)}),L.CircleMarker.include(L.BaseMarkerMethods),L.Path.include({bindLabel:function(t,e){return this.label&&this.label.options===e||(this.label=new L.Label(e,this)),this.label.setContent(t),this._showLabelAdded||(this.on("mouseover",this._showLabel,this).on("mousemove",this._moveLabel,this).on("mouseout remove",this._hideLabel,this),L.Browser.touch&&this.on("click",this._showLabel,this),this._showLabelAdded=!0),this},unbindLabel:function(){return this.label&&(this._hideLabel(),this.label=null,this._showLabelAdded=!1,this.off("mouseover",this._showLabel,this).off("mousemove",this._moveLabel,this).off("mouseout remove",this._hideLabel,this)),this},updateLabelContent:function(t){this.label&&this.label.setContent(t)},_showLabel:function(t){this.label.setLatLng(t.latlng),this._map.showLabel(this.label)},_moveLabel:function(t){this.label.setLatLng(t.latlng)},_hideLabel:function(){this.label.close()}}),L.Map.include({showLabel:function(t){return this.addLayer(t)}}),L.FeatureGroup.include({clearLayers:function(){return this.unbindLabel(),this.eachLayer(this.removeLayer,this),this},bindLabel:function(t,e){return this.invoke("bindLabel",t,e)},unbindLabel:function(){return this.invoke("unbindLabel")},updateLabelContent:function(t){this.invoke("updateLabelContent",t)}})}(this,document),L.esri={_callback:{}},L.esri.Support={CORS:!!(window.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest)},L.esri.RequestHandlers={CORS:function(t,e,i,n){var s=new XMLHttpRequest;e.f="json",s.onreadystatechange=function(){var t;if(4===s.readyState){try{t=JSON.parse(s.responseText)}catch(e){t={error:"Could not parse response as JSON."}}n?i.call(n,t):i(t)}},s.open("GET",t+"?"+L.esri.Util.serialize(e),!0),s.send(null)},JSONP:function(t,e,i,n){var s="c"+(1e9*Math.random()).toString(36).replace(".","_");e.f="json",e.callback="L.esri._callback."+s;var r=L.DomUtil.create("script",null,document.body);r.type="text/javascript",r.src=t+"?"+L.esri.Util.serialize(e),r.id=s,L.esri._callback[s]=function(t){n?i.call(n,t):i(t),document.body.removeChild(r),delete L.esri._callback[s]}}},L.esri.get=L.esri.Support.CORS?L.esri.RequestHandlers.CORS:L.esri.RequestHandlers.JSONP,L.esri.Mixins={},L.esri.Mixins.featureGrid={_activeRequests:0,_initializeFeatureGrid:function(t){this._map=t,this._previousCells=[],this.center=this._map.getCenter(),this.origin=this._map.project(this.center),this._moveHandler=L.esri.Util.debounce(function(t){"zoomend"===t.type&&(this.origin=this._map.project(this.center),this._previousCells=[]),this._requestFeatures(t.target.getBounds())},this.options.debounce,this),t.on("zoomend resize move",this._moveHandler,this),this._requestFeatures(t.getBounds())},_destroyFeatureGrid:function(t){t.off("zoomend resize move",this._moveHandler,this)},_requestFeatures:function(t){var e=this._cellsWithin(t);e&&e.length>0&&this.fire("loading",{bounds:t});for(var i=0;i<e.length;i++)this._makeRequest(e[i],e,t)},_makeRequest:function(t,e,i){this._activeRequests++;var n={geometryType:"esriGeometryEnvelope",geometry:JSON.stringify(L.esri.Util.boundsToExtent(t.bounds)),outFields:this.options.fields.join(","),outSR:4326,inSR:4326,where:this.options.where};this.options.token&&(n.token=this.options.token),L.esri.get(this.url+"query",n,function(t){this._activeRequests--,this._activeRequests<=0&&this.fire("load",{bounds:i}),!t.error||499!==t.error.code&&498!==t.error.code?this._render(t):this._authenticating||(this._authenticating=!0,this.fire("authenticationrequired",{retry:L.Util.bind(function(t){this._authenticating=!1,this.options.token=t,this._previousCells=[],this._requestFeatures(this._map.getBounds())},this)}))},this)},_cellsWithin:function(t){var e=this._map.getSize(),i=this._map.project(this._map.getCenter());Math.min(this.options.cellSize/e.x,this.options.cellSize/e.y);for(var n=t.pad(.1),s=[],r=this._map.project(n.getNorthWest()),o=this._map.project(n.getSouthEast()),a=r.subtract(i).divideBy(this.options.cellSize),l=o.subtract(i).divideBy(this.options.cellSize),h=Math.round((this.origin.x-i.x)/this.options.cellSize),u=Math.round((this.origin.y-i.y)/this.options.cellSize),p=L.esri.Util.roundAwayFromZero(a.x)-h,c=L.esri.Util.roundAwayFromZero(l.x)-h,d=L.esri.Util.roundAwayFromZero(a.y)-u,m=L.esri.Util.roundAwayFromZero(l.y)-u,f=p;c>f;f++)for(var y=d;m>y;y++){var g="cell:"+f+":"+y,v=L.esri.Util.indexOf(this._previousCells,g)>=0;if(!v||!this.options.deduplicate){var _=this._cellExtent(f,y),O=_.getCenter(),b=O.distanceTo(_.getNorthWest()),w=O.distanceTo(this.center),x={row:f,col:y,id:g,center:O,bounds:_,distance:w,radius:b};s.push(x),this._previousCells.push(g)}}return s.sort(function(t,e){return t.distance-e.distance}),s},_cellExtent:function(t,e){var i=this._cellPoint(t,e),n=this._cellPoint(t+1,e+1),s=this._map.unproject(i),r=this._map.unproject(n);return L.latLngBounds(s,r)},_cellPoint:function(t,e){var i=this.origin.x+t*this.options.cellSize,n=this.origin.y+e*this.options.cellSize;return[i,n]}},L.esri.Mixins.identifiableLayer={identify:function(t,e,i){var n={sr:"4326",mapExtent:JSON.stringify(L.esri.Util.boundsToExtent(this._map.getBounds())),tolerance:5,geometryType:"esriGeometryPoint",imageDisplay:this._map._size.x+","+this._map._size.y+",96",geometry:JSON.stringify({x:t.lng,y:t.lat,spatialReference:{wkid:4326}})};this.options.layers&&(n.layers=this.options.layers);var s;"function"==typeof e&&"undefined"==typeof i?(i=e,s=n):"object"==typeof e&&(e.layerDefs&&(e.layerDefs=this.parseLayerDefs(e.layerDefs)),s=L.Util.extend(n,e)),L.esri.get(this.url+"/identify",s,i)},parseLayerDefs:function(t){return t instanceof Array?"":"object"==typeof t?JSON.stringify(t):t}},L.esri.Mixins.metadata={_getMetadata:function(){var t={};this.options.token&&(t.token=this.options.token),L.esri.get(this.url,t,function(t){if(!t.error||499!==t.error.code&&498!==t.error.code){var e=t.extent||t.initialExtent||t.fullExtent,i={metadata:t};e&&this._map&&(!this._map||102100!==e.spatialReference.wkid&&3857!==e.spatialReference.wkid?4326===e.spatialReference.wkid&&(i.bounds=L.esri.Util.extentToBounds(e)):i.bounds=L.esri.Util.mercatorExtentToBounds(e,this._map)),this.fire("metadata",i)}else this._authenticating||(this._authenticating=!0,this.fire("authenticationrequired",{retry:L.Util.bind(function(t){this.options.token=t,this._getMetadata(),this._update()},this)}))},this)}},function(t){function e(t){var e={};for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return e}function i(t){var e,i=0,n=0,s=t.length,r=t[n];for(n;s-1>n;n++)e=t[n+1],i+=(e[0]-r[0])*(e[1]+r[1]),r=e;return i>=0}function n(t,e,i,n){var s=(n[0]-i[0])*(t[1]-i[1])-(n[1]-i[1])*(t[0]-i[0]),r=(e[0]-t[0])*(t[1]-i[1])-(e[1]-t[1])*(t[0]-i[0]),o=(n[1]-i[1])*(e[0]-t[0])-(n[0]-i[0])*(e[1]-t[1]);if(0!==o){var a=s/o,l=r/o;if(a>=0&&1>=a&&l>=0&&1>=l)return!0}return!1}function s(t,e){for(var i=0;i<t.length-1;i++)for(var s=0;s<e.length-1;s++)if(n(t[i],t[i+1],e[s],e[s+1]))return!0;return!1}function r(t,e){for(var i=!1,n=-1,s=t.length,r=s-1;++n<s;r=n)(t[n][1]<=e[1]&&e[1]<t[r][1]||t[r][1]<=e[1]&&e[1]<t[n][1])&&e[0]<(t[r][0]-t[n][0])*(e[1]-t[n][1])/(t[r][1]-t[n][1])+t[n][0]&&(i=!i);return i}function o(t,e){var i=s(t,e),n=r(t,e[0]);return!i&&n?!0:!1}function a(t){for(var e=[],n=[],s=0;s<t.length;s++){var r=t[s].slice(0);if(i(r)){var a=[r];e.push(a)}else n.push(r)}for(;n.length;){for(var l=n.pop(),h=!1,u=e.length-1;u>=0;u--){var p=e[u][0];if(o(p,l)){e[u].push(l),h=!0;break}}h||e.push([l.reverse()])}return 1===e.length?{type:"Polygon",coordinates:e[0]}:{type:"MultiPolygon",coordinates:e}}function l(t){for(var e=null,i=null,n=null,s=null,r=0;r<t.length;r++){var o=t[r],a=o[0],l=o[1];null===e?e=a:e>a&&(e=a),null===i?i=a:a>i&&(i=a),null===n?n=l:n>l&&(n=l),null===s?s=l:l>s&&(s=l)}return[e,n,i,s]}function h(t){for(var e=null,i=null,n=null,s=null,r=0;r<t.length;r++)for(var o=t[r],a=0;a<o.length;a++){var l=o[a],h=l[0],u=l[1];null===e?e=h:e>h&&(e=h),null===i?i=h:h>i&&(i=h),null===n?n=u:n>u&&(n=u),null===s?s=u:u>s&&(s=u)}return[e,n,i,s]}function u(t){for(var e=null,i=null,n=null,s=null,r=0;r<t.length;r++)for(var o=t[r],a=0;a<o.length;a++)for(var l=o[a],h=0;h<l.length;h++){var u=l[h],p=u[0],c=u[1];null===e?e=p:e>p&&(e=p),null===i?i=p:p>i&&(i=p),null===n?n=c:n>c&&(n=c),null===s?s=c:c>s&&(s=c)}return[e,n,i,s]}function p(t){var e=[],n=t.slice(0),s=n.shift().slice(0);i(s)||s.reverse(),e.push(s);for(var r=0;r<n.length;r++){var o=n[r].slice(0);i(o)&&o.reverse(),e.push(o)}return e}function c(t){for(var e=[],i=0;i<t.length;i++)for(var n=p(t[i]),s=n.length-1;s>=0;s--){var r=n[s].slice(0);e.push(r)}return e}t.esri.Util={debounce:function(t,e){var i=null;return function(){var n=this||n,s=arguments;clearTimeout(i),i=setTimeout(function(){t.apply(n,s)},e)}},roundAwayFromZero:function(t){return t>0?Math.ceil(t):Math.floor(t)},trim:function(t){return t.replace(/^\s\s*/,"").replace(/\s\s*$/,"")},cleanUrl:function(e){return e=t.esri.Util.trim(e),"/"!==e[e.length-1]&&(e+="/"),e},serialize:function(t){var e="";for(var i in t)if(t.hasOwnProperty(i)){var n=i,s=t[i];e+=encodeURIComponent(n),e+="=",e+=encodeURIComponent(s),e+="&"}return e.substring(0,e.length-1)},indexOf:function(t,e,i){if(i=i||0,t.indexOf)return t.indexOf(e,i);for(var n=i,s=t.length;s>n;n++)if(t[n]===e)return n;return-1},extentToBounds:function(e){var i=new t.LatLng(e.ymin,e.xmin),n=new t.LatLng(e.ymax,e.xmax);return new t.LatLngBounds(i,n)},mercatorExtentToBounds:function(e,i){var n=i.unproject(t.point([e.ymin,e.xmin])),s=i.unproject(t.point([e.ymax,e.xmax]));return new t.LatLngBounds(n,s)},boundsToExtent:function(t){return{xmin:t.getSouthWest().lng,ymin:t.getSouthWest().lat,xmax:t.getNorthEast().lng,ymax:t.getNorthEast().lat,spatialReference:{wkid:4326}}},boundsToEnvelope:function(e){var i=t.esri.Util.boundsToExtent(e);return{x:i.xmin,y:i.ymin,w:Math.abs(i.xmin-i.xmax),h:Math.abs(i.ymin-i.ymax)}},arcgisToGeojson:function(i,n){var s={};return n=n||{},n.idAttribute=n.idAttribute||void 0,i.x&&i.y&&(s.type="Point",s.coordinates=[i.x,i.y]),i.points&&(s.type="MultiPoint",s.coordinates=i.points.slice(0)),i.paths&&(1===i.paths.length?(s.type="LineString",s.coordinates=i.paths[0].slice(0)):(s.type="MultiLineString",s.coordinates=i.paths.slice(0))),i.rings&&(s=a(i.rings.slice(0))),(i.geometry||i.attributes)&&(s.type="Feature",s.geometry=i.geometry?t.esri.Util.arcgisToGeojson(i.geometry):null,s.properties=i.attributes?e(i.attributes):null,i.attributes&&(s.id=i.attributes[n.idAttribute]||i.attributes.OBJECTID||i.attributes.FID)),s},geojsonToArcGIS:function(e,i){var n,s=i&&i.idAttribute?i.idAttribute:"OBJECTID",r=i&&i.sr?{wkid:i.sr}:{wkid:4326},o={};switch(e.type){case"Point":o.x=e.coordinates[0],o.y=e.coordinates[1],o.spatialReference=r;break;case"MultiPoint":o.points=e.coordinates.slice(0),o.spatialReference=r;break;case"LineString":o.paths=[e.coordinates.slice(0)],o.spatialReference=r;break;case"MultiLineString":o.paths=e.coordinates.slice(0),o.spatialReference=r;break;case"Polygon":o.rings=p(e.coordinates.slice(0)),o.spatialReference=r;break;case"MultiPolygon":o.rings=c(e.coordinates.slice(0)),o.spatialReference=r;break;case"Feature":e.geometry&&(o.geometry=t.esri.Util.geojsonToArcGIS(e.geometry,i)),o.attributes=e.properties?t.esri.Util.clone(e.properties):{},o.attributes[s]=e.id;break;case"FeatureCollection":for(o=[],n=0;n<e.features.length;n++)o.push(t.esri.Util.geojsonToArcGIS(e.features[n],i));break;case"GeometryCollection":for(o=[],n=0;n<e.geometries.length;n++)o.push(t.esri.Util.geojsonToArcGIS(e.geometries[n],i))}return o},geojsonBounds:function(e){if(e.type)switch(e.type){case"Point":return[e.coordinates[0],e.coordinates[1],e.coordinates[0],e.coordinates[1]];case"MultiPoint":return l(e.coordinates);case"LineString":return l(e.coordinates);case"MultiLineString":return h(e.coordinates);case"Polygon":return h(e.coordinates);case"MultiPolygon":return u(e.coordinates);case"Feature":return e.geometry?t.esri.Util.geojsonBounds(e.geometry):null;default:throw new Error("Unknown type: "+e.type)}return null}}}(L),function(t){"use strict";function e(t,i){return this instanceof e?(this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),i&&this._initFormat(i),void this.clear()):new e(t,i)}e.prototype={all:function(){return this._all(this.data,[])},search:function(t){var e=this.data,i=[];if(!this._intersects(t,e.bbox))return i;for(var n,s,r,o,a=[];e;){for(n=0,s=e.children.length;s>n;n++)r=e.children[n],o=e.leaf?this.toBBox(r):r.bbox,this._intersects(t,o)&&(e.leaf?i.push(r):this._contains(t,o)?this._all(r,i):a.push(r));e=a.pop()}return i},load:function(t){if(!t||!t.length)return this;if(t.length<this._minEntries){for(var e=0,i=t.length;i>e;e++)this.insert(t[e]);return this}var n=this._build(t.slice(),0);if(this.data.children.length)if(this.data.height===n.height)this._splitRoot(this.data,n);else{if(this.data.height<n.height){var s=this.data;this.data=n,n=s}this._insert(n,this.data.height-n.height-1,!0)}else this.data=n;return this},insert:function(t){return t&&this._insert(t,this.data.height-1),this},clear:function(){return this.data={children:[],leaf:!0,bbox:this._empty(),height:1},this},remove:function(t){if(!t)return this;for(var e,i,n,s,r=this.data,o=this.toBBox(t),a=[],l=[];r||a.length;){if(r||(r=a.pop(),i=a[a.length-1],e=l.pop(),s=!0),r.leaf&&(n=r.children.indexOf(t),-1!==n))return r.children.splice(n,1),a.push(r),this._condense(a),this;s||r.leaf||!this._intersects(o,r.bbox)?i?(e++,r=i.children[e],s=!1):r=null:(a.push(r),l.push(e),e=0,i=r,r=r.children[0])}return this},toBBox:function(t){return t},compareMinX:function(t,e){return t[0]-e[0]},compareMinY:function(t,e){return t[1]-e[1]},toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},_all:function(t,e){for(var i=[];t;)t.leaf?e.push.apply(e,t.children):i.push.apply(i,t.children),t=i.pop();return e},_build:function(t,e,i){var n,s=t.length,r=this._maxEntries;if(r>=s)return n={children:t,leaf:!0,height:1},this._calcBBox(n),n;e||(i=Math.ceil(Math.log(s)/Math.log(r)),r=Math.ceil(s/Math.pow(r,i-1)),t.sort(this.compareMinX)),n={children:[],height:i};var o,a,l,h,u,p=Math.ceil(s/r)*Math.ceil(Math.sqrt(r)),c=Math.ceil(s/r),d=1===e%2?this.compareMinX:this.compareMinY;for(o=0;s>o;o+=p)for(l=t.slice(o,o+p).sort(d),a=0,h=l.length;h>a;a+=c)u=this._build(l.slice(a,a+c),e+1,i-1),n.children.push(u);
return this._calcBBox(n),n},_chooseSubtree:function(t,e,i,n){for(var s,r,o,a,l,h,u,p;n.push(e),!e.leaf&&n.length-1!==i;){for(u=p=1/0,s=0,r=e.children.length;r>s;s++)o=e.children[s],l=this._area(o.bbox),h=this._enlargedArea(t,o.bbox)-l,p>h?(p=h,u=u>l?l:u,a=o):h===p&&u>l&&(u=l,a=o);e=a}return e},_insert:function(t,e,i,n){var s,r=i?t.bbox:this.toBBox(t),o=[],a=this._chooseSubtree(r,n||this.data,e,o);a.children.push(t),this._extend(a.bbox,r);do s=!1,o[e].children.length>this._maxEntries&&(this._split(o,e),s=!0,e--);while(e>=0&&s);this._adjustParentBBoxes(r,o,e)},_split:function(t,e){var i=t[e],n=i.children.length,s=this._minEntries;this._chooseSplitAxis(i,s,n);var r={children:i.children.splice(this._chooseSplitIndex(i,s,n)),height:i.height};i.leaf&&(r.leaf=!0),this._calcBBox(i),this._calcBBox(r),e?t[e-1].children.push(r):this._splitRoot(i,r)},_splitRoot:function(t,e){this.data={},this.data.children=[t,e],this.data.height=t.height+1,this._calcBBox(this.data)},_chooseSplitIndex:function(t,e,i){var n,s,r,o,a,l,h,u;for(l=h=1/0,n=e;i-e>=n;n++)s=this._distBBox(t,0,n),r=this._distBBox(t,n,i),o=this._intersectionArea(s,r),a=this._area(s)+this._area(r),l>o?(l=o,u=n,h=h>a?a:h):o===l&&h>a&&(h=a,u=n);return u},_chooseSplitAxis:function(t,e,i){var n=t.leaf?this.compareMinX:this._compareNodeMinX,s=t.leaf?this.compareMinY:this._compareNodeMinY,r=this._allDistMargin(t,e,i,n),o=this._allDistMargin(t,e,i,s);o>r&&t.children.sort(n)},_allDistMargin:function(t,e,i,n){t.children.sort(n);var s,r,o=this._distBBox(t,0,e),a=this._distBBox(t,i-e,i),l=this._margin(o)+this._margin(a);for(s=e;i-e>s;s++)r=t.children[s],this._extend(o,t.leaf?this.toBBox(r):r.bbox),l+=this._margin(o);for(s=i-e-1;s>=0;s--)r=t.children[s],this._extend(a,t.leaf?this.toBBox(r):r.bbox),l+=this._margin(a);return l},_distBBox:function(t,e,i){for(var n,s=this._empty(),r=e;i>r;r++)n=t.children[r],this._extend(s,t.leaf?this.toBBox(n):n.bbox);return s},_calcBBox:function(t){t.bbox=this._empty();for(var e,i=0,n=t.children.length;n>i;i++)e=t.children[i],this._extend(t.bbox,t.leaf?this.toBBox(e):e.bbox)},_adjustParentBBoxes:function(t,e,i){for(var n=i;n>=0;n--)this._extend(e[n].bbox,t)},_condense:function(t){for(var e,i=t.length-1;i>=0;i--)0===t[i].children.length?i>0?(e=t[i-1].children,e.splice(e.indexOf(t[i]),1)):this.clear():this._calcBBox(t[i])},_contains:function(t,e){return t[0]<=e[0]&&t[1]<=e[1]&&e[2]<=t[2]&&e[3]<=t[3]},_intersects:function(t,e){return e[0]<=t[2]&&e[1]<=t[3]&&e[2]>=t[0]&&e[3]>=t[1]},_extend:function(t,e){return t[0]=Math.min(t[0],e[0]),t[1]=Math.min(t[1],e[1]),t[2]=Math.max(t[2],e[2]),t[3]=Math.max(t[3],e[3]),t},_area:function(t){return(t[2]-t[0])*(t[3]-t[1])},_margin:function(t){return t[2]-t[0]+(t[3]-t[1])},_enlargedArea:function(t,e){return(Math.max(e[2],t[2])-Math.min(e[0],t[0]))*(Math.max(e[3],t[3])-Math.min(e[1],t[1]))},_intersectionArea:function(t,e){var i=Math.max(t[0],e[0]),n=Math.max(t[1],e[1]),s=Math.min(t[2],e[2]),r=Math.min(t[3],e[3]);return Math.max(0,s-i)*Math.max(0,r-n)},_empty:function(){return[1/0,1/0,-1/0,-1/0]},_compareNodeMinX:function(t,e){return t.bbox[0]-e.bbox[0]},_compareNodeMinY:function(t,e){return t.bbox[1]-e.bbox[1]},_initFormat:function(t){var e=["return a"," - b",";"];this.compareMinX=new Function("a","b",e.join(t[0])),this.compareMinY=new Function("a","b",e.join(t[1])),this.toBBox=new Function("a","return [a"+t.join(", a")+"];")}},t.esri._rbush=e}(L),function(t){var e="https:"!==window.location.protocol?"http:":"https:",i="line-height:9px; text-overflow:ellipsis; white-space:nowrap;overflow:hidden; display:inline-block;",n="position:absolute; top:-38px; right:2px;",s="<img src='https://serverapi.arcgisonline.com/jsapi/arcgis/3.5/js/esri/images/map/logo-med.png' alt='Powered by Esri' class='esri-attribution-logo' style='"+n+"'>",r=function(t){return"<span class='esri-attributions' style='"+i+"'>"+t+"</span>"};t.esri.BasemapLayer=t.TileLayer.extend({statics:{TILES:{Streets:{urlTemplate:e+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Street_Map/MapServer/tile/{z}/{y}/{x}",attributionUrl:"https://static.arcgis.com/attribution/World_Street_Map",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],attribution:r("Esri")+s}},Topographic:{urlTemplate:e+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Topo_Map/MapServer/tile/{z}/{y}/{x}",attributionUrl:"https://static.arcgis.com/attribution/World_Topo_Map",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],attribution:r("Esri")+s}},Oceans:{urlTemplate:e+"//server.arcgisonline.com/ArcGIS/rest/services/Ocean_Basemap/MapServer/tile/{z}/{y}/{x}",attributionUrl:"https://static.arcgis.com/attribution/Ocean_Basemap",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],attribution:r("Esri")+s}},NationalGeographic:{urlTemplate:"https://server.arcgisonline.com/ArcGIS/rest/services/NatGeo_World_Map/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],attribution:r("Esri")+s}},DarkGray:{urlTemplate:e+"//tiles{s}.arcgis.com/tiles/P3ePLMYs2RVChkJx/arcgis/rest/services/World_Dark_Gray_Base_Beta/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:10,subdomains:[1,2],attribution:r("Esri, DeLorme, HERE")+s}},DarkGrayLabels:{urlTemplate:e+"//tiles{s}.arcgis.com/tiles/P3ePLMYs2RVChkJx/arcgis/rest/services/World_Dark_Gray_Reference_Beta/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:10,subdomains:[1,2]}},Gray:{urlTemplate:e+"//{s}.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"],attribution:r("Esri, NAVTEQ, DeLorme")+s}},GrayLabels:{urlTemplate:e+"//{s}.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Reference/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:16,subdomains:["server","services"]}},Imagery:{urlTemplate:e+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"],attribution:r("Esri, DigitalGlobe, GeoEye, i-cubed, USDA, USGS, AEX, Getmapping, Aerogrid, IGN, IGP, swisstopo, and the GIS User Community")+s}},ImageryLabels:{urlTemplate:e+"//{s}.arcgisonline.com/ArcGIS/rest/services/Reference/World_Boundaries_and_Places/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"]}},ImageryTransportation:{urlTemplate:e+"//{s}.arcgisonline.com/ArcGIS/rest/services/Reference/World_Transportation/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:19,subdomains:["server","services"]}},ShadedRelief:{urlTemplate:e+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Shaded_Relief/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:13,subdomains:["server","services"],attribution:r("ESRI, NAVTEQ, DeLorme")+s}},ShadedReliefLabels:{urlTemplate:e+"//{s}.arcgisonline.com/ArcGIS/rest/services/Reference/World_Boundaries_and_Places_Alternate/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:12,subdomains:["server","services"]}},Terrain:{urlTemplate:e+"//{s}.arcgisonline.com/ArcGIS/rest/services/World_Terrain_Base/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:13,subdomains:["server","services"],attribution:r("Esri, USGS, NOAA")+s}},TerrainLabels:{urlTemplate:e+"//{s}.arcgisonline.com/ArcGIS/rest/services/Reference/World_Reference_Overlay/MapServer/tile/{z}/{y}/{x}",options:{minZoom:1,maxZoom:13,subdomains:["server","services"]}}}},initialize:function(e,i){var n;if("object"==typeof e&&e.urlTemplate&&e.options)n=e;else{if("string"!=typeof e||!t.esri.BasemapLayer.TILES[e])throw new Error("L.esri.BasemapLayer: Invalid parameter. Use one of 'Streets', 'Topographic', 'Oceans', 'NationalGeographic', 'Gray', 'GrayLabels', 'DarkGray', 'DarkGrayLabels', 'Imagery', 'ImageryLabels', 'ImageryTransportation', 'ShadedRelief' or 'ShadedReliefLabels'");n=t.esri.BasemapLayer.TILES[e]}var s=t.Util.extend(n.options,i);if(t.TileLayer.prototype.initialize.call(this,n.urlTemplate,t.Util.setOptions(this,s)),n.attributionUrl){var r=n.attributionUrl;this._dynamicAttribution=!0,this._getAttributionData(r)}},_dynamicAttribution:!1,bounds:null,zoom:null,onAdd:function(e){return!e.attributionControl&&console?void console.warn("L.esri.BasemapLayer requires attribution. Please set attributionControl to true on your map"):(t.TileLayer.prototype.onAdd.call(this,e),this._dynamicAttribution&&(this.on("load",this._handleTileUpdates,this),this._map.on("viewreset zoomend dragend",this._handleTileUpdates,this)),void this._map.on("resize",this._resizeAttribution,this))},onRemove:function(e){this._dynamicAttribution&&(this.off("load",this._handleTileUpdates,this),this._map.off("viewreset zoomend dragend",this._handleTileUpdates,this)),this._map.off("resize",this._resizeAttribution,this),t.TileLayer.prototype.onRemove.call(this,e)},_handleTileUpdates:function(t){var e,i;"load"===t.type&&(e=this._map.getBounds(),i=this._map.getZoom()),("viewreset"===t.type||"dragend"===t.type||"zoomend"===t.type)&&(e=t.target.getBounds(),i=t.target.getZoom()),this.attributionBoundingBoxes&&e&&i&&(e.equals(this.bounds)&&i===this.zoom||(this.bounds=e,this.zoom=i,this._updateMapAttribution()))},_resizeAttribution:function(){var t=this._map.getSize().x;this._getAttributionLogo().style.display=600>t?"none":"block",this._getAttributionSpan().style.maxWidth=.75*t+"px"},_getAttributionData:function(e){this.attributionBoundingBoxes=[],t.esri.RequestHandlers.JSONP(e,{},this._processAttributionData,this)},_processAttributionData:function(e){for(var i=0;i<e.contributors.length;i++)for(var n=e.contributors[i],s=0;s<n.coverageAreas.length;s++){var r=n.coverageAreas[s],o=new t.LatLng(r.bbox[0],r.bbox[1]),a=new t.LatLng(r.bbox[2],r.bbox[3]);this.attributionBoundingBoxes.push({attribution:n.attribution,score:r.score,bounds:new t.LatLngBounds(o,a),minZoom:r.zoomMin,maxZoom:r.zoomMax})}this.attributionBoundingBoxes.sort(function(t,e){return t.score<e.score?-1:t.score>e.score?1:0}),this.bounds&&this._updateMapAttribution()},_getAttributionSpan:function(){return this._map._container.querySelectorAll(".esri-attributions")[0]},_getAttributionLogo:function(){return this._map._container.querySelectorAll(".esri-attribution-logo")[0]},_updateMapAttribution:function(){for(var t="",e=0;e<this.attributionBoundingBoxes.length;e++){var i=this.attributionBoundingBoxes[e];if(this.bounds.intersects(i.bounds)&&this.zoom>=i.minZoom&&this.zoom<=i.maxZoom){var n=this.attributionBoundingBoxes[e].attribution;-1===t.indexOf(n)&&(t.length>0&&(t+=", "),t+=n)}}this._getAttributionSpan().innerHTML=t,this._resizeAttribution()}}),t.esri.basemapLayer=function(e,i){return new t.esri.BasemapLayer(e,i)}}(L),function(t){function e(t,e){var i=e?"block":"none";if(t._icon&&(t._icon.style.display=i),t._shadow&&(t._shadow.style.display=i),t._layers)for(var n in t._layers)t._layers.hasOwnProperty(n)&&(t._layers[n]._container.style.display=i)}t.esri.FeatureLayer=t.GeoJSON.extend({includes:t.esri.Mixins.featureGrid,options:{cellSize:512,debounce:100,deduplicate:!0,where:"1=1",fields:["*"]},initialize:function(e,i){this.index=t.esri._rbush(),this.url=t.esri.Util.cleanUrl(e),t.Util.setOptions(this,i),t.Util.setOptions(this,i),this._getMetadata(),t.GeoJSON.prototype.initialize.call(this,[],i)},onAdd:function(e){this._updateHandler=t.esri.Util.debounce(this._update,this.options.debounce),t.LayerGroup.prototype.onAdd.call(this,e),e.on("zoomend resize moveend",this._updateHandler,this),this._initializeFeatureGrid(e)},onRemove:function(e){e.off("zoomend resize moveend",this._updateHandler,this),t.LayerGroup.prototype.onRemove.call(this,e),this._destroyFeatureGrid(e)},getLayerId:function(t){return t.feature.id},getWhere:function(){return this.options.where},setWhere:function(t){return this.options.where=t,this.refresh(),this},getFields:function(){return this.options.fields},setFields:function(t){return this.options.fields=t,this.refresh(),this},refresh:function(){this.clearLayers(),this._loaded=[],this._previousCells=[],this._requestFeatures(this._map.getBounds())},_update:function(i){t.esri.Util.boundsToEnvelope(i.target.getBounds());for(var n=this.index.search(i.target.getBounds().toBBoxString().split(",")),s=[],r=0;r<n.length;r++)s.push(n[r][4]);this.eachLayer(t.Util.bind(function(i){var n=i.feature.id;e(i,t.esri.Util.indexOf(s,n)>=0)},this))},_setObjectIdField:function(t){if(t.objectIdFieldName)this._objectIdField=t.objectIdFieldName;else for(var e=0;e<=t.fields.length-1;e++)if("esriFieldTypeOID"===t.fields[e].type){this._objectIdField=t.fields[e].name;break}},_render:function(e){if(e.features&&e.features.length&&!e.error){this._objectIdField||this._setObjectIdField(e);for(var i=[],n=e.features.length-1;n>=0;n--){var s=e.features[n],r=s.attributes[this._objectIdField];if(!this._layers[r]){var o=t.esri.Util.arcgisToGeojson(s,{idAttribute:this._objectIdField}),a=t.esri.Util.geojsonBounds(o);a.push(o.id),i.push(a),this.addData(o)}}this.index.load(i)}}}),t.esri.FeatureLayer.include(t.esri.Mixins.metadata),t.esri.featureLayer=function(e,i){return new t.esri.FeatureLayer(e,i)}}(L),L.esri.TiledMapLayer=L.TileLayer.extend({includes:L.esri.Mixins.identifiableLayer,initialize:function(t,e){e=e||{},this.url=L.esri.Util.cleanUrl(t),this.tileUrl=L.esri.Util.cleanUrl(t)+"tile/{z}/{y}/{x}",this.tileUrl.match("://tiles.arcgis.com")&&(this.tileUrl=this.tileUrl.replace("://tiles.arcgis.com","://tiles{s}.arcgis.com"),e.subdomains=["1","2","3","4"]),L.Util.setOptions(this,e),this._getMetadata(),L.TileLayer.prototype.initialize.call(this,this.tileUrl,e)}}),L.esri.TiledMapLayer.include(L.esri.Mixins.metadata),L.esri.tiledMapLayer=function(t,e){return new L.esri.TiledMapLayer(t,e)},L.esri.DynamicMapLayer=L.Class.extend({includes:L.esri.Mixins.identifiableLayer,options:{opacity:1,position:"front"},_defaultLayerParams:{format:"png24",transparent:!0,f:"image",bboxSR:3875,imageSR:3875,layers:"",layerDefs:""},initialize:function(t,e){this.url=L.esri.Util.cleanUrl(t),this._layerParams=L.Util.extend({},this._defaultLayerParams);for(var i in e)e.hasOwnProperty(i)&&this._defaultLayerParams.hasOwnProperty(i)&&(this._layerParams[i]=e[i]);this._parseLayers(),this._parseLayerDefs(),L.Util.setOptions(this,e),this._getMetadata(),this._layerParams.transparent||(this.options.opacity=1)},onAdd:function(t){if(this._map=t,this._moveHandler=L.esri.Util.debounce(this._update,150,this),t.on("moveend",this._moveHandler,this),t.options.crs&&t.options.crs.code){var e=t.options.crs.code.split(":")[1];this._layerParams.bboxSR=e,this._layerParams.imageSR=e}this._update()},onRemove:function(t){this._currentImage&&this._map.removeLayer(this._currentImage),t.off("moveend",this._moveHandler,this)},addTo:function(t){return t.addLayer(this),this},setOpacity:function(t){this.options.opacity=t,this._currentImage.setOpacity(t)},bringToFront:function(){return this.options.position="front",this._currentImage.bringToFront(),this},bringToBack:function(){return this.options.position="back",this._currentImage.bringToBack(),this},_parseLayers:function(){if("undefined"==typeof this._layerParams.layers)return void delete this._layerParams.layerOption;var t=this._layerParams.layerOption||null,e=this._layerParams.layers||null,i="show",n=["show","hide","include","exclude"];if(delete this._layerParams.layerOption,t)-1!==n.indexOf(t)&&(i=t),this._layerParams.layers=i+":"+e;else if(e instanceof Array)this._layerParams.layers=i+":"+e.join(",");else if("string"==typeof e){var s=e.match(":");s&&(e=e.split(s[0]),Number(e[1].split(",")[0])&&(-1!==n.indexOf(e[0])&&(i=e[0]),e=e[1])),this._layerParams.layers=i+":"+e}},_parseLayerDefs:function(){if("undefined"!=typeof this._layerParams.layerDefs){var t=this._layerParams.layerDefs,e=[];if(t instanceof Array)for(var i=t.length,n=0;i>n;n++)t[n]&&e.push(n+":"+t[n]);else{if("object"!=typeof t)return void delete this._layerParams.layerDefs;for(var s in t)t.hasOwnProperty(s)&&e.push(s+":"+t[s])}this._layerParams.layerDefs=e.join(";")}},_getImageUrl:function(){var t=this._map.getBounds(),e=this._map.getSize(),i=this._map.options.crs.project(t._northEast),n=this._map.options.crs.project(t._southWest);this._layerParams.bbox=[n.x,n.y,i.x,i.y].join(","),this._layerParams.size=e.x+","+e.y,this.options.token&&(this._layerParams.token=this.options.token);var s=this.url+"export"+L.Util.getParamString(this._layerParams);return s},_update:function(){if(!(this._animatingZoom||this._map._panTransition&&this._map._panTransition._inProgress)){var t=this._map.getZoom();if(!(t>this.options.maxZoom||t<this.options.minZoom)){var e=this._map.getBounds();e._southWest.wrap(),e._northEast.wrap();var i=new L.ImageOverlay(this._getImageUrl(),e,{opacity:0}).addTo(this._map);i.on("load",function(t){var i=t.target,n=this._currentImage;i._bounds.equals(e)?(this._currentImage=i,"front"===this.options.position?this._currentImage.bringToFront():this._currentImage.bringToBack(),this._currentImage.setOpacity(this.options.opacity),n&&this._map.removeLayer(n)):this._map.removeLayer(i)},this),this.fire("loading",{bounds:e})}}}}),L.esri.DynamicMapLayer.include(L.Mixin.Events),L.esri.DynamicMapLayer.include(L.esri.Mixins.metadata),L.esri.dynamicMapLayer=function(t,e){return new L.esri.DynamicMapLayer(t,e)},function(){function t(t){var e,i;if(!t||"string"!=typeof t)return null;try{window.DOMParser?(i=new DOMParser,e=i.parseFromString(t,"text/xml")):(e=new ActiveXObject("Microsoft.XMLDOM"),e.async="false",e.loadXML(t))}catch(n){e=void 0}if(!e||!e.documentElement||e.getElementsByTagName("parsererror").length)throw new Error("Invalid XML: "+t);return e}function e(t,e){return e.normalize?(t||"").trim():t}function i(t,n){var s,r,o,a,l={},h={};if(l[n.attrkey]=h,t.attributes&&t.attributes.length>0)for(s=0;s<t.attributes.length;s++){var u=t.attributes.item(s);h[u.nodeName]=u.value}for(0===t.childElementCount&&(l[n.charkey]=e(t.textContent,n)),s=0;s<t.childNodes.length;s++)if(r=t.childNodes[s],1===r.nodeType)if(o=0===r.attributes.length&&0===r.childElementCount?e(r.textContent,n):i(r,n),a=r.nodeName,l.hasOwnProperty(a)){var p=l[a];Array.isArray(p)||(p=[p],l[a]=p),p.push(o)}else l[a]=o;return l}function n(n,r){if(!n)return n;r=r||s,"string"==typeof n&&(n=t(n).documentElement);var o={};return o[n.nodeName]="undefined"==typeof n.attributes?i(n,r):0===n.attributes.length&&0===n.childElementCount?e(n.textContent,r):i(n,r),o}var s={attrkey:"$",charkey:"_",normalize:!1};"undefined"!=typeof jQuery?jQuery.extend({xml2json:n}):"undefined"!=typeof module?module.exports=n:"undefined"!=typeof window&&(window.xml2json=n)}(),function(){var t=L.divIcon({className:"leaflet-usermarker",iconSize:[34,34],iconAnchor:[17,17],popupAnchor:[0,-20],labelAnchor:[11,-3],html:""}),e=L.divIcon({className:"leaflet-usermarker",iconSize:[34,34],iconAnchor:[17,17],popupAnchor:[0,-20],labelAnchor:[11,-3],html:'<i class="pulse"></i>'}),i=L.divIcon({className:"leaflet-usermarker-small",iconSize:[17,17],iconAnchor:[9,9],popupAnchor:[0,-10],labelAnchor:[3,-4],html:""}),n=L.divIcon({className:"leaflet-usermarker-small",iconSize:[17,17],iconAnchor:[9,9],popupAnchor:[0,-10],labelAnchor:[3,-4],html:'<i class="pulse"></i>'}),s={stroke:!0,color:"#03f",weight:3,opacity:.5,fillOpacity:.15,fillColor:"#03f",clickable:!1};L.UserMarker=L.Marker.extend({options:{pulsing:!1,smallIcon:!1,accuracy:0,circleOpts:s},initialize:function(t,e){e=L.Util.setOptions(this,e),this.setPulsing(this.options.pulsing),this._accMarker=L.circle(t,this.options.accuracy,this.options.circleOpts),L.Marker.prototype.initialize.call(this,t,this.options),this.on("move",function(){this._accMarker.setLatLng(this.getLatLng())}).on("remove",function(){this._map.removeLayer(this._accMarker)})},setPulsing:function(s){this._pulsing=s,this.setIcon(this.options.smallIcon?this._pulsing?n:i:this._pulsing?e:t)},setAccuracy:function(t){this._accuracy=t,this._accMarker?this._accMarker.setRadius(t):this._accMarker=L.circle(this._latlng,t,this.options.circleOpts).addTo(this._map)},onAdd:function(t){L.Marker.prototype.onAdd.call(this,t),this._accMarker.addTo(t)}}),L.userMarker=function(t,e){return new L.UserMarker(t,e)}}(window),!function(t,e){L.drawVersion="0.2.3",L.drawLocal={draw:{toolbar:{actions:{title:"Cancel drawing",text:"Cancel"},undo:{title:"Delete last point drawn",text:"Delete last point"},buttons:{polyline:"Draw a polyline",polygon:"Draw a polygon",rectangle:"Draw a rectangle",circle:"Draw a circle",marker:"Draw a marker"}},handlers:{circle:{tooltip:{start:"Click and drag to draw circle."}},marker:{tooltip:{start:"Click map to place marker."}},polygon:{tooltip:{start:"Click to start drawing shape.",cont:"Click to continue drawing shape.",end:"Click first point to close this shape."}},polyline:{error:"<strong>Error:</strong> shape edges cannot cross!",tooltip:{start:"Click to start drawing line.",cont:"Click to continue drawing line.",end:"Click last point to finish line."}},rectangle:{tooltip:{start:"Click and drag to draw rectangle."}},simpleshape:{tooltip:{end:"Release mouse to finish drawing."}}}},edit:{toolbar:{actions:{save:{title:"Save changes.",text:"Save"},cancel:{title:"Cancel editing, discards all changes.",text:"Cancel"}},buttons:{edit:"Edit layers.",editDisabled:"No layers to edit.",remove:"Delete layers.",removeDisabled:"No layers to delete."}},handlers:{edit:{tooltip:{text:"Drag handles, or marker to edit feature.",subtext:"Click cancel to undo changes."}},remove:{tooltip:{text:"Click on a feature to remove"}}}}},L.Draw={},L.Draw.Feature=L.Handler.extend({includes:L.Mixin.Events,initialize:function(t,e){this._map=t,this._container=t._container,this._overlayPane=t._panes.overlayPane,this._popupPane=t._panes.popupPane,e&&e.shapeOptions&&(e.shapeOptions=L.Util.extend({},this.options.shapeOptions,e.shapeOptions)),L.setOptions(this,e)},enable:function(){this._enabled||(this.fire("enabled",{handler:this.type}),this._map.fire("draw:drawstart",{layerType:this.type}),L.Handler.prototype.enable.call(this))},disable:function(){this._enabled&&(L.Handler.prototype.disable.call(this),this._map.fire("draw:drawstop",{layerType:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var t=this._map;t&&(L.DomUtil.disableTextSelection(),t.getContainer().focus(),this._tooltip=new L.Tooltip(this._map),L.DomEvent.on(this._container,"keyup",this._cancelDrawing,this))},removeHooks:function(){this._map&&(L.DomUtil.enableTextSelection(),this._tooltip.dispose(),this._tooltip=null,L.DomEvent.off(this._container,"keyup",this._cancelDrawing,this))},setOptions:function(t){L.setOptions(this,t)},_fireCreatedEvent:function(t){this._map.fire("draw:created",{layer:t,layerType:this.type})},_cancelDrawing:function(t){27===t.keyCode&&this.disable()}}),L.Draw.Polyline=L.Draw.Feature.extend({statics:{TYPE:"polyline"},Poly:L.Polyline,options:{allowIntersection:!0,repeatMode:!1,drawError:{color:"#b00b00",timeout:2500},icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"}),guidelineDistance:20,maxGuideLineLength:4e3,shapeOptions:{stroke:!0,color:"#f06eaa",weight:4,opacity:.5,fill:!1,clickable:!0},metric:!0,showLength:!0,zIndexOffset:2e3},initialize:function(t,e){this.options.drawError.message=L.drawLocal.draw.handlers.polyline.error,e&&e.drawError&&(e.drawError=L.Util.extend({},this.options.drawError,e.drawError)),this.type=L.Draw.Polyline.TYPE,L.Draw.Feature.prototype.initialize.call(this,t,e)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._markers=[],this._markerGroup=new L.LayerGroup,this._map.addLayer(this._markerGroup),this._poly=new L.Polyline([],this.options.shapeOptions),this._tooltip.updateContent(this._getTooltipText()),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("mousedown",this._onMouseDown,this).addTo(this._map),this._map.on("mousemove",this._onMouseMove,this).on("mouseup",this._onMouseUp,this).on("zoomend",this._onZoomEnd,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._clearHideErrorTimeout(),this._cleanUpShape(),this._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers,this._map.removeLayer(this._poly),delete this._poly,this._mouseMarker.off("mousedown",this._onMouseDown,this).off("mouseup",this._onMouseUp,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._clearGuides(),this._map.off("mousemove",this._onMouseMove,this).off("zoomend",this._onZoomEnd,this)},deleteLastVertex:function(){if(!(this._markers.length<=1)){var t=this._markers.pop(),e=this._poly,i=this._poly.spliceLatLngs(e.getLatLngs().length-1,1)[0];this._markerGroup.removeLayer(t),e.getLatLngs().length<2&&this._map.removeLayer(e),this._vertexChanged(i,!1)}},addVertex:function(t){var e=this._markers.length;return e>0&&!this.options.allowIntersection&&this._poly.newLatLngIntersects(t)?void this._showErrorTooltip():(this._errorShown&&this._hideErrorTooltip(),this._markers.push(this._createMarker(t)),this._poly.addLatLng(t),2===this._poly.getLatLngs().length&&this._map.addLayer(this._poly),void this._vertexChanged(t,!0))},_finishShape:function(){var t=this._poly.newLatLngIntersects(this._poly.getLatLngs()[0],!0);return!this.options.allowIntersection&&t||!this._shapeIsValid()?void this._showErrorTooltip():(this._fireCreatedEvent(),this.disable(),void(this.options.repeatMode&&this.enable()))},_shapeIsValid:function(){return!0},_onZoomEnd:function(){this._updateGuide()},_onMouseMove:function(t){var e=t.layerPoint,i=t.latlng;this._currentLatLng=i,this._updateTooltip(i),this._updateGuide(e),this._mouseMarker.setLatLng(i),L.DomEvent.preventDefault(t.originalEvent)},_vertexChanged:function(t,e){this._updateFinishHandler(),this._updateRunningMeasure(t,e),this._clearGuides(),this._updateTooltip()},_onMouseDown:function(t){var e=t.originalEvent;this._mouseDownOrigin=L.point(e.clientX,e.clientY)},_onMouseUp:function(e){if(this._mouseDownOrigin){var i=L.point(e.originalEvent.clientX,e.originalEvent.clientY).distanceTo(this._mouseDownOrigin);Math.abs(i)<9*(t.devicePixelRatio||1)&&this.addVertex(e.latlng)}this._mouseDownOrigin=null},_updateFinishHandler:function(){var t=this._markers.length;t>1&&this._markers[t-1].on("click",this._finishShape,this),t>2&&this._markers[t-2].off("click",this._finishShape,this)},_createMarker:function(t){var e=new L.Marker(t,{icon:this.options.icon,zIndexOffset:2*this.options.zIndexOffset});return this._markerGroup.addLayer(e),e},_updateGuide:function(t){var e=this._markers.length;e>0&&(t=t||this._map.latLngToLayerPoint(this._currentLatLng),this._clearGuides(),this._drawGuide(this._map.latLngToLayerPoint(this._markers[e-1].getLatLng()),t))},_updateTooltip:function(t){var e=this._getTooltipText();t&&this._tooltip.updatePosition(t),this._errorShown||this._tooltip.updateContent(e)},_drawGuide:function(t,e){var i,n,s,r=Math.floor(Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))),o=this.options.guidelineDistance,a=this.options.maxGuideLineLength,l=r>a?r-a:o;for(this._guidesContainer||(this._guidesContainer=L.DomUtil.create("div","leaflet-draw-guides",this._overlayPane));r>l;l+=this.options.guidelineDistance)i=l/r,n={x:Math.floor(t.x*(1-i)+i*e.x),y:Math.floor(t.y*(1-i)+i*e.y)},s=L.DomUtil.create("div","leaflet-draw-guide-dash",this._guidesContainer),s.style.backgroundColor=this._errorShown?this.options.drawError.color:this.options.shapeOptions.color,L.DomUtil.setPosition(s,n)},_updateGuideColor:function(t){if(this._guidesContainer)for(var e=0,i=this._guidesContainer.childNodes.length;i>e;e++)this._guidesContainer.childNodes[e].style.backgroundColor=t},_clearGuides:function(){if(this._guidesContainer)for(;this._guidesContainer.firstChild;)this._guidesContainer.removeChild(this._guidesContainer.firstChild)},_getTooltipText:function(){var t,e,i=this.options.showLength;return 0===this._markers.length?t={text:L.drawLocal.draw.handlers.polyline.tooltip.start}:(e=i?this._getMeasurementString():"",t=1===this._markers.length?{text:L.drawLocal.draw.handlers.polyline.tooltip.cont,subtext:e}:{text:L.drawLocal.draw.handlers.polyline.tooltip.end,subtext:e}),t},_updateRunningMeasure:function(t,e){var i,n,s=this._markers.length;1===this._markers.length?this._measurementRunningTotal=0:(i=s-(e?2:1),n=t.distanceTo(this._markers[i].getLatLng()),this._measurementRunningTotal+=n*(e?1:-1))},_getMeasurementString:function(){var t,e=this._currentLatLng,i=this._markers[this._markers.length-1].getLatLng();return t=this._measurementRunningTotal+e.distanceTo(i),L.GeometryUtil.readableDistance(t,this.options.metric)},_showErrorTooltip:function(){this._errorShown=!0,this._tooltip.showAsError().updateContent({text:this.options.drawError.message}),this._updateGuideColor(this.options.drawError.color),this._poly.setStyle({color:this.options.drawError.color}),this._clearHideErrorTimeout(),this._hideErrorTimeout=setTimeout(L.Util.bind(this._hideErrorTooltip,this),this.options.drawError.timeout)},_hideErrorTooltip:function(){this._errorShown=!1,this._clearHideErrorTimeout(),this._tooltip.removeError().updateContent(this._getTooltipText()),this._updateGuideColor(this.options.shapeOptions.color),this._poly.setStyle({color:this.options.shapeOptions.color})},_clearHideErrorTimeout:function(){this._hideErrorTimeout&&(clearTimeout(this._hideErrorTimeout),this._hideErrorTimeout=null)},_cleanUpShape:function(){this._markers.length>1&&this._markers[this._markers.length-1].off("click",this._finishShape,this)},_fireCreatedEvent:function(){var t=new this.Poly(this._poly.getLatLngs(),this.options.shapeOptions);L.Draw.Feature.prototype._fireCreatedEvent.call(this,t)}}),L.Draw.Polygon=L.Draw.Polyline.extend({statics:{TYPE:"polygon"},Poly:L.Polygon,options:{showArea:!1,shapeOptions:{stroke:!0,color:"#f06eaa",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0}},initialize:function(t,e){L.Draw.Polyline.prototype.initialize.call(this,t,e),this.type=L.Draw.Polygon.TYPE},_updateFinishHandler:function(){var t=this._markers.length;1===t&&this._markers[0].on("click",this._finishShape,this),t>2&&(this._markers[t-1].on("dblclick",this._finishShape,this),t>3&&this._markers[t-2].off("dblclick",this._finishShape,this))},_getTooltipText:function(){var t,e;return 0===this._markers.length?t=L.drawLocal.draw.handlers.polygon.tooltip.start:this._markers.length<3?t=L.drawLocal.draw.handlers.polygon.tooltip.cont:(t=L.drawLocal.draw.handlers.polygon.tooltip.end,e=this._getMeasurementString()),{text:t,subtext:e}},_getMeasurementString:function(){var t=this._area;return t?L.GeometryUtil.readableArea(t,this.options.metric):null},_shapeIsValid:function(){return this._markers.length>=3},_vertexAdded:function(){if(!this.options.allowIntersection&&this.options.showArea){var t=this._poly.getLatLngs();this._area=L.GeometryUtil.geodesicArea(t)}},_cleanUpShape:function(){var t=this._markers.length;t>0&&(this._markers[0].off("click",this._finishShape,this),t>2&&this._markers[t-1].off("dblclick",this._finishShape,this))}}),L.SimpleShape={},L.Draw.SimpleShape=L.Draw.Feature.extend({options:{repeatMode:!1},initialize:function(t,e){this._endLabelText=L.drawLocal.draw.handlers.simpleshape.tooltip.end,L.Draw.Feature.prototype.initialize.call(this,t,e)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._mapDraggable=this._map.dragging.enabled(),this._mapDraggable&&this._map.dragging.disable(),this._container.style.cursor="crosshair",this._tooltip.updateContent({text:this._initialLabelText}),this._map.on("mousedown",this._onMouseDown,this).on("mousemove",this._onMouseMove,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._map&&(this._mapDraggable&&this._map.dragging.enable(),this._container.style.cursor="",this._map.off("mousedown",this._onMouseDown,this).off("mousemove",this._onMouseMove,this),L.DomEvent.off(e,"mouseup",this._onMouseUp,this),this._shape&&(this._map.removeLayer(this._shape),delete this._shape)),this._isDrawing=!1
},_onMouseDown:function(t){this._isDrawing=!0,this._startLatLng=t.latlng,L.DomEvent.on(e,"mouseup",this._onMouseUp,this).preventDefault(t.originalEvent)},_onMouseMove:function(t){var e=t.latlng;this._tooltip.updatePosition(e),this._isDrawing&&(this._tooltip.updateContent({text:this._endLabelText}),this._drawShape(e))},_onMouseUp:function(){this._shape&&this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()}}),L.Draw.Rectangle=L.Draw.SimpleShape.extend({statics:{TYPE:"rectangle"},options:{shapeOptions:{stroke:!0,color:"#f06eaa",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0}},initialize:function(t,e){this.type=L.Draw.Rectangle.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.rectangle.tooltip.start,L.Draw.SimpleShape.prototype.initialize.call(this,t,e)},_drawShape:function(t){this._shape?this._shape.setBounds(new L.LatLngBounds(this._startLatLng,t)):(this._shape=new L.Rectangle(new L.LatLngBounds(this._startLatLng,t),this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var t=new L.Rectangle(this._shape.getBounds(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,t)}}),L.Draw.Circle=L.Draw.SimpleShape.extend({statics:{TYPE:"circle"},options:{shapeOptions:{stroke:!0,color:"#f06eaa",weight:4,opacity:.5,fill:!0,fillColor:null,fillOpacity:.2,clickable:!0},showRadius:!0,metric:!0},initialize:function(t,e){this.type=L.Draw.Circle.TYPE,this._initialLabelText=L.drawLocal.draw.handlers.circle.tooltip.start,L.Draw.SimpleShape.prototype.initialize.call(this,t,e)},_drawShape:function(t){this._shape?this._shape.setRadius(this._startLatLng.distanceTo(t)):(this._shape=new L.Circle(this._startLatLng,this._startLatLng.distanceTo(t),this.options.shapeOptions),this._map.addLayer(this._shape))},_fireCreatedEvent:function(){var t=new L.Circle(this._startLatLng,this._shape.getRadius(),this.options.shapeOptions);L.Draw.SimpleShape.prototype._fireCreatedEvent.call(this,t)},_onMouseMove:function(t){var e,i=t.latlng,n=this.options.showRadius,s=this.options.metric;this._tooltip.updatePosition(i),this._isDrawing&&(this._drawShape(i),e=this._shape.getRadius().toFixed(1),this._tooltip.updateContent({text:this._endLabelText,subtext:n?"Radius: "+L.GeometryUtil.readableDistance(e,s):""}))}}),L.Draw.Marker=L.Draw.Feature.extend({statics:{TYPE:"marker"},options:{icon:new L.Icon.Default,repeatMode:!1,zIndexOffset:2e3},initialize:function(t,e){this.type=L.Draw.Marker.TYPE,L.Draw.Feature.prototype.initialize.call(this,t,e)},addHooks:function(){L.Draw.Feature.prototype.addHooks.call(this),this._map&&(this._tooltip.updateContent({text:L.drawLocal.draw.handlers.marker.tooltip.start}),this._mouseMarker||(this._mouseMarker=L.marker(this._map.getCenter(),{icon:L.divIcon({className:"leaflet-mouse-marker",iconAnchor:[20,20],iconSize:[40,40]}),opacity:0,zIndexOffset:this.options.zIndexOffset})),this._mouseMarker.on("click",this._onClick,this).addTo(this._map),this._map.on("mousemove",this._onMouseMove,this))},removeHooks:function(){L.Draw.Feature.prototype.removeHooks.call(this),this._map&&(this._marker&&(this._marker.off("click",this._onClick,this),this._map.off("click",this._onClick,this).removeLayer(this._marker),delete this._marker),this._mouseMarker.off("click",this._onClick,this),this._map.removeLayer(this._mouseMarker),delete this._mouseMarker,this._map.off("mousemove",this._onMouseMove,this))},_onMouseMove:function(t){var e=t.latlng;this._tooltip.updatePosition(e),this._mouseMarker.setLatLng(e),this._marker?(e=this._mouseMarker.getLatLng(),this._marker.setLatLng(e)):(this._marker=new L.Marker(e,{icon:this.options.icon,zIndexOffset:this.options.zIndexOffset}),this._marker.on("click",this._onClick,this),this._map.on("click",this._onClick,this).addLayer(this._marker))},_onClick:function(){this._fireCreatedEvent(),this.disable(),this.options.repeatMode&&this.enable()},_fireCreatedEvent:function(){var t=new L.Marker(this._marker.getLatLng(),{icon:this.options.icon});L.Draw.Feature.prototype._fireCreatedEvent.call(this,t)}}),L.Edit=L.Edit||{},L.Edit.Poly=L.Handler.extend({options:{icon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon"})},initialize:function(t,e){this._poly=t,L.setOptions(this,e)},addHooks:function(){this._poly._map&&(this._markerGroup||this._initMarkers(),this._poly._map.addLayer(this._markerGroup))},removeHooks:function(){this._poly._map&&(this._poly._map.removeLayer(this._markerGroup),delete this._markerGroup,delete this._markers)},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup),this._markers=[];var t,e,i,n,s=this._poly._latlngs;for(t=0,i=s.length;i>t;t++)n=this._createMarker(s[t],t),n.on("click",this._onMarkerClick,this),this._markers.push(n);var r,o;for(t=0,e=i-1;i>t;e=t++)(0!==t||L.Polygon&&this._poly instanceof L.Polygon)&&(r=this._markers[e],o=this._markers[t],this._createMiddleMarker(r,o),this._updatePrevNext(r,o))},_createMarker:function(t,e){var i=new L.Marker(t,{draggable:!0,icon:this.options.icon});return i._origLatLng=t,i._index=e,i.on("drag",this._onMarkerDrag,this),i.on("dragend",this._fireEdit,this),this._markerGroup.addLayer(i),i},_removeMarker:function(t){var e=t._index;this._markerGroup.removeLayer(t),this._markers.splice(e,1),this._poly.spliceLatLngs(e,1),this._updateIndexes(e,-1),t.off("drag",this._onMarkerDrag,this).off("dragend",this._fireEdit,this).off("click",this._onMarkerClick,this)},_fireEdit:function(){this._poly.edited=!0,this._poly.fire("edit")},_onMarkerDrag:function(t){var e=t.target;L.extend(e._origLatLng,e._latlng),e._middleLeft&&e._middleLeft.setLatLng(this._getMiddleLatLng(e._prev,e)),e._middleRight&&e._middleRight.setLatLng(this._getMiddleLatLng(e,e._next)),this._poly.redraw()},_onMarkerClick:function(t){var e=L.Polygon&&this._poly instanceof L.Polygon?4:3,i=t.target;this._poly._latlngs.length<e||(this._removeMarker(i),this._updatePrevNext(i._prev,i._next),i._middleLeft&&this._markerGroup.removeLayer(i._middleLeft),i._middleRight&&this._markerGroup.removeLayer(i._middleRight),i._prev&&i._next?this._createMiddleMarker(i._prev,i._next):i._prev?i._next||(i._prev._middleRight=null):i._next._middleLeft=null,this._fireEdit())},_updateIndexes:function(t,e){this._markerGroup.eachLayer(function(i){i._index>t&&(i._index+=e)})},_createMiddleMarker:function(t,e){var i,n,s,r=this._getMiddleLatLng(t,e),o=this._createMarker(r);o.setOpacity(.6),t._middleRight=e._middleLeft=o,n=function(){var n=e._index;o._index=n,o.off("click",i,this).on("click",this._onMarkerClick,this),r.lat=o.getLatLng().lat,r.lng=o.getLatLng().lng,this._poly.spliceLatLngs(n,0,r),this._markers.splice(n,0,o),o.setOpacity(1),this._updateIndexes(n,1),e._index++,this._updatePrevNext(t,o),this._updatePrevNext(o,e),this._poly.fire("editstart")},s=function(){o.off("dragstart",n,this),o.off("dragend",s,this),this._createMiddleMarker(t,o),this._createMiddleMarker(o,e)},i=function(){n.call(this),s.call(this),this._fireEdit()},o.on("click",i,this).on("dragstart",n,this).on("dragend",s,this),this._markerGroup.addLayer(o)},_updatePrevNext:function(t,e){t&&(t._next=e),e&&(e._prev=t)},_getMiddleLatLng:function(t,e){var i=this._poly._map,n=i.project(t.getLatLng()),s=i.project(e.getLatLng());return i.unproject(n._add(s)._divideBy(2))}}),L.Polyline.addInitHook(function(){this.editing||(L.Edit.Poly&&(this.editing=new L.Edit.Poly(this),this.options.editable&&this.editing.enable()),this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()}),this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()}))}),L.Edit=L.Edit||{},L.Edit.SimpleShape=L.Handler.extend({options:{moveIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-move"}),resizeIcon:new L.DivIcon({iconSize:new L.Point(8,8),className:"leaflet-div-icon leaflet-editing-icon leaflet-edit-resize"})},initialize:function(t,e){this._shape=t,L.Util.setOptions(this,e)},addHooks:function(){this._shape._map&&(this._map=this._shape._map,this._markerGroup||this._initMarkers(),this._map.addLayer(this._markerGroup))},removeHooks:function(){if(this._shape._map){this._unbindMarker(this._moveMarker);for(var t=0,e=this._resizeMarkers.length;e>t;t++)this._unbindMarker(this._resizeMarkers[t]);this._resizeMarkers=null,this._map.removeLayer(this._markerGroup),delete this._markerGroup}this._map=null},updateMarkers:function(){this._markerGroup.clearLayers(),this._initMarkers()},_initMarkers:function(){this._markerGroup||(this._markerGroup=new L.LayerGroup),this._createMoveMarker(),this._createResizeMarker()},_createMoveMarker:function(){},_createResizeMarker:function(){},_createMarker:function(t,e){var i=new L.Marker(t,{draggable:!0,icon:e,zIndexOffset:10});return this._bindMarker(i),this._markerGroup.addLayer(i),i},_bindMarker:function(t){t.on("dragstart",this._onMarkerDragStart,this).on("drag",this._onMarkerDrag,this).on("dragend",this._onMarkerDragEnd,this)},_unbindMarker:function(t){t.off("dragstart",this._onMarkerDragStart,this).off("drag",this._onMarkerDrag,this).off("dragend",this._onMarkerDragEnd,this)},_onMarkerDragStart:function(t){var e=t.target;e.setOpacity(0),this._shape.fire("editstart")},_fireEdit:function(){this._shape.edited=!0,this._shape.fire("edit")},_onMarkerDrag:function(t){var e=t.target,i=e.getLatLng();e===this._moveMarker?this._move(i):this._resize(i),this._shape.redraw()},_onMarkerDragEnd:function(t){var e=t.target;e.setOpacity(1),this._fireEdit()},_move:function(){},_resize:function(){}}),L.Edit=L.Edit||{},L.Edit.Rectangle=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var t=this._shape.getBounds(),e=t.getCenter();this._moveMarker=this._createMarker(e,this.options.moveIcon)},_createResizeMarker:function(){var t=this._getCorners();this._resizeMarkers=[];for(var e=0,i=t.length;i>e;e++)this._resizeMarkers.push(this._createMarker(t[e],this.options.resizeIcon)),this._resizeMarkers[e]._cornerIndex=e},_onMarkerDragStart:function(t){L.Edit.SimpleShape.prototype._onMarkerDragStart.call(this,t);var e=this._getCorners(),i=t.target,n=i._cornerIndex;this._oppositeCorner=e[(n+2)%4],this._toggleCornerMarkers(0,n)},_onMarkerDragEnd:function(t){var e,i,n=t.target;n===this._moveMarker&&(e=this._shape.getBounds(),i=e.getCenter(),n.setLatLng(i)),this._toggleCornerMarkers(1),this._repositionCornerMarkers(),L.Edit.SimpleShape.prototype._onMarkerDragEnd.call(this,t)},_move:function(t){for(var e,i=this._shape.getLatLngs(),n=this._shape.getBounds(),s=n.getCenter(),r=[],o=0,a=i.length;a>o;o++)e=[i[o].lat-s.lat,i[o].lng-s.lng],r.push([t.lat+e[0],t.lng+e[1]]);this._shape.setLatLngs(r),this._repositionCornerMarkers()},_resize:function(t){var e;this._shape.setBounds(L.latLngBounds(t,this._oppositeCorner)),e=this._shape.getBounds(),this._moveMarker.setLatLng(e.getCenter())},_getCorners:function(){var t=this._shape.getBounds(),e=t.getNorthWest(),i=t.getNorthEast(),n=t.getSouthEast(),s=t.getSouthWest();return[e,i,n,s]},_toggleCornerMarkers:function(t){for(var e=0,i=this._resizeMarkers.length;i>e;e++)this._resizeMarkers[e].setOpacity(t)},_repositionCornerMarkers:function(){for(var t=this._getCorners(),e=0,i=this._resizeMarkers.length;i>e;e++)this._resizeMarkers[e].setLatLng(t[e])}}),L.Rectangle.addInitHook(function(){L.Edit.Rectangle&&(this.editing=new L.Edit.Rectangle(this),this.options.editable&&this.editing.enable())}),L.Edit=L.Edit||{},L.Edit.Circle=L.Edit.SimpleShape.extend({_createMoveMarker:function(){var t=this._shape.getLatLng();this._moveMarker=this._createMarker(t,this.options.moveIcon)},_createResizeMarker:function(){var t=this._shape.getLatLng(),e=this._getResizeMarkerPoint(t);this._resizeMarkers=[],this._resizeMarkers.push(this._createMarker(e,this.options.resizeIcon))},_getResizeMarkerPoint:function(t){var e=this._shape._radius*Math.cos(Math.PI/4),i=this._map.project(t);return this._map.unproject([i.x+e,i.y-e])},_move:function(t){var e=this._getResizeMarkerPoint(t);this._resizeMarkers[0].setLatLng(e),this._shape.setLatLng(t)},_resize:function(t){var e=this._moveMarker.getLatLng(),i=e.distanceTo(t);this._shape.setRadius(i)}}),L.Circle.addInitHook(function(){L.Edit.Circle&&(this.editing=new L.Edit.Circle(this),this.options.editable&&this.editing.enable()),this.on("add",function(){this.editing&&this.editing.enabled()&&this.editing.addHooks()}),this.on("remove",function(){this.editing&&this.editing.enabled()&&this.editing.removeHooks()})}),L.LatLngUtil={cloneLatLngs:function(t){for(var e=[],i=0,n=t.length;n>i;i++)e.push(this.cloneLatLng(t[i]));return e},cloneLatLng:function(t){return L.latLng(t.lat,t.lng)}},L.GeometryUtil=L.extend(L.GeometryUtil||{},{geodesicArea:function(t){var e,i,n=t.length,s=0,r=L.LatLng.DEG_TO_RAD;if(n>2){for(var o=0;n>o;o++)e=t[o],i=t[(o+1)%n],s+=(i.lng-e.lng)*r*(2+Math.sin(e.lat*r)+Math.sin(i.lat*r));s=6378137*s*6378137/2}return Math.abs(s)},readableArea:function(t,e){var i;return e?i=t>=1e4?(1e-4*t).toFixed(2)+" ha":t.toFixed(2)+" m&sup2;":(t*=.836127,i=t>=3097600?(t/3097600).toFixed(2)+" mi&sup2;":t>=4840?(t/4840).toFixed(2)+" acres":Math.ceil(t)+" yd&sup2;"),i},readableDistance:function(t,e){var i;return e?i=t>1e3?(t/1e3).toFixed(2)+" km":Math.ceil(t)+" m":(t*=1.09361,i=t>1760?(t/1760).toFixed(2)+" miles":Math.ceil(t)+" yd"),i}}),L.Util.extend(L.LineUtil,{segmentsIntersect:function(t,e,i,n){return this._checkCounterclockwise(t,i,n)!==this._checkCounterclockwise(e,i,n)&&this._checkCounterclockwise(t,e,i)!==this._checkCounterclockwise(t,e,n)},_checkCounterclockwise:function(t,e,i){return(i.y-t.y)*(e.x-t.x)>(e.y-t.y)*(i.x-t.x)}}),L.Polyline.include({intersects:function(){var t,e,i,n=this._originalPoints,s=n?n.length:0;if(this._tooFewPointsForIntersection())return!1;for(t=s-1;t>=3;t--)if(e=n[t-1],i=n[t],this._lineSegmentsIntersectsRange(e,i,t-2))return!0;return!1},newLatLngIntersects:function(t,e){return this._map?this.newPointIntersects(this._map.latLngToLayerPoint(t),e):!1},newPointIntersects:function(t,e){var i=this._originalPoints,n=i?i.length:0,s=i?i[n-1]:null,r=n-2;return this._tooFewPointsForIntersection(1)?!1:this._lineSegmentsIntersectsRange(s,t,r,e?1:0)},_tooFewPointsForIntersection:function(t){var e=this._originalPoints,i=e?e.length:0;return i+=t||0,!this._originalPoints||3>=i},_lineSegmentsIntersectsRange:function(t,e,i,n){var s,r,o=this._originalPoints;n=n||0;for(var a=i;a>n;a--)if(s=o[a-1],r=o[a],L.LineUtil.segmentsIntersect(t,e,s,r))return!0;return!1}}),L.Polygon.include({intersects:function(){var t,e,i,n,s,r=this._originalPoints;return this._tooFewPointsForIntersection()?!1:(t=L.Polyline.prototype.intersects.call(this))?!0:(e=r.length,i=r[0],n=r[e-1],s=e-2,this._lineSegmentsIntersectsRange(n,i,s,1))}}),L.Control.Draw=L.Control.extend({options:{position:"topleft",draw:{},edit:!1},initialize:function(t){if(L.version<"0.7")throw new Error("Leaflet.draw 0.2.3+ requires Leaflet 0.7.0+. Download latest from https://github.com/Leaflet/Leaflet/");L.Control.prototype.initialize.call(this,t);var e,i;this._toolbars={},L.DrawToolbar&&this.options.draw&&(i=new L.DrawToolbar(this.options.draw),e=L.stamp(i),this._toolbars[e]=i,this._toolbars[e].on("enable",this._toolbarEnabled,this)),L.EditToolbar&&this.options.edit&&(i=new L.EditToolbar(this.options.edit),e=L.stamp(i),this._toolbars[e]=i,this._toolbars[e].on("enable",this._toolbarEnabled,this))},onAdd:function(t){var e,i=L.DomUtil.create("div","leaflet-draw"),n=!1,s="leaflet-draw-toolbar-top";for(var r in this._toolbars)this._toolbars.hasOwnProperty(r)&&(e=this._toolbars[r].addToolbar(t),e&&(n||(L.DomUtil.hasClass(e,s)||L.DomUtil.addClass(e.childNodes[0],s),n=!0),i.appendChild(e)));return i},onRemove:function(){for(var t in this._toolbars)this._toolbars.hasOwnProperty(t)&&this._toolbars[t].removeToolbar()},setDrawingOptions:function(t){for(var e in this._toolbars)this._toolbars[e]instanceof L.DrawToolbar&&this._toolbars[e].setOptions(t)},_toolbarEnabled:function(t){var e=""+L.stamp(t.target);for(var i in this._toolbars)this._toolbars.hasOwnProperty(i)&&i!==e&&this._toolbars[i].disable()}}),L.Map.mergeOptions({drawControlTooltips:!0,drawControl:!1}),L.Map.addInitHook(function(){this.options.drawControl&&(this.drawControl=new L.Control.Draw,this.addControl(this.drawControl))}),L.Toolbar=L.Class.extend({includes:[L.Mixin.Events],initialize:function(t){L.setOptions(this,t),this._modes={},this._actionButtons=[],this._activeMode=null},enabled:function(){return null!==this._activeMode},disable:function(){this.enabled()&&this._activeMode.handler.disable()},addToolbar:function(t){var e,i=L.DomUtil.create("div","leaflet-draw-section"),n=0,s=this._toolbarClass||"",r=this.getModeHandlers(t);for(this._toolbarContainer=L.DomUtil.create("div","leaflet-draw-toolbar leaflet-bar"),this._map=t,e=0;e<r.length;e++)r[e].enabled&&this._initModeHandler(r[e].handler,this._toolbarContainer,n++,s,r[e].title);return n?(this._lastButtonIndex=--n,this._actionsContainer=L.DomUtil.create("ul","leaflet-draw-actions"),i.appendChild(this._toolbarContainer),i.appendChild(this._actionsContainer),i):void 0},removeToolbar:function(){for(var t in this._modes)this._modes.hasOwnProperty(t)&&(this._disposeButton(this._modes[t].button,this._modes[t].handler.enable,this._modes[t].handler),this._modes[t].handler.disable(),this._modes[t].handler.off("enabled",this._handlerActivated,this).off("disabled",this._handlerDeactivated,this));this._modes={};for(var e=0,i=this._actionButtons.length;i>e;e++)this._disposeButton(this._actionButtons[e].button,this._actionButtons[e].callback,this);this._actionButtons=[],this._actionsContainer=null},_initModeHandler:function(t,e,i,n,s){var r=t.type;this._modes[r]={},this._modes[r].handler=t,this._modes[r].button=this._createButton({title:s,className:n+"-"+r,container:e,callback:this._modes[r].handler.enable,context:this._modes[r].handler}),this._modes[r].buttonIndex=i,this._modes[r].handler.on("enabled",this._handlerActivated,this).on("disabled",this._handlerDeactivated,this)},_createButton:function(t){var e=L.DomUtil.create("a",t.className||"",t.container);return e.href="#",t.text&&(e.innerHTML=t.text),t.title&&(e.title=t.title),L.DomEvent.on(e,"click",L.DomEvent.stopPropagation).on(e,"mousedown",L.DomEvent.stopPropagation).on(e,"dblclick",L.DomEvent.stopPropagation).on(e,"click",L.DomEvent.preventDefault).on(e,"click",t.callback,t.context),e},_disposeButton:function(t,e){L.DomEvent.off(t,"click",L.DomEvent.stopPropagation).off(t,"mousedown",L.DomEvent.stopPropagation).off(t,"dblclick",L.DomEvent.stopPropagation).off(t,"click",L.DomEvent.preventDefault).off(t,"click",e)},_handlerActivated:function(t){this.disable(),this._activeMode=this._modes[t.handler],L.DomUtil.addClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled"),this._showActionsToolbar(),this.fire("enable")},_handlerDeactivated:function(){this._hideActionsToolbar(),L.DomUtil.removeClass(this._activeMode.button,"leaflet-draw-toolbar-button-enabled"),this._activeMode=null,this.fire("disable")},_createActions:function(t){var e,i,n,s,r=this._actionsContainer,o=this.getActions(t),a=o.length;for(i=0,n=this._actionButtons.length;n>i;i++)this._disposeButton(this._actionButtons[i].button,this._actionButtons[i].callback);for(this._actionButtons=[];r.firstChild;)r.removeChild(r.firstChild);for(var l=0;a>l;l++)"enabled"in o[l]&&!o[l].enabled||(e=L.DomUtil.create("li","",r),s=this._createButton({title:o[l].title,text:o[l].text,container:e,callback:o[l].callback,context:o[l].context}),this._actionButtons.push({button:s,callback:o[l].callback}))},_showActionsToolbar:function(){var t=this._activeMode.buttonIndex,e=this._lastButtonIndex,i=this._activeMode.button.offsetTop-1;this._createActions(this._activeMode.handler),this._actionsContainer.style.top=i+"px",0===t&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-notop"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-top")),t===e&&(L.DomUtil.addClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom"),L.DomUtil.addClass(this._actionsContainer,"leaflet-draw-actions-bottom")),this._actionsContainer.style.display="block"},_hideActionsToolbar:function(){this._actionsContainer.style.display="none",L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-notop"),L.DomUtil.removeClass(this._toolbarContainer,"leaflet-draw-toolbar-nobottom"),L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-top"),L.DomUtil.removeClass(this._actionsContainer,"leaflet-draw-actions-bottom")}}),L.Tooltip=L.Class.extend({initialize:function(t){this._map=t,this._popupPane=t._panes.popupPane,this._container=t.options.drawControlTooltips?L.DomUtil.create("div","leaflet-draw-tooltip",this._popupPane):null,this._singleLineLabel=!1},dispose:function(){this._container&&(this._popupPane.removeChild(this._container),this._container=null)},updateContent:function(t){return this._container?(t.subtext=t.subtext||"",0!==t.subtext.length||this._singleLineLabel?t.subtext.length>0&&this._singleLineLabel&&(L.DomUtil.removeClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!1):(L.DomUtil.addClass(this._container,"leaflet-draw-tooltip-single"),this._singleLineLabel=!0),this._container.innerHTML=(t.subtext.length>0?'<span class="leaflet-draw-tooltip-subtext">'+t.subtext+"</span><br />":"")+"<span>"+t.text+"</span>",this):this},updatePosition:function(t){var e=this._map.latLngToLayerPoint(t),i=this._container;return this._container&&(i.style.visibility="inherit",L.DomUtil.setPosition(i,e)),this},showAsError:function(){return this._container&&L.DomUtil.addClass(this._container,"leaflet-error-draw-tooltip"),this},removeError:function(){return this._container&&L.DomUtil.removeClass(this._container,"leaflet-error-draw-tooltip"),this}}),L.DrawToolbar=L.Toolbar.extend({options:{polyline:{},polygon:{},rectangle:{},circle:{},marker:{}},initialize:function(t){for(var e in this.options)this.options.hasOwnProperty(e)&&t[e]&&(t[e]=L.extend({},this.options[e],t[e]));this._toolbarClass="leaflet-draw-draw",L.Toolbar.prototype.initialize.call(this,t)},getModeHandlers:function(t){return[{enabled:this.options.polyline,handler:new L.Draw.Polyline(t,this.options.polyline),title:L.drawLocal.draw.toolbar.buttons.polyline},{enabled:this.options.polygon,handler:new L.Draw.Polygon(t,this.options.polygon),title:L.drawLocal.draw.toolbar.buttons.polygon},{enabled:this.options.rectangle,handler:new L.Draw.Rectangle(t,this.options.rectangle),title:L.drawLocal.draw.toolbar.buttons.rectangle},{enabled:this.options.circle,handler:new L.Draw.Circle(t,this.options.circle),title:L.drawLocal.draw.toolbar.buttons.circle},{enabled:this.options.marker,handler:new L.Draw.Marker(t,this.options.marker),title:L.drawLocal.draw.toolbar.buttons.marker}]},getActions:function(t){return[{enabled:t.deleteLastVertex,title:L.drawLocal.draw.toolbar.undo.title,text:L.drawLocal.draw.toolbar.undo.text,callback:t.deleteLastVertex,context:t},{title:L.drawLocal.draw.toolbar.actions.title,text:L.drawLocal.draw.toolbar.actions.text,callback:this.disable,context:this}]},setOptions:function(t){L.setOptions(this,t);for(var e in this._modes)this._modes.hasOwnProperty(e)&&t.hasOwnProperty(e)&&this._modes[e].handler.setOptions(t[e])}}),L.EditToolbar=L.Toolbar.extend({options:{edit:{selectedPathOptions:{color:"#fe57a1",opacity:.6,dashArray:"10, 10",fill:!0,fillColor:"#fe57a1",fillOpacity:.1}},remove:{},featureGroup:null},initialize:function(t){t.edit&&("undefined"==typeof t.edit.selectedPathOptions&&(t.edit.selectedPathOptions=this.options.edit.selectedPathOptions),t.edit=L.extend({},this.options.edit,t.edit)),t.remove&&(t.remove=L.extend({},this.options.remove,t.remove)),this._toolbarClass="leaflet-draw-edit",L.Toolbar.prototype.initialize.call(this,t),this._selectedFeatureCount=0},getModeHandlers:function(t){var e=this.options.featureGroup;return[{enabled:this.options.edit,handler:new L.EditToolbar.Edit(t,{featureGroup:e,selectedPathOptions:this.options.edit.selectedPathOptions}),title:L.drawLocal.edit.toolbar.buttons.edit},{enabled:this.options.remove,handler:new L.EditToolbar.Delete(t,{featureGroup:e}),title:L.drawLocal.edit.toolbar.buttons.remove}]},getActions:function(){return[{title:L.drawLocal.edit.toolbar.actions.save.title,text:L.drawLocal.edit.toolbar.actions.save.text,callback:this._save,context:this},{title:L.drawLocal.edit.toolbar.actions.cancel.title,text:L.drawLocal.edit.toolbar.actions.cancel.text,callback:this.disable,context:this}]},addToolbar:function(t){var e=L.Toolbar.prototype.addToolbar.call(this,t);return this._checkDisabled(),this.options.featureGroup.on("layeradd layerremove",this._checkDisabled,this),e},removeToolbar:function(){this.options.featureGroup.off("layeradd layerremove",this._checkDisabled,this),L.Toolbar.prototype.removeToolbar.call(this)},disable:function(){this.enabled()&&(this._activeMode.handler.revertLayers(),L.Toolbar.prototype.disable.call(this))},_save:function(){this._activeMode.handler.save(),this._activeMode.handler.disable()},_checkDisabled:function(){var t,e=this.options.featureGroup,i=0!==e.getLayers().length;this.options.edit&&(t=this._modes[L.EditToolbar.Edit.TYPE].button,i?L.DomUtil.removeClass(t,"leaflet-disabled"):L.DomUtil.addClass(t,"leaflet-disabled"),t.setAttribute("title",i?L.drawLocal.edit.toolbar.buttons.edit:L.drawLocal.edit.toolbar.buttons.editDisabled)),this.options.remove&&(t=this._modes[L.EditToolbar.Delete.TYPE].button,i?L.DomUtil.removeClass(t,"leaflet-disabled"):L.DomUtil.addClass(t,"leaflet-disabled"),t.setAttribute("title",i?L.drawLocal.edit.toolbar.buttons.remove:L.drawLocal.edit.toolbar.buttons.removeDisabled))}}),L.EditToolbar.Edit=L.Handler.extend({statics:{TYPE:"edit"},includes:L.Mixin.Events,initialize:function(t,e){if(L.Handler.prototype.initialize.call(this,t),this._selectedPathOptions=e.selectedPathOptions,this._featureGroup=e.featureGroup,!(this._featureGroup instanceof L.FeatureGroup))throw new Error("options.featureGroup must be a L.FeatureGroup");this._uneditedLayerProps={},this.type=L.EditToolbar.Edit.TYPE},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire("draw:editstart",{handler:this.type}),L.Handler.prototype.enable.call(this),this._featureGroup.on("layeradd",this._enableLayerEdit,this).on("layerremove",this._disableLayerEdit,this))},disable:function(){this._enabled&&(this._featureGroup.off("layeradd",this._enableLayerEdit,this).off("layerremove",this._disableLayerEdit,this),L.Handler.prototype.disable.call(this),this._map.fire("draw:editstop",{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var t=this._map;t&&(t.getContainer().focus(),this._featureGroup.eachLayer(this._enableLayerEdit,this),this._tooltip=new L.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.edit.tooltip.text,subtext:L.drawLocal.edit.handlers.edit.tooltip.subtext}),this._map.on("mousemove",this._onMouseMove,this))},removeHooks:function(){this._map&&(this._featureGroup.eachLayer(this._disableLayerEdit,this),this._uneditedLayerProps={},this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this))},revertLayers:function(){this._featureGroup.eachLayer(function(t){this._revertLayer(t)},this)},save:function(){var t=new L.LayerGroup;this._featureGroup.eachLayer(function(e){e.edited&&(t.addLayer(e),e.edited=!1)}),this._map.fire("draw:edited",{layers:t})},_backupLayer:function(t){var e=L.Util.stamp(t);this._uneditedLayerProps[e]||(t instanceof L.Polyline||t instanceof L.Polygon||t instanceof L.Rectangle?this._uneditedLayerProps[e]={latlngs:L.LatLngUtil.cloneLatLngs(t.getLatLngs())}:t instanceof L.Circle?this._uneditedLayerProps[e]={latlng:L.LatLngUtil.cloneLatLng(t.getLatLng()),radius:t.getRadius()}:t instanceof L.Marker&&(this._uneditedLayerProps[e]={latlng:L.LatLngUtil.cloneLatLng(t.getLatLng())}))},_revertLayer:function(t){var e=L.Util.stamp(t);t.edited=!1,this._uneditedLayerProps.hasOwnProperty(e)&&(t instanceof L.Polyline||t instanceof L.Polygon||t instanceof L.Rectangle?t.setLatLngs(this._uneditedLayerProps[e].latlngs):t instanceof L.Circle?(t.setLatLng(this._uneditedLayerProps[e].latlng),t.setRadius(this._uneditedLayerProps[e].radius)):t instanceof L.Marker&&t.setLatLng(this._uneditedLayerProps[e].latlng))},_toggleMarkerHighlight:function(t){if(t._icon){var e=t._icon;e.style.display="none",L.DomUtil.hasClass(e,"leaflet-edit-marker-selected")?(L.DomUtil.removeClass(e,"leaflet-edit-marker-selected"),this._offsetMarker(e,-4)):(L.DomUtil.addClass(e,"leaflet-edit-marker-selected"),this._offsetMarker(e,4)),e.style.display=""}},_offsetMarker:function(t,e){var i=parseInt(t.style.marginTop,10)-e,n=parseInt(t.style.marginLeft,10)-e;t.style.marginTop=i+"px",t.style.marginLeft=n+"px"},_enableLayerEdit:function(t){var e,i=t.layer||t.target||t,n=i instanceof L.Marker;(!n||i._icon)&&(this._backupLayer(i),this._selectedPathOptions&&(e=L.Util.extend({},this._selectedPathOptions),n?this._toggleMarkerHighlight(i):(i.options.previousOptions=L.Util.extend({dashArray:null},i.options),i instanceof L.Circle||i instanceof L.Polygon||i instanceof L.Rectangle||(e.fill=!1),i.setStyle(e))),n?(i.dragging.enable(),i.on("dragend",this._onMarkerDragEnd)):i.editing.enable())},_disableLayerEdit:function(t){var e=t.layer||t.target||t;e.edited=!1,this._selectedPathOptions&&(e instanceof L.Marker?this._toggleMarkerHighlight(e):(e.setStyle(e.options.previousOptions),delete e.options.previousOptions)),e instanceof L.Marker?(e.dragging.disable(),e.off("dragend",this._onMarkerDragEnd,this)):e.editing.disable()},_onMarkerDragEnd:function(t){var e=t.target;e.edited=!0},_onMouseMove:function(t){this._tooltip.updatePosition(t.latlng)},_hasAvailableLayers:function(){return 0!==this._featureGroup.getLayers().length}}),L.EditToolbar.Delete=L.Handler.extend({statics:{TYPE:"remove"},includes:L.Mixin.Events,initialize:function(t,e){if(L.Handler.prototype.initialize.call(this,t),L.Util.setOptions(this,e),this._deletableLayers=this.options.featureGroup,!(this._deletableLayers instanceof L.FeatureGroup))throw new Error("options.featureGroup must be a L.FeatureGroup");this.type=L.EditToolbar.Delete.TYPE},enable:function(){!this._enabled&&this._hasAvailableLayers()&&(this.fire("enabled",{handler:this.type}),this._map.fire("draw:deletestart",{handler:this.type}),L.Handler.prototype.enable.call(this),this._deletableLayers.on("layeradd",this._enableLayerDelete,this).on("layerremove",this._disableLayerDelete,this))},disable:function(){this._enabled&&(this._deletableLayers.off("layeradd",this._enableLayerDelete,this).off("layerremove",this._disableLayerDelete,this),L.Handler.prototype.disable.call(this),this._map.fire("draw:deletestop",{handler:this.type}),this.fire("disabled",{handler:this.type}))},addHooks:function(){var t=this._map;t&&(t.getContainer().focus(),this._deletableLayers.eachLayer(this._enableLayerDelete,this),this._deletedLayers=new L.layerGroup,this._tooltip=new L.Tooltip(this._map),this._tooltip.updateContent({text:L.drawLocal.edit.handlers.remove.tooltip.text}),this._map.on("mousemove",this._onMouseMove,this))},removeHooks:function(){this._map&&(this._deletableLayers.eachLayer(this._disableLayerDelete,this),this._deletedLayers=null,this._tooltip.dispose(),this._tooltip=null,this._map.off("mousemove",this._onMouseMove,this))},revertLayers:function(){this._deletedLayers.eachLayer(function(t){this._deletableLayers.addLayer(t)},this)},save:function(){this._map.fire("draw:deleted",{layers:this._deletedLayers})},_enableLayerDelete:function(t){var e=t.layer||t.target||t;e.on("click",this._removeLayer,this)},_disableLayerDelete:function(t){var e=t.layer||t.target||t;e.off("click",this._removeLayer,this),this._deletedLayers.removeLayer(e)},_removeLayer:function(t){var e=t.layer||t.target||t;this._deletableLayers.removeLayer(e),this._deletedLayers.addLayer(e)},_onMouseMove:function(t){this._tooltip.updatePosition(t.latlng)
},_hasAvailableLayers:function(){return 0!==this._deletableLayers.getLayers().length}})}(window,document);var OpenLayers={VERSION_NUMBER:"Release 2.13.1",singleFile:!0,_getScriptLocation:function(){for(var t,e,i=new RegExp("(^|(.*?\\/))(OpenLayers[^\\/]*?\\.js)(\\?|$)"),n=document.getElementsByTagName("script"),s="",r=0,o=n.length;o>r;r++)if(t=n[r].getAttribute("src"),t&&(e=t.match(i))){s=e[1];break}return function(){return s}}(),ImgPath:""};OpenLayers.Class=function(){var t=arguments.length,e=arguments[0],i=arguments[t-1],n="function"==typeof i.initialize?i.initialize:function(){e.prototype.initialize.apply(this,arguments)};if(t>1){var s=[n,e].concat(Array.prototype.slice.call(arguments).slice(1,t-1),i);OpenLayers.inherit.apply(null,s)}else n.prototype=i;return n},OpenLayers.inherit=function(t,e){var i=function(){};i.prototype=e.prototype,t.prototype=new i;var n,s,r;for(n=2,s=arguments.length;s>n;n++)r=arguments[n],"function"==typeof r&&(r=r.prototype),OpenLayers.Util.extend(t.prototype,r)},OpenLayers.Util=OpenLayers.Util||{},OpenLayers.Util.extend=function(t,e){if(t=t||{},e){for(var i in e){var n=e[i];void 0!==n&&(t[i]=n)}var s="function"==typeof window.Event&&e instanceof window.Event;!s&&e.hasOwnProperty&&e.hasOwnProperty("toString")&&(t.toString=e.toString)}return t},OpenLayers.String={startsWith:function(t,e){return 0==t.indexOf(e)},contains:function(t,e){return-1!=t.indexOf(e)},trim:function(t){return t.replace(/^\s\s*/,"").replace(/\s\s*$/,"")},camelize:function(t){for(var e=t.split("-"),i=e[0],n=1,s=e.length;s>n;n++){var r=e[n];i+=r.charAt(0).toUpperCase()+r.substring(1)}return i},format:function(t,e,i){e||(e=window);var n=function(t,n){for(var s,r=n.split(/\.+/),o=0;o<r.length&&(0==o&&(s=e),void 0!==s);o++)s=s[r[o]];return"function"==typeof s&&(s=i?s.apply(null,i):s()),"undefined"==typeof s?"undefined":s};return t.replace(OpenLayers.String.tokenRegEx,n)},tokenRegEx:/\$\{([\w.]+?)\}/g,numberRegEx:/^([+-]?)(?=\d|\.\d)\d*(\.\d*)?([Ee]([+-]?\d+))?$/,isNumeric:function(t){return OpenLayers.String.numberRegEx.test(t)},numericIf:function(t,e){var i=t;return e===!0&&null!=t&&t.replace&&(t=t.replace(/^\s*|\s*$/g,"")),OpenLayers.String.isNumeric(t)?parseFloat(t):i}},OpenLayers.Number={decimalSeparator:".",thousandsSeparator:",",limitSigDigs:function(t,e){var i=0;return e>0&&(i=parseFloat(t.toPrecision(e))),i},format:function(t,e,i,n){e="undefined"!=typeof e?e:0,i="undefined"!=typeof i?i:OpenLayers.Number.thousandsSeparator,n="undefined"!=typeof n?n:OpenLayers.Number.decimalSeparator,null!=e&&(t=parseFloat(t.toFixed(e)));var s=t.toString().split(".");1==s.length&&null==e&&(e=0);var r=s[0];if(i)for(var o=/(-?[0-9]+)([0-9]{3})/;o.test(r);)r=r.replace(o,"$1"+i+"$2");var a;if(0==e)a=r;else{var l=s.length>1?s[1]:"0";null!=e&&(l+=new Array(e-l.length+1).join("0")),a=r+n+l}return a},zeroPad:function(t,e,i){for(var n=t.toString(i||10);n.length<e;)n="0"+n;return n}},OpenLayers.Function={bind:function(t,e){var i=Array.prototype.slice.apply(arguments,[2]);return function(){var n=i.concat(Array.prototype.slice.apply(arguments,[0]));return t.apply(e,n)}},bindAsEventListener:function(t,e){return function(i){return t.call(e,i||window.event)}},False:function(){return!1},True:function(){return!0},Void:function(){}},OpenLayers.Array={filter:function(t,e,i){var n=[];if(Array.prototype.filter)n=t.filter(e,i);else{var s=t.length;if("function"!=typeof e)throw new TypeError;for(var r=0;s>r;r++)if(r in t){var o=t[r];e.call(i,o,r,t)&&n.push(o)}}return n}},OpenLayers.Bounds=OpenLayers.Class({left:null,bottom:null,right:null,top:null,centerLonLat:null,initialize:function(t,e,i,n){OpenLayers.Util.isArray(t)&&(n=t[3],i=t[2],e=t[1],t=t[0]),null!=t&&(this.left=OpenLayers.Util.toFloat(t)),null!=e&&(this.bottom=OpenLayers.Util.toFloat(e)),null!=i&&(this.right=OpenLayers.Util.toFloat(i)),null!=n&&(this.top=OpenLayers.Util.toFloat(n))},clone:function(){return new OpenLayers.Bounds(this.left,this.bottom,this.right,this.top)},equals:function(t){var e=!1;return null!=t&&(e=this.left==t.left&&this.right==t.right&&this.top==t.top&&this.bottom==t.bottom),e},toString:function(){return[this.left,this.bottom,this.right,this.top].join(",")},toArray:function(t){return t===!0?[this.bottom,this.left,this.top,this.right]:[this.left,this.bottom,this.right,this.top]},toBBOX:function(t,e){null==t&&(t=6);var i=Math.pow(10,t),n=Math.round(this.left*i)/i,s=Math.round(this.bottom*i)/i,r=Math.round(this.right*i)/i,o=Math.round(this.top*i)/i;return e===!0?s+","+n+","+o+","+r:n+","+s+","+r+","+o},toGeometry:function(){return new OpenLayers.Geometry.Polygon([new OpenLayers.Geometry.LinearRing([new OpenLayers.Geometry.Point(this.left,this.bottom),new OpenLayers.Geometry.Point(this.right,this.bottom),new OpenLayers.Geometry.Point(this.right,this.top),new OpenLayers.Geometry.Point(this.left,this.top)])])},getWidth:function(){return this.right-this.left},getHeight:function(){return this.top-this.bottom},getSize:function(){return new OpenLayers.Size(this.getWidth(),this.getHeight())},getCenterPixel:function(){return new OpenLayers.Pixel((this.left+this.right)/2,(this.bottom+this.top)/2)},getCenterLonLat:function(){return this.centerLonLat||(this.centerLonLat=new OpenLayers.LonLat((this.left+this.right)/2,(this.bottom+this.top)/2)),this.centerLonLat},scale:function(t,e){null==e&&(e=this.getCenterLonLat());var i,n;"OpenLayers.LonLat"==e.CLASS_NAME?(i=e.lon,n=e.lat):(i=e.x,n=e.y);var s=(this.left-i)*t+i,r=(this.bottom-n)*t+n,o=(this.right-i)*t+i,a=(this.top-n)*t+n;return new OpenLayers.Bounds(s,r,o,a)},add:function(t,e){if(null==t||null==e)throw new TypeError("Bounds.add cannot receive null values");return new OpenLayers.Bounds(this.left+t,this.bottom+e,this.right+t,this.top+e)},extend:function(t){if(t)switch(t.CLASS_NAME){case"OpenLayers.LonLat":this.extendXY(t.lon,t.lat);break;case"OpenLayers.Geometry.Point":this.extendXY(t.x,t.y);break;case"OpenLayers.Bounds":this.centerLonLat=null,(null==this.left||t.left<this.left)&&(this.left=t.left),(null==this.bottom||t.bottom<this.bottom)&&(this.bottom=t.bottom),(null==this.right||t.right>this.right)&&(this.right=t.right),(null==this.top||t.top>this.top)&&(this.top=t.top)}},extendXY:function(t,e){this.centerLonLat=null,(null==this.left||t<this.left)&&(this.left=t),(null==this.bottom||e<this.bottom)&&(this.bottom=e),(null==this.right||t>this.right)&&(this.right=t),(null==this.top||e>this.top)&&(this.top=e)},containsLonLat:function(t,e){"boolean"==typeof e&&(e={inclusive:e}),e=e||{};var i=this.contains(t.lon,t.lat,e.inclusive),n=e.worldBounds;if(n&&!i){var s=n.getWidth(),r=(n.left+n.right)/2,o=Math.round((t.lon-r)/s);i=this.containsLonLat({lon:t.lon-o*s,lat:t.lat},{inclusive:e.inclusive})}return i},containsPixel:function(t,e){return this.contains(t.x,t.y,e)},contains:function(t,e,i){if(null==i&&(i=!0),null==t||null==e)return!1;t=OpenLayers.Util.toFloat(t),e=OpenLayers.Util.toFloat(e);var n=!1;return n=i?t>=this.left&&t<=this.right&&e>=this.bottom&&e<=this.top:t>this.left&&t<this.right&&e>this.bottom&&e<this.top},intersectsBounds:function(t,e){if("boolean"==typeof e&&(e={inclusive:e}),e=e||{},e.worldBounds){var i=this.wrapDateLine(e.worldBounds);t=t.wrapDateLine(e.worldBounds)}else i=this;null==e.inclusive&&(e.inclusive=!0);var n=!1,s=i.left==t.right||i.right==t.left||i.top==t.bottom||i.bottom==t.top;if(e.inclusive||!s){var r=t.bottom>=i.bottom&&t.bottom<=i.top||i.bottom>=t.bottom&&i.bottom<=t.top,o=t.top>=i.bottom&&t.top<=i.top||i.top>t.bottom&&i.top<t.top,a=t.left>=i.left&&t.left<=i.right||i.left>=t.left&&i.left<=t.right,l=t.right>=i.left&&t.right<=i.right||i.right>=t.left&&i.right<=t.right;n=(r||o)&&(a||l)}if(e.worldBounds&&!n){var h=e.worldBounds,u=h.getWidth(),p=!h.containsBounds(i),c=!h.containsBounds(t);p&&!c?(t=t.add(-u,0),n=i.intersectsBounds(t,{inclusive:e.inclusive})):c&&!p&&(i=i.add(-u,0),n=t.intersectsBounds(i,{inclusive:e.inclusive}))}return n},containsBounds:function(t,e,i){null==e&&(e=!1),null==i&&(i=!0);var n=this.contains(t.left,t.bottom,i),s=this.contains(t.right,t.bottom,i),r=this.contains(t.left,t.top,i),o=this.contains(t.right,t.top,i);return e?n||s||r||o:n&&s&&r&&o},determineQuadrant:function(t){var e="",i=this.getCenterLonLat();return e+=t.lat<i.lat?"b":"t",e+=t.lon<i.lon?"l":"r"},transform:function(t,e){this.centerLonLat=null;var i=OpenLayers.Projection.transform({x:this.left,y:this.bottom},t,e),n=OpenLayers.Projection.transform({x:this.right,y:this.bottom},t,e),s=OpenLayers.Projection.transform({x:this.left,y:this.top},t,e),r=OpenLayers.Projection.transform({x:this.right,y:this.top},t,e);return this.left=Math.min(i.x,s.x),this.bottom=Math.min(i.y,n.y),this.right=Math.max(n.x,r.x),this.top=Math.max(s.y,r.y),this},wrapDateLine:function(t,e){e=e||{};var i=e.leftTolerance||0,n=e.rightTolerance||0,s=this.clone();if(t){for(var r=t.getWidth();s.left<t.left&&s.right-n<=t.left;)s=s.add(r,0);for(;s.left+i>=t.right&&s.right>t.right;)s=s.add(-r,0);var o=s.left+i;o<t.right&&o>t.left&&s.right-n>t.right&&(s=s.add(-r,0))}return s},CLASS_NAME:"OpenLayers.Bounds"}),OpenLayers.Bounds.fromString=function(t,e){var i=t.split(",");return OpenLayers.Bounds.fromArray(i,e)},OpenLayers.Bounds.fromArray=function(t,e){return e===!0?new OpenLayers.Bounds(t[1],t[0],t[3],t[2]):new OpenLayers.Bounds(t[0],t[1],t[2],t[3])},OpenLayers.Bounds.fromSize=function(t){return new OpenLayers.Bounds(0,t.h,t.w,0)},OpenLayers.Bounds.oppositeQuadrant=function(t){var e="";return e+="t"==t.charAt(0)?"b":"t",e+="l"==t.charAt(1)?"r":"l"},OpenLayers.Element={visible:function(t){return"none"!=OpenLayers.Util.getElement(t).style.display},toggle:function(){for(var t=0,e=arguments.length;e>t;t++){var i=OpenLayers.Util.getElement(arguments[t]),n=OpenLayers.Element.visible(i)?"none":"";i.style.display=n}},remove:function(t){t=OpenLayers.Util.getElement(t),t.parentNode.removeChild(t)},getHeight:function(t){return t=OpenLayers.Util.getElement(t),t.offsetHeight},hasClass:function(t,e){var i=t.className;return!!i&&new RegExp("(^|\\s)"+e+"(\\s|$)").test(i)},addClass:function(t,e){return OpenLayers.Element.hasClass(t,e)||(t.className+=(t.className?" ":"")+e),t},removeClass:function(t,e){var i=t.className;return i&&(t.className=OpenLayers.String.trim(i.replace(new RegExp("(^|\\s+)"+e+"(\\s+|$)")," "))),t},toggleClass:function(t,e){return OpenLayers.Element.hasClass(t,e)?OpenLayers.Element.removeClass(t,e):OpenLayers.Element.addClass(t,e),t},getStyle:function(t,e){t=OpenLayers.Util.getElement(t);var i=null;if(t&&t.style){if(i=t.style[OpenLayers.String.camelize(e)],!i)if(document.defaultView&&document.defaultView.getComputedStyle){var n=document.defaultView.getComputedStyle(t,null);i=n?n.getPropertyValue(e):null}else t.currentStyle&&(i=t.currentStyle[OpenLayers.String.camelize(e)]);var s=["left","top","right","bottom"];window.opera&&-1!=OpenLayers.Util.indexOf(s,e)&&"static"==OpenLayers.Element.getStyle(t,"position")&&(i="auto")}return"auto"==i?null:i}},OpenLayers.LonLat=OpenLayers.Class({lon:0,lat:0,initialize:function(t,e){OpenLayers.Util.isArray(t)&&(e=t[1],t=t[0]),this.lon=OpenLayers.Util.toFloat(t),this.lat=OpenLayers.Util.toFloat(e)},toString:function(){return"lon="+this.lon+",lat="+this.lat},toShortString:function(){return this.lon+", "+this.lat},clone:function(){return new OpenLayers.LonLat(this.lon,this.lat)},add:function(t,e){if(null==t||null==e)throw new TypeError("LonLat.add cannot receive null values");return new OpenLayers.LonLat(this.lon+OpenLayers.Util.toFloat(t),this.lat+OpenLayers.Util.toFloat(e))},equals:function(t){var e=!1;return null!=t&&(e=this.lon==t.lon&&this.lat==t.lat||isNaN(this.lon)&&isNaN(this.lat)&&isNaN(t.lon)&&isNaN(t.lat)),e},transform:function(t,e){var i=OpenLayers.Projection.transform({x:this.lon,y:this.lat},t,e);return this.lon=i.x,this.lat=i.y,this},wrapDateLine:function(t){var e=this.clone();if(t){for(;e.lon<t.left;)e.lon+=t.getWidth();for(;e.lon>t.right;)e.lon-=t.getWidth()}return e},CLASS_NAME:"OpenLayers.LonLat"}),OpenLayers.LonLat.fromString=function(t){var e=t.split(",");return new OpenLayers.LonLat(e[0],e[1])},OpenLayers.LonLat.fromArray=function(t){var e=OpenLayers.Util.isArray(t),i=e&&t[0],n=e&&t[1];return new OpenLayers.LonLat(i,n)},OpenLayers.Pixel=OpenLayers.Class({x:0,y:0,initialize:function(t,e){this.x=parseFloat(t),this.y=parseFloat(e)},toString:function(){return"x="+this.x+",y="+this.y},clone:function(){return new OpenLayers.Pixel(this.x,this.y)},equals:function(t){var e=!1;return null!=t&&(e=this.x==t.x&&this.y==t.y||isNaN(this.x)&&isNaN(this.y)&&isNaN(t.x)&&isNaN(t.y)),e},distanceTo:function(t){return Math.sqrt(Math.pow(this.x-t.x,2)+Math.pow(this.y-t.y,2))},add:function(t,e){if(null==t||null==e)throw new TypeError("Pixel.add cannot receive null values");return new OpenLayers.Pixel(this.x+t,this.y+e)},offset:function(t){var e=this.clone();return t&&(e=this.add(t.x,t.y)),e},CLASS_NAME:"OpenLayers.Pixel"}),OpenLayers.Size=OpenLayers.Class({w:0,h:0,initialize:function(t,e){this.w=parseFloat(t),this.h=parseFloat(e)},toString:function(){return"w="+this.w+",h="+this.h},clone:function(){return new OpenLayers.Size(this.w,this.h)},equals:function(t){var e=!1;return null!=t&&(e=this.w==t.w&&this.h==t.h||isNaN(this.w)&&isNaN(this.h)&&isNaN(t.w)&&isNaN(t.h)),e},CLASS_NAME:"OpenLayers.Size"}),OpenLayers.Console={log:function(){},debug:function(){},info:function(){},warn:function(){},error:function(){},userError:function(t){alert(t)},assert:function(){},dir:function(){},dirxml:function(){},trace:function(){},group:function(){},groupEnd:function(){},time:function(){},timeEnd:function(){},profile:function(){},profileEnd:function(){},count:function(){},CLASS_NAME:"OpenLayers.Console"},function(){for(var t=document.getElementsByTagName("script"),e=0,i=t.length;i>e;++e)if(-1!=t[e].src.indexOf("firebug.js")&&console){OpenLayers.Util.extend(OpenLayers.Console,console);break}}(),OpenLayers.Lang={code:null,defaultCode:"en",getCode:function(){return OpenLayers.Lang.code||OpenLayers.Lang.setCode(),OpenLayers.Lang.code},setCode:function(t){var e;t||(t="msie"==OpenLayers.BROWSER_NAME?navigator.userLanguage:navigator.language);var i=t.split("-");if(i[0]=i[0].toLowerCase(),"object"==typeof OpenLayers.Lang[i[0]]&&(e=i[0]),i[1]){var n=i[0]+"-"+i[1].toUpperCase();"object"==typeof OpenLayers.Lang[n]&&(e=n)}e||(OpenLayers.Console.warn("Failed to find OpenLayers.Lang."+i.join("-")+" dictionary, falling back to default language"),e=OpenLayers.Lang.defaultCode),OpenLayers.Lang.code=e},translate:function(t,e){var i=OpenLayers.Lang[OpenLayers.Lang.getCode()],n=i&&i[t];return n||(n=t),e&&(n=OpenLayers.String.format(n,e)),n}},OpenLayers.i18n=OpenLayers.Lang.translate,OpenLayers.Util=OpenLayers.Util||{},OpenLayers.Util.getElement=function(){for(var t=[],e=0,i=arguments.length;i>e;e++){var n=arguments[e];if("string"==typeof n&&(n=document.getElementById(n)),1==arguments.length)return n;t.push(n)}return t},OpenLayers.Util.isElement=function(t){return!(!t||1!==t.nodeType)},OpenLayers.Util.isArray=function(t){return"[object Array]"===Object.prototype.toString.call(t)},OpenLayers.Util.removeItem=function(t,e){for(var i=t.length-1;i>=0;i--)t[i]==e&&t.splice(i,1);return t},OpenLayers.Util.indexOf=function(t,e){if("function"==typeof t.indexOf)return t.indexOf(e);for(var i=0,n=t.length;n>i;i++)if(t[i]==e)return i;return-1},OpenLayers.Util.dotless=/\./g,OpenLayers.Util.modifyDOMElement=function(t,e,i,n,s,r,o,a){e&&(t.id=e.replace(OpenLayers.Util.dotless,"_")),i&&(t.style.left=i.x+"px",t.style.top=i.y+"px"),n&&(t.style.width=n.w+"px",t.style.height=n.h+"px"),s&&(t.style.position=s),r&&(t.style.border=r),o&&(t.style.overflow=o),parseFloat(a)>=0&&parseFloat(a)<1?(t.style.filter="alpha(opacity="+100*a+")",t.style.opacity=a):1==parseFloat(a)&&(t.style.filter="",t.style.opacity="")},OpenLayers.Util.createDiv=function(t,e,i,n,s,r,o,a){var l=document.createElement("div");return n&&(l.style.backgroundImage="url("+n+")"),t||(t=OpenLayers.Util.createUniqueID("OpenLayersDiv")),s||(s="absolute"),OpenLayers.Util.modifyDOMElement(l,t,e,i,s,r,o,a),l},OpenLayers.Util.createImage=function(t,e,i,n,s,r,o,a){function l(){h.style.display="",OpenLayers.Event.stopObservingElement(h)}var h=document.createElement("img");return t||(t=OpenLayers.Util.createUniqueID("OpenLayersDiv")),s||(s="relative"),OpenLayers.Util.modifyDOMElement(h,t,e,i,s,r,null,o),a&&(h.style.display="none",OpenLayers.Event.observe(h,"load",l),OpenLayers.Event.observe(h,"error",l)),h.style.alt=t,h.galleryImg="no",n&&(h.src=n),h},OpenLayers.IMAGE_RELOAD_ATTEMPTS=0,OpenLayers.Util.alphaHackNeeded=null,OpenLayers.Util.alphaHack=function(){if(null==OpenLayers.Util.alphaHackNeeded){var t=navigator.appVersion.split("MSIE"),e=parseFloat(t[1]),i=!1;try{i=!!document.body.filters}catch(n){}OpenLayers.Util.alphaHackNeeded=i&&e>=5.5&&7>e}return OpenLayers.Util.alphaHackNeeded},OpenLayers.Util.modifyAlphaImageDiv=function(t,e,i,n,s,r,o,a,l){OpenLayers.Util.modifyDOMElement(t,e,i,n,r,null,null,l);var h=t.childNodes[0];s&&(h.src=s),OpenLayers.Util.modifyDOMElement(h,t.id+"_innerImage",null,n,"relative",o),OpenLayers.Util.alphaHack()&&("none"!=t.style.display&&(t.style.display="inline-block"),null==a&&(a="scale"),t.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+h.src+"', sizingMethod='"+a+"')",parseFloat(t.style.opacity)>=0&&parseFloat(t.style.opacity)<1&&(t.style.filter+=" alpha(opacity="+100*t.style.opacity+")"),h.style.filter="alpha(opacity=0)")},OpenLayers.Util.createAlphaImageDiv=function(t,e,i,n,s,r,o,a,l){var h=OpenLayers.Util.createDiv(),u=OpenLayers.Util.createImage(null,null,null,null,null,null,null,l);return u.className="olAlphaImg",h.appendChild(u),OpenLayers.Util.modifyAlphaImageDiv(h,t,e,i,n,s,r,o,a),h},OpenLayers.Util.upperCaseObject=function(t){var e={};for(var i in t)e[i.toUpperCase()]=t[i];return e},OpenLayers.Util.applyDefaults=function(t,e){t=t||{};var i="function"==typeof window.Event&&e instanceof window.Event;for(var n in e)(void 0===t[n]||!i&&e.hasOwnProperty&&e.hasOwnProperty(n)&&!t.hasOwnProperty(n))&&(t[n]=e[n]);return!i&&e&&e.hasOwnProperty&&e.hasOwnProperty("toString")&&!t.hasOwnProperty("toString")&&(t.toString=e.toString),t},OpenLayers.Util.getParameterString=function(t){var e=[];for(var i in t){var n=t[i];if(null!=n&&"function"!=typeof n){var s;if("object"==typeof n&&n.constructor==Array){for(var r,o=[],a=0,l=n.length;l>a;a++)r=n[a],o.push(encodeURIComponent(null===r||void 0===r?"":r));s=o.join(",")}else s=encodeURIComponent(n);e.push(encodeURIComponent(i)+"="+s)}}return e.join("&")},OpenLayers.Util.urlAppend=function(t,e){var i=t;if(e){var n=(t+" ").split(/[?&]/);i+=" "===n.pop()?e:n.length?"&"+e:"?"+e}return i},OpenLayers.Util.getImagesLocation=function(){return OpenLayers.ImgPath||OpenLayers._getScriptLocation()+"img/"},OpenLayers.Util.getImageLocation=function(t){return OpenLayers.Util.getImagesLocation()+t},OpenLayers.Util.Try=function(){for(var t=null,e=0,i=arguments.length;i>e;e++){var n=arguments[e];try{t=n();break}catch(s){}}return t},OpenLayers.Util.getXmlNodeValue=function(t){var e=null;return OpenLayers.Util.Try(function(){e=t.text,e||(e=t.textContent),e||(e=t.firstChild.nodeValue)},function(){e=t.textContent}),e},OpenLayers.Util.mouseLeft=function(t,e){for(var i=t.relatedTarget?t.relatedTarget:t.toElement;i!=e&&null!=i;)i=i.parentNode;return i!=e},OpenLayers.Util.DEFAULT_PRECISION=14,OpenLayers.Util.toFloat=function(t,e){return null==e&&(e=OpenLayers.Util.DEFAULT_PRECISION),"number"!=typeof t&&(t=parseFloat(t)),0===e?t:parseFloat(t.toPrecision(e))},OpenLayers.Util.rad=function(t){return t*Math.PI/180},OpenLayers.Util.deg=function(t){return 180*t/Math.PI},OpenLayers.Util.VincentyConstants={a:6378137,b:6356752.3142,f:1/298.257223563},OpenLayers.Util.distVincenty=function(t,e){for(var i=OpenLayers.Util.VincentyConstants,n=i.a,s=i.b,r=i.f,o=OpenLayers.Util.rad(e.lon-t.lon),a=Math.atan((1-r)*Math.tan(OpenLayers.Util.rad(t.lat))),l=Math.atan((1-r)*Math.tan(OpenLayers.Util.rad(e.lat))),h=Math.sin(a),u=Math.cos(a),p=Math.sin(l),c=Math.cos(l),d=o,m=2*Math.PI,f=20;Math.abs(d-m)>1e-12&&--f>0;){var y=Math.sin(d),g=Math.cos(d),v=Math.sqrt(c*y*c*y+(u*p-h*c*g)*(u*p-h*c*g));if(0==v)return 0;var L=h*p+u*c*g,_=Math.atan2(v,L),O=Math.asin(u*c*y/v),b=Math.cos(O)*Math.cos(O),w=L-2*h*p/b,x=r/16*b*(4+r*(4-3*b));m=d,d=o+(1-x)*r*Math.sin(O)*(_+x*v*(w+x*L*(-1+2*w*w)))}if(0==f)return 0/0;var S=b*(n*n-s*s)/(s*s),C=1+S/16384*(4096+S*(-768+S*(320-175*S))),E=S/1024*(256+S*(-128+S*(74-47*S))),P=E*v*(w+E/4*(L*(-1+2*w*w)-E/6*w*(-3+4*v*v)*(-3+4*w*w))),M=s*C*(_-P),N=M.toFixed(3)/1e3;return N},OpenLayers.Util.destinationVincenty=function(t,e,i){for(var n=OpenLayers.Util,s=n.VincentyConstants,r=s.a,o=s.b,a=s.f,l=t.lon,h=t.lat,u=i,p=n.rad(e),c=Math.sin(p),d=Math.cos(p),m=(1-a)*Math.tan(n.rad(h)),f=1/Math.sqrt(1+m*m),y=m*f,g=Math.atan2(m,d),v=f*c,L=1-v*v,_=L*(r*r-o*o)/(o*o),O=1+_/16384*(4096+_*(-768+_*(320-175*_))),b=_/1024*(256+_*(-128+_*(74-47*_))),w=u/(o*O),x=2*Math.PI;Math.abs(w-x)>1e-12;){var S=Math.cos(2*g+w),C=Math.sin(w),E=Math.cos(w),P=b*C*(S+b/4*(E*(-1+2*S*S)-b/6*S*(-3+4*C*C)*(-3+4*S*S)));x=w,w=u/(o*O)+P}{var M=y*C-f*E*d,N=Math.atan2(y*E+f*C*d,(1-a)*Math.sqrt(v*v+M*M)),T=Math.atan2(C*c,f*E-y*C*d),A=a/16*L*(4+a*(4-3*L)),k=T-(1-A)*a*v*(w+A*C*(S+A*E*(-1+2*S*S)));Math.atan2(v,-M)}return new OpenLayers.LonLat(l+n.deg(k),n.deg(N))},OpenLayers.Util.getParameters=function(t,e){e=e||{},t=null===t||void 0===t?window.location.href:t;var i="";if(OpenLayers.String.contains(t,"?")){var n=t.indexOf("?")+1,s=OpenLayers.String.contains(t,"#")?t.indexOf("#"):t.length;i=t.substring(n,s)}for(var r={},o=i.split(/[&;]/),a=0,l=o.length;l>a;++a){var h=o[a].split("=");if(h[0]){var u=h[0];try{u=decodeURIComponent(u)}catch(p){u=unescape(u)}var c=(h[1]||"").replace(/\+/g," ");try{c=decodeURIComponent(c)}catch(p){c=unescape(c)}e.splitArgs!==!1&&(c=c.split(",")),1==c.length&&(c=c[0]),r[u]=c}}return r},OpenLayers.Util.lastSeqID=0,OpenLayers.Util.createUniqueID=function(t){return t=null==t?"id_":t.replace(OpenLayers.Util.dotless,"_"),OpenLayers.Util.lastSeqID+=1,t+OpenLayers.Util.lastSeqID},OpenLayers.INCHES_PER_UNIT={inches:1,ft:12,mi:63360,m:39.37,km:39370,dd:4374754,yd:36},OpenLayers.INCHES_PER_UNIT["in"]=OpenLayers.INCHES_PER_UNIT.inches,OpenLayers.INCHES_PER_UNIT.degrees=OpenLayers.INCHES_PER_UNIT.dd,OpenLayers.INCHES_PER_UNIT.nmi=1852*OpenLayers.INCHES_PER_UNIT.m,OpenLayers.METERS_PER_INCH=.0254000508001016,OpenLayers.Util.extend(OpenLayers.INCHES_PER_UNIT,{Inch:OpenLayers.INCHES_PER_UNIT.inches,Meter:1/OpenLayers.METERS_PER_INCH,Foot:.3048006096012192/OpenLayers.METERS_PER_INCH,IFoot:.3048/OpenLayers.METERS_PER_INCH,ClarkeFoot:.3047972651151/OpenLayers.METERS_PER_INCH,SearsFoot:.30479947153867626/OpenLayers.METERS_PER_INCH,GoldCoastFoot:.3047997101815088/OpenLayers.METERS_PER_INCH,IInch:.0254/OpenLayers.METERS_PER_INCH,MicroInch:254e-7/OpenLayers.METERS_PER_INCH,Mil:2.54e-8/OpenLayers.METERS_PER_INCH,Centimeter:.01/OpenLayers.METERS_PER_INCH,Kilometer:1e3/OpenLayers.METERS_PER_INCH,Yard:.9144018288036576/OpenLayers.METERS_PER_INCH,SearsYard:.914398414616029/OpenLayers.METERS_PER_INCH,IndianYard:.9143985307444408/OpenLayers.METERS_PER_INCH,IndianYd37:.91439523/OpenLayers.METERS_PER_INCH,IndianYd62:.9143988/OpenLayers.METERS_PER_INCH,IndianYd75:.9143985/OpenLayers.METERS_PER_INCH,IndianFoot:.30479951/OpenLayers.METERS_PER_INCH,IndianFt37:.30479841/OpenLayers.METERS_PER_INCH,IndianFt62:.3047996/OpenLayers.METERS_PER_INCH,IndianFt75:.3047995/OpenLayers.METERS_PER_INCH,Mile:1609.3472186944373/OpenLayers.METERS_PER_INCH,IYard:.9144/OpenLayers.METERS_PER_INCH,IMile:1609.344/OpenLayers.METERS_PER_INCH,NautM:1852/OpenLayers.METERS_PER_INCH,"Lat-66":110943.31648893273/OpenLayers.METERS_PER_INCH,"Lat-83":110946.25736872235/OpenLayers.METERS_PER_INCH,Decimeter:.1/OpenLayers.METERS_PER_INCH,Millimeter:.001/OpenLayers.METERS_PER_INCH,Dekameter:10/OpenLayers.METERS_PER_INCH,Decameter:10/OpenLayers.METERS_PER_INCH,Hectometer:100/OpenLayers.METERS_PER_INCH,GermanMeter:1.0000135965/OpenLayers.METERS_PER_INCH,CaGrid:.999738/OpenLayers.METERS_PER_INCH,ClarkeChain:20.1166194976/OpenLayers.METERS_PER_INCH,GunterChain:20.11684023368047/OpenLayers.METERS_PER_INCH,BenoitChain:20.116782494375872/OpenLayers.METERS_PER_INCH,SearsChain:20.11676512155/OpenLayers.METERS_PER_INCH,ClarkeLink:.201166194976/OpenLayers.METERS_PER_INCH,GunterLink:.2011684023368047/OpenLayers.METERS_PER_INCH,BenoitLink:.20116782494375873/OpenLayers.METERS_PER_INCH,SearsLink:.2011676512155/OpenLayers.METERS_PER_INCH,Rod:5.02921005842012/OpenLayers.METERS_PER_INCH,IntnlChain:20.1168/OpenLayers.METERS_PER_INCH,IntnlLink:.201168/OpenLayers.METERS_PER_INCH,Perch:5.02921005842012/OpenLayers.METERS_PER_INCH,Pole:5.02921005842012/OpenLayers.METERS_PER_INCH,Furlong:201.1684023368046/OpenLayers.METERS_PER_INCH,Rood:3.778266898/OpenLayers.METERS_PER_INCH,CapeFoot:.3047972615/OpenLayers.METERS_PER_INCH,Brealey:375/OpenLayers.METERS_PER_INCH,ModAmFt:.304812252984506/OpenLayers.METERS_PER_INCH,Fathom:1.8288/OpenLayers.METERS_PER_INCH,"NautM-UK":1853.184/OpenLayers.METERS_PER_INCH,"50kilometers":5e4/OpenLayers.METERS_PER_INCH,"150kilometers":15e4/OpenLayers.METERS_PER_INCH}),OpenLayers.Util.extend(OpenLayers.INCHES_PER_UNIT,{mm:OpenLayers.INCHES_PER_UNIT.Meter/1e3,cm:OpenLayers.INCHES_PER_UNIT.Meter/100,dm:100*OpenLayers.INCHES_PER_UNIT.Meter,km:1e3*OpenLayers.INCHES_PER_UNIT.Meter,kmi:OpenLayers.INCHES_PER_UNIT.nmi,fath:OpenLayers.INCHES_PER_UNIT.Fathom,ch:OpenLayers.INCHES_PER_UNIT.IntnlChain,link:OpenLayers.INCHES_PER_UNIT.IntnlLink,"us-in":OpenLayers.INCHES_PER_UNIT.inches,"us-ft":OpenLayers.INCHES_PER_UNIT.Foot,"us-yd":OpenLayers.INCHES_PER_UNIT.Yard,"us-ch":OpenLayers.INCHES_PER_UNIT.GunterChain,"us-mi":OpenLayers.INCHES_PER_UNIT.Mile,"ind-yd":OpenLayers.INCHES_PER_UNIT.IndianYd37,"ind-ft":OpenLayers.INCHES_PER_UNIT.IndianFt37,"ind-ch":20.11669506/OpenLayers.METERS_PER_INCH}),OpenLayers.DOTS_PER_INCH=72,OpenLayers.Util.normalizeScale=function(t){var e=t>1?1/t:t;return e},OpenLayers.Util.getResolutionFromScale=function(t,e){var i;if(t){null==e&&(e="degrees");var n=OpenLayers.Util.normalizeScale(t);i=1/(n*OpenLayers.INCHES_PER_UNIT[e]*OpenLayers.DOTS_PER_INCH)}return i},OpenLayers.Util.getScaleFromResolution=function(t,e){null==e&&(e="degrees");var i=t*OpenLayers.INCHES_PER_UNIT[e]*OpenLayers.DOTS_PER_INCH;return i},OpenLayers.Util.pagePosition=function(t){var e=[0,0],i=OpenLayers.Util.getViewportElement();if(!t||t==window||t==i)return e;var n,s=OpenLayers.IS_GECKO&&document.getBoxObjectFor&&"absolute"==OpenLayers.Element.getStyle(t,"position")&&(""==t.style.top||""==t.style.left),r=null;if(t.getBoundingClientRect){n=t.getBoundingClientRect();var o=window.pageYOffset||i.scrollTop,a=window.pageXOffset||i.scrollLeft;e[0]=n.left+a,e[1]=n.top+o}else if(document.getBoxObjectFor&&!s){n=document.getBoxObjectFor(t);var l=document.getBoxObjectFor(i);e[0]=n.screenX-l.screenX,e[1]=n.screenY-l.screenY}else{if(e[0]=t.offsetLeft,e[1]=t.offsetTop,r=t.offsetParent,r!=t)for(;r;)e[0]+=r.offsetLeft,e[1]+=r.offsetTop,r=r.offsetParent;var h=OpenLayers.BROWSER_NAME;for(("opera"==h||"safari"==h&&"absolute"==OpenLayers.Element.getStyle(t,"position"))&&(e[1]-=document.body.offsetTop),r=t.offsetParent;r&&r!=document.body;)e[0]-=r.scrollLeft,("opera"!=h||"TR"!=r.tagName)&&(e[1]-=r.scrollTop),r=r.offsetParent}return e},OpenLayers.Util.getViewportElement=function(){var t=arguments.callee.viewportElement;return void 0==t&&(t="msie"==OpenLayers.BROWSER_NAME&&"CSS1Compat"!=document.compatMode?document.body:document.documentElement,arguments.callee.viewportElement=t),t},OpenLayers.Util.isEquivalentUrl=function(t,e,i){i=i||{},OpenLayers.Util.applyDefaults(i,{ignoreCase:!0,ignorePort80:!0,ignoreHash:!0,splitArgs:!1});var n=OpenLayers.Util.createUrlObject(t,i),s=OpenLayers.Util.createUrlObject(e,i);for(var r in n)if("args"!==r&&n[r]!=s[r])return!1;for(var r in n.args){if(n.args[r]!=s.args[r])return!1;delete s.args[r]}for(var r in s.args)return!1;return!0},OpenLayers.Util.createUrlObject=function(t,e){if(e=e||{},!/^\w+:\/\//.test(t)){var i=window.location,n=i.port?":"+i.port:"",s=i.protocol+"//"+i.host.split(":").shift()+n;if(0===t.indexOf("/"))t=s+t;else{var r=i.pathname.split("/");r.pop(),t=s+r.join("/")+"/"+t}}e.ignoreCase&&(t=t.toLowerCase());var o=document.createElement("a");o.href=t;var a={};a.host=o.host.split(":").shift(),a.protocol=o.protocol,a.port=e.ignorePort80?"80"==o.port||"0"==o.port?"":o.port:""==o.port||"0"==o.port?"80":o.port,a.hash=e.ignoreHash||"#"===o.hash?"":o.hash;var l=o.search;if(!l){var h=t.indexOf("?");l=-1!=h?t.substr(h):""}return a.args=OpenLayers.Util.getParameters(l,{splitArgs:e.splitArgs}),a.pathname="/"==o.pathname.charAt(0)?o.pathname:"/"+o.pathname,a},OpenLayers.Util.removeTail=function(t){var e=null,i=t.indexOf("?"),n=t.indexOf("#");return e=-1==i?-1!=n?t.substr(0,n):t:-1!=n?t.substr(0,Math.min(i,n)):t.substr(0,i)},OpenLayers.IS_GECKO=function(){var t=navigator.userAgent.toLowerCase();return-1==t.indexOf("webkit")&&-1!=t.indexOf("gecko")}(),OpenLayers.CANVAS_SUPPORTED=function(){var t=document.createElement("canvas");return!(!t.getContext||!t.getContext("2d"))}(),OpenLayers.BROWSER_NAME=function(){var t="",e=navigator.userAgent.toLowerCase();return-1!=e.indexOf("opera")?t="opera":-1!=e.indexOf("msie")?t="msie":-1!=e.indexOf("safari")?t="safari":-1!=e.indexOf("mozilla")&&(t=-1!=e.indexOf("firefox")?"firefox":"mozilla"),t}(),OpenLayers.Util.getBrowserName=function(){return OpenLayers.BROWSER_NAME},OpenLayers.Util.getRenderedDimensions=function(t,e,i){var n,s,r=document.createElement("div");r.style.visibility="hidden";for(var o=i&&i.containerElement?i.containerElement:document.body,a=!1,l=null,h=o;h&&"body"!=h.tagName.toLowerCase();){var u=OpenLayers.Element.getStyle(h,"position");if("absolute"==u){a=!0;break}if(u&&"static"!=u)break;h=h.parentNode}!a||0!==o.clientHeight&&0!==o.clientWidth||(l=document.createElement("div"),l.style.visibility="hidden",l.style.position="absolute",l.style.overflow="visible",l.style.width=document.body.clientWidth+"px",l.style.height=document.body.clientHeight+"px",l.appendChild(r)),r.style.position="absolute",e&&(e.w?(n=e.w,r.style.width=n+"px"):e.h&&(s=e.h,r.style.height=s+"px")),i&&i.displayClass&&(r.className=i.displayClass);var p=document.createElement("div");if(p.innerHTML=t,p.style.overflow="visible",p.childNodes)for(var c=0,d=p.childNodes.length;d>c;c++)p.childNodes[c].style&&(p.childNodes[c].style.overflow="visible");return r.appendChild(p),o.appendChild(l?l:r),n||(n=parseInt(p.scrollWidth),r.style.width=n+"px"),s||(s=parseInt(p.scrollHeight)),r.removeChild(p),l?(l.removeChild(r),o.removeChild(l)):o.removeChild(r),new OpenLayers.Size(n,s)},OpenLayers.Util.getScrollbarWidth=function(){var t=OpenLayers.Util._scrollbarWidth;if(null==t){var e=null,i=null,n=0,s=0;e=document.createElement("div"),e.style.position="absolute",e.style.top="-1000px",e.style.left="-1000px",e.style.width="100px",e.style.height="50px",e.style.overflow="hidden",i=document.createElement("div"),i.style.width="100%",i.style.height="200px",e.appendChild(i),document.body.appendChild(e),n=i.offsetWidth,e.style.overflow="scroll",s=i.offsetWidth,document.body.removeChild(document.body.lastChild),OpenLayers.Util._scrollbarWidth=n-s,t=OpenLayers.Util._scrollbarWidth}return t},OpenLayers.Util.getFormattedLonLat=function(t,e,i){i||(i="dms"),t=(t+540)%360-180;var n=Math.abs(t),s=Math.floor(n),r=(n-s)/(1/60),o=r;r=Math.floor(r);var a=(o-r)/(1/60);a=Math.round(10*a),a/=10,a>=60&&(a-=60,r+=1,r>=60&&(r-=60,s+=1)),10>s&&(s="0"+s);var l=s+"°";return i.indexOf("dm")>=0&&(10>r&&(r="0"+r),l+=r+"'",i.indexOf("dms")>=0&&(10>a&&(a="0"+a),l+=a+'"')),l+=OpenLayers.i18n("lon"==e?0>t?"W":"E":0>t?"S":"N")},OpenLayers.Format=OpenLayers.Class({options:null,externalProjection:null,internalProjection:null,data:null,keepData:!1,initialize:function(t){OpenLayers.Util.extend(this,t),this.options=t},destroy:function(){},read:function(){throw new Error("Read not implemented.")},write:function(){throw new Error("Write not implemented.")},CLASS_NAME:"OpenLayers.Format"}),OpenLayers.Format.XML=OpenLayers.Class(OpenLayers.Format,{namespaces:null,namespaceAlias:null,defaultPrefix:null,readers:{},writers:{},xmldom:null,initialize:function(t){window.ActiveXObject&&(this.xmldom=new ActiveXObject("Microsoft.XMLDOM")),OpenLayers.Format.prototype.initialize.apply(this,[t]),this.namespaces=OpenLayers.Util.extend({},this.namespaces),this.namespaceAlias={};
for(var e in this.namespaces)this.namespaceAlias[this.namespaces[e]]=e},destroy:function(){this.xmldom=null,OpenLayers.Format.prototype.destroy.apply(this,arguments)},setNamespace:function(t,e){this.namespaces[t]=e,this.namespaceAlias[e]=t},read:function(t){var e=t.indexOf("<");e>0&&(t=t.substring(e));var i=OpenLayers.Util.Try(OpenLayers.Function.bind(function(){var e;return e=window.ActiveXObject&&!this.xmldom?new ActiveXObject("Microsoft.XMLDOM"):this.xmldom,e.loadXML(t),e},this),function(){return(new DOMParser).parseFromString(t,"text/xml")},function(){var e=new XMLHttpRequest;return e.open("GET","data:text/xml;charset=utf-8,"+encodeURIComponent(t),!1),e.overrideMimeType&&e.overrideMimeType("text/xml"),e.send(null),e.responseXML});return this.keepData&&(this.data=i),i},write:function(t){var e;if(this.xmldom)e=t.xml;else{var i=new XMLSerializer;if(1==t.nodeType){var n=document.implementation.createDocument("","",null);n.importNode&&(t=n.importNode(t,!0)),n.appendChild(t),e=i.serializeToString(n)}else e=i.serializeToString(t)}return e},createElementNS:function(t,e){var i;return i=this.xmldom?"string"==typeof t?this.xmldom.createNode(1,e,t):this.xmldom.createNode(1,e,""):document.createElementNS(t,e)},createDocumentFragment:function(){var t;return t=this.xmldom?this.xmldom.createDocumentFragment():document.createDocumentFragment()},createTextNode:function(t){var e;return"string"!=typeof t&&(t=String(t)),e=this.xmldom?this.xmldom.createTextNode(t):document.createTextNode(t)},getElementsByTagNameNS:function(t,e,i){var n=[];if(t.getElementsByTagNameNS)n=t.getElementsByTagNameNS(e,i);else for(var s,r,o=t.getElementsByTagName("*"),a=0,l=o.length;l>a;++a)s=o[a],r=s.prefix?s.prefix+":"+i:i,("*"==i||r==s.nodeName)&&("*"==e||e==s.namespaceURI)&&n.push(s);return n},getAttributeNodeNS:function(t,e,i){var n=null;if(t.getAttributeNodeNS)n=t.getAttributeNodeNS(e,i);else for(var s,r,o=t.attributes,a=0,l=o.length;l>a;++a)if(s=o[a],s.namespaceURI==e&&(r=s.prefix?s.prefix+":"+i:i,r==s.nodeName)){n=s;break}return n},getAttributeNS:function(t,e,i){var n="";if(t.getAttributeNS)n=t.getAttributeNS(e,i)||"";else{var s=this.getAttributeNodeNS(t,e,i);s&&(n=s.nodeValue)}return n},getChildValue:function(t,e){var i=e||"";if(t)for(var n=t.firstChild;n;n=n.nextSibling)switch(n.nodeType){case 3:case 4:i+=n.nodeValue}return i},isSimpleContent:function(t){for(var e=!0,i=t.firstChild;i;i=i.nextSibling)if(1===i.nodeType){e=!1;break}return e},contentType:function(t){for(var e=!1,i=!1,n=OpenLayers.Format.XML.CONTENT_TYPE.EMPTY,s=t.firstChild;s;s=s.nextSibling){switch(s.nodeType){case 1:i=!0;break;case 8:break;default:e=!0}if(i&&e)break}if(i&&e)n=OpenLayers.Format.XML.CONTENT_TYPE.MIXED;else{if(i)return OpenLayers.Format.XML.CONTENT_TYPE.COMPLEX;if(e)return OpenLayers.Format.XML.CONTENT_TYPE.SIMPLE}return n},hasAttributeNS:function(t,e,i){var n=!1;return n=t.hasAttributeNS?t.hasAttributeNS(e,i):!!this.getAttributeNodeNS(t,e,i)},setAttributeNS:function(t,e,i,n){if(t.setAttributeNS)t.setAttributeNS(e,i,n);else{if(!this.xmldom)throw"setAttributeNS not implemented";if(e){var s=t.ownerDocument.createNode(2,i,e);s.nodeValue=n,t.setAttributeNode(s)}else t.setAttribute(i,n)}},createElementNSPlus:function(t,e){e=e||{};var i=e.uri||this.namespaces[e.prefix];if(!i){var n=t.indexOf(":");i=this.namespaces[t.substring(0,n)]}i||(i=this.namespaces[this.defaultPrefix]);var s=this.createElementNS(i,t);e.attributes&&this.setAttributes(s,e.attributes);var r=e.value;return null!=r&&s.appendChild(this.createTextNode(r)),s},setAttributes:function(t,e){var i,n;for(var s in e)null!=e[s]&&e[s].toString&&(i=e[s].toString(),n=this.namespaces[s.substring(0,s.indexOf(":"))]||null,this.setAttributeNS(t,n,s,i))},readNode:function(t,e){e||(e={});var i=this.readers[t.namespaceURI?this.namespaceAlias[t.namespaceURI]:this.defaultPrefix];if(i){var n=t.localName||t.nodeName.split(":").pop(),s=i[n]||i["*"];s&&s.apply(this,[t,e])}return e},readChildNodes:function(t,e){e||(e={});for(var i,n=t.childNodes,s=0,r=n.length;r>s;++s)i=n[s],1==i.nodeType&&this.readNode(i,e);return e},writeNode:function(t,e,i){var n,s,r=t.indexOf(":");r>0?(n=t.substring(0,r),s=t.substring(r+1)):(n=i?this.namespaceAlias[i.namespaceURI]:this.defaultPrefix,s=t);var o=this.writers[n][s].apply(this,[e]);return i&&i.appendChild(o),o},getChildEl:function(t,e,i){return t&&this.getThisOrNextEl(t.firstChild,e,i)},getNextEl:function(t,e,i){return t&&this.getThisOrNextEl(t.nextSibling,e,i)},getThisOrNextEl:function(t,e,i){t:for(var n=t;n;n=n.nextSibling)switch(n.nodeType){case 1:if(!(e&&e!==(n.localName||n.nodeName.split(":").pop())||i&&i!==n.namespaceURI))break t;n=null;break t;case 3:if(/^\s*$/.test(n.nodeValue))break;case 4:case 6:case 12:case 10:case 11:n=null;break t}return n||null},lookupNamespaceURI:function(t,e){var i=null;if(t)if(t.lookupNamespaceURI)i=t.lookupNamespaceURI(e);else t:switch(t.nodeType){case 1:if(null!==t.namespaceURI&&t.prefix===e){i=t.namespaceURI;break t}var n=t.attributes.length;if(n)for(var s,r=0;n>r;++r){if(s=t.attributes[r],"xmlns"===s.prefix&&s.name==="xmlns:"+e){i=s.value||null;break t}if("xmlns"===s.name&&null===e){i=s.value||null;break t}}i=this.lookupNamespaceURI(t.parentNode,e);break t;case 2:i=this.lookupNamespaceURI(t.ownerElement,e);break t;case 9:i=this.lookupNamespaceURI(t.documentElement,e);break t;case 6:case 12:case 10:case 11:break t;default:i=this.lookupNamespaceURI(t.parentNode,e)}return i},getXMLDoc:function(){return OpenLayers.Format.XML.document||this.xmldom||(document.implementation&&document.implementation.createDocument?OpenLayers.Format.XML.document=document.implementation.createDocument("","",null):!this.xmldom&&window.ActiveXObject&&(this.xmldom=new ActiveXObject("Microsoft.XMLDOM"))),OpenLayers.Format.XML.document||this.xmldom},CLASS_NAME:"OpenLayers.Format.XML"}),OpenLayers.Format.XML.CONTENT_TYPE={EMPTY:0,SIMPLE:1,COMPLEX:2,MIXED:3},OpenLayers.Format.XML.lookupNamespaceURI=OpenLayers.Function.bind(OpenLayers.Format.XML.prototype.lookupNamespaceURI,OpenLayers.Format.XML.prototype),OpenLayers.Format.XML.document=null,OpenLayers.Date={dateRegEx:/^(?:(\d{4})(?:-(\d{2})(?:-(\d{2}))?)?)?(?:(?:T(\d{1,2}):(\d{2}):(\d{2}(?:\.\d+)?)(Z|(?:[+-]\d{1,2}(?::(\d{2}))?)))|Z)?$/,toISOString:function(){return"toISOString"in Date.prototype?function(t){return t.toISOString()}:function(t){var e;return e=isNaN(t.getTime())?"Invalid Date":t.getUTCFullYear()+"-"+OpenLayers.Number.zeroPad(t.getUTCMonth()+1,2)+"-"+OpenLayers.Number.zeroPad(t.getUTCDate(),2)+"T"+OpenLayers.Number.zeroPad(t.getUTCHours(),2)+":"+OpenLayers.Number.zeroPad(t.getUTCMinutes(),2)+":"+OpenLayers.Number.zeroPad(t.getUTCSeconds(),2)+"."+OpenLayers.Number.zeroPad(t.getUTCMilliseconds(),3)+"Z"}}(),parse:function(t){var e,i=t.match(this.dateRegEx);if(i&&(i[1]||i[7])){var n=parseInt(i[1],10)||0,s=parseInt(i[2],10)-1||0,r=parseInt(i[3],10)||1;e=new Date(Date.UTC(n,s,r));var o=i[7];if(o){var a=parseInt(i[4],10),l=parseInt(i[5],10),h=parseFloat(i[6]),u=0|h,p=Math.round(1e3*(h-u));if(e.setUTCHours(a,l,u,p),"Z"!==o){var c=parseInt(o,10),d=parseInt(i[8],10)||0,m=-1e3*(3600*c+60*d);e=new Date(e.getTime()+m)}}}else e=new Date("invalid");return e}},OpenLayers.Feature=OpenLayers.Class({layer:null,id:null,lonlat:null,data:null,marker:null,popupClass:null,popup:null,initialize:function(t,e,i){this.layer=t,this.lonlat=e,this.data=null!=i?i:{},this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")},destroy:function(){null!=this.layer&&null!=this.layer.map&&null!=this.popup&&this.layer.map.removePopup(this.popup),null!=this.layer&&null!=this.marker&&this.layer.removeMarker(this.marker),this.layer=null,this.id=null,this.lonlat=null,this.data=null,null!=this.marker&&(this.destroyMarker(this.marker),this.marker=null),null!=this.popup&&(this.destroyPopup(this.popup),this.popup=null)},onScreen:function(){var t=!1;if(null!=this.layer&&null!=this.layer.map){var e=this.layer.map.getExtent();t=e.containsLonLat(this.lonlat)}return t},createMarker:function(){return null!=this.lonlat&&(this.marker=new OpenLayers.Marker(this.lonlat,this.data.icon)),this.marker},destroyMarker:function(){this.marker.destroy()},createPopup:function(t){if(null!=this.lonlat){if(!this.popup){var e=this.marker?this.marker.icon:null,i=this.popupClass?this.popupClass:OpenLayers.Popup.Anchored;this.popup=new i(this.id+"_popup",this.lonlat,this.data.popupSize,this.data.popupContentHTML,e,t)}null!=this.data.overflow&&(this.popup.contentDiv.style.overflow=this.data.overflow),this.popup.feature=this}return this.popup},destroyPopup:function(){this.popup&&(this.popup.feature=null,this.popup.destroy(),this.popup=null)},CLASS_NAME:"OpenLayers.Feature"}),OpenLayers.State={UNKNOWN:"Unknown",INSERT:"Insert",UPDATE:"Update",DELETE:"Delete"},OpenLayers.Feature.Vector=OpenLayers.Class(OpenLayers.Feature,{fid:null,geometry:null,attributes:null,bounds:null,state:null,style:null,url:null,renderIntent:"default",modified:null,initialize:function(t,e,i){OpenLayers.Feature.prototype.initialize.apply(this,[null,null,e]),this.lonlat=null,this.geometry=t?t:null,this.state=null,this.attributes={},e&&(this.attributes=OpenLayers.Util.extend(this.attributes,e)),this.style=i?i:null},destroy:function(){this.layer&&(this.layer.removeFeatures(this),this.layer=null),this.geometry=null,this.modified=null,OpenLayers.Feature.prototype.destroy.apply(this,arguments)},clone:function(){return new OpenLayers.Feature.Vector(this.geometry?this.geometry.clone():null,this.attributes,this.style)},onScreen:function(t){var e=!1;if(this.layer&&this.layer.map){var i=this.layer.map.getExtent();if(t){var n=this.geometry.getBounds();e=i.intersectsBounds(n)}else{var s=i.toGeometry();e=s.intersects(this.geometry)}}return e},getVisibility:function(){return!(this.style&&"none"==this.style.display||!this.layer||this.layer&&this.layer.styleMap&&"none"==this.layer.styleMap.createSymbolizer(this,this.renderIntent).display||this.layer&&!this.layer.getVisibility())},createMarker:function(){return null},destroyMarker:function(){},createPopup:function(){return null},atPoint:function(t,e,i){var n=!1;return this.geometry&&(n=this.geometry.atPoint(t,e,i)),n},destroyPopup:function(){},move:function(t){if(!this.layer||!this.geometry.move)return void 0;var e;e="OpenLayers.LonLat"==t.CLASS_NAME?this.layer.getViewPortPxFromLonLat(t):t;var i=this.layer.getViewPortPxFromLonLat(this.geometry.getBounds().getCenterLonLat()),n=this.layer.map.getResolution();return this.geometry.move(n*(e.x-i.x),n*(i.y-e.y)),this.layer.drawFeature(this),i},toState:function(t){if(t==OpenLayers.State.UPDATE)switch(this.state){case OpenLayers.State.UNKNOWN:case OpenLayers.State.DELETE:this.state=t;break;case OpenLayers.State.UPDATE:case OpenLayers.State.INSERT:}else if(t==OpenLayers.State.INSERT)switch(this.state){case OpenLayers.State.UNKNOWN:break;default:this.state=t}else if(t==OpenLayers.State.DELETE)switch(this.state){case OpenLayers.State.INSERT:break;case OpenLayers.State.DELETE:break;case OpenLayers.State.UNKNOWN:case OpenLayers.State.UPDATE:this.state=t}else t==OpenLayers.State.UNKNOWN&&(this.state=t)},CLASS_NAME:"OpenLayers.Feature.Vector"}),OpenLayers.Feature.Vector.style={"default":{fillColor:"#ee9900",fillOpacity:.4,hoverFillColor:"white",hoverFillOpacity:.8,strokeColor:"#ee9900",strokeOpacity:1,strokeWidth:1,strokeLinecap:"round",strokeDashstyle:"solid",hoverStrokeColor:"red",hoverStrokeOpacity:1,hoverStrokeWidth:.2,pointRadius:6,hoverPointRadius:1,hoverPointUnit:"%",pointerEvents:"visiblePainted",cursor:"inherit",fontColor:"#000000",labelAlign:"cm",labelOutlineColor:"white",labelOutlineWidth:3},select:{fillColor:"blue",fillOpacity:.4,hoverFillColor:"white",hoverFillOpacity:.8,strokeColor:"blue",strokeOpacity:1,strokeWidth:2,strokeLinecap:"round",strokeDashstyle:"solid",hoverStrokeColor:"red",hoverStrokeOpacity:1,hoverStrokeWidth:.2,pointRadius:6,hoverPointRadius:1,hoverPointUnit:"%",pointerEvents:"visiblePainted",cursor:"pointer",fontColor:"#000000",labelAlign:"cm",labelOutlineColor:"white",labelOutlineWidth:3},temporary:{fillColor:"#66cccc",fillOpacity:.2,hoverFillColor:"white",hoverFillOpacity:.8,strokeColor:"#66cccc",strokeOpacity:1,strokeLinecap:"round",strokeWidth:2,strokeDashstyle:"solid",hoverStrokeColor:"red",hoverStrokeOpacity:1,hoverStrokeWidth:.2,pointRadius:6,hoverPointRadius:1,hoverPointUnit:"%",pointerEvents:"visiblePainted",cursor:"inherit",fontColor:"#000000",labelAlign:"cm",labelOutlineColor:"white",labelOutlineWidth:3},"delete":{display:"none"}},OpenLayers.Geometry=OpenLayers.Class({id:null,parent:null,bounds:null,initialize:function(){this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")},destroy:function(){this.id=null,this.bounds=null},clone:function(){return new OpenLayers.Geometry},setBounds:function(t){t&&(this.bounds=t.clone())},clearBounds:function(){this.bounds=null,this.parent&&this.parent.clearBounds()},extendBounds:function(t){var e=this.getBounds();e?this.bounds.extend(t):this.setBounds(t)},getBounds:function(){return null==this.bounds&&this.calculateBounds(),this.bounds},calculateBounds:function(){},distanceTo:function(){},getVertices:function(){},atPoint:function(t,e,i){var n=!1,s=this.getBounds();if(null!=s&&null!=t){var r=null!=e?e:0,o=null!=i?i:0,a=new OpenLayers.Bounds(this.bounds.left-r,this.bounds.bottom-o,this.bounds.right+r,this.bounds.top+o);n=a.containsLonLat(t)}return n},getLength:function(){return 0},getArea:function(){return 0},getCentroid:function(){return null},toString:function(){var t;return t=OpenLayers.Format&&OpenLayers.Format.WKT?OpenLayers.Format.WKT.prototype.write(new OpenLayers.Feature.Vector(this)):Object.prototype.toString.call(this)},CLASS_NAME:"OpenLayers.Geometry"}),OpenLayers.Geometry.fromWKT=function(t){var e;if(OpenLayers.Format&&OpenLayers.Format.WKT){var i=OpenLayers.Geometry.fromWKT.format;i||(i=new OpenLayers.Format.WKT,OpenLayers.Geometry.fromWKT.format=i);var n=i.read(t);if(n instanceof OpenLayers.Feature.Vector)e=n.geometry;else if(OpenLayers.Util.isArray(n)){for(var s=n.length,r=new Array(s),o=0;s>o;++o)r[o]=n[o].geometry;e=new OpenLayers.Geometry.Collection(r)}}return e},OpenLayers.Geometry.segmentsIntersect=function(t,e,i){var n=i&&i.point,s=i&&i.tolerance,r=!1,o=t.x1-e.x1,a=t.y1-e.y1,l=t.x2-t.x1,h=t.y2-t.y1,u=e.y2-e.y1,p=e.x2-e.x1,c=u*l-p*h,d=p*a-u*o,m=l*a-h*o;if(0==c)0==d&&0==m&&(r=!0);else{var f=d/c,y=m/c;if(f>=0&&1>=f&&y>=0&&1>=y)if(n){var g=t.x1+f*l,v=t.y1+f*h;r=new OpenLayers.Geometry.Point(g,v)}else r=!0}if(s){var L;if(r){if(n){var _,g,v,O=[t,e];t:for(var b=0;2>b;++b){_=O[b];for(var w=1;3>w;++w)if(g=_["x"+w],v=_["y"+w],L=Math.sqrt(Math.pow(g-r.x,2)+Math.pow(v-r.y,2)),s>L){r.x=g,r.y=v;break t}}}}else{var x,S,g,v,C,E,O=[t,e];t:for(var b=0;2>b;++b){x=O[b],S=O[(b+1)%2];for(var w=1;3>w;++w)if(C={x:x["x"+w],y:x["y"+w]},E=OpenLayers.Geometry.distanceToSegment(C,S),E.distance<s){r=n?new OpenLayers.Geometry.Point(C.x,C.y):!0;break t}}}}return r},OpenLayers.Geometry.distanceToSegment=function(t,e){var i=OpenLayers.Geometry.distanceSquaredToSegment(t,e);return i.distance=Math.sqrt(i.distance),i},OpenLayers.Geometry.distanceSquaredToSegment=function(t,e){var i,n,s=t.x,r=t.y,o=e.x1,a=e.y1,l=e.x2,h=e.y2,u=l-o,p=h-a,c=(u*(s-o)+p*(r-a))/(Math.pow(u,2)+Math.pow(p,2));return 0>=c?(i=o,n=a):c>=1?(i=l,n=h):(i=o+c*u,n=a+c*p),{distance:Math.pow(i-s,2)+Math.pow(n-r,2),x:i,y:n,along:c}},OpenLayers.Geometry.Point=OpenLayers.Class(OpenLayers.Geometry,{x:null,y:null,initialize:function(t,e){OpenLayers.Geometry.prototype.initialize.apply(this,arguments),this.x=parseFloat(t),this.y=parseFloat(e)},clone:function(t){return null==t&&(t=new OpenLayers.Geometry.Point(this.x,this.y)),OpenLayers.Util.applyDefaults(t,this),t},calculateBounds:function(){this.bounds=new OpenLayers.Bounds(this.x,this.y,this.x,this.y)},distanceTo:function(t,e){var i,n,s,r,o,a,l=!(e&&e.edge===!1),h=l&&e&&e.details;return t instanceof OpenLayers.Geometry.Point?(n=this.x,s=this.y,r=t.x,o=t.y,i=Math.sqrt(Math.pow(n-r,2)+Math.pow(s-o,2)),a=h?{x0:n,y0:s,x1:r,y1:o,distance:i}:i):(a=t.distanceTo(this,e),h&&(a={x0:a.x1,y0:a.y1,x1:a.x0,y1:a.y0,distance:a.distance})),a},equals:function(t){var e=!1;return null!=t&&(e=this.x==t.x&&this.y==t.y||isNaN(this.x)&&isNaN(this.y)&&isNaN(t.x)&&isNaN(t.y)),e},toShortString:function(){return this.x+", "+this.y},move:function(t,e){this.x=this.x+t,this.y=this.y+e,this.clearBounds()},rotate:function(t,e){t*=Math.PI/180;var i=this.distanceTo(e),n=t+Math.atan2(this.y-e.y,this.x-e.x);this.x=e.x+i*Math.cos(n),this.y=e.y+i*Math.sin(n),this.clearBounds()},getCentroid:function(){return new OpenLayers.Geometry.Point(this.x,this.y)},resize:function(t,e,i){return i=void 0==i?1:i,this.x=e.x+t*i*(this.x-e.x),this.y=e.y+t*(this.y-e.y),this.clearBounds(),this},intersects:function(t){var e=!1;return e="OpenLayers.Geometry.Point"==t.CLASS_NAME?this.equals(t):t.intersects(this)},transform:function(t,e){return t&&e&&(OpenLayers.Projection.transform(this,t,e),this.bounds=null),this},getVertices:function(){return[this]},CLASS_NAME:"OpenLayers.Geometry.Point"}),OpenLayers.Geometry.Collection=OpenLayers.Class(OpenLayers.Geometry,{components:null,componentTypes:null,initialize:function(t){OpenLayers.Geometry.prototype.initialize.apply(this,arguments),this.components=[],null!=t&&this.addComponents(t)},destroy:function(){this.components.length=0,this.components=null,OpenLayers.Geometry.prototype.destroy.apply(this,arguments)},clone:function(){for(var geometry=eval("new "+this.CLASS_NAME+"()"),i=0,len=this.components.length;len>i;i++)geometry.addComponent(this.components[i].clone());return OpenLayers.Util.applyDefaults(geometry,this),geometry},getComponentsString:function(){for(var t=[],e=0,i=this.components.length;i>e;e++)t.push(this.components[e].toShortString());return t.join(",")},calculateBounds:function(){this.bounds=null;var t=new OpenLayers.Bounds,e=this.components;if(e)for(var i=0,n=e.length;n>i;i++)t.extend(e[i].getBounds());null!=t.left&&null!=t.bottom&&null!=t.right&&null!=t.top&&this.setBounds(t)},addComponents:function(t){OpenLayers.Util.isArray(t)||(t=[t]);for(var e=0,i=t.length;i>e;e++)this.addComponent(t[e])},addComponent:function(t,e){var i=!1;if(t&&(null==this.componentTypes||OpenLayers.Util.indexOf(this.componentTypes,t.CLASS_NAME)>-1)){if(null!=e&&e<this.components.length){var n=this.components.slice(0,e),s=this.components.slice(e,this.components.length);n.push(t),this.components=n.concat(s)}else this.components.push(t);t.parent=this,this.clearBounds(),i=!0}return i},removeComponents:function(t){var e=!1;OpenLayers.Util.isArray(t)||(t=[t]);for(var i=t.length-1;i>=0;--i)e=this.removeComponent(t[i])||e;return e},removeComponent:function(t){return OpenLayers.Util.removeItem(this.components,t),this.clearBounds(),!0},getLength:function(){for(var t=0,e=0,i=this.components.length;i>e;e++)t+=this.components[e].getLength();return t},getArea:function(){for(var t=0,e=0,i=this.components.length;i>e;e++)t+=this.components[e].getArea();return t},getGeodesicArea:function(t){for(var e=0,i=0,n=this.components.length;n>i;i++)e+=this.components[i].getGeodesicArea(t);return e},getCentroid:function(t){if(!t)return this.components.length&&this.components[0].getCentroid();var e=this.components.length;if(!e)return!1;for(var i,n=[],s=[],r=0,o=Number.MAX_VALUE,a=0;e>a;++a){i=this.components[a];var l=i.getArea(),h=i.getCentroid(!0);isNaN(l)||isNaN(h.x)||isNaN(h.y)||(n.push(l),r+=l,o=o>l&&l>0?l:o,s.push(h))}if(e=n.length,0===r){for(var a=0;e>a;++a)n[a]=1;r=n.length}else{for(var a=0;e>a;++a)n[a]/=o;r/=o}for(var h,l,u=0,p=0,a=0;e>a;++a)h=s[a],l=n[a],u+=h.x*l,p+=h.y*l;return new OpenLayers.Geometry.Point(u/r,p/r)},getGeodesicLength:function(t){for(var e=0,i=0,n=this.components.length;n>i;i++)e+=this.components[i].getGeodesicLength(t);return e},move:function(t,e){for(var i=0,n=this.components.length;n>i;i++)this.components[i].move(t,e)},rotate:function(t,e){for(var i=0,n=this.components.length;n>i;++i)this.components[i].rotate(t,e)},resize:function(t,e,i){for(var n=0;n<this.components.length;++n)this.components[n].resize(t,e,i);return this},distanceTo:function(t,e){for(var i,n,s,r=!(e&&e.edge===!1),o=r&&e&&e.details,a=Number.POSITIVE_INFINITY,l=0,h=this.components.length;h>l&&(i=this.components[l].distanceTo(t,e),s=o?i.distance:i,!(a>s&&(a=s,n=i,0==a)));++l);return n},equals:function(t){var e=!0;if(t&&t.CLASS_NAME&&this.CLASS_NAME==t.CLASS_NAME)if(OpenLayers.Util.isArray(t.components)&&t.components.length==this.components.length){for(var i=0,n=this.components.length;n>i;++i)if(!this.components[i].equals(t.components[i])){e=!1;break}}else e=!1;else e=!1;return e},transform:function(t,e){if(t&&e){for(var i=0,n=this.components.length;n>i;i++){var s=this.components[i];s.transform(t,e)}this.bounds=null}return this},intersects:function(t){for(var e=!1,i=0,n=this.components.length;n>i&&!(e=t.intersects(this.components[i]));++i);return e},getVertices:function(t){for(var e=[],i=0,n=this.components.length;n>i;++i)Array.prototype.push.apply(e,this.components[i].getVertices(t));return e},CLASS_NAME:"OpenLayers.Geometry.Collection"}),OpenLayers.Geometry.MultiPoint=OpenLayers.Class(OpenLayers.Geometry.Collection,{componentTypes:["OpenLayers.Geometry.Point"],addPoint:function(t,e){this.addComponent(t,e)},removePoint:function(t){this.removeComponent(t)},CLASS_NAME:"OpenLayers.Geometry.MultiPoint"}),OpenLayers.Geometry.Curve=OpenLayers.Class(OpenLayers.Geometry.MultiPoint,{componentTypes:["OpenLayers.Geometry.Point"],getLength:function(){var t=0;if(this.components&&this.components.length>1)for(var e=1,i=this.components.length;i>e;e++)t+=this.components[e-1].distanceTo(this.components[e]);return t},getGeodesicLength:function(t){var e=this;if(t){var i=new OpenLayers.Projection("EPSG:4326");i.equals(t)||(e=this.clone().transform(t,i))}var n=0;if(e.components&&e.components.length>1)for(var s,r,o=1,a=e.components.length;a>o;o++)s=e.components[o-1],r=e.components[o],n+=OpenLayers.Util.distVincenty({lon:s.x,lat:s.y},{lon:r.x,lat:r.y});return 1e3*n},CLASS_NAME:"OpenLayers.Geometry.Curve"}),OpenLayers.Geometry.LineString=OpenLayers.Class(OpenLayers.Geometry.Curve,{removeComponent:function(){var t=this.components&&this.components.length>2;return t&&OpenLayers.Geometry.Collection.prototype.removeComponent.apply(this,arguments),t},intersects:function(t){var e=!1,i=t.CLASS_NAME;if("OpenLayers.Geometry.LineString"==i||"OpenLayers.Geometry.LinearRing"==i||"OpenLayers.Geometry.Point"==i){var n,s=this.getSortedSegments();n="OpenLayers.Geometry.Point"==i?[{x1:t.x,y1:t.y,x2:t.x,y2:t.y}]:t.getSortedSegments();var r,o,a,l,h,u,p,c;t:for(var d=0,m=s.length;m>d;++d){r=s[d],o=r.x1,a=r.x2,l=r.y1,h=r.y2;for(var f=0,y=n.length;y>f&&(u=n[f],!(u.x1>a));++f)if(!(u.x2<o||(p=u.y1,c=u.y2,Math.min(p,c)>Math.max(l,h)||Math.max(p,c)<Math.min(l,h)||!OpenLayers.Geometry.segmentsIntersect(r,u)))){e=!0;break t}}}else e=t.intersects(this);return e},getSortedSegments:function(){function t(t,e){return t.x1-e.x1}for(var e,i,n=this.components.length-1,s=new Array(n),r=0;n>r;++r)e=this.components[r],i=this.components[r+1],s[r]=e.x<i.x?{x1:e.x,y1:e.y,x2:i.x,y2:i.y}:{x1:i.x,y1:i.y,x2:e.x,y2:e.y};return s.sort(t)},splitWithSegment:function(t,e){for(var i,n,s,r,o,a=!(e&&e.edge===!1),l=e&&e.tolerance,h=[],u=this.getVertices(),p=[],c=[],d=!1,m={point:!0,tolerance:l},f=null,y=0,g=u.length-2;g>=y;++y)if(i=u[y],p.push(i.clone()),n=u[y+1],o={x1:i.x,y1:i.y,x2:n.x,y2:n.y},s=OpenLayers.Geometry.segmentsIntersect(t,o,m),s instanceof OpenLayers.Geometry.Point&&(r=s.x===t.x1&&s.y===t.y1||s.x===t.x2&&s.y===t.y2||s.equals(i)||s.equals(n)?!0:!1,r||a)){if(s.equals(c[c.length-1])||c.push(s.clone()),0===y&&s.equals(i))continue;if(s.equals(n))continue;d=!0,s.equals(i)||p.push(s),h.push(new OpenLayers.Geometry.LineString(p)),p=[s.clone()]}if(d&&(p.push(n.clone()),h.push(new OpenLayers.Geometry.LineString(p))),c.length>0){var v=t.x1<t.x2?1:-1,L=t.y1<t.y2?1:-1;f={lines:h,points:c.sort(function(t,e){return v*t.x-v*e.x||L*t.y-L*e.y})}}return f},split:function(t,e){var i,n,s,r,o=null,a=e&&e.mutual;if(t instanceof OpenLayers.Geometry.LineString){var l,h,u,p,c,d,m=this.getVertices(),f=[];s=[];for(var y=0,g=m.length-2;g>=y;++y){l=m[y],h=m[y+1],u={x1:l.x,y1:l.y,x2:h.x,y2:h.y},r=r||[t],a&&f.push(l.clone());for(var v=0;v<r.length;++v)if(p=r[v].splitWithSegment(u,e),p&&(c=p.lines,c.length>0&&(c.unshift(v,1),Array.prototype.splice.apply(r,c),v+=c.length-2),a))for(var L=0,_=p.points.length;_>L;++L)d=p.points[L],d.equals(l)||(f.push(d),s.push(new OpenLayers.Geometry.LineString(f)),f=d.equals(h)?[]:[d.clone()])}a&&s.length>0&&f.length>0&&(f.push(h.clone()),s.push(new OpenLayers.Geometry.LineString(f)))}else o=t.splitWith(this,e);return r&&r.length>1?n=!0:r=[],s&&s.length>1?i=!0:s=[],(n||i)&&(o=a?[s,r]:r),o},splitWith:function(t,e){return t.split(this,e)},getVertices:function(t){var e;return e=t===!0?[this.components[0],this.components[this.components.length-1]]:t===!1?this.components.slice(1,this.components.length-1):this.components.slice()},distanceTo:function(t,e){var i,n=!(e&&e.edge===!1),s=n&&e&&e.details,r={},o=Number.POSITIVE_INFINITY;if(t instanceof OpenLayers.Geometry.Point){for(var a,l=this.getSortedSegments(),h=t.x,u=t.y,p=0,c=l.length;c>p;++p)if(a=l[p],i=OpenLayers.Geometry.distanceToSegment(t,a),i.distance<o){if(o=i.distance,r=i,0===o)break}else if(a.x2>h&&(u>a.y1&&u<a.y2||u<a.y1&&u>a.y2))break;r=s?{distance:r.distance,x0:r.x,y0:r.y,x1:h,y1:u}:r.distance}else if(t instanceof OpenLayers.Geometry.LineString){var d,m,f,y,g,v=this.getSortedSegments(),L=t.getSortedSegments(),_=L.length,O={point:!0};t:for(var p=0,c=v.length;c>p;++p){d=v[p],y=d.x1,g=d.y1;for(var b=0;_>b;++b){if(m=L[b],f=OpenLayers.Geometry.segmentsIntersect(d,m,O)){o=0,r={distance:0,x0:f.x,y0:f.y,x1:f.x,y1:f.y};break t}i=OpenLayers.Geometry.distanceToSegment({x:y,y:g},m),i.distance<o&&(o=i.distance,r={distance:o,x0:y,y0:g,x1:i.x,y1:i.y})}}if(s||(r=r.distance),0!==o&&d){i=t.distanceTo(new OpenLayers.Geometry.Point(d.x2,d.y2),e);var w=s?i.distance:i;o>w&&(r=s?{distance:o,x0:i.x1,y0:i.y1,x1:i.x0,y1:i.y0}:w)}}else r=t.distanceTo(this,e),s&&(r={distance:r.distance,x0:r.x1,y0:r.y1,x1:r.x0,y1:r.y0});return r},simplify:function(t){if(this&&null!==this){var e=this.getVertices();if(e.length<3)return this;var i=function(t,e){return t-e},n=function(t,e,i,r){for(var o,l=0,h=0,u=e;i>u;u++)o=s(t[e],t[i],t[u]),o>l&&(l=o,h=u);l>r&&h!=e&&(a.push(h),n(t,e,h,r),n(t,h,i,r))},s=function(t,e,i){var n=Math.abs(.5*(t.x*e.y+e.x*i.y+i.x*t.y-e.x*t.y-i.x*e.y-t.x*i.y)),s=Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)),r=n/s*2;return r},r=0,o=e.length-1,a=[];for(a.push(r),a.push(o);e[r].equals(e[o]);)o--,a.push(o);n(e,r,o,t);var l=[];a.sort(i);for(var h=0;h<a.length;h++)l.push(e[a[h]]);return new OpenLayers.Geometry.LineString(l)}return this},CLASS_NAME:"OpenLayers.Geometry.LineString"}),OpenLayers.Geometry.LinearRing=OpenLayers.Class(OpenLayers.Geometry.LineString,{componentTypes:["OpenLayers.Geometry.Point"],addComponent:function(t,e){var i=!1,n=this.components.pop();null==e&&t.equals(n)||(i=OpenLayers.Geometry.Collection.prototype.addComponent.apply(this,arguments));var s=this.components[0];return OpenLayers.Geometry.Collection.prototype.addComponent.apply(this,[s]),i},removeComponent:function(){var t=this.components&&this.components.length>3;if(t){this.components.pop(),OpenLayers.Geometry.Collection.prototype.removeComponent.apply(this,arguments);var e=this.components[0];OpenLayers.Geometry.Collection.prototype.addComponent.apply(this,[e])}return t},move:function(t,e){for(var i=0,n=this.components.length;n-1>i;i++)this.components[i].move(t,e)},rotate:function(t,e){for(var i=0,n=this.components.length;n-1>i;++i)this.components[i].rotate(t,e)},resize:function(t,e,i){for(var n=0,s=this.components.length;s-1>n;++n)this.components[n].resize(t,e,i);return this},transform:function(t,e){if(t&&e){for(var i=0,n=this.components.length;n-1>i;i++){var s=this.components[i];s.transform(t,e)}this.bounds=null}return this},getCentroid:function(){if(this.components){var t=this.components.length;if(t>0&&2>=t)return this.components[0].clone();if(t>2){var e=0,i=0,n=this.components[0].x,s=this.components[0].y,r=-1*this.getArea();if(0!=r){for(var o=0;t-1>o;o++){var a=this.components[o],l=this.components[o+1];e+=(a.x+l.x-2*n)*((a.x-n)*(l.y-s)-(l.x-n)*(a.y-s)),i+=(a.y+l.y-2*s)*((a.x-n)*(l.y-s)-(l.x-n)*(a.y-s))}var h=n+e/(6*r),u=s+i/(6*r)}else{for(var o=0;t-1>o;o++)e+=this.components[o].x,i+=this.components[o].y;var h=e/(t-1),u=i/(t-1)}return new OpenLayers.Geometry.Point(h,u)}return null}},getArea:function(){var t=0;if(this.components&&this.components.length>2){for(var e=0,i=0,n=this.components.length;n-1>i;i++){var s=this.components[i],r=this.components[i+1];e+=(s.x+r.x)*(r.y-s.y)}t=-e/2}return t},getGeodesicArea:function(t){var e=this;if(t){var i=new OpenLayers.Projection("EPSG:4326");i.equals(t)||(e=this.clone().transform(t,i))}var n=0,s=e.components&&e.components.length;if(s>2){for(var r,o,a=0;s-1>a;a++)r=e.components[a],o=e.components[a+1],n+=OpenLayers.Util.rad(o.x-r.x)*(2+Math.sin(OpenLayers.Util.rad(r.y))+Math.sin(OpenLayers.Util.rad(o.y)));n=6378137*n*6378137/2}return n},containsPoint:function(t){function e(t,e,i,n,s){return(t-s)*((n-e)/(s-i))+n}for(var i,n,s,r,o,a,l,h=OpenLayers.Number.limitSigDigs,u=14,p=h(t.x,u),c=h(t.y,u),d=this.components.length-1,m=0,f=0;d>f;++f)if(i=this.components[f],s=h(i.x,u),r=h(i.y,u),n=this.components[f+1],o=h(n.x,u),a=h(n.y,u),r!=a){if(l=h(e(c,s,r,o,a),u),l==p&&(a>r&&c>=r&&a>=c||r>a&&r>=c&&c>=a)){m=-1;break}p>=l||s!=o&&(l<Math.min(s,o)||l>Math.max(s,o))||(a>r&&c>=r&&a>c||r>a&&r>c&&c>=a)&&++m}else if(c==r&&(o>=s&&p>=s&&o>=p||s>=o&&s>=p&&p>=o)){m=-1;break}var y=-1==m?1:!!(1&m);return y},intersects:function(t){var e=!1;if("OpenLayers.Geometry.Point"==t.CLASS_NAME)e=this.containsPoint(t);else if("OpenLayers.Geometry.LineString"==t.CLASS_NAME)e=t.intersects(this);else if("OpenLayers.Geometry.LinearRing"==t.CLASS_NAME)e=OpenLayers.Geometry.LineString.prototype.intersects.apply(this,[t]);else for(var i=0,n=t.components.length;n>i&&!(e=t.components[i].intersects(this));++i);return e},getVertices:function(t){return t===!0?[]:this.components.slice(0,this.components.length-1)},CLASS_NAME:"OpenLayers.Geometry.LinearRing"}),OpenLayers.Geometry.Polygon=OpenLayers.Class(OpenLayers.Geometry.Collection,{componentTypes:["OpenLayers.Geometry.LinearRing"],getArea:function(){var t=0;if(this.components&&this.components.length>0){t+=Math.abs(this.components[0].getArea());for(var e=1,i=this.components.length;i>e;e++)t-=Math.abs(this.components[e].getArea())}return t},getGeodesicArea:function(t){var e=0;if(this.components&&this.components.length>0){e+=Math.abs(this.components[0].getGeodesicArea(t));for(var i=1,n=this.components.length;n>i;i++)e-=Math.abs(this.components[i].getGeodesicArea(t))}return e},containsPoint:function(t){var e=this.components.length,i=!1;if(e>0&&(i=this.components[0].containsPoint(t),1!==i&&i&&e>1))for(var n,s=1;e>s;++s)if(n=this.components[s].containsPoint(t)){i=1===n?1:!1;break}return i},intersects:function(t){var e,i,n=!1;if("OpenLayers.Geometry.Point"==t.CLASS_NAME)n=this.containsPoint(t);else if("OpenLayers.Geometry.LineString"==t.CLASS_NAME||"OpenLayers.Geometry.LinearRing"==t.CLASS_NAME){for(e=0,i=this.components.length;i>e&&!(n=t.intersects(this.components[e]));++e);if(!n)for(e=0,i=t.components.length;i>e&&!(n=this.containsPoint(t.components[e]));++e);}else for(e=0,i=t.components.length;i>e&&!(n=this.intersects(t.components[e]));++e);if(!n&&"OpenLayers.Geometry.Polygon"==t.CLASS_NAME){var s=this.components[0];for(e=0,i=s.components.length;i>e&&!(n=t.containsPoint(s.components[e]));++e);}return n},distanceTo:function(t,e){var i,n=!(e&&e.edge===!1);return i=!n&&this.intersects(t)?0:OpenLayers.Geometry.Collection.prototype.distanceTo.apply(this,[t,e])},CLASS_NAME:"OpenLayers.Geometry.Polygon"}),OpenLayers.Geometry.Polygon.createRegularPolygon=function(t,e,i,n){var s=Math.PI*(1/i-.5);n&&(s+=n/180*Math.PI);for(var r,o,a,l=[],h=0;i>h;++h)r=s+2*h*Math.PI/i,o=t.x+e*Math.cos(r),a=t.y+e*Math.sin(r),l.push(new OpenLayers.Geometry.Point(o,a));var u=new OpenLayers.Geometry.LinearRing(l);
return new OpenLayers.Geometry.Polygon([u])},OpenLayers.Event={observers:!1,KEY_SPACE:32,KEY_BACKSPACE:8,KEY_TAB:9,KEY_RETURN:13,KEY_ESC:27,KEY_LEFT:37,KEY_UP:38,KEY_RIGHT:39,KEY_DOWN:40,KEY_DELETE:46,element:function(t){return t.target||t.srcElement},isSingleTouch:function(t){return t.touches&&1==t.touches.length},isMultiTouch:function(t){return t.touches&&t.touches.length>1},isLeftClick:function(t){return t.which&&1==t.which||t.button&&1==t.button},isRightClick:function(t){return t.which&&3==t.which||t.button&&2==t.button},stop:function(t,e){e||OpenLayers.Event.preventDefault(t),t.stopPropagation?t.stopPropagation():t.cancelBubble=!0},preventDefault:function(t){t.preventDefault?t.preventDefault():t.returnValue=!1},findElement:function(t,e){for(var i=OpenLayers.Event.element(t);i.parentNode&&(!i.tagName||i.tagName.toUpperCase()!=e.toUpperCase());)i=i.parentNode;return i},observe:function(t,e,i,n){var s=OpenLayers.Util.getElement(t);if(n=n||!1,"keypress"==e&&(navigator.appVersion.match(/Konqueror|Safari|KHTML/)||s.attachEvent)&&(e="keydown"),this.observers||(this.observers={}),!s._eventCacheID){var r="eventCacheID_";s.id&&(r=s.id+"_"+r),s._eventCacheID=OpenLayers.Util.createUniqueID(r)}var o=s._eventCacheID;this.observers[o]||(this.observers[o]=[]),this.observers[o].push({element:s,name:e,observer:i,useCapture:n}),s.addEventListener?s.addEventListener(e,i,n):s.attachEvent&&s.attachEvent("on"+e,i)},stopObservingElement:function(t){var e=OpenLayers.Util.getElement(t),i=e._eventCacheID;this._removeElementObservers(OpenLayers.Event.observers[i])},_removeElementObservers:function(t){if(t)for(var e=t.length-1;e>=0;e--){var i=t[e];OpenLayers.Event.stopObserving.apply(this,[i.element,i.name,i.observer,i.useCapture])}},stopObserving:function(t,e,i,n){n=n||!1;var s=OpenLayers.Util.getElement(t),r=s._eventCacheID;"keypress"==e&&(navigator.appVersion.match(/Konqueror|Safari|KHTML/)||s.detachEvent)&&(e="keydown");var o=!1,a=OpenLayers.Event.observers[r];if(a)for(var l=0;!o&&l<a.length;){var h=a[l];if(h.name==e&&h.observer==i&&h.useCapture==n){a.splice(l,1),0==a.length&&delete OpenLayers.Event.observers[r],o=!0;break}l++}return o&&(s.removeEventListener?s.removeEventListener(e,i,n):s&&s.detachEvent&&s.detachEvent("on"+e,i)),o},unloadCache:function(){if(OpenLayers.Event&&OpenLayers.Event.observers){for(var t in OpenLayers.Event.observers){var e=OpenLayers.Event.observers[t];OpenLayers.Event._removeElementObservers.apply(this,[e])}OpenLayers.Event.observers=!1}},CLASS_NAME:"OpenLayers.Event"},OpenLayers.Event.observe(window,"unload",OpenLayers.Event.unloadCache,!1),OpenLayers.Events=OpenLayers.Class({BROWSER_EVENTS:["mouseover","mouseout","mousedown","mouseup","mousemove","click","dblclick","rightclick","dblrightclick","resize","focus","blur","touchstart","touchmove","touchend","keydown"],listeners:null,object:null,element:null,eventHandler:null,fallThrough:null,includeXY:!1,extensions:null,extensionCount:null,clearMouseListener:null,initialize:function(t,e,i,n,s){OpenLayers.Util.extend(this,s),this.object=t,this.fallThrough=n,this.listeners={},this.extensions={},this.extensionCount={},this._msTouches=[],null!=e&&this.attachToElement(e)},destroy:function(){for(var t in this.extensions)"boolean"!=typeof this.extensions[t]&&this.extensions[t].destroy();this.extensions=null,this.element&&(OpenLayers.Event.stopObservingElement(this.element),this.element.hasScrollEvent&&OpenLayers.Event.stopObserving(window,"scroll",this.clearMouseListener)),this.element=null,this.listeners=null,this.object=null,this.fallThrough=null,this.eventHandler=null},addEventType:function(){},attachToElement:function(t){this.element?OpenLayers.Event.stopObservingElement(this.element):(this.eventHandler=OpenLayers.Function.bindAsEventListener(this.handleBrowserEvent,this),this.clearMouseListener=OpenLayers.Function.bind(this.clearMouseCache,this)),this.element=t;for(var e,i=!!window.navigator.msMaxTouchPoints,n=0,s=this.BROWSER_EVENTS.length;s>n;n++)e=this.BROWSER_EVENTS[n],OpenLayers.Event.observe(t,e,this.eventHandler),i&&0===e.indexOf("touch")&&this.addMsTouchListener(t,e,this.eventHandler);OpenLayers.Event.observe(t,"dragstart",OpenLayers.Event.stop)},on:function(t){for(var e in t)"scope"!=e&&t.hasOwnProperty(e)&&this.register(e,t.scope,t[e])},register:function(t,e,i,n){if(t in OpenLayers.Events&&!this.extensions[t]&&(this.extensions[t]=new OpenLayers.Events[t](this)),null!=i){null==e&&(e=this.object);var s=this.listeners[t];s||(s=[],this.listeners[t]=s,this.extensionCount[t]=0);var r={obj:e,func:i};n?(s.splice(this.extensionCount[t],0,r),"object"==typeof n&&n.extension&&this.extensionCount[t]++):s.push(r)}},registerPriority:function(t,e,i){this.register(t,e,i,!0)},un:function(t){for(var e in t)"scope"!=e&&t.hasOwnProperty(e)&&this.unregister(e,t.scope,t[e])},unregister:function(t,e,i){null==e&&(e=this.object);var n=this.listeners[t];if(null!=n)for(var s=0,r=n.length;r>s;s++)if(n[s].obj==e&&n[s].func==i){n.splice(s,1);break}},remove:function(t){null!=this.listeners[t]&&(this.listeners[t]=[])},triggerEvent:function(t,e){var i=this.listeners[t];if(!i||0==i.length)return void 0;null==e&&(e={}),e.object=this.object,e.element=this.element,e.type||(e.type=t),i=i.slice();for(var n,s=0,r=i.length;r>s;s++){var o=i[s];if(n=o.func.apply(o.obj,[e]),void 0!=n&&0==n)break}return this.fallThrough||OpenLayers.Event.stop(e,!0),n},handleBrowserEvent:function(t){var e=t.type,i=this.listeners[e];if(i&&0!=i.length){var n=t.touches;if(n&&n[0]){for(var s,r=0,o=0,a=n.length,l=0;a>l;++l)s=this.getTouchClientXY(n[l]),r+=s.clientX,o+=s.clientY;t.clientX=r/a,t.clientY=o/a}this.includeXY&&(t.xy=this.getMousePosition(t)),this.triggerEvent(e,t)}},getTouchClientXY:function(t){var e=window.olMockWin||window,i=e.pageXOffset,n=e.pageYOffset,s=t.clientX,r=t.clientY;return 0===t.pageY&&Math.floor(r)>Math.floor(t.pageY)||0===t.pageX&&Math.floor(s)>Math.floor(t.pageX)?(s-=i,r-=n):(r<t.pageY-n||s<t.pageX-i)&&(s=t.pageX-i,r=t.pageY-n),t.olClientX=s,t.olClientY=r,{clientX:s,clientY:r}},clearMouseCache:function(){this.element.scrolls=null,this.element.lefttop=null,this.element.offsets=null},getMousePosition:function(t){if(this.includeXY?this.element.hasScrollEvent||(OpenLayers.Event.observe(window,"scroll",this.clearMouseListener),this.element.hasScrollEvent=!0):this.clearMouseCache(),!this.element.scrolls){var e=OpenLayers.Util.getViewportElement();this.element.scrolls=[window.pageXOffset||e.scrollLeft,window.pageYOffset||e.scrollTop]}return this.element.lefttop||(this.element.lefttop=[document.documentElement.clientLeft||0,document.documentElement.clientTop||0]),this.element.offsets||(this.element.offsets=OpenLayers.Util.pagePosition(this.element)),new OpenLayers.Pixel(t.clientX+this.element.scrolls[0]-this.element.offsets[0]-this.element.lefttop[0],t.clientY+this.element.scrolls[1]-this.element.offsets[1]-this.element.lefttop[1])},addMsTouchListener:function(t,e,i){function n(t){i(OpenLayers.Util.applyDefaults({stopPropagation:function(){for(var t=s.length-1;t>=0;--t)s[t].stopPropagation()},preventDefault:function(){for(var t=s.length-1;t>=0;--t)s[t].preventDefault()},type:e},t))}var s=(this.eventHandler,this._msTouches);switch(e){case"touchstart":return this.addMsTouchListenerStart(t,e,n);case"touchend":return this.addMsTouchListenerEnd(t,e,n);case"touchmove":return this.addMsTouchListenerMove(t,e,n);default:throw"Unknown touch event type"}},addMsTouchListenerStart:function(t,e,i){var n=this._msTouches,s=function(t){for(var e=!1,s=0,r=n.length;r>s;++s)if(n[s].pointerId==t.pointerId){e=!0;break}e||n.push(t),t.touches=n.slice(),i(t)};OpenLayers.Event.observe(t,"MSPointerDown",s);var r=function(t){for(var e=0,i=n.length;i>e;++e)if(n[e].pointerId==t.pointerId){n.splice(e,1);break}};OpenLayers.Event.observe(t,"MSPointerUp",r)},addMsTouchListenerMove:function(t,e,i){var n=this._msTouches,s=function(t){if(!(t.pointerType==t.MSPOINTER_TYPE_MOUSE&&0==t.buttons||1==n.length&&n[0].pageX==t.pageX&&n[0].pageY==t.pageY)){for(var e=0,s=n.length;s>e;++e)if(n[e].pointerId==t.pointerId){n[e]=t;break}t.touches=n.slice(),i(t)}};OpenLayers.Event.observe(t,"MSPointerMove",s)},addMsTouchListenerEnd:function(t,e,i){var n=this._msTouches,s=function(t){for(var e=0,s=n.length;s>e;++e)if(n[e].pointerId==t.pointerId){n.splice(e,1);break}t.touches=n.slice(),i(t)};OpenLayers.Event.observe(t,"MSPointerUp",s)},CLASS_NAME:"OpenLayers.Events"}),OpenLayers.ProxyHost="",OpenLayers.Request||(OpenLayers.Request={}),OpenLayers.Util.extend(OpenLayers.Request,{DEFAULT_CONFIG:{method:"GET",url:window.location.href,async:!0,user:void 0,password:void 0,params:null,proxy:OpenLayers.ProxyHost,headers:{},data:null,callback:function(){},success:null,failure:null,scope:null},URL_SPLIT_REGEX:/([^:]*:)\/\/([^:]*:?[^@]*@)?([^:\/\?]*):?([^\/\?]*)/,events:new OpenLayers.Events(this),makeSameOrigin:function(t,e){var i=0!==t.indexOf("http"),n=!i&&t.match(this.URL_SPLIT_REGEX);if(n){var s=window.location;i=n[1]==s.protocol&&n[3]==s.hostname;var r=n[4],o=s.port;(80!=r&&""!=r||"80"!=o&&""!=o)&&(i=i&&r==o)}return i||e&&(t="function"==typeof e?e(t):e+encodeURIComponent(t)),t},issue:function(t){var e=OpenLayers.Util.extend(this.DEFAULT_CONFIG,{proxy:OpenLayers.ProxyHost});t=t||{},t.headers=t.headers||{},t=OpenLayers.Util.applyDefaults(t,e),t.headers=OpenLayers.Util.applyDefaults(t.headers,e.headers);var i,n=!1;for(i in t.headers)t.headers.hasOwnProperty(i)&&"x-requested-with"===i.toLowerCase()&&(n=!0);n===!1&&(t.headers["X-Requested-With"]="XMLHttpRequest");var s=new OpenLayers.Request.XMLHttpRequest,r=OpenLayers.Util.urlAppend(t.url,OpenLayers.Util.getParameterString(t.params||{}));r=OpenLayers.Request.makeSameOrigin(r,t.proxy),s.open(t.method,r,t.async,t.user,t.password);for(var o in t.headers)s.setRequestHeader(o,t.headers[o]);var a=this.events,l=this;return s.onreadystatechange=function(){if(s.readyState==OpenLayers.Request.XMLHttpRequest.DONE){var e=a.triggerEvent("complete",{request:s,config:t,requestUrl:r});e!==!1&&l.runCallbacks({request:s,config:t,requestUrl:r})}},t.async===!1?s.send(t.data):window.setTimeout(function(){0!==s.readyState&&s.send(t.data)},0),s},runCallbacks:function(t){var e,i=t.request,n=t.config,s=n.scope?OpenLayers.Function.bind(n.callback,n.scope):n.callback;n.success&&(e=n.scope?OpenLayers.Function.bind(n.success,n.scope):n.success);var r;n.failure&&(r=n.scope?OpenLayers.Function.bind(n.failure,n.scope):n.failure),"file:"==OpenLayers.Util.createUrlObject(n.url).protocol&&i.responseText&&(i.status=200),s(i),(!i.status||i.status>=200&&i.status<300)&&(this.events.triggerEvent("success",t),e&&e(i)),i.status&&(i.status<200||i.status>=300)&&(this.events.triggerEvent("failure",t),r&&r(i))},GET:function(t){return t=OpenLayers.Util.extend(t,{method:"GET"}),OpenLayers.Request.issue(t)},POST:function(t){return t=OpenLayers.Util.extend(t,{method:"POST"}),t.headers=t.headers?t.headers:{},"CONTENT-TYPE"in OpenLayers.Util.upperCaseObject(t.headers)||(t.headers["Content-Type"]="application/xml"),OpenLayers.Request.issue(t)},PUT:function(t){return t=OpenLayers.Util.extend(t,{method:"PUT"}),t.headers=t.headers?t.headers:{},"CONTENT-TYPE"in OpenLayers.Util.upperCaseObject(t.headers)||(t.headers["Content-Type"]="application/xml"),OpenLayers.Request.issue(t)},DELETE:function(t){return t=OpenLayers.Util.extend(t,{method:"DELETE"}),OpenLayers.Request.issue(t)},HEAD:function(t){return t=OpenLayers.Util.extend(t,{method:"HEAD"}),OpenLayers.Request.issue(t)},OPTIONS:function(t){return t=OpenLayers.Util.extend(t,{method:"OPTIONS"}),OpenLayers.Request.issue(t)}}),function(){function t(){this._object=a&&!u?new a:new window.ActiveXObject("Microsoft.XMLHTTP"),this._listeners=[]}function e(){return new t}function i(t){if(t._object.send(t._data),l&&!t._async)for(t.readyState=e.OPENED,r(t);t.readyState<e.DONE;)if(t.readyState++,n(t),t._aborted)return}function n(t){e.onreadystatechange&&e.onreadystatechange.apply(t),t.dispatchEvent({type:"readystatechange",bubbles:!1,cancelable:!1,timeStamp:new Date+0})}function s(t){var e=t.responseXML,i=t.responseText;return h&&i&&e&&!e.documentElement&&t.getResponseHeader("Content-Type").match(/[^\/]+\/[^\+]+\+xml/)&&(e=new window.ActiveXObject("Microsoft.XMLDOM"),e.async=!1,e.validateOnParse=!1,e.loadXML(i)),e&&(h&&0!=e.parseError||!e.documentElement||e.documentElement&&"parsererror"==e.documentElement.tagName)?null:e}function r(t){try{t.responseText=t._object.responseText}catch(e){}try{t.responseXML=s(t._object)}catch(e){}try{t.status=t._object.status}catch(e){}try{t.statusText=t._object.statusText}catch(e){}}function o(t){t._object.onreadystatechange=new window.Function}var a=window.XMLHttpRequest,l=!!window.controllers,h=window.document.all&&!window.opera,u=h&&window.navigator.userAgent.match(/MSIE 7.0/);e.prototype=t.prototype,l&&a.wrapped&&(e.wrapped=a.wrapped),e.UNSENT=0,e.OPENED=1,e.HEADERS_RECEIVED=2,e.LOADING=3,e.DONE=4,e.prototype.readyState=e.UNSENT,e.prototype.responseText="",e.prototype.responseXML=null,e.prototype.status=0,e.prototype.statusText="",e.prototype.priority="NORMAL",e.prototype.onreadystatechange=null,e.onreadystatechange=null,e.onopen=null,e.onsend=null,e.onabort=null,e.prototype.open=function(t,i,s,a,u){delete this._headers,arguments.length<3&&(s=!0),this._async=s;var p,c=this,d=this.readyState;h&&s&&(p=function(){d!=e.DONE&&(o(c),c.abort())},window.attachEvent("onunload",p)),e.onopen&&e.onopen.apply(this,arguments),arguments.length>4?this._object.open(t,i,s,a,u):arguments.length>3?this._object.open(t,i,s,a):this._object.open(t,i,s),this.readyState=e.OPENED,n(this),this._object.onreadystatechange=function(){if(!l||s){if(c.readyState=c._object.readyState,r(c),c._aborted)return void(c.readyState=e.UNSENT);c.readyState==e.DONE&&(delete c._data,o(c),h&&s&&window.detachEvent("onunload",p)),d!=c.readyState&&n(c),d=c.readyState}}},e.prototype.send=function(t){e.onsend&&e.onsend.apply(this,arguments),arguments.length||(t=null),t&&t.nodeType&&(t=window.XMLSerializer?(new window.XMLSerializer).serializeToString(t):t.xml,this._headers["Content-Type"]||this._object.setRequestHeader("Content-Type","application/xml")),this._data=t,i(this)},e.prototype.abort=function(){e.onabort&&e.onabort.apply(this,arguments),this.readyState>e.UNSENT&&(this._aborted=!0),this._object.abort(),o(this),this.readyState=e.UNSENT,delete this._data},e.prototype.getAllResponseHeaders=function(){return this._object.getAllResponseHeaders()},e.prototype.getResponseHeader=function(t){return this._object.getResponseHeader(t)},e.prototype.setRequestHeader=function(t,e){return this._headers||(this._headers={}),this._headers[t]=e,this._object.setRequestHeader(t,e)},e.prototype.addEventListener=function(t,e,i){for(var n,s=0;n=this._listeners[s];s++)if(n[0]==t&&n[1]==e&&n[2]==i)return;this._listeners.push([t,e,i])},e.prototype.removeEventListener=function(t,e,i){for(var n,s=0;(n=this._listeners[s])&&(n[0]!=t||n[1]!=e||n[2]!=i);s++);n&&this._listeners.splice(s,1)},e.prototype.dispatchEvent=function(t){var e={type:t.type,target:this,currentTarget:this,eventPhase:2,bubbles:t.bubbles,cancelable:t.cancelable,timeStamp:t.timeStamp,stopPropagation:function(){},preventDefault:function(){},initEvent:function(){}};"readystatechange"==e.type&&this.onreadystatechange&&(this.onreadystatechange.handleEvent||this.onreadystatechange).apply(this,[e]);for(var i,n=0;i=this._listeners[n];n++)i[0]!=e.type||i[2]||(i[1].handleEvent||i[1]).apply(this,[e])},e.prototype.toString=function(){return"[object XMLHttpRequest]"},e.toString=function(){return"[XMLHttpRequest]"},window.Function.prototype.apply||(window.Function.prototype.apply=function(t,e){e||(e=[]),t.__func=this,t.__func(e[0],e[1],e[2],e[3],e[4]),delete t.__func}),OpenLayers.Request||(OpenLayers.Request={}),OpenLayers.Request.XMLHttpRequest=e}(),OpenLayers.Projection=OpenLayers.Class({proj:null,projCode:null,titleRegEx:/\+title=[^\+]*/,initialize:function(t,e){OpenLayers.Util.extend(this,e),this.projCode=t,"object"==typeof Proj4js&&(this.proj=new Proj4js.Proj(t))},getCode:function(){return this.proj?this.proj.srsCode:this.projCode},getUnits:function(){return this.proj?this.proj.units:null},toString:function(){return this.getCode()},equals:function(t){var e=t,i=!1;if(e)if(e instanceof OpenLayers.Projection||(e=new OpenLayers.Projection(e)),"object"==typeof Proj4js&&this.proj.defData&&e.proj.defData)i=this.proj.defData.replace(this.titleRegEx,"")==e.proj.defData.replace(this.titleRegEx,"");else if(e.getCode){var n=this.getCode(),s=e.getCode();i=n==s||!!OpenLayers.Projection.transforms[n]&&OpenLayers.Projection.transforms[n][s]===OpenLayers.Projection.nullTransform}return i},destroy:function(){delete this.proj,delete this.projCode},CLASS_NAME:"OpenLayers.Projection"}),OpenLayers.Projection.transforms={},OpenLayers.Projection.defaults={"EPSG:4326":{units:"degrees",maxExtent:[-180,-90,180,90],yx:!0},"CRS:84":{units:"degrees",maxExtent:[-180,-90,180,90]},"EPSG:900913":{units:"m",maxExtent:[-20037508.34,-20037508.34,20037508.34,20037508.34]}},OpenLayers.Projection.addTransform=function(t,e,i){if(i===OpenLayers.Projection.nullTransform){var n=OpenLayers.Projection.defaults[t];n&&!OpenLayers.Projection.defaults[e]&&(OpenLayers.Projection.defaults[e]=n)}OpenLayers.Projection.transforms[t]||(OpenLayers.Projection.transforms[t]={}),OpenLayers.Projection.transforms[t][e]=i},OpenLayers.Projection.transform=function(t,e,i){if(e&&i)if(e instanceof OpenLayers.Projection||(e=new OpenLayers.Projection(e)),i instanceof OpenLayers.Projection||(i=new OpenLayers.Projection(i)),e.proj&&i.proj)t=Proj4js.transform(e.proj,i.proj,t);else{var n=e.getCode(),s=i.getCode(),r=OpenLayers.Projection.transforms;r[n]&&r[n][s]&&r[n][s](t)}return t},OpenLayers.Projection.nullTransform=function(t){return t},function(){function t(t){return t.x=180*t.x/s,t.y=180/Math.PI*(2*Math.atan(Math.exp(t.y/s*Math.PI))-Math.PI/2),t}function e(t){t.x=t.x*s/180;var e=Math.log(Math.tan((90+t.y)*Math.PI/360))/Math.PI*s;return t.y=Math.max(-20037508.34,Math.min(e,20037508.34)),t}function i(i,n){var s,r,o,a,l,h=OpenLayers.Projection.addTransform,u=OpenLayers.Projection.nullTransform;for(s=0,r=n.length;r>s;++s)for(o=n[s],h(i,o,e),h(o,i,t),l=s+1;r>l;++l)a=n[l],h(o,a,u),h(a,o,u)}var n,s=20037508.34,r=["EPSG:900913","EPSG:3857","EPSG:102113","EPSG:102100"],o=["CRS:84","urn:ogc:def:crs:EPSG:6.6:4326","EPSG:4326"];for(n=r.length-1;n>=0;--n)i(r[n],o);for(n=o.length-1;n>=0;--n)i(o[n],r)}(),OpenLayers.Format.KML=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{kml:"http://www.opengis.net/kml/2.2",gx:"http://www.google.com/kml/ext/2.2"},kmlns:"http://earth.google.com/kml/2.0",placemarksDesc:"No description available",foldersName:"OpenLayers export",foldersDesc:"Exported on "+new Date,extractAttributes:!0,kvpAttributes:!1,extractStyles:!1,extractTracks:!1,trackAttributes:null,internalns:null,features:null,styles:null,styleBaseUrl:"",fetched:null,maxDepth:0,initialize:function(t){this.regExes={trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g,kmlColor:/(\w{2})(\w{2})(\w{2})(\w{2})/,kmlIconPalette:/root:\/\/icons\/palette-(\d+)(\.\w+)/,straightBracket:/\$\[(.*?)\]/g},this.externalProjection=new OpenLayers.Projection("EPSG:4326"),OpenLayers.Format.XML.prototype.initialize.apply(this,[t])},read:function(t){this.features=[],this.styles={},this.fetched={};var e={depth:0,styleBaseUrl:this.styleBaseUrl};return this.parseData(t,e)},parseData:function(t,e){"string"==typeof t&&(t=OpenLayers.Format.XML.prototype.read.apply(this,[t]));for(var i=["Link","NetworkLink","Style","StyleMap","Placemark"],n=0,s=i.length;s>n;++n){var r=i[n],o=this.getElementsByTagNameNS(t,"*",r);if(0!=o.length)switch(r.toLowerCase()){case"link":case"networklink":this.parseLinks(o,e);break;case"style":this.extractStyles&&this.parseStyles(o,e);break;case"stylemap":this.extractStyles&&this.parseStyleMaps(o,e);break;case"placemark":this.parseFeatures(o,e)}}return this.features},parseLinks:function(t,e){if(e.depth>=this.maxDepth)return!1;var i=OpenLayers.Util.extend({},e);i.depth++;for(var n=0,s=t.length;s>n;n++){var r=this.parseProperty(t[n],"*","href");if(r&&!this.fetched[r]){this.fetched[r]=!0;var o=this.fetchLink(r);o&&this.parseData(o,i)}}},fetchLink:function(t){var e=OpenLayers.Request.GET({url:t,async:!1});return e?e.responseText:void 0},parseStyles:function(t,e){for(var i=0,n=t.length;n>i;i++){var s=this.parseStyle(t[i]);if(s){var r=(e.styleBaseUrl||"")+"#"+s.id;this.styles[r]=s}}},parseKmlColor:function(t){var e=null;if(t){var i=t.match(this.regExes.kmlColor);i&&(e={color:"#"+i[4]+i[3]+i[2],opacity:parseInt(i[1],16)/255})}return e},parseStyle:function(t){for(var e,i,n={},s=["LineStyle","PolyStyle","IconStyle","BalloonStyle","LabelStyle"],r=0,o=s.length;o>r;++r)if(e=s[r],i=this.getElementsByTagNameNS(t,"*",e)[0])switch(e.toLowerCase()){case"linestyle":var a=this.parseProperty(i,"*","color"),l=this.parseKmlColor(a);l&&(n.strokeColor=l.color,n.strokeOpacity=l.opacity);var h=this.parseProperty(i,"*","width");h&&(n.strokeWidth=h);break;case"polystyle":var a=this.parseProperty(i,"*","color"),l=this.parseKmlColor(a);l&&(n.fillOpacity=l.opacity,n.fillColor=l.color);var u=this.parseProperty(i,"*","fill");"0"==u&&(n.fillColor="none");var p=this.parseProperty(i,"*","outline");"0"==p&&(n.strokeWidth="0");break;case"iconstyle":var c=parseFloat(this.parseProperty(i,"*","scale")||1),h=32*c,d=32*c,m=this.getElementsByTagNameNS(i,"*","Icon")[0];if(m){var f=this.parseProperty(m,"*","href");if(f){var y=this.parseProperty(m,"*","w"),g=this.parseProperty(m,"*","h"),v="http://maps.google.com/mapfiles/kml";!OpenLayers.String.startsWith(f,v)||y||g||(y=64,g=64,c/=2),y=y||g,g=g||y,y&&(h=parseInt(y)*c),g&&(d=parseInt(g)*c);var L=f.match(this.regExes.kmlIconPalette);if(L){var _=L[1],O=L[2],b=this.parseProperty(m,"*","x"),w=this.parseProperty(m,"*","y"),x=b?b/32:0,S=w?7-w/32:7,C=8*S+x;f="http://maps.google.com/mapfiles/kml/pal"+_+"/icon"+C+O}n.graphicOpacity=1,n.externalGraphic=f}}var E=this.getElementsByTagNameNS(i,"*","hotSpot")[0];if(E){var b=parseFloat(E.getAttribute("x")),w=parseFloat(E.getAttribute("y")),P=E.getAttribute("xunits");"pixels"==P?n.graphicXOffset=-b*c:"insetPixels"==P?n.graphicXOffset=-h+b*c:"fraction"==P&&(n.graphicXOffset=-h*b);var M=E.getAttribute("yunits");"pixels"==M?n.graphicYOffset=-d+w*c+1:"insetPixels"==M?n.graphicYOffset=-(w*c)+1:"fraction"==M&&(n.graphicYOffset=-d*(1-w)+1)}n.graphicWidth=h,n.graphicHeight=d;break;case"balloonstyle":var N=OpenLayers.Util.getXmlNodeValue(i);N&&(n.balloonStyle=N.replace(this.regExes.straightBracket,"${$1}"));break;case"labelstyle":var a=this.parseProperty(i,"*","color"),l=this.parseKmlColor(a);l&&(n.fontColor=l.color,n.fontOpacity=l.opacity)}!n.strokeColor&&n.fillColor&&(n.strokeColor=n.fillColor);var T=t.getAttribute("id");return T&&n&&(n.id=T),n},parseStyleMaps:function(t,e){for(var i=0,n=t.length;n>i;i++)for(var s=t[i],r=this.getElementsByTagNameNS(s,"*","Pair"),o=s.getAttribute("id"),a=0,l=r.length;l>a;a++){var h=r[a],u=this.parseProperty(h,"*","key"),p=this.parseProperty(h,"*","styleUrl");p&&"normal"==u&&(this.styles[(e.styleBaseUrl||"")+"#"+o]=this.styles[(e.styleBaseUrl||"")+p])}},parseFeatures:function(t,e){for(var i=[],n=0,s=t.length;s>n;n++){var r=t[n],o=this.parseFeature.apply(this,[r]);if(!o)throw"Bad Placemark: "+n;if(this.extractStyles&&o.attributes&&o.attributes.styleUrl&&(o.style=this.getStyle(o.attributes.styleUrl,e)),this.extractStyles){var a=this.getElementsByTagNameNS(r,"*","Style")[0];if(a){var l=this.parseStyle(a);l&&(o.style=OpenLayers.Util.extend(o.style,l))}}if(this.extractTracks){var h=this.getElementsByTagNameNS(r,this.namespaces.gx,"Track");if(h&&h.length>0){var u=h[0],p={features:[],feature:o};this.readNode(u,p),p.features.length>0&&i.push.apply(i,p.features)}}else i.push(o)}this.features=this.features.concat(i)},readers:{kml:{when:function(t,e){e.whens.push(OpenLayers.Date.parse(this.getChildValue(t)))},_trackPointAttribute:function(t,e){var i=t.nodeName.split(":").pop();e.attributes[i].push(this.getChildValue(t))}},gx:{Track:function(t,e){var i={whens:[],points:[],angles:[]};if(this.trackAttributes){var n;i.attributes={};for(var s=0,r=this.trackAttributes.length;r>s;++s)n=this.trackAttributes[s],i.attributes[n]=[],n in this.readers.kml||(this.readers.kml[n]=this.readers.kml._trackPointAttribute)}if(this.readChildNodes(t,i),i.whens.length!==i.points.length)throw new Error("gx:Track with unequal number of when ("+i.whens.length+") and gx:coord ("+i.points.length+") elements.");var o=i.angles.length>0;if(o&&i.whens.length!==i.angles.length)throw new Error("gx:Track with unequal number of when ("+i.whens.length+") and gx:angles ("+i.angles.length+") elements.");for(var a,l,h,s=0,r=i.whens.length;r>s;++s){if(a=e.feature.clone(),a.fid=e.feature.fid||e.feature.id,l=i.points[s],a.geometry=l,"z"in l&&(a.attributes.altitude=l.z),this.internalProjection&&this.externalProjection&&a.geometry.transform(this.externalProjection,this.internalProjection),this.trackAttributes)for(var u=0,p=this.trackAttributes.length;p>u;++u){var n=this.trackAttributes[u];a.attributes[n]=i.attributes[n][s]}a.attributes.when=i.whens[s],a.attributes.trackId=e.feature.id,o&&(h=i.angles[s],a.attributes.heading=parseFloat(h[0]),a.attributes.tilt=parseFloat(h[1]),a.attributes.roll=parseFloat(h[2])),e.features.push(a)}},coord:function(t,e){var i=this.getChildValue(t),n=i.replace(this.regExes.trimSpace,"").split(/\s+/),s=new OpenLayers.Geometry.Point(n[0],n[1]);n.length>2&&(s.z=parseFloat(n[2])),e.points.push(s)},angles:function(t,e){var i=this.getChildValue(t),n=i.replace(this.regExes.trimSpace,"").split(/\s+/);e.angles.push(n)}}},parseFeature:function(t){for(var e,i,n,s,r=["MultiGeometry","Polygon","LineString","Point"],o=0,a=r.length;a>o;++o)if(e=r[o],this.internalns=t.namespaceURI?t.namespaceURI:this.kmlns,i=this.getElementsByTagNameNS(t,this.internalns,e),i.length>0){var s=this.parseGeometry[e.toLowerCase()];if(!s)throw new TypeError("Unsupported geometry type: "+e);n=s.apply(this,[i[0]]),this.internalProjection&&this.externalProjection&&n.transform(this.externalProjection,this.internalProjection);break}var l;this.extractAttributes&&(l=this.parseAttributes(t));var h=new OpenLayers.Feature.Vector(n,l),u=t.getAttribute("id")||t.getAttribute("name");return null!=u&&(h.fid=u),h},getStyle:function(t,e){var i=OpenLayers.Util.removeTail(t),n=OpenLayers.Util.extend({},e);if(n.depth++,n.styleBaseUrl=i,!this.styles[t]&&!OpenLayers.String.startsWith(t,"#")&&n.depth<=this.maxDepth&&!this.fetched[i]){var s=this.fetchLink(i);s&&this.parseData(s,n)}var r=OpenLayers.Util.extend({},this.styles[t]);return r},parseGeometry:{point:function(t){var e=this.getElementsByTagNameNS(t,this.internalns,"coordinates"),i=[];if(e.length>0){var n=e[0].firstChild.nodeValue;n=n.replace(this.regExes.removeSpace,""),i=n.split(",")}var s=null;if(!(i.length>1))throw"Bad coordinate string: "+n;return 2==i.length&&(i[2]=null),s=new OpenLayers.Geometry.Point(i[0],i[1],i[2])},linestring:function(t,e){var i=this.getElementsByTagNameNS(t,this.internalns,"coordinates"),n=null;if(i.length>0){var s=this.getChildValue(i[0]);s=s.replace(this.regExes.trimSpace,""),s=s.replace(this.regExes.trimComma,",");for(var r,o,a=s.split(this.regExes.splitSpace),l=a.length,h=new Array(l),u=0;l>u;++u){if(r=a[u].split(","),o=r.length,!(o>1))throw"Bad LineString point coordinates: "+a[u];2==r.length&&(r[2]=null),h[u]=new OpenLayers.Geometry.Point(r[0],r[1],r[2])}if(!l)throw"Bad LineString coordinates: "+s;n=e?new OpenLayers.Geometry.LinearRing(h):new OpenLayers.Geometry.LineString(h)}return n},polygon:function(t){var e=this.getElementsByTagNameNS(t,this.internalns,"LinearRing"),i=e.length,n=new Array(i);if(i>0)for(var s,r=0,o=e.length;o>r;++r){if(s=this.parseGeometry.linestring.apply(this,[e[r],!0]),!s)throw"Bad LinearRing geometry: "+r;n[r]=s}return new OpenLayers.Geometry.Polygon(n)},multigeometry:function(t){for(var e,i,n=[],s=t.childNodes,r=0,o=s.length;o>r;++r)if(e=s[r],1==e.nodeType){var a=e.prefix?e.nodeName.split(":")[1]:e.nodeName,i=this.parseGeometry[a.toLowerCase()];i&&n.push(i.apply(this,[e]))}return new OpenLayers.Geometry.Collection(n)}},parseAttributes:function(t){var e={},i=t.getElementsByTagName("ExtendedData");i.length&&(e=this.parseExtendedData(i[0]));for(var n,s,r,o=t.childNodes,a=0,l=o.length;l>a;++a)if(n=o[a],1==n.nodeType&&(s=n.childNodes,s.length>=1&&s.length<=3)){var r;switch(s.length){case 1:r=s[0];break;case 2:var h=s[0],u=s[1];r=3==h.nodeType||4==h.nodeType?h:u;break;case 3:default:r=s[1]}if(3==r.nodeType||4==r.nodeType){var p=n.prefix?n.nodeName.split(":")[1]:n.nodeName,c=OpenLayers.Util.getXmlNodeValue(r);c&&(c=c.replace(this.regExes.trimSpace,""),e[p]=c)}}return e},parseExtendedData:function(t){var e,i,n,s,r={},o=t.getElementsByTagName("Data");for(e=0,i=o.length;i>e;e++){n=o[e],s=n.getAttribute("name");var a={},l=n.getElementsByTagName("value");if(l.length&&(a.value=this.getChildValue(l[0])),this.kvpAttributes)r[s]=a.value;else{var h=n.getElementsByTagName("displayName");h.length&&(a.displayName=this.getChildValue(h[0])),r[s]=a}}var u=t.getElementsByTagName("SimpleData");for(e=0,i=u.length;i>e;e++){var a={};n=u[e],s=n.getAttribute("name"),a.value=this.getChildValue(n),this.kvpAttributes?r[s]=a.value:(a.displayName=s,r[s]=a)}return r},parseProperty:function(t,e,i){var n,s=this.getElementsByTagNameNS(t,e,i);try{n=OpenLayers.Util.getXmlNodeValue(s[0])}catch(r){n=null}return n},write:function(t){OpenLayers.Util.isArray(t)||(t=[t]);for(var e=this.createElementNS(this.kmlns,"kml"),i=this.createFolderXML(),n=0,s=t.length;s>n;++n)i.appendChild(this.createPlacemarkXML(t[n]));return e.appendChild(i),OpenLayers.Format.XML.prototype.write.apply(this,[e])},createFolderXML:function(){var t=this.createElementNS(this.kmlns,"Folder");if(this.foldersName){var e=this.createElementNS(this.kmlns,"name"),i=this.createTextNode(this.foldersName);e.appendChild(i),t.appendChild(e)}if(this.foldersDesc){var n=this.createElementNS(this.kmlns,"description"),s=this.createTextNode(this.foldersDesc);n.appendChild(s),t.appendChild(n)}return t},createPlacemarkXML:function(t){var e=this.createElementNS(this.kmlns,"name"),i=t.style&&t.style.label?t.style.label:t.id,n=t.attributes.name||i;e.appendChild(this.createTextNode(n));var s=this.createElementNS(this.kmlns,"description"),r=t.attributes.description||this.placemarksDesc;s.appendChild(this.createTextNode(r));var o=this.createElementNS(this.kmlns,"Placemark");null!=t.fid&&o.setAttribute("id",t.fid),o.appendChild(e),o.appendChild(s);var a=this.buildGeometryNode(t.geometry);if(o.appendChild(a),t.attributes){var l=this.buildExtendedData(t.attributes);l&&o.appendChild(l)}return o},buildGeometryNode:function(t){var e=t.CLASS_NAME,i=e.substring(e.lastIndexOf(".")+1),n=this.buildGeometry[i.toLowerCase()],s=null;return n&&(s=n.apply(this,[t])),s},buildGeometry:{point:function(t){var e=this.createElementNS(this.kmlns,"Point");return e.appendChild(this.buildCoordinatesNode(t)),e},multipoint:function(t){return this.buildGeometry.collection.apply(this,[t])},linestring:function(t){var e=this.createElementNS(this.kmlns,"LineString");return e.appendChild(this.buildCoordinatesNode(t)),e},multilinestring:function(t){return this.buildGeometry.collection.apply(this,[t])},linearring:function(t){var e=this.createElementNS(this.kmlns,"LinearRing");return e.appendChild(this.buildCoordinatesNode(t)),e},polygon:function(t){for(var e,i,n,s=this.createElementNS(this.kmlns,"Polygon"),r=t.components,o=0,a=r.length;a>o;++o)n=0==o?"outerBoundaryIs":"innerBoundaryIs",e=this.createElementNS(this.kmlns,n),i=this.buildGeometry.linearring.apply(this,[r[o]]),e.appendChild(i),s.appendChild(e);return s},multipolygon:function(t){return this.buildGeometry.collection.apply(this,[t])},collection:function(t){for(var e,i=this.createElementNS(this.kmlns,"MultiGeometry"),n=0,s=t.components.length;s>n;++n)e=this.buildGeometryNode.apply(this,[t.components[n]]),e&&i.appendChild(e);return i}},buildCoordinatesNode:function(t){var e,i=this.createElementNS(this.kmlns,"coordinates"),n=t.components;if(n){for(var s,r=n.length,o=new Array(r),a=0;r>a;++a)s=n[a],o[a]=this.buildCoordinates(s);
e=o.join(" ")}else e=this.buildCoordinates(t);var l=this.createTextNode(e);return i.appendChild(l),i},buildCoordinates:function(t){return this.internalProjection&&this.externalProjection&&(t=t.clone(),t.transform(this.internalProjection,this.externalProjection)),t.x+","+t.y},buildExtendedData:function(t){var e=this.createElementNS(this.kmlns,"ExtendedData");for(var i in t)if(t[i]&&"name"!=i&&"description"!=i&&"styleUrl"!=i){var n=this.createElementNS(this.kmlns,"Data");n.setAttribute("name",i);var s=this.createElementNS(this.kmlns,"value");if("object"==typeof t[i]){if(t[i].value&&s.appendChild(this.createTextNode(t[i].value)),t[i].displayName){var r=this.createElementNS(this.kmlns,"displayName");r.appendChild(this.getXMLDoc().createCDATASection(t[i].displayName)),n.appendChild(r)}}else s.appendChild(this.createTextNode(t[i]));n.appendChild(s),e.appendChild(n)}return this.isSimpleContent(e)?null:e},CLASS_NAME:"OpenLayers.Format.KML"}),OpenLayers.Geometry.MultiLineString=OpenLayers.Class(OpenLayers.Geometry.Collection,{componentTypes:["OpenLayers.Geometry.LineString"],split:function(t,e){for(var i,n,s,r,o,a=null,l=e&&e.mutual,h=[],u=[t],p=0,c=this.components.length;c>p;++p){n=this.components[p],r=!1;for(var d=0;d<u.length;++d)if(i=n.split(u[d],e)){if(l){s=i[0];for(var m=0,f=s.length;f>m;++m)0===m&&h.length?h[h.length-1].addComponent(s[m]):h.push(new OpenLayers.Geometry.MultiLineString([s[m]]));r=!0,i=i[1]}if(i.length){i.unshift(d,1),Array.prototype.splice.apply(u,i);break}}r||(h.length?h[h.length-1].addComponent(n.clone()):h=[new OpenLayers.Geometry.MultiLineString(n.clone())])}return h&&h.length>1?r=!0:h=[],u&&u.length>1?o=!0:u=[],(r||o)&&(a=l?[h,u]:u),a},splitWith:function(t,e){var i,n,s,r,o,a,l,h=null,u=e&&e.mutual;if(t instanceof OpenLayers.Geometry.LineString){l=[],a=[t];for(var p=0,c=this.components.length;c>p;++p){o=!1,n=this.components[p];for(var d=0;d<a.length;++d)if(i=a[d].split(n,e)){u&&(s=i[0],s.length&&(s.unshift(d,1),Array.prototype.splice.apply(a,s),d+=s.length-2),i=i[1],0===i.length&&(i=[n.clone()]));for(var m=0,f=i.length;f>m;++m)0===m&&l.length?l[l.length-1].addComponent(i[m]):l.push(new OpenLayers.Geometry.MultiLineString([i[m]]));o=!0}o||(l.length?l[l.length-1].addComponent(n.clone()):l=[new OpenLayers.Geometry.MultiLineString([n.clone()])])}}else h=t.split(this);return a&&a.length>1?r=!0:a=[],l&&l.length>1?o=!0:l=[],(r||o)&&(h=u?[a,l]:l),h},CLASS_NAME:"OpenLayers.Geometry.MultiLineString"}),OpenLayers.Geometry.MultiPolygon=OpenLayers.Class(OpenLayers.Geometry.Collection,{componentTypes:["OpenLayers.Geometry.Polygon"],CLASS_NAME:"OpenLayers.Geometry.MultiPolygon"}),OpenLayers.Format.GML=OpenLayers.Class(OpenLayers.Format.XML,{featureNS:"http://mapserver.gis.umn.edu/mapserver",featurePrefix:"feature",featureName:"featureMember",layerName:"features",geometryName:"geometry",collectionName:"FeatureCollection",gmlns:"http://www.opengis.net/gml",extractAttributes:!0,xy:!0,initialize:function(t){this.regExes={trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},OpenLayers.Format.XML.prototype.initialize.apply(this,[t])},read:function(t){"string"==typeof t&&(t=OpenLayers.Format.XML.prototype.read.apply(this,[t]));for(var e=this.getElementsByTagNameNS(t.documentElement,this.gmlns,this.featureName),i=[],n=0;n<e.length;n++){var s=this.parseFeature(e[n]);s&&i.push(s)}return i},parseFeature:function(t){for(var e,i,n,s,r=["MultiPolygon","Polygon","MultiLineString","LineString","MultiPoint","Point","Envelope"],o=0;o<r.length;++o)if(e=r[o],i=this.getElementsByTagNameNS(t,this.gmlns,e),i.length>0){if(s=this.parseGeometry[e.toLowerCase()],!s)throw new TypeError("Unsupported geometry type: "+e);n=s.apply(this,[i[0]]),this.internalProjection&&this.externalProjection&&n.transform(this.externalProjection,this.internalProjection);break}var a,l=this.getElementsByTagNameNS(t,this.gmlns,"Box");for(o=0;o<l.length;++o){var h=l[o],u=this.parseGeometry.box.apply(this,[h]),p=h.parentNode,c=p.localName||p.nodeName.split(":").pop();"boundedBy"===c?a=u:n=u.toGeometry()}var d;this.extractAttributes&&(d=this.parseAttributes(t));var m=new OpenLayers.Feature.Vector(n,d);m.bounds=a,m.gml={featureType:t.firstChild.nodeName.split(":")[1],featureNS:t.firstChild.namespaceURI,featureNSPrefix:t.firstChild.prefix};for(var f,y=t.firstChild;y&&(1!=y.nodeType||!(f=y.getAttribute("fid")||y.getAttribute("id")));)y=y.nextSibling;return m.fid=f,m},parseGeometry:{point:function(t){var e,i,n=[],e=this.getElementsByTagNameNS(t,this.gmlns,"pos");if(e.length>0&&(i=e[0].firstChild.nodeValue,i=i.replace(this.regExes.trimSpace,""),n=i.split(this.regExes.splitSpace)),0==n.length&&(e=this.getElementsByTagNameNS(t,this.gmlns,"coordinates"),e.length>0&&(i=e[0].firstChild.nodeValue,i=i.replace(this.regExes.removeSpace,""),n=i.split(","))),0==n.length&&(e=this.getElementsByTagNameNS(t,this.gmlns,"coord"),e.length>0)){var s=this.getElementsByTagNameNS(e[0],this.gmlns,"X"),r=this.getElementsByTagNameNS(e[0],this.gmlns,"Y");s.length>0&&r.length>0&&(n=[s[0].firstChild.nodeValue,r[0].firstChild.nodeValue])}return 2==n.length&&(n[2]=null),this.xy?new OpenLayers.Geometry.Point(n[0],n[1],n[2]):new OpenLayers.Geometry.Point(n[1],n[0],n[2])},multipoint:function(t){var e=this.getElementsByTagNameNS(t,this.gmlns,"Point"),i=[];if(e.length>0)for(var n,s=0;s<e.length;++s)n=this.parseGeometry.point.apply(this,[e[s]]),n&&i.push(n);return new OpenLayers.Geometry.MultiPoint(i)},linestring:function(t,e){var i,n,s=[],r=[];if(i=this.getElementsByTagNameNS(t,this.gmlns,"posList"),i.length>0){n=this.getChildValue(i[0]),n=n.replace(this.regExes.trimSpace,""),s=n.split(this.regExes.splitSpace);for(var o,a,l,h,u=parseInt(i[0].getAttribute("dimension")),p=0;p<s.length/u;++p)o=p*u,a=s[o],l=s[o+1],h=2==u?null:s[o+2],r.push(this.xy?new OpenLayers.Geometry.Point(a,l,h):new OpenLayers.Geometry.Point(l,a,h))}if(0==s.length&&(i=this.getElementsByTagNameNS(t,this.gmlns,"coordinates"),i.length>0)){n=this.getChildValue(i[0]),n=n.replace(this.regExes.trimSpace,""),n=n.replace(this.regExes.trimComma,",");for(var c=n.split(this.regExes.splitSpace),p=0;p<c.length;++p)s=c[p].split(","),2==s.length&&(s[2]=null),r.push(this.xy?new OpenLayers.Geometry.Point(s[0],s[1],s[2]):new OpenLayers.Geometry.Point(s[1],s[0],s[2]))}var d=null;return 0!=r.length&&(d=e?new OpenLayers.Geometry.LinearRing(r):new OpenLayers.Geometry.LineString(r)),d},multilinestring:function(t){var e=this.getElementsByTagNameNS(t,this.gmlns,"LineString"),i=[];if(e.length>0)for(var n,s=0;s<e.length;++s)n=this.parseGeometry.linestring.apply(this,[e[s]]),n&&i.push(n);return new OpenLayers.Geometry.MultiLineString(i)},polygon:function(t){var e=this.getElementsByTagNameNS(t,this.gmlns,"LinearRing"),i=[];if(e.length>0)for(var n,s=0;s<e.length;++s)n=this.parseGeometry.linestring.apply(this,[e[s],!0]),n&&i.push(n);return new OpenLayers.Geometry.Polygon(i)},multipolygon:function(t){var e=this.getElementsByTagNameNS(t,this.gmlns,"Polygon"),i=[];if(e.length>0)for(var n,s=0;s<e.length;++s)n=this.parseGeometry.polygon.apply(this,[e[s]]),n&&i.push(n);return new OpenLayers.Geometry.MultiPolygon(i)},envelope:function(t){var e,i,n=[],s=this.getElementsByTagNameNS(t,this.gmlns,"lowerCorner");if(s.length>0){var r=[];if(s.length>0&&(e=s[0].firstChild.nodeValue,e=e.replace(this.regExes.trimSpace,""),r=e.split(this.regExes.splitSpace)),2==r.length&&(r[2]=null),this.xy)var o=new OpenLayers.Geometry.Point(r[0],r[1],r[2]);else var o=new OpenLayers.Geometry.Point(r[1],r[0],r[2])}var a=this.getElementsByTagNameNS(t,this.gmlns,"upperCorner");if(a.length>0){var r=[];if(a.length>0&&(e=a[0].firstChild.nodeValue,e=e.replace(this.regExes.trimSpace,""),r=e.split(this.regExes.splitSpace)),2==r.length&&(r[2]=null),this.xy)var l=new OpenLayers.Geometry.Point(r[0],r[1],r[2]);else var l=new OpenLayers.Geometry.Point(r[1],r[0],r[2])}if(o&&l){n.push(new OpenLayers.Geometry.Point(o.x,o.y)),n.push(new OpenLayers.Geometry.Point(l.x,o.y)),n.push(new OpenLayers.Geometry.Point(l.x,l.y)),n.push(new OpenLayers.Geometry.Point(o.x,l.y)),n.push(new OpenLayers.Geometry.Point(o.x,o.y));var h=new OpenLayers.Geometry.LinearRing(n);i=new OpenLayers.Geometry.Polygon([h])}return i},box:function(t){var e,i,n=this.getElementsByTagNameNS(t,this.gmlns,"coordinates"),s=null,r=null;return n.length>0&&(e=n[0].firstChild.nodeValue,i=e.split(" "),2==i.length&&(s=i[0].split(","),r=i[1].split(","))),null!==s&&null!==r?new OpenLayers.Bounds(parseFloat(s[0]),parseFloat(s[1]),parseFloat(r[0]),parseFloat(r[1])):void 0}},parseAttributes:function(t){for(var e,i,n,s,r,o,a,l={},h=t.firstChild;h;){if(1==h.nodeType){for(e=h.childNodes,i=0;i<e.length;++i)n=e[i],1==n.nodeType&&(s=n.childNodes,1==s.length?(r=s[0],(3==r.nodeType||4==r.nodeType)&&(o=n.prefix?n.nodeName.split(":")[1]:n.nodeName,a=r.nodeValue.replace(this.regExes.trimSpace,""),l[o]=a)):l[n.nodeName.split(":").pop()]=null);break}h=h.nextSibling}return l},write:function(t){OpenLayers.Util.isArray(t)||(t=[t]);for(var e=this.createElementNS("http://www.opengis.net/wfs","wfs:"+this.collectionName),i=0;i<t.length;i++)e.appendChild(this.createFeatureXML(t[i]));return OpenLayers.Format.XML.prototype.write.apply(this,[e])},createFeatureXML:function(t){var e=t.geometry,i=this.buildGeometryNode(e),n=this.createElementNS(this.featureNS,this.featurePrefix+":"+this.geometryName);n.appendChild(i);var s=this.createElementNS(this.gmlns,"gml:"+this.featureName),r=this.createElementNS(this.featureNS,this.featurePrefix+":"+this.layerName),o=t.fid||t.id;r.setAttribute("fid",o),r.appendChild(n);for(var a in t.attributes){var l=this.createTextNode(t.attributes[a]),h=a.substring(a.lastIndexOf(":")+1),u=this.createElementNS(this.featureNS,this.featurePrefix+":"+h);u.appendChild(l),r.appendChild(u)}return s.appendChild(r),s},buildGeometryNode:function(t){this.externalProjection&&this.internalProjection&&(t=t.clone(),t.transform(this.internalProjection,this.externalProjection));var e=t.CLASS_NAME,i=e.substring(e.lastIndexOf(".")+1),n=this.buildGeometry[i.toLowerCase()];return n.apply(this,[t])},buildGeometry:{point:function(t){var e=this.createElementNS(this.gmlns,"gml:Point");return e.appendChild(this.buildCoordinatesNode(t)),e},multipoint:function(t){for(var e,i,n=this.createElementNS(this.gmlns,"gml:MultiPoint"),s=t.components,r=0;r<s.length;r++)e=this.createElementNS(this.gmlns,"gml:pointMember"),i=this.buildGeometry.point.apply(this,[s[r]]),e.appendChild(i),n.appendChild(e);return n},linestring:function(t){var e=this.createElementNS(this.gmlns,"gml:LineString");return e.appendChild(this.buildCoordinatesNode(t)),e},multilinestring:function(t){for(var e,i,n=this.createElementNS(this.gmlns,"gml:MultiLineString"),s=t.components,r=0;r<s.length;++r)e=this.createElementNS(this.gmlns,"gml:lineStringMember"),i=this.buildGeometry.linestring.apply(this,[s[r]]),e.appendChild(i),n.appendChild(e);return n},linearring:function(t){var e=this.createElementNS(this.gmlns,"gml:LinearRing");return e.appendChild(this.buildCoordinatesNode(t)),e},polygon:function(t){for(var e,i,n,s=this.createElementNS(this.gmlns,"gml:Polygon"),r=t.components,o=0;o<r.length;++o)n=0==o?"outerBoundaryIs":"innerBoundaryIs",e=this.createElementNS(this.gmlns,"gml:"+n),i=this.buildGeometry.linearring.apply(this,[r[o]]),e.appendChild(i),s.appendChild(e);return s},multipolygon:function(t){for(var e,i,n=this.createElementNS(this.gmlns,"gml:MultiPolygon"),s=t.components,r=0;r<s.length;++r)e=this.createElementNS(this.gmlns,"gml:polygonMember"),i=this.buildGeometry.polygon.apply(this,[s[r]]),e.appendChild(i),n.appendChild(e);return n},bounds:function(t){var e=this.createElementNS(this.gmlns,"gml:Box");return e.appendChild(this.buildCoordinatesNode(t)),e}},buildCoordinatesNode:function(t){var e=this.createElementNS(this.gmlns,"gml:coordinates");e.setAttribute("decimal","."),e.setAttribute("cs",","),e.setAttribute("ts"," ");var i=[];if(t instanceof OpenLayers.Bounds)i.push(t.left+","+t.bottom),i.push(t.right+","+t.top);else for(var n=t.components?t.components:[t],s=0;s<n.length;s++)i.push(n[s].x+","+n[s].y);var r=this.createTextNode(i.join(" "));return e.appendChild(r),e},CLASS_NAME:"OpenLayers.Format.GML"}),OpenLayers.Format.GML||(OpenLayers.Format.GML={}),OpenLayers.Format.GML.Base=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{gml:"http://www.opengis.net/gml",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance",wfs:"http://www.opengis.net/wfs"},defaultPrefix:"gml",schemaLocation:null,featureType:null,featureNS:null,geometryName:"geometry",extractAttributes:!0,srsName:null,xy:!0,geometryTypes:null,singleFeatureType:null,regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g,featureMember:/^(.*:)?featureMembers?$/},initialize:function(t){OpenLayers.Format.XML.prototype.initialize.apply(this,[t]),this.setGeometryTypes(),t&&t.featureNS&&this.setNamespace("feature",t.featureNS),this.singleFeatureType=!t||"string"==typeof t.featureType},read:function(t){"string"==typeof t&&(t=OpenLayers.Format.XML.prototype.read.apply(this,[t])),t&&9==t.nodeType&&(t=t.documentElement);var e=[];if(this.readNode(t,{features:e},!0),0==e.length){var i=this.getElementsByTagNameNS(t,this.namespaces.gml,"featureMember");if(i.length)for(var n=0,s=i.length;s>n;++n)this.readNode(i[n],{features:e},!0);else{var i=this.getElementsByTagNameNS(t,this.namespaces.gml,"featureMembers");i.length&&this.readNode(i[0],{features:e},!0)}}return e},readNode:function(t,e,i){return i===!0&&this.autoConfig===!0&&(this.featureType=null,delete this.namespaceAlias[this.featureNS],delete this.namespaces.feature,this.featureNS=null),this.featureNS||t.prefix in this.namespaces||t.parentNode.namespaceURI!=this.namespaces.gml||!this.regExes.featureMember.test(t.parentNode.nodeName)||(this.featureType=t.nodeName.split(":").pop(),this.setNamespace("feature",t.namespaceURI),this.featureNS=t.namespaceURI,this.autoConfig=!0),OpenLayers.Format.XML.prototype.readNode.apply(this,[t,e])},readers:{gml:{_inherit:function(){},featureMember:function(t,e){this.readChildNodes(t,e)},featureMembers:function(t,e){this.readChildNodes(t,e)},name:function(t,e){e.name=this.getChildValue(t)},boundedBy:function(t,e){var i={};this.readChildNodes(t,i),i.components&&i.components.length>0&&(e.bounds=i.components[0])},Point:function(t,e){var i={points:[]};this.readChildNodes(t,i),e.components||(e.components=[]),e.components.push(i.points[0])},coordinates:function(t,e){var i=this.getChildValue(t).replace(this.regExes.trimSpace,"");i=i.replace(this.regExes.trimComma,",");for(var n,s=i.split(this.regExes.splitSpace),r=s.length,o=new Array(r),a=0;r>a;++a)n=s[a].split(","),o[a]=this.xy?new OpenLayers.Geometry.Point(n[0],n[1],n[2]):new OpenLayers.Geometry.Point(n[1],n[0],n[2]);e.points=o},coord:function(t,e){var i={};this.readChildNodes(t,i),e.points||(e.points=[]),e.points.push(new OpenLayers.Geometry.Point(i.x,i.y,i.z))},X:function(t,e){e.x=this.getChildValue(t)},Y:function(t,e){e.y=this.getChildValue(t)},Z:function(t,e){e.z=this.getChildValue(t)},MultiPoint:function(t,e){var i={components:[]};this.readers.gml._inherit.apply(this,[t,i,e]),this.readChildNodes(t,i),e.components=[new OpenLayers.Geometry.MultiPoint(i.components)]},pointMember:function(t,e){this.readChildNodes(t,e)},LineString:function(t,e){var i={};this.readers.gml._inherit.apply(this,[t,i,e]),this.readChildNodes(t,i),e.components||(e.components=[]),e.components.push(new OpenLayers.Geometry.LineString(i.points))},MultiLineString:function(t,e){var i={components:[]};this.readers.gml._inherit.apply(this,[t,i,e]),this.readChildNodes(t,i),e.components=[new OpenLayers.Geometry.MultiLineString(i.components)]},lineStringMember:function(t,e){this.readChildNodes(t,e)},Polygon:function(t,e){var i={outer:null,inner:[]};this.readers.gml._inherit.apply(this,[t,i,e]),this.readChildNodes(t,i),i.inner.unshift(i.outer),e.components||(e.components=[]),e.components.push(new OpenLayers.Geometry.Polygon(i.inner))},LinearRing:function(t,e){var i={};this.readers.gml._inherit.apply(this,[t,i]),this.readChildNodes(t,i),e.components=[new OpenLayers.Geometry.LinearRing(i.points)]},MultiPolygon:function(t,e){var i={components:[]};this.readers.gml._inherit.apply(this,[t,i,e]),this.readChildNodes(t,i),e.components=[new OpenLayers.Geometry.MultiPolygon(i.components)]},polygonMember:function(t,e){this.readChildNodes(t,e)},GeometryCollection:function(t,e){var i={components:[]};this.readers.gml._inherit.apply(this,[t,i,e]),this.readChildNodes(t,i),e.components=[new OpenLayers.Geometry.Collection(i.components)]},geometryMember:function(t,e){this.readChildNodes(t,e)}},feature:{"*":function(t,e){var i,n=t.localName||t.nodeName.split(":").pop();e.features?this.singleFeatureType||-1===OpenLayers.Util.indexOf(this.featureType,n)?n===this.featureType&&(i="_typeName"):i="_typeName":0==t.childNodes.length||1==t.childNodes.length&&3==t.firstChild.nodeType?this.extractAttributes&&(i="_attribute"):i="_geometry",i&&this.readers.feature[i].apply(this,[t,e])},_typeName:function(t,e){var i={components:[],attributes:{}};this.readChildNodes(t,i),i.name&&(i.attributes.name=i.name);var n=new OpenLayers.Feature.Vector(i.components[0],i.attributes);this.singleFeatureType||(n.type=t.nodeName.split(":").pop(),n.namespace=t.namespaceURI);var s=t.getAttribute("fid")||this.getAttributeNS(t,this.namespaces.gml,"id");s&&(n.fid=s),this.internalProjection&&this.externalProjection&&n.geometry&&n.geometry.transform(this.externalProjection,this.internalProjection),i.bounds&&(n.bounds=i.bounds),e.features.push(n)},_geometry:function(t,e){this.geometryName||(this.geometryName=t.nodeName.split(":").pop()),this.readChildNodes(t,e)},_attribute:function(t,e){var i=t.localName||t.nodeName.split(":").pop(),n=this.getChildValue(t);e.attributes[i]=n}},wfs:{FeatureCollection:function(t,e){this.readChildNodes(t,e)}}},write:function(t){var e;e=OpenLayers.Util.isArray(t)?"featureMembers":"featureMember";var i=this.writeNode("gml:"+e,t);return this.setAttributeNS(i,this.namespaces.xsi,"xsi:schemaLocation",this.schemaLocation),OpenLayers.Format.XML.prototype.write.apply(this,[i])},writers:{gml:{featureMember:function(t){var e=this.createElementNSPlus("gml:featureMember");return this.writeNode("feature:_typeName",t,e),e},MultiPoint:function(t){for(var e=this.createElementNSPlus("gml:MultiPoint"),i=t.components||[t],n=0,s=i.length;s>n;++n)this.writeNode("pointMember",i[n],e);return e},pointMember:function(t){var e=this.createElementNSPlus("gml:pointMember");return this.writeNode("Point",t,e),e},MultiLineString:function(t){for(var e=this.createElementNSPlus("gml:MultiLineString"),i=t.components||[t],n=0,s=i.length;s>n;++n)this.writeNode("lineStringMember",i[n],e);return e},lineStringMember:function(t){var e=this.createElementNSPlus("gml:lineStringMember");return this.writeNode("LineString",t,e),e},MultiPolygon:function(t){for(var e=this.createElementNSPlus("gml:MultiPolygon"),i=t.components||[t],n=0,s=i.length;s>n;++n)this.writeNode("polygonMember",i[n],e);return e},polygonMember:function(t){var e=this.createElementNSPlus("gml:polygonMember");return this.writeNode("Polygon",t,e),e},GeometryCollection:function(t){for(var e=this.createElementNSPlus("gml:GeometryCollection"),i=0,n=t.components.length;n>i;++i)this.writeNode("geometryMember",t.components[i],e);return e},geometryMember:function(t){var e=this.createElementNSPlus("gml:geometryMember"),i=this.writeNode("feature:_geometry",t);return e.appendChild(i.firstChild),e}},feature:{_typeName:function(t){var e=this.createElementNSPlus("feature:"+this.featureType,{attributes:{fid:t.fid}});t.geometry&&this.writeNode("feature:_geometry",t.geometry,e);for(var i in t.attributes){var n=t.attributes[i];null!=n&&this.writeNode("feature:_attribute",{name:i,value:n},e)}return e},_geometry:function(t){this.externalProjection&&this.internalProjection&&(t=t.clone().transform(this.internalProjection,this.externalProjection));var e=this.createElementNSPlus("feature:"+this.geometryName),i=this.geometryTypes[t.CLASS_NAME],n=this.writeNode("gml:"+i,t,e);return this.srsName&&n.setAttribute("srsName",this.srsName),e},_attribute:function(t){return this.createElementNSPlus("feature:"+t.name,{value:t.value})}},wfs:{FeatureCollection:function(t){for(var e=this.createElementNSPlus("wfs:FeatureCollection"),i=0,n=t.length;n>i;++i)this.writeNode("gml:featureMember",t[i],e);return e}}},setGeometryTypes:function(){this.geometryTypes={"OpenLayers.Geometry.Point":"Point","OpenLayers.Geometry.MultiPoint":"MultiPoint","OpenLayers.Geometry.LineString":"LineString","OpenLayers.Geometry.MultiLineString":"MultiLineString","OpenLayers.Geometry.Polygon":"Polygon","OpenLayers.Geometry.MultiPolygon":"MultiPolygon","OpenLayers.Geometry.Collection":"GeometryCollection"}},CLASS_NAME:"OpenLayers.Format.GML.Base"}),OpenLayers.Format.GML.v2=OpenLayers.Class(OpenLayers.Format.GML.Base,{schemaLocation:"http://www.opengis.net/gml http://schemas.opengis.net/gml/2.1.2/feature.xsd",initialize:function(t){OpenLayers.Format.GML.Base.prototype.initialize.apply(this,[t])},readers:{gml:OpenLayers.Util.applyDefaults({outerBoundaryIs:function(t,e){var i={};this.readChildNodes(t,i),e.outer=i.components[0]},innerBoundaryIs:function(t,e){var i={};this.readChildNodes(t,i),e.inner.push(i.components[0])},Box:function(t,e){var i={};this.readChildNodes(t,i),e.components||(e.components=[]);var n=i.points[0],s=i.points[1];e.components.push(new OpenLayers.Bounds(n.x,n.y,s.x,s.y))}},OpenLayers.Format.GML.Base.prototype.readers.gml),feature:OpenLayers.Format.GML.Base.prototype.readers.feature,wfs:OpenLayers.Format.GML.Base.prototype.readers.wfs},write:function(t){var e;e=OpenLayers.Util.isArray(t)?"wfs:FeatureCollection":"gml:featureMember";var i=this.writeNode(e,t);return this.setAttributeNS(i,this.namespaces.xsi,"xsi:schemaLocation",this.schemaLocation),OpenLayers.Format.XML.prototype.write.apply(this,[i])},writers:{gml:OpenLayers.Util.applyDefaults({Point:function(t){var e=this.createElementNSPlus("gml:Point");return this.writeNode("coordinates",[t],e),e},coordinates:function(t){for(var e,i=t.length,n=new Array(i),s=0;i>s;++s)e=t[s],n[s]=this.xy?e.x+","+e.y:e.y+","+e.x,void 0!=e.z&&(n[s]+=","+e.z);return this.createElementNSPlus("gml:coordinates",{attributes:{decimal:".",cs:",",ts:" "},value:1==i?n[0]:n.join(" ")})},LineString:function(t){var e=this.createElementNSPlus("gml:LineString");return this.writeNode("coordinates",t.components,e),e},Polygon:function(t){var e=this.createElementNSPlus("gml:Polygon");this.writeNode("outerBoundaryIs",t.components[0],e);for(var i=1;i<t.components.length;++i)this.writeNode("innerBoundaryIs",t.components[i],e);return e},outerBoundaryIs:function(t){var e=this.createElementNSPlus("gml:outerBoundaryIs");return this.writeNode("LinearRing",t,e),e},innerBoundaryIs:function(t){var e=this.createElementNSPlus("gml:innerBoundaryIs");return this.writeNode("LinearRing",t,e),e},LinearRing:function(t){var e=this.createElementNSPlus("gml:LinearRing");return this.writeNode("coordinates",t.components,e),e},Box:function(t){var e=this.createElementNSPlus("gml:Box");return this.writeNode("coordinates",[{x:t.left,y:t.bottom},{x:t.right,y:t.top}],e),this.srsName&&e.setAttribute("srsName",this.srsName),e}},OpenLayers.Format.GML.Base.prototype.writers.gml),feature:OpenLayers.Format.GML.Base.prototype.writers.feature,wfs:OpenLayers.Format.GML.Base.prototype.writers.wfs},CLASS_NAME:"OpenLayers.Format.GML.v2"}),OpenLayers.Style=OpenLayers.Class({id:null,name:null,title:null,description:null,layerName:null,isDefault:!1,rules:null,context:null,defaultStyle:null,defaultsPerSymbolizer:!1,propertyStyles:null,initialize:function(t,e){OpenLayers.Util.extend(this,e),this.rules=[],e&&e.rules&&this.addRules(e.rules),this.setDefaultStyle(t||OpenLayers.Feature.Vector.style["default"]),this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")},destroy:function(){for(var t=0,e=this.rules.length;e>t;t++)this.rules[t].destroy(),this.rules[t]=null;this.rules=null,this.defaultStyle=null},createSymbolizer:function(t){for(var e,i=this.defaultsPerSymbolizer?{}:this.createLiterals(OpenLayers.Util.extend({},this.defaultStyle),t),n=this.rules,s=[],r=!1,o=0,a=n.length;a>o;o++){e=n[o];var l=e.evaluate(t);l&&(e instanceof OpenLayers.Rule&&e.elseFilter?s.push(e):(r=!0,this.applySymbolizer(e,i,t)))}if(0==r&&s.length>0){r=!0;for(var o=0,a=s.length;a>o;o++)this.applySymbolizer(s[o],i,t)}return n.length>0&&0==r&&(i.display="none"),null!=i.label&&"string"!=typeof i.label&&(i.label=String(i.label)),i},applySymbolizer:function(t,e,i){var n=i.geometry?this.getSymbolizerPrefix(i.geometry):OpenLayers.Style.SYMBOLIZER_PREFIXES[0],s=t.symbolizer[n]||t.symbolizer;if(this.defaultsPerSymbolizer===!0){var r=this.defaultStyle;OpenLayers.Util.applyDefaults(s,{pointRadius:r.pointRadius}),(s.stroke===!0||s.graphic===!0)&&OpenLayers.Util.applyDefaults(s,{strokeWidth:r.strokeWidth,strokeColor:r.strokeColor,strokeOpacity:r.strokeOpacity,strokeDashstyle:r.strokeDashstyle,strokeLinecap:r.strokeLinecap}),(s.fill===!0||s.graphic===!0)&&OpenLayers.Util.applyDefaults(s,{fillColor:r.fillColor,fillOpacity:r.fillOpacity}),s.graphic===!0&&OpenLayers.Util.applyDefaults(s,{pointRadius:this.defaultStyle.pointRadius,externalGraphic:this.defaultStyle.externalGraphic,graphicName:this.defaultStyle.graphicName,graphicOpacity:this.defaultStyle.graphicOpacity,graphicWidth:this.defaultStyle.graphicWidth,graphicHeight:this.defaultStyle.graphicHeight,graphicXOffset:this.defaultStyle.graphicXOffset,graphicYOffset:this.defaultStyle.graphicYOffset})}return this.createLiterals(OpenLayers.Util.extend(e,s),i)},createLiterals:function(t,e){var i=OpenLayers.Util.extend({},e.attributes||e.data);OpenLayers.Util.extend(i,this.context);for(var n in this.propertyStyles)t[n]=OpenLayers.Style.createLiteral(t[n],i,e,n);return t},findPropertyStyles:function(){var t={},e=this.defaultStyle;this.addPropertyStyles(t,e);for(var i,n,s=this.rules,r=0,o=s.length;o>r;r++){i=s[r].symbolizer;for(var a in i){if(n=i[a],"object"!=typeof n){this.addPropertyStyles(t,i);break}this.addPropertyStyles(t,n)}}return t},addPropertyStyles:function(t,e){var i;for(var n in e)i=e[n],"string"==typeof i&&i.match(/\$\{\w+\}/)&&(t[n]=!0);return t},addRules:function(t){Array.prototype.push.apply(this.rules,t),this.propertyStyles=this.findPropertyStyles()},setDefaultStyle:function(t){this.defaultStyle=t,this.propertyStyles=this.findPropertyStyles()},getSymbolizerPrefix:function(t){for(var e=OpenLayers.Style.SYMBOLIZER_PREFIXES,i=0,n=e.length;n>i;i++)if(-1!=t.CLASS_NAME.indexOf(e[i]))return e[i]},clone:function(){var t=OpenLayers.Util.extend({},this);if(this.rules){t.rules=[];for(var e=0,i=this.rules.length;i>e;++e)t.rules.push(this.rules[e].clone())}t.context=this.context&&OpenLayers.Util.extend({},this.context);var n=OpenLayers.Util.extend({},this.defaultStyle);return new OpenLayers.Style(n,t)},CLASS_NAME:"OpenLayers.Style"}),OpenLayers.Style.createLiteral=function(t,e,i,n){return"string"==typeof t&&-1!=t.indexOf("${")&&(t=OpenLayers.String.format(t,e,[i,n]),t=isNaN(t)||!t?t:parseFloat(t)),t},OpenLayers.Style.SYMBOLIZER_PREFIXES=["Point","Line","Polygon","Text","Raster"],OpenLayers.Rule=OpenLayers.Class({id:null,name:null,title:null,description:null,context:null,filter:null,elseFilter:!1,symbolizer:null,symbolizers:null,minScaleDenominator:null,maxScaleDenominator:null,initialize:function(t){this.symbolizer={},OpenLayers.Util.extend(this,t),this.symbolizers&&delete this.symbolizer,this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")},destroy:function(){for(var t in this.symbolizer)this.symbolizer[t]=null;this.symbolizer=null,delete this.symbolizers},evaluate:function(t){var e=this.getContext(t),i=!0;if(this.minScaleDenominator||this.maxScaleDenominator)var n=t.layer.map.getScale();return this.minScaleDenominator&&(i=n>=OpenLayers.Style.createLiteral(this.minScaleDenominator,e)),i&&this.maxScaleDenominator&&(i=n<OpenLayers.Style.createLiteral(this.maxScaleDenominator,e)),i&&this.filter&&(i=this.filter.evaluate("OpenLayers.Filter.FeatureId"==this.filter.CLASS_NAME?t:e)),i},getContext:function(t){var e=this.context;return e||(e=t.attributes||t.data),"function"==typeof this.context&&(e=this.context(t)),e},clone:function(){var t=OpenLayers.Util.extend({},this);if(this.symbolizers){var e=this.symbolizers.length;t.symbolizers=new Array(e);for(var i=0;e>i;++i)t.symbolizers[i]=this.symbolizers[i].clone()}else{t.symbolizer={};var n,s;for(var r in this.symbolizer)n=this.symbolizer[r],s=typeof n,"object"===s?t.symbolizer[r]=OpenLayers.Util.extend({},n):"string"===s&&(t.symbolizer[r]=n)}return t.filter=this.filter&&this.filter.clone(),t.context=this.context&&OpenLayers.Util.extend({},this.context),new OpenLayers.Rule(t)},CLASS_NAME:"OpenLayers.Rule"}),OpenLayers.Format.OGCExceptionReport=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{ogc:"http://www.opengis.net/ogc"},regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},defaultPrefix:"ogc",read:function(t){"string"==typeof t&&(t=OpenLayers.Format.XML.prototype.read.apply(this,[t]));var e=t.documentElement,i={exceptionReport:null};return e&&(this.readChildNodes(t,i),null===i.exceptionReport&&(i=(new OpenLayers.Format.OWSCommon).read(t))),i},readers:{ogc:{ServiceExceptionReport:function(t,e){e.exceptionReport={exceptions:[]},this.readChildNodes(t,e.exceptionReport)},ServiceException:function(t,e){var i={code:t.getAttribute("code"),locator:t.getAttribute("locator"),text:this.getChildValue(t)};e.exceptions.push(i)}}},CLASS_NAME:"OpenLayers.Format.OGCExceptionReport"}),OpenLayers.Format.XML.VersionedOGC=OpenLayers.Class(OpenLayers.Format.XML,{defaultVersion:null,version:null,profile:null,allowFallback:!1,name:null,stringifyOutput:!1,parser:null,initialize:function(t){OpenLayers.Format.XML.prototype.initialize.apply(this,[t]);var e=this.CLASS_NAME;this.name=e.substring(e.lastIndexOf(".")+1)},getVersion:function(t,e){var i;return t?(i=this.version,i||(i=t.getAttribute("version"),i||(i=this.defaultVersion))):i=e&&e.version||this.version||this.defaultVersion,i},getParser:function(t){t=t||this.defaultVersion;var e=this.profile?"_"+this.profile:"";if(!this.parser||this.parser.VERSION!=t){var i=OpenLayers.Format[this.name]["v"+t.replace(/\./g,"_")+e];if(!i&&(""!==e&&this.allowFallback&&(e="",i=OpenLayers.Format[this.name]["v"+t.replace(/\./g,"_")]),!i))throw"Can't find a "+this.name+" parser for version "+t+e;this.parser=new i(this.options)}return this.parser},write:function(t,e){var i=this.getVersion(null,e);this.parser=this.getParser(i);var n=this.parser.write(t,e);return this.stringifyOutput===!1?n:OpenLayers.Format.XML.prototype.write.apply(this,[n])},read:function(t,e){"string"==typeof t&&(t=OpenLayers.Format.XML.prototype.read.apply(this,[t]));var i=t.documentElement,n=this.getVersion(i);this.parser=this.getParser(n);var s=this.parser.read(t,e),r=this.parser.errorProperty||null;if(null!==r&&void 0===s[r]){var o=new OpenLayers.Format.OGCExceptionReport;s.error=o.read(t)}return s.version=n,s},CLASS_NAME:"OpenLayers.Format.XML.VersionedOGC"}),OpenLayers.Filter=OpenLayers.Class({initialize:function(t){OpenLayers.Util.extend(this,t)},destroy:function(){},evaluate:function(){return!0},clone:function(){return null},toString:function(){var t;return t=OpenLayers.Format&&OpenLayers.Format.CQL?OpenLayers.Format.CQL.prototype.write(this):Object.prototype.toString.call(this)},CLASS_NAME:"OpenLayers.Filter"}),OpenLayers.Filter.FeatureId=OpenLayers.Class(OpenLayers.Filter,{fids:null,type:"FID",initialize:function(t){this.fids=[],OpenLayers.Filter.prototype.initialize.apply(this,[t])},evaluate:function(t){for(var e=0,i=this.fids.length;i>e;e++){var n=t.fid||t.id;if(n==this.fids[e])return!0}return!1},clone:function(){var t=new OpenLayers.Filter.FeatureId;return OpenLayers.Util.extend(t,this),t.fids=this.fids.slice(),t},CLASS_NAME:"OpenLayers.Filter.FeatureId"}),OpenLayers.Filter.Logical=OpenLayers.Class(OpenLayers.Filter,{filters:null,type:null,initialize:function(t){this.filters=[],OpenLayers.Filter.prototype.initialize.apply(this,[t])
},destroy:function(){this.filters=null,OpenLayers.Filter.prototype.destroy.apply(this)},evaluate:function(t){var e,i;switch(this.type){case OpenLayers.Filter.Logical.AND:for(e=0,i=this.filters.length;i>e;e++)if(0==this.filters[e].evaluate(t))return!1;return!0;case OpenLayers.Filter.Logical.OR:for(e=0,i=this.filters.length;i>e;e++)if(1==this.filters[e].evaluate(t))return!0;return!1;case OpenLayers.Filter.Logical.NOT:return!this.filters[0].evaluate(t)}return void 0},clone:function(){for(var t=[],e=0,i=this.filters.length;i>e;++e)t.push(this.filters[e].clone());return new OpenLayers.Filter.Logical({type:this.type,filters:t})},CLASS_NAME:"OpenLayers.Filter.Logical"}),OpenLayers.Filter.Logical.AND="&&",OpenLayers.Filter.Logical.OR="||",OpenLayers.Filter.Logical.NOT="!",OpenLayers.Filter.Comparison=OpenLayers.Class(OpenLayers.Filter,{type:null,property:null,value:null,matchCase:!0,lowerBoundary:null,upperBoundary:null,initialize:function(t){OpenLayers.Filter.prototype.initialize.apply(this,[t]),this.type===OpenLayers.Filter.Comparison.LIKE&&void 0===t.matchCase&&(this.matchCase=null)},evaluate:function(t){t instanceof OpenLayers.Feature.Vector&&(t=t.attributes);var e,i=!1,n=t[this.property];switch(this.type){case OpenLayers.Filter.Comparison.EQUAL_TO:e=this.value,i=this.matchCase||"string"!=typeof n||"string"!=typeof e?n==e:n.toUpperCase()==e.toUpperCase();break;case OpenLayers.Filter.Comparison.NOT_EQUAL_TO:e=this.value,i=this.matchCase||"string"!=typeof n||"string"!=typeof e?n!=e:n.toUpperCase()!=e.toUpperCase();break;case OpenLayers.Filter.Comparison.LESS_THAN:i=n<this.value;break;case OpenLayers.Filter.Comparison.GREATER_THAN:i=n>this.value;break;case OpenLayers.Filter.Comparison.LESS_THAN_OR_EQUAL_TO:i=n<=this.value;break;case OpenLayers.Filter.Comparison.GREATER_THAN_OR_EQUAL_TO:i=n>=this.value;break;case OpenLayers.Filter.Comparison.BETWEEN:i=n>=this.lowerBoundary&&n<=this.upperBoundary;break;case OpenLayers.Filter.Comparison.LIKE:var s=new RegExp(this.value,"gi");i=s.test(n);break;case OpenLayers.Filter.Comparison.IS_NULL:i=null===n}return i},value2regex:function(t,e,i){if("."==t)throw new Error("'.' is an unsupported wildCard character for OpenLayers.Filter.Comparison");return t=t?t:"*",e=e?e:".",i=i?i:"!",this.value=this.value.replace(new RegExp("\\"+i+"(.|$)","g"),"\\$1"),this.value=this.value.replace(new RegExp("\\"+e,"g"),"."),this.value=this.value.replace(new RegExp("\\"+t,"g"),".*"),this.value=this.value.replace(new RegExp("\\\\.\\*","g"),"\\"+t),this.value=this.value.replace(new RegExp("\\\\\\.","g"),"\\"+e),this.value},regex2value:function(){var t=this.value;return t=t.replace(/!/g,"!!"),t=t.replace(/(\\)?\\\./g,function(t,e){return e?t:"!."}),t=t.replace(/(\\)?\\\*/g,function(t,e){return e?t:"!*"}),t=t.replace(/\\\\/g,"\\"),t=t.replace(/\.\*/g,"*")},clone:function(){return OpenLayers.Util.extend(new OpenLayers.Filter.Comparison,this)},CLASS_NAME:"OpenLayers.Filter.Comparison"}),OpenLayers.Filter.Comparison.EQUAL_TO="==",OpenLayers.Filter.Comparison.NOT_EQUAL_TO="!=",OpenLayers.Filter.Comparison.LESS_THAN="<",OpenLayers.Filter.Comparison.GREATER_THAN=">",OpenLayers.Filter.Comparison.LESS_THAN_OR_EQUAL_TO="<=",OpenLayers.Filter.Comparison.GREATER_THAN_OR_EQUAL_TO=">=",OpenLayers.Filter.Comparison.BETWEEN="..",OpenLayers.Filter.Comparison.LIKE="~",OpenLayers.Filter.Comparison.IS_NULL="NULL",OpenLayers.Filter.Spatial=OpenLayers.Class(OpenLayers.Filter,{type:null,property:null,value:null,distance:null,distanceUnits:null,evaluate:function(t){var e=!1;switch(this.type){case OpenLayers.Filter.Spatial.BBOX:case OpenLayers.Filter.Spatial.INTERSECTS:if(t.geometry){var i=this.value;"OpenLayers.Bounds"==this.value.CLASS_NAME&&(i=this.value.toGeometry()),t.geometry.intersects(i)&&(e=!0)}break;default:throw new Error("evaluate is not implemented for this filter type.")}return e},clone:function(){var t=OpenLayers.Util.applyDefaults({value:this.value&&this.value.clone&&this.value.clone()},this);return new OpenLayers.Filter.Spatial(t)},CLASS_NAME:"OpenLayers.Filter.Spatial"}),OpenLayers.Filter.Spatial.BBOX="BBOX",OpenLayers.Filter.Spatial.INTERSECTS="INTERSECTS",OpenLayers.Filter.Spatial.DWITHIN="DWITHIN",OpenLayers.Filter.Spatial.WITHIN="WITHIN",OpenLayers.Filter.Spatial.CONTAINS="CONTAINS",OpenLayers.Format.SLD=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,{profile:null,defaultVersion:"1.0.0",stringifyOutput:!0,namedLayersAsArray:!1,CLASS_NAME:"OpenLayers.Format.SLD"}),OpenLayers.Format.Filter=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,{defaultVersion:"1.0.0",CLASS_NAME:"OpenLayers.Format.Filter"}),OpenLayers.Filter.Function=OpenLayers.Class(OpenLayers.Filter,{name:null,params:null,CLASS_NAME:"OpenLayers.Filter.Function"}),OpenLayers.Format.Filter.v1=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{ogc:"http://www.opengis.net/ogc",gml:"http://www.opengis.net/gml",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance"},defaultPrefix:"ogc",schemaLocation:null,initialize:function(t){OpenLayers.Format.XML.prototype.initialize.apply(this,[t])},read:function(t){var e={};return this.readers.ogc.Filter.apply(this,[t,e]),e.filter},readers:{ogc:{_expression:function(t){for(var e,i="",n=t.firstChild;n;n=n.nextSibling)switch(n.nodeType){case 1:e=this.readNode(n),e.property?i+="${"+e.property+"}":void 0!==e.value&&(i+=e.value);break;case 3:case 4:i+=n.nodeValue}return i},Filter:function(t,e){var i={fids:[],filters:[]};this.readChildNodes(t,i),i.fids.length>0?e.filter=new OpenLayers.Filter.FeatureId({fids:i.fids}):i.filters.length>0&&(e.filter=i.filters[0])},FeatureId:function(t,e){var i=t.getAttribute("fid");i&&e.fids.push(i)},And:function(t,e){var i=new OpenLayers.Filter.Logical({type:OpenLayers.Filter.Logical.AND});this.readChildNodes(t,i),e.filters.push(i)},Or:function(t,e){var i=new OpenLayers.Filter.Logical({type:OpenLayers.Filter.Logical.OR});this.readChildNodes(t,i),e.filters.push(i)},Not:function(t,e){var i=new OpenLayers.Filter.Logical({type:OpenLayers.Filter.Logical.NOT});this.readChildNodes(t,i),e.filters.push(i)},PropertyIsLessThan:function(t,e){var i=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.LESS_THAN});this.readChildNodes(t,i),e.filters.push(i)},PropertyIsGreaterThan:function(t,e){var i=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.GREATER_THAN});this.readChildNodes(t,i),e.filters.push(i)},PropertyIsLessThanOrEqualTo:function(t,e){var i=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.LESS_THAN_OR_EQUAL_TO});this.readChildNodes(t,i),e.filters.push(i)},PropertyIsGreaterThanOrEqualTo:function(t,e){var i=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.GREATER_THAN_OR_EQUAL_TO});this.readChildNodes(t,i),e.filters.push(i)},PropertyIsBetween:function(t,e){var i=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.BETWEEN});this.readChildNodes(t,i),e.filters.push(i)},Literal:function(t,e){e.value=OpenLayers.String.numericIf(this.getChildValue(t),!0)},PropertyName:function(t,e){e.property=this.getChildValue(t)},LowerBoundary:function(t,e){e.lowerBoundary=OpenLayers.String.numericIf(this.readers.ogc._expression.call(this,t),!0)},UpperBoundary:function(t,e){e.upperBoundary=OpenLayers.String.numericIf(this.readers.ogc._expression.call(this,t),!0)},Intersects:function(t,e){this.readSpatial(t,e,OpenLayers.Filter.Spatial.INTERSECTS)},Within:function(t,e){this.readSpatial(t,e,OpenLayers.Filter.Spatial.WITHIN)},Contains:function(t,e){this.readSpatial(t,e,OpenLayers.Filter.Spatial.CONTAINS)},DWithin:function(t,e){this.readSpatial(t,e,OpenLayers.Filter.Spatial.DWITHIN)},Distance:function(t,e){e.distance=parseInt(this.getChildValue(t)),e.distanceUnits=t.getAttribute("units")},Function:function(){},PropertyIsNull:function(t,e){var i=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.IS_NULL});this.readChildNodes(t,i),e.filters.push(i)}}},readSpatial:function(t,e,i){var n=new OpenLayers.Filter.Spatial({type:i});this.readChildNodes(t,n),n.value=n.components[0],delete n.components,e.filters.push(n)},encodeLiteral:function(t){return t instanceof Date&&(t=OpenLayers.Date.toISOString(t)),t},writeOgcExpression:function(t,e){return t instanceof OpenLayers.Filter.Function?this.writeNode("Function",t,e):this.writeNode("Literal",t,e),e},write:function(t){return this.writers.ogc.Filter.apply(this,[t])},writers:{ogc:{Filter:function(t){var e=this.createElementNSPlus("ogc:Filter");return this.writeNode(this.getFilterType(t),t,e),e},_featureIds:function(t){for(var e=this.createDocumentFragment(),i=0,n=t.fids.length;n>i;++i)this.writeNode("ogc:FeatureId",t.fids[i],e);return e},FeatureId:function(t){return this.createElementNSPlus("ogc:FeatureId",{attributes:{fid:t}})},And:function(t){for(var e,i=this.createElementNSPlus("ogc:And"),n=0,s=t.filters.length;s>n;++n)e=t.filters[n],this.writeNode(this.getFilterType(e),e,i);return i},Or:function(t){for(var e,i=this.createElementNSPlus("ogc:Or"),n=0,s=t.filters.length;s>n;++n)e=t.filters[n],this.writeNode(this.getFilterType(e),e,i);return i},Not:function(t){var e=this.createElementNSPlus("ogc:Not"),i=t.filters[0];return this.writeNode(this.getFilterType(i),i,e),e},PropertyIsLessThan:function(t){var e=this.createElementNSPlus("ogc:PropertyIsLessThan");return this.writeNode("PropertyName",t,e),this.writeOgcExpression(t.value,e),e},PropertyIsGreaterThan:function(t){var e=this.createElementNSPlus("ogc:PropertyIsGreaterThan");return this.writeNode("PropertyName",t,e),this.writeOgcExpression(t.value,e),e},PropertyIsLessThanOrEqualTo:function(t){var e=this.createElementNSPlus("ogc:PropertyIsLessThanOrEqualTo");return this.writeNode("PropertyName",t,e),this.writeOgcExpression(t.value,e),e},PropertyIsGreaterThanOrEqualTo:function(t){var e=this.createElementNSPlus("ogc:PropertyIsGreaterThanOrEqualTo");return this.writeNode("PropertyName",t,e),this.writeOgcExpression(t.value,e),e},PropertyIsBetween:function(t){var e=this.createElementNSPlus("ogc:PropertyIsBetween");return this.writeNode("PropertyName",t,e),this.writeNode("LowerBoundary",t,e),this.writeNode("UpperBoundary",t,e),e},PropertyName:function(t){return this.createElementNSPlus("ogc:PropertyName",{value:t.property})},Literal:function(t){var e=this.encodeLiteral||OpenLayers.Format.Filter.v1.prototype.encodeLiteral;return this.createElementNSPlus("ogc:Literal",{value:e(t)})},LowerBoundary:function(t){var e=this.createElementNSPlus("ogc:LowerBoundary");return this.writeOgcExpression(t.lowerBoundary,e),e},UpperBoundary:function(t){var e=this.createElementNSPlus("ogc:UpperBoundary");return this.writeNode("Literal",t.upperBoundary,e),e},INTERSECTS:function(t){return this.writeSpatial(t,"Intersects")},WITHIN:function(t){return this.writeSpatial(t,"Within")},CONTAINS:function(t){return this.writeSpatial(t,"Contains")},DWITHIN:function(t){var e=this.writeSpatial(t,"DWithin");return this.writeNode("Distance",t,e),e},Distance:function(t){return this.createElementNSPlus("ogc:Distance",{attributes:{units:t.distanceUnits},value:t.distance})},Function:function(t){for(var e=this.createElementNSPlus("ogc:Function",{attributes:{name:t.name}}),i=t.params,n=0,s=i.length;s>n;n++)this.writeOgcExpression(i[n],e);return e},PropertyIsNull:function(t){var e=this.createElementNSPlus("ogc:PropertyIsNull");return this.writeNode("PropertyName",t,e),e}}},getFilterType:function(t){var e=this.filterMap[t.type];if(!e)throw"Filter writing not supported for rule type: "+t.type;return e},filterMap:{"&&":"And","||":"Or","!":"Not","==":"PropertyIsEqualTo","!=":"PropertyIsNotEqualTo","<":"PropertyIsLessThan",">":"PropertyIsGreaterThan","<=":"PropertyIsLessThanOrEqualTo",">=":"PropertyIsGreaterThanOrEqualTo","..":"PropertyIsBetween","~":"PropertyIsLike",NULL:"PropertyIsNull",BBOX:"BBOX",DWITHIN:"DWITHIN",WITHIN:"WITHIN",CONTAINS:"CONTAINS",INTERSECTS:"INTERSECTS",FID:"_featureIds"},CLASS_NAME:"OpenLayers.Format.Filter.v1"}),OpenLayers.Format.Filter.v1_0_0=OpenLayers.Class(OpenLayers.Format.GML.v2,OpenLayers.Format.Filter.v1,{VERSION:"1.0.0",schemaLocation:"http://www.opengis.net/ogc/filter/1.0.0/filter.xsd",initialize:function(t){OpenLayers.Format.GML.v2.prototype.initialize.apply(this,[t])},readers:{ogc:OpenLayers.Util.applyDefaults({PropertyIsEqualTo:function(t,e){var i=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.EQUAL_TO});this.readChildNodes(t,i),e.filters.push(i)},PropertyIsNotEqualTo:function(t,e){var i=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.NOT_EQUAL_TO});this.readChildNodes(t,i),e.filters.push(i)},PropertyIsLike:function(t,e){var i=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.LIKE});this.readChildNodes(t,i);var n=t.getAttribute("wildCard"),s=t.getAttribute("singleChar"),r=t.getAttribute("escape");i.value2regex(n,s,r),e.filters.push(i)}},OpenLayers.Format.Filter.v1.prototype.readers.ogc),gml:OpenLayers.Format.GML.v2.prototype.readers.gml,feature:OpenLayers.Format.GML.v2.prototype.readers.feature},writers:{ogc:OpenLayers.Util.applyDefaults({PropertyIsEqualTo:function(t){var e=this.createElementNSPlus("ogc:PropertyIsEqualTo");return this.writeNode("PropertyName",t,e),this.writeOgcExpression(t.value,e),e},PropertyIsNotEqualTo:function(t){var e=this.createElementNSPlus("ogc:PropertyIsNotEqualTo");return this.writeNode("PropertyName",t,e),this.writeOgcExpression(t.value,e),e},PropertyIsLike:function(t){var e=this.createElementNSPlus("ogc:PropertyIsLike",{attributes:{wildCard:"*",singleChar:".",escape:"!"}});return this.writeNode("PropertyName",t,e),this.writeNode("Literal",t.regex2value(),e),e},BBOX:function(t){var e=this.createElementNSPlus("ogc:BBOX");t.property&&this.writeNode("PropertyName",t,e);var i=this.writeNode("gml:Box",t.value,e);return t.projection&&i.setAttribute("srsName",t.projection),e}},OpenLayers.Format.Filter.v1.prototype.writers.ogc),gml:OpenLayers.Format.GML.v2.prototype.writers.gml,feature:OpenLayers.Format.GML.v2.prototype.writers.feature},writeSpatial:function(t,e){var i=this.createElementNSPlus("ogc:"+e);if(this.writeNode("PropertyName",t,i),t.value instanceof OpenLayers.Filter.Function)this.writeNode("Function",t.value,i);else{var n;n=t.value instanceof OpenLayers.Geometry?this.writeNode("feature:_geometry",t.value).firstChild:this.writeNode("gml:Box",t.value),t.projection&&n.setAttribute("srsName",t.projection),i.appendChild(n)}return i},CLASS_NAME:"OpenLayers.Format.Filter.v1_0_0"}),OpenLayers.Symbolizer=OpenLayers.Class({zIndex:0,initialize:function(t){OpenLayers.Util.extend(this,t)},clone:function(){var Type=eval(this.CLASS_NAME);return new Type(OpenLayers.Util.extend({},this))},CLASS_NAME:"OpenLayers.Symbolizer"}),OpenLayers.Symbolizer.Point=OpenLayers.Class(OpenLayers.Symbolizer,{initialize:function(){OpenLayers.Symbolizer.prototype.initialize.apply(this,arguments)},CLASS_NAME:"OpenLayers.Symbolizer.Point"}),OpenLayers.Symbolizer.Line=OpenLayers.Class(OpenLayers.Symbolizer,{initialize:function(){OpenLayers.Symbolizer.prototype.initialize.apply(this,arguments)},CLASS_NAME:"OpenLayers.Symbolizer.Line"}),OpenLayers.Symbolizer.Polygon=OpenLayers.Class(OpenLayers.Symbolizer,{initialize:function(){OpenLayers.Symbolizer.prototype.initialize.apply(this,arguments)},CLASS_NAME:"OpenLayers.Symbolizer.Polygon"}),OpenLayers.Symbolizer.Text=OpenLayers.Class(OpenLayers.Symbolizer,{initialize:function(){OpenLayers.Symbolizer.prototype.initialize.apply(this,arguments)},CLASS_NAME:"OpenLayers.Symbolizer.Text"}),OpenLayers.Symbolizer.Raster=OpenLayers.Class(OpenLayers.Symbolizer,{initialize:function(){OpenLayers.Symbolizer.prototype.initialize.apply(this,arguments)},CLASS_NAME:"OpenLayers.Symbolizer.Raster"}),OpenLayers.Format.SLD.v1=OpenLayers.Class(OpenLayers.Format.Filter.v1_0_0,{namespaces:{sld:"http://www.opengis.net/sld",ogc:"http://www.opengis.net/ogc",gml:"http://www.opengis.net/gml",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance"},defaultPrefix:"sld",schemaLocation:null,multipleSymbolizers:!1,featureTypeCounter:null,defaultSymbolizer:{fillColor:"#808080",fillOpacity:1,strokeColor:"#000000",strokeOpacity:1,strokeWidth:1,strokeDashstyle:"solid",pointRadius:3,graphicName:"square"},read:function(t,e){e=OpenLayers.Util.applyDefaults(e,this.options);var i={namedLayers:e.namedLayersAsArray===!0?[]:{}};return this.readChildNodes(t,i),i},readers:OpenLayers.Util.applyDefaults({sld:{StyledLayerDescriptor:function(t,e){e.version=t.getAttribute("version"),this.readChildNodes(t,e)},Name:function(t,e){e.name=this.getChildValue(t)},Title:function(t,e){e.title=this.getChildValue(t)},Abstract:function(t,e){e.description=this.getChildValue(t)},NamedLayer:function(t,e){var i={userStyles:[],namedStyles:[]};this.readChildNodes(t,i);for(var n=0,s=i.userStyles.length;s>n;++n)i.userStyles[n].layerName=i.name;OpenLayers.Util.isArray(e.namedLayers)?e.namedLayers.push(i):e.namedLayers[i.name]=i},NamedStyle:function(t,e){e.namedStyles.push(this.getChildName(t.firstChild))},UserStyle:function(t,e){var i={defaultsPerSymbolizer:!0,rules:[]};this.featureTypeCounter=-1,this.readChildNodes(t,i);var n;this.multipleSymbolizers?(delete i.defaultsPerSymbolizer,n=new OpenLayers.Style2(i)):n=new OpenLayers.Style(this.defaultSymbolizer,i),e.userStyles.push(n)},IsDefault:function(t,e){"1"==this.getChildValue(t)&&(e.isDefault=!0)},FeatureTypeStyle:function(t,e){++this.featureTypeCounter;var i={rules:this.multipleSymbolizers?e.rules:[]};this.readChildNodes(t,i),this.multipleSymbolizers||(e.rules=i.rules)},Rule:function(t,e){var i;this.multipleSymbolizers&&(i={symbolizers:[]});var n=new OpenLayers.Rule(i);this.readChildNodes(t,n),e.rules.push(n)},ElseFilter:function(t,e){e.elseFilter=!0},MinScaleDenominator:function(t,e){e.minScaleDenominator=parseFloat(this.getChildValue(t))},MaxScaleDenominator:function(t,e){e.maxScaleDenominator=parseFloat(this.getChildValue(t))},TextSymbolizer:function(t,e){var i={};this.readChildNodes(t,i),this.multipleSymbolizers?(i.zIndex=this.featureTypeCounter,e.symbolizers.push(new OpenLayers.Symbolizer.Text(i))):e.symbolizer.Text=OpenLayers.Util.applyDefaults(i,e.symbolizer.Text)},LabelPlacement:function(t,e){this.readChildNodes(t,e)},PointPlacement:function(t,e){var i={};this.readChildNodes(t,i),i.labelRotation=i.rotation,delete i.rotation;var n,s=e.labelAnchorPointX,r=e.labelAnchorPointY;1/3>=s?n="l":s>1/3&&2/3>s?n="c":s>=2/3&&(n="r"),1/3>=r?n+="b":r>1/3&&2/3>r?n+="m":r>=2/3&&(n+="t"),i.labelAlign=n,OpenLayers.Util.applyDefaults(e,i)},AnchorPoint:function(t,e){this.readChildNodes(t,e)},AnchorPointX:function(t,e){var i=this.readers.ogc._expression.call(this,t);i&&(e.labelAnchorPointX=i)},AnchorPointY:function(t,e){var i=this.readers.ogc._expression.call(this,t);i&&(e.labelAnchorPointY=i)},Displacement:function(t,e){this.readChildNodes(t,e)},DisplacementX:function(t,e){var i=this.readers.ogc._expression.call(this,t);i&&(e.labelXOffset=i)},DisplacementY:function(t,e){var i=this.readers.ogc._expression.call(this,t);i&&(e.labelYOffset=i)},LinePlacement:function(t,e){this.readChildNodes(t,e)},PerpendicularOffset:function(t,e){var i=this.readers.ogc._expression.call(this,t);i&&(e.labelPerpendicularOffset=i)},Label:function(t,e){var i=this.readers.ogc._expression.call(this,t);i&&(e.label=i)},Font:function(t,e){this.readChildNodes(t,e)},Halo:function(t,e){var i={};this.readChildNodes(t,i),e.haloRadius=i.haloRadius,e.haloColor=i.fillColor,e.haloOpacity=i.fillOpacity},Radius:function(t,e){var i=this.readers.ogc._expression.call(this,t);null!=i&&(e.haloRadius=i)},RasterSymbolizer:function(t,e){var i={};this.readChildNodes(t,i),this.multipleSymbolizers?(i.zIndex=this.featureTypeCounter,e.symbolizers.push(new OpenLayers.Symbolizer.Raster(i))):e.symbolizer.Raster=OpenLayers.Util.applyDefaults(i,e.symbolizer.Raster)},Geometry:function(t,e){e.geometry={},this.readChildNodes(t,e.geometry)},ColorMap:function(t,e){e.colorMap=[],this.readChildNodes(t,e.colorMap)},ColorMapEntry:function(t,e){var i=t.getAttribute("quantity"),n=t.getAttribute("opacity");e.push({color:t.getAttribute("color"),quantity:null!==i?parseFloat(i):void 0,label:t.getAttribute("label")||void 0,opacity:null!==n?parseFloat(n):void 0})},LineSymbolizer:function(t,e){var i={};this.readChildNodes(t,i),this.multipleSymbolizers?(i.zIndex=this.featureTypeCounter,e.symbolizers.push(new OpenLayers.Symbolizer.Line(i))):e.symbolizer.Line=OpenLayers.Util.applyDefaults(i,e.symbolizer.Line)},PolygonSymbolizer:function(t,e){var i={fill:!1,stroke:!1};this.multipleSymbolizers||(i=e.symbolizer.Polygon||i),this.readChildNodes(t,i),this.multipleSymbolizers?(i.zIndex=this.featureTypeCounter,e.symbolizers.push(new OpenLayers.Symbolizer.Polygon(i))):e.symbolizer.Polygon=i},PointSymbolizer:function(t,e){var i={fill:!1,stroke:!1,graphic:!1};this.multipleSymbolizers||(i=e.symbolizer.Point||i),this.readChildNodes(t,i),this.multipleSymbolizers?(i.zIndex=this.featureTypeCounter,e.symbolizers.push(new OpenLayers.Symbolizer.Point(i))):e.symbolizer.Point=i},Stroke:function(t,e){e.stroke=!0,this.readChildNodes(t,e)},Fill:function(t,e){e.fill=!0,this.readChildNodes(t,e)},CssParameter:function(t,e){var i=t.getAttribute("name"),n=this.cssMap[i];if(e.label&&("fill"===i?n="fontColor":"fill-opacity"===i&&(n="fontOpacity")),n){var s=this.readers.ogc._expression.call(this,t);s&&(e[n]=s)}},Graphic:function(t,e){e.graphic=!0;var i={};this.readChildNodes(t,i);for(var n,s,r=["stroke","strokeColor","strokeWidth","strokeOpacity","strokeLinecap","fill","fillColor","fillOpacity","graphicName","rotation","graphicFormat"],o=0,a=r.length;a>o;++o)n=r[o],s=i[n],void 0!=s&&(e[n]=s);if(void 0!=i.opacity&&(e.graphicOpacity=i.opacity),void 0!=i.size){var l=i.size/2;isNaN(l)?e.graphicWidth=i.size:e.pointRadius=i.size/2}void 0!=i.href&&(e.externalGraphic=i.href),void 0!=i.rotation&&(e.rotation=i.rotation)},ExternalGraphic:function(t,e){this.readChildNodes(t,e)},Mark:function(t,e){this.readChildNodes(t,e)},WellKnownName:function(t,e){e.graphicName=this.getChildValue(t)},Opacity:function(t,e){var i=this.readers.ogc._expression.call(this,t);i&&(e.opacity=i)},Size:function(t,e){var i=this.readers.ogc._expression.call(this,t);i&&(e.size=i)},Rotation:function(t,e){var i=this.readers.ogc._expression.call(this,t);i&&(e.rotation=i)},OnlineResource:function(t,e){e.href=this.getAttributeNS(t,this.namespaces.xlink,"href")},Format:function(t,e){e.graphicFormat=this.getChildValue(t)}}},OpenLayers.Format.Filter.v1_0_0.prototype.readers),cssMap:{stroke:"strokeColor","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","stroke-linecap":"strokeLinecap","stroke-dasharray":"strokeDashstyle",fill:"fillColor","fill-opacity":"fillOpacity","font-family":"fontFamily","font-size":"fontSize","font-weight":"fontWeight","font-style":"fontStyle"},getCssProperty:function(t){var e=null;for(var i in this.cssMap)if(this.cssMap[i]==t){e=i;break}return e},getGraphicFormat:function(t){var e;for(var i in this.graphicFormats)if(this.graphicFormats[i].test(t)){e=i;break}return e||this.defaultGraphicFormat},defaultGraphicFormat:"image/png",graphicFormats:{"image/jpeg":/\.jpe?g$/i,"image/gif":/\.gif$/i,"image/png":/\.png$/i},write:function(t){return this.writers.sld.StyledLayerDescriptor.apply(this,[t])},writers:OpenLayers.Util.applyDefaults({sld:{_OGCExpression:function(t,e){var i=this.createElementNSPlus(t),n="string"==typeof e?e.split("${"):[e];i.appendChild(this.createTextNode(n[0]));for(var s,r,o=1,a=n.length;a>o;o++)s=n[o],r=s.indexOf("}"),r>0?(this.writeNode("ogc:PropertyName",{property:s.substring(0,r)},i),i.appendChild(this.createTextNode(s.substring(++r)))):i.appendChild(this.createTextNode("${"+s));return i},StyledLayerDescriptor:function(t){var e=this.createElementNSPlus("sld:StyledLayerDescriptor",{attributes:{version:this.VERSION,"xsi:schemaLocation":this.schemaLocation}});if(e.setAttribute("xmlns:ogc",this.namespaces.ogc),e.setAttribute("xmlns:gml",this.namespaces.gml),t.name&&this.writeNode("Name",t.name,e),t.title&&this.writeNode("Title",t.title,e),t.description&&this.writeNode("Abstract",t.description,e),OpenLayers.Util.isArray(t.namedLayers))for(var i=0,n=t.namedLayers.length;n>i;++i)this.writeNode("NamedLayer",t.namedLayers[i],e);else for(var s in t.namedLayers)this.writeNode("NamedLayer",t.namedLayers[s],e);return e},Name:function(t){return this.createElementNSPlus("sld:Name",{value:t})},Title:function(t){return this.createElementNSPlus("sld:Title",{value:t})},Abstract:function(t){return this.createElementNSPlus("sld:Abstract",{value:t})},NamedLayer:function(t){var e=this.createElementNSPlus("sld:NamedLayer");if(this.writeNode("Name",t.name,e),t.namedStyles)for(var i=0,n=t.namedStyles.length;n>i;++i)this.writeNode("NamedStyle",t.namedStyles[i],e);if(t.userStyles)for(var i=0,n=t.userStyles.length;n>i;++i)this.writeNode("UserStyle",t.userStyles[i],e);return e},NamedStyle:function(t){var e=this.createElementNSPlus("sld:NamedStyle");return this.writeNode("Name",t,e),e},UserStyle:function(t){var e=this.createElementNSPlus("sld:UserStyle");if(t.name&&this.writeNode("Name",t.name,e),t.title&&this.writeNode("Title",t.title,e),t.description&&this.writeNode("Abstract",t.description,e),t.isDefault&&this.writeNode("IsDefault",t.isDefault,e),this.multipleSymbolizers&&t.rules){for(var i,n,s,r,o,a={0:[]},l=[0],h=0,u=t.rules.length;u>h;++h)if(i=t.rules[h],i.symbolizers){n={};for(var p=0,c=i.symbolizers.length;c>p;++p)s=i.symbolizers[p],r=s.zIndex,r in n||(o=i.clone(),o.symbolizers=[],n[r]=o),n[r].symbolizers.push(s.clone());for(r in n)r in a||(l.push(r),a[r]=[]),a[r].push(n[r])}else a[0].push(i.clone());l.sort();for(var d,h=0,u=l.length;u>h;++h)d=a[l[h]],d.length>0&&(o=t.clone(),o.rules=a[l[h]],this.writeNode("FeatureTypeStyle",o,e))}else this.writeNode("FeatureTypeStyle",t,e);return e},IsDefault:function(t){return this.createElementNSPlus("sld:IsDefault",{value:t?"1":"0"})},FeatureTypeStyle:function(t){for(var e=this.createElementNSPlus("sld:FeatureTypeStyle"),i=0,n=t.rules.length;n>i;++i)this.writeNode("Rule",t.rules[i],e);return e},Rule:function(t){var e=this.createElementNSPlus("sld:Rule");t.name&&this.writeNode("Name",t.name,e),t.title&&this.writeNode("Title",t.title,e),t.description&&this.writeNode("Abstract",t.description,e),t.elseFilter?this.writeNode("ElseFilter",null,e):t.filter&&this.writeNode("ogc:Filter",t.filter,e),void 0!=t.minScaleDenominator&&this.writeNode("MinScaleDenominator",t.minScaleDenominator,e),void 0!=t.maxScaleDenominator&&this.writeNode("MaxScaleDenominator",t.maxScaleDenominator,e);var i,n;if(this.multipleSymbolizers&&t.symbolizers)for(var n,s=0,r=t.symbolizers.length;r>s;++s)n=t.symbolizers[s],i=n.CLASS_NAME.split(".").pop(),this.writeNode(i+"Symbolizer",n,e);else for(var o=OpenLayers.Style.SYMBOLIZER_PREFIXES,s=0,a=o.length;a>s;++s)i=o[s],n=t.symbolizer[i],n&&this.writeNode(i+"Symbolizer",n,e);return e},ElseFilter:function(){return this.createElementNSPlus("sld:ElseFilter")},MinScaleDenominator:function(t){return this.createElementNSPlus("sld:MinScaleDenominator",{value:t})},MaxScaleDenominator:function(t){return this.createElementNSPlus("sld:MaxScaleDenominator",{value:t})},LineSymbolizer:function(t){var e=this.createElementNSPlus("sld:LineSymbolizer");return this.writeNode("Stroke",t,e),e},Stroke:function(t){var e=this.createElementNSPlus("sld:Stroke");return void 0!=t.strokeColor&&this.writeNode("CssParameter",{symbolizer:t,key:"strokeColor"},e),void 0!=t.strokeOpacity&&this.writeNode("CssParameter",{symbolizer:t,key:"strokeOpacity"},e),void 0!=t.strokeWidth&&this.writeNode("CssParameter",{symbolizer:t,key:"strokeWidth"},e),void 0!=t.strokeDashstyle&&"solid"!==t.strokeDashstyle&&this.writeNode("CssParameter",{symbolizer:t,key:"strokeDashstyle"},e),void 0!=t.strokeLinecap&&this.writeNode("CssParameter",{symbolizer:t,key:"strokeLinecap"},e),e},CssParameter:function(t){return this.createElementNSPlus("sld:CssParameter",{attributes:{name:this.getCssProperty(t.key)},value:t.symbolizer[t.key]})},TextSymbolizer:function(t){var e=this.createElementNSPlus("sld:TextSymbolizer");return null!=t.label&&this.writeNode("Label",t.label,e),(null!=t.fontFamily||null!=t.fontSize||null!=t.fontWeight||null!=t.fontStyle)&&this.writeNode("Font",t,e),(null!=t.labelAnchorPointX||null!=t.labelAnchorPointY||null!=t.labelAlign||null!=t.labelXOffset||null!=t.labelYOffset||null!=t.labelRotation||null!=t.labelPerpendicularOffset)&&this.writeNode("LabelPlacement",t,e),(null!=t.haloRadius||null!=t.haloColor||null!=t.haloOpacity)&&this.writeNode("Halo",t,e),(null!=t.fontColor||null!=t.fontOpacity)&&this.writeNode("Fill",{fillColor:t.fontColor,fillOpacity:t.fontOpacity},e),e},LabelPlacement:function(t){var e=this.createElementNSPlus("sld:LabelPlacement");return null==t.labelAnchorPointX&&null==t.labelAnchorPointY&&null==t.labelAlign&&null==t.labelXOffset&&null==t.labelYOffset&&null==t.labelRotation||null!=t.labelPerpendicularOffset||this.writeNode("PointPlacement",t,e),null!=t.labelPerpendicularOffset&&this.writeNode("LinePlacement",t,e),e},LinePlacement:function(t){var e=this.createElementNSPlus("sld:LinePlacement");return this.writeNode("PerpendicularOffset",t.labelPerpendicularOffset,e),e},PerpendicularOffset:function(t){return this.createElementNSPlus("sld:PerpendicularOffset",{value:t})},PointPlacement:function(t){var e=this.createElementNSPlus("sld:PointPlacement");return(null!=t.labelAnchorPointX||null!=t.labelAnchorPointY||null!=t.labelAlign)&&this.writeNode("AnchorPoint",t,e),(null!=t.labelXOffset||null!=t.labelYOffset)&&this.writeNode("Displacement",t,e),null!=t.labelRotation&&this.writeNode("Rotation",t.labelRotation,e),e},AnchorPoint:function(t){var e=this.createElementNSPlus("sld:AnchorPoint"),i=t.labelAnchorPointX,n=t.labelAnchorPointY;if(null!=i&&this.writeNode("AnchorPointX",i,e),null!=n&&this.writeNode("AnchorPointY",n,e),null==i&&null==n){var s=t.labelAlign.substr(0,1),r=t.labelAlign.substr(1,1);"l"===s?i=0:"c"===s?i=.5:"r"===s&&(i=1),"b"===r?n=0:"m"===r?n=.5:"t"===r&&(n=1),this.writeNode("AnchorPointX",i,e),this.writeNode("AnchorPointY",n,e)}return e},AnchorPointX:function(t){return this.createElementNSPlus("sld:AnchorPointX",{value:t})},AnchorPointY:function(t){return this.createElementNSPlus("sld:AnchorPointY",{value:t})},Displacement:function(t){var e=this.createElementNSPlus("sld:Displacement");return null!=t.labelXOffset&&this.writeNode("DisplacementX",t.labelXOffset,e),null!=t.labelYOffset&&this.writeNode("DisplacementY",t.labelYOffset,e),e},DisplacementX:function(t){return this.createElementNSPlus("sld:DisplacementX",{value:t})},DisplacementY:function(t){return this.createElementNSPlus("sld:DisplacementY",{value:t})},Font:function(t){var e=this.createElementNSPlus("sld:Font");return t.fontFamily&&this.writeNode("CssParameter",{symbolizer:t,key:"fontFamily"},e),t.fontSize&&this.writeNode("CssParameter",{symbolizer:t,key:"fontSize"},e),t.fontWeight&&this.writeNode("CssParameter",{symbolizer:t,key:"fontWeight"},e),t.fontStyle&&this.writeNode("CssParameter",{symbolizer:t,key:"fontStyle"},e),e},Label:function(t){return this.writers.sld._OGCExpression.call(this,"sld:Label",t)},Halo:function(t){var e=this.createElementNSPlus("sld:Halo");return t.haloRadius&&this.writeNode("Radius",t.haloRadius,e),(t.haloColor||t.haloOpacity)&&this.writeNode("Fill",{fillColor:t.haloColor,fillOpacity:t.haloOpacity},e),e},Radius:function(t){return this.createElementNSPlus("sld:Radius",{value:t})},RasterSymbolizer:function(t){var e=this.createElementNSPlus("sld:RasterSymbolizer");return t.geometry&&this.writeNode("Geometry",t.geometry,e),t.opacity&&this.writeNode("Opacity",t.opacity,e),t.colorMap&&this.writeNode("ColorMap",t.colorMap,e),e},Geometry:function(t){var e=this.createElementNSPlus("sld:Geometry");return t.property&&this.writeNode("ogc:PropertyName",t,e),e},ColorMap:function(t){for(var e=this.createElementNSPlus("sld:ColorMap"),i=0,n=t.length;n>i;++i)this.writeNode("ColorMapEntry",t[i],e);return e},ColorMapEntry:function(t){var e=this.createElementNSPlus("sld:ColorMapEntry"),i=t;return e.setAttribute("color",i.color),void 0!==i.opacity&&e.setAttribute("opacity",parseFloat(i.opacity)),void 0!==i.quantity&&e.setAttribute("quantity",parseFloat(i.quantity)),void 0!==i.label&&e.setAttribute("label",i.label),e
},PolygonSymbolizer:function(t){var e=this.createElementNSPlus("sld:PolygonSymbolizer");return t.fill!==!1&&this.writeNode("Fill",t,e),t.stroke!==!1&&this.writeNode("Stroke",t,e),e},Fill:function(t){var e=this.createElementNSPlus("sld:Fill");return t.fillColor&&this.writeNode("CssParameter",{symbolizer:t,key:"fillColor"},e),null!=t.fillOpacity&&this.writeNode("CssParameter",{symbolizer:t,key:"fillOpacity"},e),e},PointSymbolizer:function(t){var e=this.createElementNSPlus("sld:PointSymbolizer");return this.writeNode("Graphic",t,e),e},Graphic:function(t){var e=this.createElementNSPlus("sld:Graphic");return void 0!=t.externalGraphic?this.writeNode("ExternalGraphic",t,e):this.writeNode("Mark",t,e),void 0!=t.graphicOpacity&&this.writeNode("Opacity",t.graphicOpacity,e),void 0!=t.pointRadius?this.writeNode("Size",2*t.pointRadius,e):void 0!=t.graphicWidth&&this.writeNode("Size",t.graphicWidth,e),void 0!=t.rotation&&this.writeNode("Rotation",t.rotation,e),e},ExternalGraphic:function(t){var e=this.createElementNSPlus("sld:ExternalGraphic");this.writeNode("OnlineResource",t.externalGraphic,e);var i=t.graphicFormat||this.getGraphicFormat(t.externalGraphic);return this.writeNode("Format",i,e),e},Mark:function(t){var e=this.createElementNSPlus("sld:Mark");return t.graphicName&&this.writeNode("WellKnownName",t.graphicName,e),t.fill!==!1&&this.writeNode("Fill",t,e),t.stroke!==!1&&this.writeNode("Stroke",t,e),e},WellKnownName:function(t){return this.createElementNSPlus("sld:WellKnownName",{value:t})},Opacity:function(t){return this.createElementNSPlus("sld:Opacity",{value:t})},Size:function(t){return this.writers.sld._OGCExpression.call(this,"sld:Size",t)},Rotation:function(t){return this.createElementNSPlus("sld:Rotation",{value:t})},OnlineResource:function(t){return this.createElementNSPlus("sld:OnlineResource",{attributes:{"xlink:type":"simple","xlink:href":t}})},Format:function(t){return this.createElementNSPlus("sld:Format",{value:t})}}},OpenLayers.Format.Filter.v1_0_0.prototype.writers),CLASS_NAME:"OpenLayers.Format.SLD.v1"}),OpenLayers.Format.SLD.v1_0_0=OpenLayers.Class(OpenLayers.Format.SLD.v1,{VERSION:"1.0.0",schemaLocation:"http://www.opengis.net/sld http://schemas.opengis.net/sld/1.0.0/StyledLayerDescriptor.xsd",CLASS_NAME:"OpenLayers.Format.SLD.v1_0_0"}),OpenLayers.Format.Context=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,{layerOptions:null,layerParams:null,read:function(t,e){var i,n=OpenLayers.Format.XML.VersionedOGC.prototype.read.apply(this,arguments);if(e&&e.map)if(this.context=n,e.map instanceof OpenLayers.Map)i=this.mergeContextToMap(n,e.map);else{var s=e.map;(OpenLayers.Util.isElement(s)||"string"==typeof s)&&(s={div:s}),i=this.contextToMap(n,s)}else i=n;return i},getLayerFromContext:function(t){var e,i,n={queryable:t.queryable,visibility:t.visibility,maxExtent:t.maxExtent,metadata:OpenLayers.Util.applyDefaults(t.metadata,{styles:t.styles,formats:t.formats,"abstract":t["abstract"],dataURL:t.dataURL}),numZoomLevels:t.numZoomLevels,units:t.units,isBaseLayer:t.isBaseLayer,opacity:t.opacity,displayInLayerSwitcher:t.displayInLayerSwitcher,singleTile:t.singleTile,tileSize:t.tileSize?new OpenLayers.Size(t.tileSize.width,t.tileSize.height):void 0,minScale:t.minScale||t.maxScaleDenominator,maxScale:t.maxScale||t.minScaleDenominator,srs:t.srs,dimensions:t.dimensions,metadataURL:t.metadataURL};this.layerOptions&&OpenLayers.Util.applyDefaults(n,this.layerOptions);var s={layers:t.name,transparent:t.transparent,version:t.version};if(t.formats&&t.formats.length>0)for(s.format=t.formats[0].value,e=0,i=t.formats.length;i>e;e++){var r=t.formats[e];if(1==r.current){s.format=r.value;break}}if(t.styles&&t.styles.length>0)for(e=0,i=t.styles.length;i>e;e++){var o=t.styles[e];if(1==o.current){o.href?s.sld=o.href:o.body?s.sld_body=o.body:s.styles=o.name;break}}this.layerParams&&OpenLayers.Util.applyDefaults(s,this.layerParams);var a=null,l=t.service;return l==OpenLayers.Format.Context.serviceTypes.WFS?(n.strategies=[new OpenLayers.Strategy.BBOX],n.protocol=new OpenLayers.Protocol.WFS({url:t.url,featurePrefix:t.name.split(":")[0],featureType:t.name.split(":").pop()}),a=new OpenLayers.Layer.Vector(t.title||t.name,n)):l==OpenLayers.Format.Context.serviceTypes.KML?(n.strategies=[new OpenLayers.Strategy.Fixed],n.protocol=new OpenLayers.Protocol.HTTP({url:t.url,format:new OpenLayers.Format.KML}),a=new OpenLayers.Layer.Vector(t.title||t.name,n)):l==OpenLayers.Format.Context.serviceTypes.GML?(n.strategies=[new OpenLayers.Strategy.Fixed],n.protocol=new OpenLayers.Protocol.HTTP({url:t.url,format:new OpenLayers.Format.GML}),a=new OpenLayers.Layer.Vector(t.title||t.name,n)):t.features?(a=new OpenLayers.Layer.Vector(t.title||t.name,n),a.addFeatures(t.features)):t.categoryLayer!==!0&&(a=new OpenLayers.Layer.WMS(t.title||t.name,t.url,s,n)),a},getLayersFromContext:function(t){for(var e=[],i=0,n=t.length;n>i;i++){var s=this.getLayerFromContext(t[i]);null!==s&&e.push(s)}return e},contextToMap:function(t,e){e=OpenLayers.Util.applyDefaults({maxExtent:t.maxExtent,projection:t.projection,units:t.units},e),e.maxExtent&&(e.maxResolution=e.maxExtent.getWidth()/OpenLayers.Map.TILE_WIDTH);var i={contactInformation:t.contactInformation,"abstract":t["abstract"],keywords:t.keywords,logo:t.logo,descriptionURL:t.descriptionURL};e.metadata=i;var n=new OpenLayers.Map(e);return n.addLayers(this.getLayersFromContext(t.layersContext)),n.setCenter(t.bounds.getCenterLonLat(),n.getZoomForExtent(t.bounds,!0)),n},mergeContextToMap:function(t,e){return e.addLayers(this.getLayersFromContext(t.layersContext)),e},write:function(t){return t=this.toContext(t),OpenLayers.Format.XML.VersionedOGC.prototype.write.apply(this,arguments)},CLASS_NAME:"OpenLayers.Format.Context"}),OpenLayers.Format.Context.serviceTypes={WMS:"urn:ogc:serviceType:WMS",WFS:"urn:ogc:serviceType:WFS",WCS:"urn:ogc:serviceType:WCS",GML:"urn:ogc:serviceType:GML",SLD:"urn:ogc:serviceType:SLD",FES:"urn:ogc:serviceType:FES",KML:"urn:ogc:serviceType:KML"},OpenLayers.Format.OWSContext=OpenLayers.Class(OpenLayers.Format.Context,{defaultVersion:"0.3.1",getVersion:function(){var t=OpenLayers.Format.XML.VersionedOGC.prototype.getVersion.apply(this,arguments);return"0.3.0"===t&&(t=this.defaultVersion),t},toContext:function(t){var e={};return"OpenLayers.Map"==t.CLASS_NAME&&(e.bounds=t.getExtent(),e.maxExtent=t.maxExtent,e.projection=t.projection,e.size=t.getSize(),e.layers=t.layers),e},CLASS_NAME:"OpenLayers.Format.OWSContext"}),OpenLayers.Format.OWSCommon=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,{defaultVersion:"1.0.0",getVersion:function(t){var e=this.version;if(!e){var i=t.getAttribute("xmlns:ows");i&&"1.1"===i.substring(i.lastIndexOf("/")+1)&&(e="1.1.0"),e||(e=this.defaultVersion)}return e},CLASS_NAME:"OpenLayers.Format.OWSCommon"}),OpenLayers.Format.OWSCommon.v1=OpenLayers.Class(OpenLayers.Format.XML,{regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},read:function(t,e){e=OpenLayers.Util.applyDefaults(e,this.options);var i={};return this.readChildNodes(t,i),i},readers:{ows:{Exception:function(t,e){var i={code:t.getAttribute("exceptionCode"),locator:t.getAttribute("locator"),texts:[]};e.exceptions.push(i),this.readChildNodes(t,i)},ExceptionText:function(t,e){var i=this.getChildValue(t);e.texts.push(i)},ServiceIdentification:function(t,e){e.serviceIdentification={},this.readChildNodes(t,e.serviceIdentification)},Title:function(t,e){e.title=this.getChildValue(t)},Abstract:function(t,e){e["abstract"]=this.getChildValue(t)},Keywords:function(t,e){e.keywords={},this.readChildNodes(t,e.keywords)},Keyword:function(t,e){e[this.getChildValue(t)]=!0},ServiceType:function(t,e){e.serviceType={codeSpace:t.getAttribute("codeSpace"),value:this.getChildValue(t)}},ServiceTypeVersion:function(t,e){e.serviceTypeVersion=this.getChildValue(t)},Fees:function(t,e){e.fees=this.getChildValue(t)},AccessConstraints:function(t,e){e.accessConstraints=this.getChildValue(t)},ServiceProvider:function(t,e){e.serviceProvider={},this.readChildNodes(t,e.serviceProvider)},ProviderName:function(t,e){e.providerName=this.getChildValue(t)},ProviderSite:function(t,e){e.providerSite=this.getAttributeNS(t,this.namespaces.xlink,"href")},ServiceContact:function(t,e){e.serviceContact={},this.readChildNodes(t,e.serviceContact)},IndividualName:function(t,e){e.individualName=this.getChildValue(t)},PositionName:function(t,e){e.positionName=this.getChildValue(t)},ContactInfo:function(t,e){e.contactInfo={},this.readChildNodes(t,e.contactInfo)},Phone:function(t,e){e.phone={},this.readChildNodes(t,e.phone)},Voice:function(t,e){e.voice=this.getChildValue(t)},Address:function(t,e){e.address={},this.readChildNodes(t,e.address)},DeliveryPoint:function(t,e){e.deliveryPoint=this.getChildValue(t)},City:function(t,e){e.city=this.getChildValue(t)},AdministrativeArea:function(t,e){e.administrativeArea=this.getChildValue(t)},PostalCode:function(t,e){e.postalCode=this.getChildValue(t)},Country:function(t,e){e.country=this.getChildValue(t)},ElectronicMailAddress:function(t,e){e.electronicMailAddress=this.getChildValue(t)},Role:function(t,e){e.role=this.getChildValue(t)},OperationsMetadata:function(t,e){e.operationsMetadata={},this.readChildNodes(t,e.operationsMetadata)},Operation:function(t,e){var i=t.getAttribute("name");e[i]={},this.readChildNodes(t,e[i])},DCP:function(t,e){e.dcp={},this.readChildNodes(t,e.dcp)},HTTP:function(t,e){e.http={},this.readChildNodes(t,e.http)},Get:function(t,e){e.get||(e.get=[]);var i={url:this.getAttributeNS(t,this.namespaces.xlink,"href")};this.readChildNodes(t,i),e.get.push(i)},Post:function(t,e){e.post||(e.post=[]);var i={url:this.getAttributeNS(t,this.namespaces.xlink,"href")};this.readChildNodes(t,i),e.post.push(i)},Parameter:function(t,e){e.parameters||(e.parameters={});var i=t.getAttribute("name");e.parameters[i]={},this.readChildNodes(t,e.parameters[i])},Constraint:function(t,e){e.constraints||(e.constraints={});var i=t.getAttribute("name");e.constraints[i]={},this.readChildNodes(t,e.constraints[i])},Value:function(t,e){e[this.getChildValue(t)]=!0},OutputFormat:function(t,e){e.formats.push({value:this.getChildValue(t)}),this.readChildNodes(t,e)},WGS84BoundingBox:function(t,e){var i={};i.crs=t.getAttribute("crs"),e.BoundingBox?e.BoundingBox.push(i):(e.projection=i.crs,i=e),this.readChildNodes(t,i)},BoundingBox:function(t,e){this.readers.ows.WGS84BoundingBox.apply(this,[t,e])},LowerCorner:function(t,e){var i=this.getChildValue(t).replace(this.regExes.trimSpace,"");i=i.replace(this.regExes.trimComma,",");var n=i.split(this.regExes.splitSpace);e.left=n[0],e.bottom=n[1]},UpperCorner:function(t,e){var i=this.getChildValue(t).replace(this.regExes.trimSpace,"");i=i.replace(this.regExes.trimComma,",");var n=i.split(this.regExes.splitSpace);e.right=n[0],e.top=n[1],e.bounds=new OpenLayers.Bounds(e.left,e.bottom,e.right,e.top),delete e.left,delete e.bottom,delete e.right,delete e.top},Language:function(t,e){e.language=this.getChildValue(t)}}},writers:{ows:{BoundingBox:function(t,e){var i=this.createElementNSPlus(e||"ows:BoundingBox",{attributes:{crs:t.projection}});return this.writeNode("ows:LowerCorner",t,i),this.writeNode("ows:UpperCorner",t,i),i},LowerCorner:function(t){var e=this.createElementNSPlus("ows:LowerCorner",{value:t.bounds.left+" "+t.bounds.bottom});return e},UpperCorner:function(t){var e=this.createElementNSPlus("ows:UpperCorner",{value:t.bounds.right+" "+t.bounds.top});return e},Identifier:function(t){var e=this.createElementNSPlus("ows:Identifier",{value:t});return e},Title:function(t){var e=this.createElementNSPlus("ows:Title",{value:t});return e},Abstract:function(t){var e=this.createElementNSPlus("ows:Abstract",{value:t});return e},OutputFormat:function(t){var e=this.createElementNSPlus("ows:OutputFormat",{value:t});return e}}},CLASS_NAME:"OpenLayers.Format.OWSCommon.v1"}),OpenLayers.Format.OWSCommon.v1_0_0=OpenLayers.Class(OpenLayers.Format.OWSCommon.v1,{namespaces:{ows:"http://www.opengis.net/ows",xlink:"http://www.w3.org/1999/xlink"},readers:{ows:OpenLayers.Util.applyDefaults({ExceptionReport:function(t,e){e.success=!1,e.exceptionReport={version:t.getAttribute("version"),language:t.getAttribute("language"),exceptions:[]},this.readChildNodes(t,e.exceptionReport)}},OpenLayers.Format.OWSCommon.v1.prototype.readers.ows)},writers:{ows:OpenLayers.Format.OWSCommon.v1.prototype.writers.ows},CLASS_NAME:"OpenLayers.Format.OWSCommon.v1_0_0"}),OpenLayers.Format.OWSContext.v0_3_1=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{owc:"http://www.opengis.net/ows-context",gml:"http://www.opengis.net/gml",kml:"http://www.opengis.net/kml/2.2",ogc:"http://www.opengis.net/ogc",ows:"http://www.opengis.net/ows",sld:"http://www.opengis.net/sld",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance"},VERSION:"0.3.1",schemaLocation:"http://www.opengis.net/ows-context http://www.ogcnetwork.net/schemas/owc/0.3.1/owsContext.xsd",defaultPrefix:"owc",extractAttributes:!0,xy:!0,regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},featureNS:"http://mapserver.gis.umn.edu/mapserver",featureType:"vector",geometryName:"geometry",nestingLayerLookup:null,initialize:function(t){OpenLayers.Format.XML.prototype.initialize.apply(this,[t]),OpenLayers.Format.GML.v2.prototype.setGeometryTypes.call(this)},setNestingPath:function(t){if(t.layersContext)for(var e=0,i=t.layersContext.length;i>e;e++){var n=t.layersContext[e],s=[],r=t.title||"";t.metadata&&t.metadata.nestingPath&&(s=t.metadata.nestingPath.slice()),""!=r&&s.push(r),n.metadata.nestingPath=s,n.layersContext&&this.setNestingPath(n)}},decomposeNestingPath:function(t){var e=[];if(OpenLayers.Util.isArray(t)){for(var i=t.slice();i.length>0;)e.push(i.slice()),i.pop();e.reverse()}return e},read:function(t){"string"==typeof t&&(t=OpenLayers.Format.XML.prototype.read.apply(this,[t])),t&&9==t.nodeType&&(t=t.documentElement);var e={};this.readNode(t,e),this.setNestingPath({layersContext:e.layersContext});var i=[];return this.processLayer(i,e),delete e.layersContext,e.layersContext=i,e},processLayer:function(t,e){if(e.layersContext)for(var i=0,n=e.layersContext.length;n>i;i++){var s=e.layersContext[i];t.push(s),s.layersContext&&this.processLayer(t,s)}},write:function(t,e){var i="OWSContext";this.nestingLayerLookup={},e=e||{},OpenLayers.Util.applyDefaults(e,t);var n=this.writeNode(i,e);return this.nestingLayerLookup=null,this.setAttributeNS(n,this.namespaces.xsi,"xsi:schemaLocation",this.schemaLocation),OpenLayers.Format.XML.prototype.write.apply(this,[n])},readers:{kml:{Document:function(t,e){e.features=new OpenLayers.Format.KML({kmlns:this.namespaces.kml,extractStyles:!0}).read(t)}},owc:{OWSContext:function(t,e){this.readChildNodes(t,e)},General:function(t,e){this.readChildNodes(t,e)},ResourceList:function(t,e){this.readChildNodes(t,e)},Layer:function(t,e){var i={metadata:{},visibility:"1"!=t.getAttribute("hidden"),queryable:"1"==t.getAttribute("queryable"),opacity:null!=t.getAttribute("opacity")?parseFloat(t.getAttribute("opacity")):null,name:t.getAttribute("name"),categoryLayer:null==t.getAttribute("name"),formats:[],styles:[]};e.layersContext||(e.layersContext=[]),e.layersContext.push(i),this.readChildNodes(t,i)},InlineGeometry:function(t,e){e.features=[];var i,n=this.getElementsByTagNameNS(t,this.namespaces.gml,"featureMember");if(n.length>=1&&(i=n[0]),i&&i.firstChild){var s=i.firstChild.nextSibling?i.firstChild.nextSibling:i.firstChild;this.setNamespace("feature",s.namespaceURI),this.featureType=s.localName||s.nodeName.split(":").pop(),this.readChildNodes(t,e)}},Server:function(t,e){(!e.service&&!e.version||e.service!=OpenLayers.Format.Context.serviceTypes.WMS)&&(e.service=t.getAttribute("service"),e.version=t.getAttribute("version"),this.readChildNodes(t,e))},Name:function(t,e){e.name=this.getChildValue(t),this.readChildNodes(t,e)},Title:function(t,e){e.title=this.getChildValue(t),this.readChildNodes(t,e)},StyleList:function(t,e){this.readChildNodes(t,e.styles)},Style:function(t,e){var i={};e.push(i),this.readChildNodes(t,i)},LegendURL:function(t,e){var i={};e.legend=i,this.readChildNodes(t,i)},OnlineResource:function(t,e){e.url=this.getAttributeNS(t,this.namespaces.xlink,"href"),this.readChildNodes(t,e)}},ows:OpenLayers.Format.OWSCommon.v1_0_0.prototype.readers.ows,gml:OpenLayers.Format.GML.v2.prototype.readers.gml,sld:OpenLayers.Format.SLD.v1_0_0.prototype.readers.sld,feature:OpenLayers.Format.GML.v2.prototype.readers.feature},writers:{owc:{OWSContext:function(t){var e=this.createElementNSPlus("OWSContext",{attributes:{version:this.VERSION,id:t.id||OpenLayers.Util.createUniqueID("OpenLayers_OWSContext_")}});return this.writeNode("General",t,e),this.writeNode("ResourceList",t,e),e},General:function(t){var e=this.createElementNSPlus("General");return this.writeNode("ows:BoundingBox",t,e),this.writeNode("ows:Title",t.title||"OpenLayers OWSContext",e),e},ResourceList:function(t){for(var e=this.createElementNSPlus("ResourceList"),i=0,n=t.layers.length;n>i;i++){var s=t.layers[i],r=this.decomposeNestingPath(s.metadata.nestingPath);this.writeNode("_Layer",{layer:s,subPaths:r},e)}return e},Server:function(t){var e=this.createElementNSPlus("Server",{attributes:{version:t.version,service:t.service}});return this.writeNode("OnlineResource",t,e),e},OnlineResource:function(t){var e=this.createElementNSPlus("OnlineResource",{attributes:{"xlink:href":t.url}});return e},InlineGeometry:function(t){var e=this.createElementNSPlus("InlineGeometry"),i=t.getDataExtent();null!==i&&this.writeNode("gml:boundedBy",i,e);for(var n=0,s=t.features.length;s>n;n++)this.writeNode("gml:featureMember",t.features[n],e);return e},StyleList:function(t){for(var e=this.createElementNSPlus("StyleList"),i=0,n=t.length;n>i;i++)this.writeNode("Style",t[i],e);return e},Style:function(t){var e=this.createElementNSPlus("Style");return this.writeNode("Name",t,e),this.writeNode("Title",t,e),t.legend&&this.writeNode("LegendURL",t,e),e},Name:function(t){var e=this.createElementNSPlus("Name",{value:t.name});return e},Title:function(t){var e=this.createElementNSPlus("Title",{value:t.title});return e},LegendURL:function(t){var e=this.createElementNSPlus("LegendURL");return this.writeNode("OnlineResource",t.legend,e),e},_WMS:function(t){var e=this.createElementNSPlus("Layer",{attributes:{name:t.params.LAYERS,queryable:t.queryable?"1":"0",hidden:t.visibility?"0":"1",opacity:t.hasOwnProperty("opacity")?t.opacity:null}});return this.writeNode("ows:Title",t.name,e),this.writeNode("ows:OutputFormat",t.params.FORMAT,e),this.writeNode("Server",{service:OpenLayers.Format.Context.serviceTypes.WMS,version:t.params.VERSION,url:t.url},e),t.metadata.styles&&t.metadata.styles.length>0&&this.writeNode("StyleList",t.metadata.styles,e),e},_Layer:function(t){var e,i,n,s;if(e=t.layer,i=t.subPaths,n=null,s=null,i.length>0){var r=i[0].join("/"),o=r.lastIndexOf("/");return n=this.nestingLayerLookup[r],s=o>0?r.substring(o+1,r.length):r,n||(n=this.createElementNSPlus("Layer"),this.writeNode("ows:Title",s,n),this.nestingLayerLookup[r]=n),t.subPaths.shift(),this.writeNode("_Layer",t,n),n}return e instanceof OpenLayers.Layer.WMS?n=this.writeNode("_WMS",e):e instanceof OpenLayers.Layer.Vector&&(e.protocol instanceof OpenLayers.Protocol.WFS.v1?n=this.writeNode("_WFS",e):e.protocol instanceof OpenLayers.Protocol.HTTP?e.protocol.format instanceof OpenLayers.Format.GML?(e.protocol.format.version="2.1.2",n=this.writeNode("_GML",e)):e.protocol.format instanceof OpenLayers.Format.KML&&(e.protocol.format.version="2.2",n=this.writeNode("_KML",e)):(this.setNamespace("feature",this.featureNS),n=this.writeNode("_InlineGeometry",e))),e.options.maxScale&&this.writeNode("sld:MinScaleDenominator",e.options.maxScale,n),e.options.minScale&&this.writeNode("sld:MaxScaleDenominator",e.options.minScale,n),this.nestingLayerLookup[e.name]=n,n},_WFS:function(t){var e=this.createElementNSPlus("Layer",{attributes:{name:t.protocol.featurePrefix+":"+t.protocol.featureType,hidden:t.visibility?"0":"1"}});return this.writeNode("ows:Title",t.name,e),this.writeNode("Server",{service:OpenLayers.Format.Context.serviceTypes.WFS,version:t.protocol.version,url:t.protocol.url},e),e},_InlineGeometry:function(t){var e=this.createElementNSPlus("Layer",{attributes:{name:this.featureType,hidden:t.visibility?"0":"1"}});return this.writeNode("ows:Title",t.name,e),this.writeNode("InlineGeometry",t,e),e},_GML:function(t){var e=this.createElementNSPlus("Layer");return this.writeNode("ows:Title",t.name,e),this.writeNode("Server",{service:OpenLayers.Format.Context.serviceTypes.GML,url:t.protocol.url,version:t.protocol.format.version},e),e},_KML:function(t){var e=this.createElementNSPlus("Layer");return this.writeNode("ows:Title",t.name,e),this.writeNode("Server",{service:OpenLayers.Format.Context.serviceTypes.KML,version:t.protocol.format.version,url:t.protocol.url},e),e}},gml:OpenLayers.Util.applyDefaults({boundedBy:function(t){var e=this.createElementNSPlus("gml:boundedBy");return this.writeNode("gml:Box",t,e),e}},OpenLayers.Format.GML.v2.prototype.writers.gml),ows:OpenLayers.Format.OWSCommon.v1_0_0.prototype.writers.ows,sld:OpenLayers.Format.SLD.v1_0_0.prototype.writers.sld,feature:OpenLayers.Format.GML.v2.prototype.writers.feature},CLASS_NAME:"OpenLayers.Format.OWSContext.v0_3_1"}),OpenLayers.Format.CSWGetRecords=function(t){t=OpenLayers.Util.applyDefaults(t,OpenLayers.Format.CSWGetRecords.DEFAULTS);var e=OpenLayers.Format.CSWGetRecords["v"+t.version.replace(/\./g,"_")];if(!e)throw"Unsupported CSWGetRecords version: "+t.version;return new e(t)},OpenLayers.Format.CSWGetRecords.DEFAULTS={version:"2.0.2"},OpenLayers.Control=OpenLayers.Class({id:null,map:null,div:null,type:null,allowSelection:!1,displayClass:"",title:"",autoActivate:!1,active:null,handlerOptions:null,handler:null,eventListeners:null,events:null,initialize:function(t){this.displayClass=this.CLASS_NAME.replace("OpenLayers.","ol").replace(/\./g,""),OpenLayers.Util.extend(this,t),this.events=new OpenLayers.Events(this),this.eventListeners instanceof Object&&this.events.on(this.eventListeners),null==this.id&&(this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_"))},destroy:function(){if(this.events&&(this.eventListeners&&this.events.un(this.eventListeners),this.events.destroy(),this.events=null),this.eventListeners=null,this.handler&&(this.handler.destroy(),this.handler=null),this.handlers){for(var t in this.handlers)this.handlers.hasOwnProperty(t)&&"function"==typeof this.handlers[t].destroy&&this.handlers[t].destroy();this.handlers=null}this.map&&(this.map.removeControl(this),this.map=null),this.div=null},setMap:function(t){this.map=t,this.handler&&this.handler.setMap(t)},draw:function(t){return null==this.div&&(this.div=OpenLayers.Util.createDiv(this.id),this.div.className=this.displayClass,this.allowSelection||(this.div.className+=" olControlNoSelect",this.div.setAttribute("unselectable","on",0),this.div.onselectstart=OpenLayers.Function.False),""!=this.title&&(this.div.title=this.title)),null!=t&&(this.position=t.clone()),this.moveTo(this.position),this.div},moveTo:function(t){null!=t&&null!=this.div&&(this.div.style.left=t.x+"px",this.div.style.top=t.y+"px")},activate:function(){return this.active?!1:(this.handler&&this.handler.activate(),this.active=!0,this.map&&OpenLayers.Element.addClass(this.map.viewPortDiv,this.displayClass.replace(/ /g,"")+"Active"),this.events.triggerEvent("activate"),!0)},deactivate:function(){return this.active?(this.handler&&this.handler.deactivate(),this.active=!1,this.map&&OpenLayers.Element.removeClass(this.map.viewPortDiv,this.displayClass.replace(/ /g,"")+"Active"),this.events.triggerEvent("deactivate"),!0):!1},CLASS_NAME:"OpenLayers.Control"}),OpenLayers.Control.TYPE_BUTTON=1,OpenLayers.Control.TYPE_TOGGLE=2,OpenLayers.Control.TYPE_TOOL=3,OpenLayers.Events.buttonclick=OpenLayers.Class({target:null,events:["mousedown","mouseup","click","dblclick","touchstart","touchmove","touchend","keydown"],startRegEx:/^mousedown|touchstart$/,cancelRegEx:/^touchmove$/,completeRegEx:/^mouseup|touchend$/,initialize:function(t){this.target=t;for(var e=this.events.length-1;e>=0;--e)this.target.register(this.events[e],this,this.buttonClick,{extension:!0})},destroy:function(){for(var t=this.events.length-1;t>=0;--t)this.target.unregister(this.events[t],this,this.buttonClick);delete this.target},getPressedButton:function(t){var e,i=3;do{if(OpenLayers.Element.hasClass(t,"olButton")){e=t;break}t=t.parentNode}while(--i>0&&t);return e},ignore:function(t){var e=3,i=!1;do{if("a"===t.nodeName.toLowerCase()){i=!0;break}t=t.parentNode}while(--e>0&&t);return i},buttonClick:function(t){var e=!0,i=OpenLayers.Event.element(t);if(i&&(OpenLayers.Event.isLeftClick(t)||!~t.type.indexOf("mouse"))){var n=this.getPressedButton(i);if(n){if("keydown"===t.type)switch(t.keyCode){case OpenLayers.Event.KEY_RETURN:case OpenLayers.Event.KEY_SPACE:this.target.triggerEvent("buttonclick",{buttonElement:n}),OpenLayers.Event.stop(t),e=!1}else if(this.startEvt){if(this.completeRegEx.test(t.type)){var s=OpenLayers.Util.pagePosition(n),r=OpenLayers.Util.getViewportElement(),o=window.pageYOffset||r.scrollTop,a=window.pageXOffset||r.scrollLeft;s[0]=s[0]-a,s[1]=s[1]-o,this.target.triggerEvent("buttonclick",{buttonElement:n,buttonXY:{x:this.startEvt.clientX-s[0],y:this.startEvt.clientY-s[1]}})}this.cancelRegEx.test(t.type)&&delete this.startEvt,OpenLayers.Event.stop(t),e=!1}this.startRegEx.test(t.type)&&(this.startEvt=t,OpenLayers.Event.stop(t),e=!1)}else e=!this.ignore(OpenLayers.Event.element(t)),delete this.startEvt}return e}}),OpenLayers.Util=OpenLayers.Util||{},OpenLayers.Util.vendorPrefix=function(){"use strict";function t(t){return t?t.replace(/([A-Z])/g,function(t){return"-"+t.toLowerCase()}).replace(/^ms-/,"-ms-"):null}function e(e){if(void 0===o[e]){var i=e.replace(/(-[\s\S])/g,function(t){return t.charAt(1).toUpperCase()}),s=n(i);o[e]=t(s)}return o[e]}function i(t,e){if(void 0===a[e]){var i,n,r=0,o=s.length,l="undefined"!=typeof t.cssText;for(a[e]=null;o>r;r++)if(n=s[r],n?(l||(n=n.toLowerCase()),i=n+e.charAt(0).toUpperCase()+e.slice(1)):i=e,void 0!==t[i]){a[e]=i;break}}return a[e]}function n(t){return i(r,t)}var s=["","O","ms","Moz","Webkit"],r=document.createElement("div").style,o={},a={};return{css:e,js:i,style:n,cssCache:o,jsCache:a}}(),OpenLayers.Animation=function(t){function e(t,e,i){e=e>0?e:Number.POSITIVE_INFINITY;var n=++o,s=+new Date;return a[n]=function(){a[n]&&+new Date-s<=e?(t(),a[n]&&r(a[n],i)):delete a[n]},r(a[n],i),n}function i(t){delete a[t]}var n=OpenLayers.Util.vendorPrefix.js(t,"requestAnimationFrame"),s=!!n,r=function(){var e=t[n]||function(e){t.setTimeout(e,16)};return function(i,n){e.apply(t,[i,n])}}(),o=0,a={};return{isNative:s,requestFrame:r,start:e,stop:i}}(window),OpenLayers.Tween=OpenLayers.Class({easing:null,begin:null,finish:null,duration:null,callbacks:null,time:null,minFrameRate:null,startTime:null,animationId:null,playing:!1,initialize:function(t){this.easing=t?t:OpenLayers.Easing.Expo.easeOut},start:function(t,e,i,n){this.playing=!0,this.begin=t,this.finish=e,this.duration=i,this.callbacks=n.callbacks,this.minFrameRate=n.minFrameRate||30,this.time=0,this.startTime=(new Date).getTime(),OpenLayers.Animation.stop(this.animationId),this.animationId=null,this.callbacks&&this.callbacks.start&&this.callbacks.start.call(this,this.begin),this.animationId=OpenLayers.Animation.start(OpenLayers.Function.bind(this.play,this))},stop:function(){this.playing&&(this.callbacks&&this.callbacks.done&&this.callbacks.done.call(this,this.finish),OpenLayers.Animation.stop(this.animationId),this.animationId=null,this.playing=!1)},play:function(){var t={};for(var e in this.begin){var i=this.begin[e],n=this.finish[e];if(null==i||null==n||isNaN(i)||isNaN(n))throw new TypeError("invalid value for Tween");var s=n-i;t[e]=this.easing.apply(this,[this.time,i,s,this.duration])}this.time++,this.callbacks&&this.callbacks.eachStep&&((new Date).getTime()-this.startTime)/this.time<=1e3/this.minFrameRate&&this.callbacks.eachStep.call(this,t),this.time>this.duration&&this.stop()},CLASS_NAME:"OpenLayers.Tween"}),OpenLayers.Easing={CLASS_NAME:"OpenLayers.Easing"},OpenLayers.Easing.Linear={easeIn:function(t,e,i,n){return i*t/n+e},easeOut:function(t,e,i,n){return i*t/n+e},easeInOut:function(t,e,i,n){return i*t/n+e},CLASS_NAME:"OpenLayers.Easing.Linear"},OpenLayers.Easing.Expo={easeIn:function(t,e,i,n){return 0==t?e:i*Math.pow(2,10*(t/n-1))+e},easeOut:function(t,e,i,n){return t==n?e+i:i*(-Math.pow(2,-10*t/n)+1)+e},easeInOut:function(t,e,i,n){return 0==t?e:t==n?e+i:(t/=n/2)<1?i/2*Math.pow(2,10*(t-1))+e:i/2*(-Math.pow(2,-10*--t)+2)+e},CLASS_NAME:"OpenLayers.Easing.Expo"},OpenLayers.Easing.Quad={easeIn:function(t,e,i,n){return i*(t/=n)*t+e},easeOut:function(t,e,i,n){return-i*(t/=n)*(t-2)+e},easeInOut:function(t,e,i,n){return(t/=n/2)<1?i/2*t*t+e:-i/2*(--t*(t-2)-1)+e},CLASS_NAME:"OpenLayers.Easing.Quad"},OpenLayers.Map=OpenLayers.Class({Z_INDEX_BASE:{BaseLayer:100,Overlay:325,Feature:725,Popup:750,Control:1e3},id:null,fractionalZoom:!1,events:null,allOverlays:!1,div:null,dragging:!1,size:null,viewPortDiv:null,layerContainerOrigin:null,layerContainerDiv:null,layers:null,controls:null,popups:null,baseLayer:null,center:null,resolution:null,zoom:0,panRatio:1.5,options:null,tileSize:null,projection:"EPSG:4326",units:null,resolutions:null,maxResolution:null,minResolution:null,maxScale:null,minScale:null,maxExtent:null,minExtent:null,restrictedExtent:null,numZoomLevels:16,theme:null,displayProjection:null,fallThrough:!1,autoUpdateSize:!0,eventListeners:null,panTween:null,panMethod:OpenLayers.Easing.Expo.easeOut,panDuration:50,zoomTween:null,zoomMethod:OpenLayers.Easing.Quad.easeOut,zoomDuration:20,paddingForPopups:null,layerContainerOriginPx:null,minPx:null,maxPx:null,initialize:function(t,e){1===arguments.length&&"object"==typeof t&&(e=t,t=e&&e.div),this.tileSize=new OpenLayers.Size(OpenLayers.Map.TILE_WIDTH,OpenLayers.Map.TILE_HEIGHT),this.paddingForPopups=new OpenLayers.Bounds(15,15,15,15),this.theme=OpenLayers._getScriptLocation()+"theme/default/style.css",this.options=OpenLayers.Util.extend({},e),OpenLayers.Util.extend(this,e);var i=this.projection instanceof OpenLayers.Projection?this.projection.projCode:this.projection;OpenLayers.Util.applyDefaults(this,OpenLayers.Projection.defaults[i]),!this.maxExtent||this.maxExtent instanceof OpenLayers.Bounds||(this.maxExtent=new OpenLayers.Bounds(this.maxExtent)),!this.minExtent||this.minExtent instanceof OpenLayers.Bounds||(this.minExtent=new OpenLayers.Bounds(this.minExtent)),!this.restrictedExtent||this.restrictedExtent instanceof OpenLayers.Bounds||(this.restrictedExtent=new OpenLayers.Bounds(this.restrictedExtent)),!this.center||this.center instanceof OpenLayers.LonLat||(this.center=new OpenLayers.LonLat(this.center)),this.layers=[],this.id=OpenLayers.Util.createUniqueID("OpenLayers.Map_"),this.div=OpenLayers.Util.getElement(t),this.div||(this.div=document.createElement("div"),this.div.style.height="1px",this.div.style.width="1px"),OpenLayers.Element.addClass(this.div,"olMap");var n=this.id+"_OpenLayers_ViewPort";if(this.viewPortDiv=OpenLayers.Util.createDiv(n,null,null,null,"relative",null,"hidden"),this.viewPortDiv.style.width="100%",this.viewPortDiv.style.height="100%",this.viewPortDiv.className="olMapViewport",this.div.appendChild(this.viewPortDiv),this.events=new OpenLayers.Events(this,this.viewPortDiv,null,this.fallThrough,{includeXY:!0}),OpenLayers.TileManager&&null!==this.tileManager&&(this.tileManager instanceof OpenLayers.TileManager||(this.tileManager=new OpenLayers.TileManager(this.tileManager)),this.tileManager.addMap(this)),n=this.id+"_OpenLayers_Container",this.layerContainerDiv=OpenLayers.Util.createDiv(n),this.layerContainerDiv.style.zIndex=this.Z_INDEX_BASE.Popup-1,this.layerContainerOriginPx={x:0,y:0},this.applyTransform(),this.viewPortDiv.appendChild(this.layerContainerDiv),this.updateSize(),this.eventListeners instanceof Object&&this.events.on(this.eventListeners),this.autoUpdateSize===!0&&(this.updateSizeDestroy=OpenLayers.Function.bind(this.updateSize,this),OpenLayers.Event.observe(window,"resize",this.updateSizeDestroy)),this.theme){for(var s=!0,r=document.getElementsByTagName("link"),o=0,a=r.length;a>o;++o)if(OpenLayers.Util.isEquivalentUrl(r.item(o).href,this.theme)){s=!1;
break}if(s){var l=document.createElement("link");l.setAttribute("rel","stylesheet"),l.setAttribute("type","text/css"),l.setAttribute("href",this.theme),document.getElementsByTagName("head")[0].appendChild(l)}}null==this.controls&&(this.controls=[],null!=OpenLayers.Control&&(OpenLayers.Control.Navigation?this.controls.push(new OpenLayers.Control.Navigation):OpenLayers.Control.TouchNavigation&&this.controls.push(new OpenLayers.Control.TouchNavigation),OpenLayers.Control.Zoom?this.controls.push(new OpenLayers.Control.Zoom):OpenLayers.Control.PanZoom&&this.controls.push(new OpenLayers.Control.PanZoom),OpenLayers.Control.ArgParser&&this.controls.push(new OpenLayers.Control.ArgParser),OpenLayers.Control.Attribution&&this.controls.push(new OpenLayers.Control.Attribution)));for(var o=0,a=this.controls.length;a>o;o++)this.addControlToMap(this.controls[o]);this.popups=[],this.unloadDestroy=OpenLayers.Function.bind(this.destroy,this),OpenLayers.Event.observe(window,"unload",this.unloadDestroy),e&&e.layers&&(delete this.center,delete this.zoom,this.addLayers(e.layers),e.center&&!this.getCenter()&&this.setCenter(e.center,e.zoom)),this.panMethod&&(this.panTween=new OpenLayers.Tween(this.panMethod)),this.zoomMethod&&this.applyTransform.transform&&(this.zoomTween=new OpenLayers.Tween(this.zoomMethod))},getViewport:function(){return this.viewPortDiv},render:function(t){this.div=OpenLayers.Util.getElement(t),OpenLayers.Element.addClass(this.div,"olMap"),this.viewPortDiv.parentNode.removeChild(this.viewPortDiv),this.div.appendChild(this.viewPortDiv),this.updateSize()},unloadDestroy:null,updateSizeDestroy:null,destroy:function(){if(!this.unloadDestroy)return!1;if(this.panTween&&(this.panTween.stop(),this.panTween=null),this.zoomTween&&(this.zoomTween.stop(),this.zoomTween=null),OpenLayers.Event.stopObserving(window,"unload",this.unloadDestroy),this.unloadDestroy=null,this.updateSizeDestroy&&OpenLayers.Event.stopObserving(window,"resize",this.updateSizeDestroy),this.paddingForPopups=null,null!=this.controls){for(var t=this.controls.length-1;t>=0;--t)this.controls[t].destroy();this.controls=null}if(null!=this.layers){for(var t=this.layers.length-1;t>=0;--t)this.layers[t].destroy(!1);this.layers=null}this.viewPortDiv&&this.viewPortDiv.parentNode&&this.viewPortDiv.parentNode.removeChild(this.viewPortDiv),this.viewPortDiv=null,this.tileManager&&(this.tileManager.removeMap(this),this.tileManager=null),this.eventListeners&&(this.events.un(this.eventListeners),this.eventListeners=null),this.events.destroy(),this.events=null,this.options=null},setOptions:function(t){var e=this.minPx&&t.restrictedExtent!=this.restrictedExtent;OpenLayers.Util.extend(this,t),e&&this.moveTo(this.getCachedCenter(),this.zoom,{forceZoomChange:!0})},getTileSize:function(){return this.tileSize},getBy:function(t,e,i){var n="function"==typeof i.test,s=OpenLayers.Array.filter(this[t],function(t){return t[e]==i||n&&i.test(t[e])});return s},getLayersBy:function(t,e){return this.getBy("layers",t,e)},getLayersByName:function(t){return this.getLayersBy("name",t)},getLayersByClass:function(t){return this.getLayersBy("CLASS_NAME",t)},getControlsBy:function(t,e){return this.getBy("controls",t,e)},getControlsByClass:function(t){return this.getControlsBy("CLASS_NAME",t)},getLayer:function(t){for(var e=null,i=0,n=this.layers.length;n>i;i++){var s=this.layers[i];if(s.id==t){e=s;break}}return e},setLayerZIndex:function(t,e){t.setZIndex(this.Z_INDEX_BASE[t.isBaseLayer?"BaseLayer":"Overlay"]+5*e)},resetLayersZIndex:function(){for(var t=0,e=this.layers.length;e>t;t++){var i=this.layers[t];this.setLayerZIndex(i,t)}},addLayer:function(t){for(var e=0,i=this.layers.length;i>e;e++)if(this.layers[e]==t)return!1;return this.events.triggerEvent("preaddlayer",{layer:t})===!1?!1:(this.allOverlays&&(t.isBaseLayer=!1),t.div.className="olLayerDiv",t.div.style.overflow="",this.setLayerZIndex(t,this.layers.length),t.isFixed?this.viewPortDiv.appendChild(t.div):this.layerContainerDiv.appendChild(t.div),this.layers.push(t),t.setMap(this),t.isBaseLayer||this.allOverlays&&!this.baseLayer?null==this.baseLayer?this.setBaseLayer(t):t.setVisibility(!1):t.redraw(),this.events.triggerEvent("addlayer",{layer:t}),t.events.triggerEvent("added",{map:this,layer:t}),t.afterAdd(),!0)},addLayers:function(t){for(var e=0,i=t.length;i>e;e++)this.addLayer(t[e])},removeLayer:function(t,e){if(this.events.triggerEvent("preremovelayer",{layer:t})!==!1){if(null==e&&(e=!0),t.isFixed?this.viewPortDiv.removeChild(t.div):this.layerContainerDiv.removeChild(t.div),OpenLayers.Util.removeItem(this.layers,t),t.removeMap(this),t.map=null,this.baseLayer==t&&(this.baseLayer=null,e))for(var i=0,n=this.layers.length;n>i;i++){var s=this.layers[i];if(s.isBaseLayer||this.allOverlays){this.setBaseLayer(s);break}}this.resetLayersZIndex(),this.events.triggerEvent("removelayer",{layer:t}),t.events.triggerEvent("removed",{map:this,layer:t})}},getNumLayers:function(){return this.layers.length},getLayerIndex:function(t){return OpenLayers.Util.indexOf(this.layers,t)},setLayerIndex:function(t,e){var i=this.getLayerIndex(t);if(0>e?e=0:e>this.layers.length&&(e=this.layers.length),i!=e){this.layers.splice(i,1),this.layers.splice(e,0,t);for(var n=0,s=this.layers.length;s>n;n++)this.setLayerZIndex(this.layers[n],n);this.events.triggerEvent("changelayer",{layer:t,property:"order"}),this.allOverlays&&(0===e?this.setBaseLayer(t):this.baseLayer!==this.layers[0]&&this.setBaseLayer(this.layers[0]))}},raiseLayer:function(t,e){var i=this.getLayerIndex(t)+e;this.setLayerIndex(t,i)},setBaseLayer:function(t){if(t!=this.baseLayer&&-1!=OpenLayers.Util.indexOf(this.layers,t)){var e=this.getCachedCenter(),i=OpenLayers.Util.getResolutionFromScale(this.getScale(),t.units);if(null==this.baseLayer||this.allOverlays||this.baseLayer.setVisibility(!1),this.baseLayer=t,(!this.allOverlays||this.baseLayer.visibility)&&(this.baseLayer.setVisibility(!0),this.baseLayer.inRange===!1&&this.baseLayer.redraw()),null!=e){var n=this.getZoomForResolution(i||this.resolution,!0);this.setCenter(e,n,!1,!0)}this.events.triggerEvent("changebaselayer",{layer:this.baseLayer})}},addControl:function(t,e){this.controls.push(t),this.addControlToMap(t,e)},addControls:function(t,e){for(var i=1===arguments.length?[]:e,n=0,s=t.length;s>n;n++){var r=t[n],o=i[n]?i[n]:null;this.addControl(r,o)}},addControlToMap:function(t,e){t.outsideViewport=null!=t.div,this.displayProjection&&!t.displayProjection&&(t.displayProjection=this.displayProjection),t.setMap(this);var i=t.draw(e);i&&(t.outsideViewport||(i.style.zIndex=this.Z_INDEX_BASE.Control+this.controls.length,this.viewPortDiv.appendChild(i))),t.autoActivate&&t.activate()},getControl:function(t){for(var e=null,i=0,n=this.controls.length;n>i;i++){var s=this.controls[i];if(s.id==t){e=s;break}}return e},removeControl:function(t){t&&t==this.getControl(t.id)&&(t.div&&t.div.parentNode==this.viewPortDiv&&this.viewPortDiv.removeChild(t.div),OpenLayers.Util.removeItem(this.controls,t))},addPopup:function(t,e){if(e)for(var i=this.popups.length-1;i>=0;--i)this.removePopup(this.popups[i]);t.map=this,this.popups.push(t);var n=t.draw();n&&(n.style.zIndex=this.Z_INDEX_BASE.Popup+this.popups.length,this.layerContainerDiv.appendChild(n))},removePopup:function(t){if(OpenLayers.Util.removeItem(this.popups,t),t.div)try{this.layerContainerDiv.removeChild(t.div)}catch(e){}t.map=null},getSize:function(){var t=null;return null!=this.size&&(t=this.size.clone()),t},updateSize:function(){var t=this.getCurrentSize();if(t&&!isNaN(t.h)&&!isNaN(t.w)){this.events.clearMouseCache();var e=this.getSize();if(null==e&&(this.size=e=t),!t.equals(e)){this.size=t;for(var i=0,n=this.layers.length;n>i;i++)this.layers[i].onMapResize();var s=this.getCachedCenter();if(null!=this.baseLayer&&null!=s){var r=this.getZoom();this.zoom=null,this.setCenter(s,r)}}}this.events.triggerEvent("updatesize")},getCurrentSize:function(){var t=new OpenLayers.Size(this.div.clientWidth,this.div.clientHeight);return(0==t.w&&0==t.h||isNaN(t.w)&&isNaN(t.h))&&(t.w=this.div.offsetWidth,t.h=this.div.offsetHeight),(0==t.w&&0==t.h||isNaN(t.w)&&isNaN(t.h))&&(t.w=parseInt(this.div.style.width),t.h=parseInt(this.div.style.height)),t},calculateBounds:function(t,e){var i=null;if(null==t&&(t=this.getCachedCenter()),null==e&&(e=this.getResolution()),null!=t&&null!=e){var n=this.size.w*e/2,s=this.size.h*e/2;i=new OpenLayers.Bounds(t.lon-n,t.lat-s,t.lon+n,t.lat+s)}return i},getCenter:function(){var t=null,e=this.getCachedCenter();return e&&(t=e.clone()),t},getCachedCenter:function(){return!this.center&&this.size&&(this.center=this.getLonLatFromViewPortPx({x:this.size.w/2,y:this.size.h/2})),this.center},getZoom:function(){return this.zoom},pan:function(t,e,i){if(i=OpenLayers.Util.applyDefaults(i,{animate:!0,dragging:!1}),i.dragging)(0!=t||0!=e)&&this.moveByPx(t,e);else{var n=this.getViewPortPxFromLonLat(this.getCachedCenter()),s=n.add(t,e);if(this.dragging||!s.equals(n)){var r=this.getLonLatFromViewPortPx(s);i.animate?this.panTo(r):(this.moveTo(r),this.dragging&&(this.dragging=!1,this.events.triggerEvent("moveend")))}}},panTo:function(t){if(this.panTween&&this.getExtent().scale(this.panRatio).containsLonLat(t)){var e=this.getCachedCenter();if(t.equals(e))return;var i=this.getPixelFromLonLat(e),n=this.getPixelFromLonLat(t),s={x:n.x-i.x,y:n.y-i.y},r={x:0,y:0};this.panTween.start({x:0,y:0},s,this.panDuration,{callbacks:{eachStep:OpenLayers.Function.bind(function(t){var e=t.x-r.x,i=t.y-r.y;this.moveByPx(e,i),r.x=Math.round(t.x),r.y=Math.round(t.y)},this),done:OpenLayers.Function.bind(function(){this.moveTo(t),this.dragging=!1,this.events.triggerEvent("moveend")},this)}})}else this.setCenter(t)},setCenter:function(t,e,i,n){this.panTween&&this.panTween.stop(),this.zoomTween&&this.zoomTween.stop(),this.moveTo(t,e,{dragging:i,forceZoomChange:n})},moveByPx:function(t,e){var i=this.size.w/2,n=this.size.h/2,s=i+t,r=n+e,o=this.baseLayer.wrapDateLine,a=0,l=0;if(this.restrictedExtent&&(a=i,l=n,o=!1),t=o||s<=this.maxPx.x-a&&s>=this.minPx.x+a?Math.round(t):0,e=r<=this.maxPx.y-l&&r>=this.minPx.y+l?Math.round(e):0,t||e){this.dragging||(this.dragging=!0,this.events.triggerEvent("movestart")),this.center=null,t&&(this.layerContainerOriginPx.x-=t,this.minPx.x-=t,this.maxPx.x-=t),e&&(this.layerContainerOriginPx.y-=e,this.minPx.y-=e,this.maxPx.y-=e),this.applyTransform();var h,u,p;for(u=0,p=this.layers.length;p>u;++u)h=this.layers[u],h.visibility&&(h===this.baseLayer||h.inRange)&&(h.moveByPx(t,e),h.events.triggerEvent("move"));this.events.triggerEvent("move")}},adjustZoom:function(t){if(this.baseLayer&&this.baseLayer.wrapDateLine){var e=this.baseLayer.resolutions,i=this.getMaxExtent().getWidth()/this.size.w;if(this.getResolutionForZoom(t)>i)if(this.fractionalZoom)t=this.getZoomForResolution(i);else for(var n=0|t,s=e.length;s>n;++n)if(e[n]<=i){t=n;break}}return t},getMinZoom:function(){return this.adjustZoom(0)},moveTo:function(t,e,i){null==t||t instanceof OpenLayers.LonLat||(t=new OpenLayers.LonLat(t)),i||(i={}),null!=e&&(e=parseFloat(e),this.fractionalZoom||(e=Math.round(e)));var n=e;e=this.adjustZoom(e),e!==n&&(t=this.getCenter());var s=i.dragging||this.dragging,r=i.forceZoomChange;if(this.getCachedCenter()||this.isValidLonLat(t)||(t=this.maxExtent.getCenterLonLat(),this.center=t.clone()),null!=this.restrictedExtent){null==t&&(t=this.center),null==e&&(e=this.getZoom());var o=this.getResolutionForZoom(e),a=this.calculateBounds(t,o);if(!this.restrictedExtent.containsBounds(a)){var l=this.restrictedExtent.getCenterLonLat();a.getWidth()>this.restrictedExtent.getWidth()?t=new OpenLayers.LonLat(l.lon,t.lat):a.left<this.restrictedExtent.left?t=t.add(this.restrictedExtent.left-a.left,0):a.right>this.restrictedExtent.right&&(t=t.add(this.restrictedExtent.right-a.right,0)),a.getHeight()>this.restrictedExtent.getHeight()?t=new OpenLayers.LonLat(t.lon,l.lat):a.bottom<this.restrictedExtent.bottom?t=t.add(0,this.restrictedExtent.bottom-a.bottom):a.top>this.restrictedExtent.top&&(t=t.add(0,this.restrictedExtent.top-a.top))}}var h=r||this.isValidZoomLevel(e)&&e!=this.getZoom(),u=this.isValidLonLat(t)&&!t.equals(this.center);if(h||u||s){s||this.events.triggerEvent("movestart",{zoomChanged:h}),u&&(!h&&this.center&&this.centerLayerContainer(t),this.center=t.clone());var p=h?this.getResolutionForZoom(e):this.getResolution();if(h||null==this.layerContainerOrigin){this.layerContainerOrigin=this.getCachedCenter(),this.layerContainerOriginPx.x=0,this.layerContainerOriginPx.y=0,this.applyTransform();var c=this.getMaxExtent({restricted:!0}),d=c.getCenterLonLat(),m=this.center.lon-d.lon,f=d.lat-this.center.lat,y=Math.round(c.getWidth()/p),g=Math.round(c.getHeight()/p);this.minPx={x:(this.size.w-y)/2-m/p,y:(this.size.h-g)/2-f/p},this.maxPx={x:this.minPx.x+Math.round(c.getWidth()/p),y:this.minPx.y+Math.round(c.getHeight()/p)}}h&&(this.zoom=e,this.resolution=p);var v=this.getExtent();this.baseLayer.visibility&&(this.baseLayer.moveTo(v,h,i.dragging),i.dragging||this.baseLayer.events.triggerEvent("moveend",{zoomChanged:h})),v=this.baseLayer.getExtent();for(var L=this.layers.length-1;L>=0;--L){var _=this.layers[L];if(_!==this.baseLayer&&!_.isBaseLayer){var O=_.calculateInRange();_.inRange!=O&&(_.inRange=O,O||_.display(!1),this.events.triggerEvent("changelayer",{layer:_,property:"visibility"})),O&&_.visibility&&(_.moveTo(v,h,i.dragging),i.dragging||_.events.triggerEvent("moveend",{zoomChanged:h}))}}if(this.events.triggerEvent("move"),s||this.events.triggerEvent("moveend"),h){for(var L=0,b=this.popups.length;b>L;L++)this.popups[L].updatePosition();this.events.triggerEvent("zoomend")}}},centerLayerContainer:function(t){var e=this.getViewPortPxFromLonLat(this.layerContainerOrigin),i=this.getViewPortPxFromLonLat(t);if(null!=e&&null!=i){var n=this.layerContainerOriginPx.x,s=this.layerContainerOriginPx.y,r=Math.round(e.x-i.x),o=Math.round(e.y-i.y);this.applyTransform(this.layerContainerOriginPx.x=r,this.layerContainerOriginPx.y=o);var a=n-r,l=s-o;this.minPx.x-=a,this.maxPx.x-=a,this.minPx.y-=l,this.maxPx.y-=l}},isValidZoomLevel:function(t){return null!=t&&t>=0&&t<this.getNumZoomLevels()},isValidLonLat:function(t){var e=!1;if(null!=t){var i=this.getMaxExtent(),n=this.baseLayer.wrapDateLine&&i;e=i.containsLonLat(t,{worldBounds:n})}return e},getProjection:function(){var t=this.getProjectionObject();return t?t.getCode():null},getProjectionObject:function(){var t=null;return null!=this.baseLayer&&(t=this.baseLayer.projection),t},getMaxResolution:function(){var t=null;return null!=this.baseLayer&&(t=this.baseLayer.maxResolution),t},getMaxExtent:function(t){var e=null;return t&&t.restricted&&this.restrictedExtent?e=this.restrictedExtent:null!=this.baseLayer&&(e=this.baseLayer.maxExtent),e},getNumZoomLevels:function(){var t=null;return null!=this.baseLayer&&(t=this.baseLayer.numZoomLevels),t},getExtent:function(){var t=null;return null!=this.baseLayer&&(t=this.baseLayer.getExtent()),t},getResolution:function(){var t=null;return null!=this.baseLayer?t=this.baseLayer.getResolution():this.allOverlays===!0&&this.layers.length>0&&(t=this.layers[0].getResolution()),t},getUnits:function(){var t=null;return null!=this.baseLayer&&(t=this.baseLayer.units),t},getScale:function(){var t=null;if(null!=this.baseLayer){var e=this.getResolution(),i=this.baseLayer.units;t=OpenLayers.Util.getScaleFromResolution(e,i)}return t},getZoomForExtent:function(t,e){var i=null;return null!=this.baseLayer&&(i=this.baseLayer.getZoomForExtent(t,e)),i},getResolutionForZoom:function(t){var e=null;return this.baseLayer&&(e=this.baseLayer.getResolutionForZoom(t)),e},getZoomForResolution:function(t,e){var i=null;return null!=this.baseLayer&&(i=this.baseLayer.getZoomForResolution(t,e)),i},zoomTo:function(t,e){var i=this;if(i.isValidZoomLevel(t))if(i.baseLayer.wrapDateLine&&(t=i.adjustZoom(t)),i.zoomTween){var n=i.getResolution(),s=i.getResolutionForZoom(t),r={scale:1},o={scale:n/s};if(i.zoomTween.playing&&i.zoomTween.duration<3*i.zoomDuration)i.zoomTween.finish={scale:i.zoomTween.finish.scale*o.scale};else{if(!e){var a=i.getSize();e={x:a.w/2,y:a.h/2}}i.zoomTween.start(r,o,i.zoomDuration,{minFrameRate:50,callbacks:{eachStep:function(t){var n=i.layerContainerOriginPx,s=t.scale,r=(s-1)*(n.x-e.x)|0,o=(s-1)*(n.y-e.y)|0;i.applyTransform(n.x+r,n.y+o,s)},done:function(t){i.applyTransform();var n=i.getResolution()/t.scale,s=i.getZoomForResolution(n,!0);i.moveTo(i.getZoomTargetCenter(e,n),s,!0)}}})}}else{var l=e?i.getZoomTargetCenter(e,i.getResolutionForZoom(t)):null;i.setCenter(l,t)}},zoomIn:function(){this.zoomTo(this.getZoom()+1)},zoomOut:function(){this.zoomTo(this.getZoom()-1)},zoomToExtent:function(t,e){t instanceof OpenLayers.Bounds||(t=new OpenLayers.Bounds(t));var i=t.getCenterLonLat();if(this.baseLayer.wrapDateLine){var n=this.getMaxExtent();for(t=t.clone();t.right<t.left;)t.right+=n.getWidth();i=t.getCenterLonLat().wrapDateLine(n)}this.setCenter(i,this.getZoomForExtent(t,e))},zoomToMaxExtent:function(t){var e=t?t.restricted:!0,i=this.getMaxExtent({restricted:e});this.zoomToExtent(i)},zoomToScale:function(t,e){var i=OpenLayers.Util.getResolutionFromScale(t,this.baseLayer.units),n=this.size.w*i/2,s=this.size.h*i/2,r=this.getCachedCenter(),o=new OpenLayers.Bounds(r.lon-n,r.lat-s,r.lon+n,r.lat+s);this.zoomToExtent(o,e)},getLonLatFromViewPortPx:function(t){var e=null;return null!=this.baseLayer&&(e=this.baseLayer.getLonLatFromViewPortPx(t)),e},getViewPortPxFromLonLat:function(t){var e=null;return null!=this.baseLayer&&(e=this.baseLayer.getViewPortPxFromLonLat(t)),e},getZoomTargetCenter:function(t,e){var i=null,n=this.getSize(),s=n.w/2-t.x,r=t.y-n.h/2,o=this.getLonLatFromPixel(t);return o&&(i=new OpenLayers.LonLat(o.lon+s*e,o.lat+r*e)),i},getLonLatFromPixel:function(t){return this.getLonLatFromViewPortPx(t)},getPixelFromLonLat:function(t){var e=this.getViewPortPxFromLonLat(t);return e.x=Math.round(e.x),e.y=Math.round(e.y),e},getGeodesicPixelSize:function(t){var e=t?this.getLonLatFromPixel(t):this.getCachedCenter()||new OpenLayers.LonLat(0,0),i=this.getResolution(),n=e.add(-i/2,0),s=e.add(i/2,0),r=e.add(0,-i/2),o=e.add(0,i/2),a=new OpenLayers.Projection("EPSG:4326"),l=this.getProjectionObject()||a;return l.equals(a)||(n.transform(l,a),s.transform(l,a),r.transform(l,a),o.transform(l,a)),new OpenLayers.Size(OpenLayers.Util.distVincenty(n,s),OpenLayers.Util.distVincenty(r,o))},getViewPortPxFromLayerPx:function(t){var e=null;if(null!=t){var i=this.layerContainerOriginPx.x,n=this.layerContainerOriginPx.y;e=t.add(i,n)}return e},getLayerPxFromViewPortPx:function(t){var e=null;if(null!=t){var i=-this.layerContainerOriginPx.x,n=-this.layerContainerOriginPx.y;e=t.add(i,n),(isNaN(e.x)||isNaN(e.y))&&(e=null)}return e},getLonLatFromLayerPx:function(t){return t=this.getViewPortPxFromLayerPx(t),this.getLonLatFromViewPortPx(t)},getLayerPxFromLonLat:function(t){var e=this.getPixelFromLonLat(t);return this.getLayerPxFromViewPortPx(e)},applyTransform:function(t,e,i){i=i||1;var n=this.layerContainerOriginPx,s=1!==i;t=t||n.x,e=e||n.y;var r=this.layerContainerDiv.style,o=this.applyTransform.transform,a=this.applyTransform.template;if(void 0===o&&(o=OpenLayers.Util.vendorPrefix.style("transform"),this.applyTransform.transform=o,o)){var l=OpenLayers.Element.getStyle(this.viewPortDiv,OpenLayers.Util.vendorPrefix.css("transform"));l&&"none"===l||(a=["translate3d(",",0) ","scale3d(",",1)"],r[o]=[a[0],"0,0",a[1]].join("")),a&&~r[o].indexOf(a[0])||(a=["translate(",") ","scale(",")"]),this.applyTransform.template=a}null===o||"translate3d("!==a[0]&&s!==!0?(r.left=t+"px",r.top=e+"px",null!==o&&(r[o]="")):(s===!0&&"translate("===a[0]&&(t-=n.x,e-=n.y,r.left=n.x+"px",r.top=n.y+"px"),r[o]=[a[0],t,"px,",e,"px",a[1],a[2],i,",",i,a[3]].join(""))},CLASS_NAME:"OpenLayers.Map"}),OpenLayers.Map.TILE_WIDTH=256,OpenLayers.Map.TILE_HEIGHT=256,OpenLayers.Handler=OpenLayers.Class({id:null,control:null,map:null,keyMask:null,active:!1,evt:null,touch:!1,initialize:function(t,e,i){OpenLayers.Util.extend(this,i),this.control=t,this.callbacks=e;var n=this.map||t.map;n&&this.setMap(n),this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")},setMap:function(t){this.map=t},checkModifiers:function(t){if(null==this.keyMask)return!0;var e=(t.shiftKey?OpenLayers.Handler.MOD_SHIFT:0)|(t.ctrlKey?OpenLayers.Handler.MOD_CTRL:0)|(t.altKey?OpenLayers.Handler.MOD_ALT:0)|(t.metaKey?OpenLayers.Handler.MOD_META:0);return e==this.keyMask},activate:function(){if(this.active)return!1;for(var t=OpenLayers.Events.prototype.BROWSER_EVENTS,e=0,i=t.length;i>e;e++)this[t[e]]&&this.register(t[e],this[t[e]]);return this.active=!0,!0},deactivate:function(){if(!this.active)return!1;for(var t=OpenLayers.Events.prototype.BROWSER_EVENTS,e=0,i=t.length;i>e;e++)this[t[e]]&&this.unregister(t[e],this[t[e]]);return this.touch=!1,this.active=!1,!0},startTouch:function(){if(!this.touch){this.touch=!0;for(var t=["mousedown","mouseup","mousemove","click","dblclick","mouseout"],e=0,i=t.length;i>e;e++)this[t[e]]&&this.unregister(t[e],this[t[e]])}},callback:function(t,e){t&&this.callbacks[t]&&this.callbacks[t].apply(this.control,e)},register:function(t,e){this.map.events.registerPriority(t,this,e),this.map.events.registerPriority(t,this,this.setEvent)},unregister:function(t,e){this.map.events.unregister(t,this,e),this.map.events.unregister(t,this,this.setEvent)},setEvent:function(t){return this.evt=t,!0},destroy:function(){this.deactivate(),this.control=this.map=null},CLASS_NAME:"OpenLayers.Handler"}),OpenLayers.Handler.MOD_NONE=0,OpenLayers.Handler.MOD_SHIFT=1,OpenLayers.Handler.MOD_CTRL=2,OpenLayers.Handler.MOD_ALT=4,OpenLayers.Handler.MOD_META=8,OpenLayers.Handler.Click=OpenLayers.Class(OpenLayers.Handler,{delay:300,single:!0,"double":!1,pixelTolerance:0,dblclickTolerance:13,stopSingle:!1,stopDouble:!1,timerId:null,down:null,last:null,first:null,rightclickTimerId:null,touchstart:function(t){return this.startTouch(),this.down=this.getEventInfo(t),this.last=this.getEventInfo(t),!0},touchmove:function(t){return this.last=this.getEventInfo(t),!0},touchend:function(t){return this.down&&(t.xy=this.last.xy,t.lastTouches=this.last.touches,this.handleSingle(t),this.down=null),!0},mousedown:function(t){return this.down=this.getEventInfo(t),this.last=this.getEventInfo(t),!0},mouseup:function(t){var e=!0;return this.checkModifiers(t)&&this.control.handleRightClicks&&OpenLayers.Event.isRightClick(t)&&(e=this.rightclick(t)),e},rightclick:function(t){if(this.passesTolerance(t)){if(null!=this.rightclickTimerId)return this.clearTimer(),this.callback("dblrightclick",[t]),!this.stopDouble;var e=this["double"]?OpenLayers.Util.extend({},t):this.callback("rightclick",[t]),i=OpenLayers.Function.bind(this.delayedRightCall,this,e);this.rightclickTimerId=window.setTimeout(i,this.delay)}return!this.stopSingle},delayedRightCall:function(t){this.rightclickTimerId=null,t&&this.callback("rightclick",[t])},click:function(t){return this.last||(this.last=this.getEventInfo(t)),this.handleSingle(t),!this.stopSingle},dblclick:function(t){return this.handleDouble(t),!this.stopDouble},handleDouble:function(t){this.passesDblclickTolerance(t)&&(this["double"]&&this.callback("dblclick",[t]),this.clearTimer())},handleSingle:function(t){if(this.passesTolerance(t))if(null!=this.timerId)this.last.touches&&1===this.last.touches.length&&(this["double"]&&OpenLayers.Event.preventDefault(t),this.handleDouble(t)),this.last.touches&&2===this.last.touches.length||this.clearTimer();else{this.first=this.getEventInfo(t);var e=this.single?OpenLayers.Util.extend({},t):null;this.queuePotentialClick(e)}},queuePotentialClick:function(t){this.timerId=window.setTimeout(OpenLayers.Function.bind(this.delayedCall,this,t),this.delay)},passesTolerance:function(t){var e=!0;if(null!=this.pixelTolerance&&this.down&&this.down.xy&&(e=this.pixelTolerance>=this.down.xy.distanceTo(t.xy),e&&this.touch&&this.down.touches.length===this.last.touches.length))for(var i=0,n=this.down.touches.length;n>i;++i)if(this.getTouchDistance(this.down.touches[i],this.last.touches[i])>this.pixelTolerance){e=!1;break}return e},getTouchDistance:function(t,e){return Math.sqrt(Math.pow(t.clientX-e.clientX,2)+Math.pow(t.clientY-e.clientY,2))},passesDblclickTolerance:function(){var t=!0;return this.down&&this.first&&(t=this.down.xy.distanceTo(this.first.xy)<=this.dblclickTolerance),t},clearTimer:function(){null!=this.timerId&&(window.clearTimeout(this.timerId),this.timerId=null),null!=this.rightclickTimerId&&(window.clearTimeout(this.rightclickTimerId),this.rightclickTimerId=null)},delayedCall:function(t){this.timerId=null,t&&this.callback("click",[t])},getEventInfo:function(t){var e;if(t.touches){var i=t.touches.length;e=new Array(i);for(var n,s=0;i>s;s++)n=t.touches[s],e[s]={clientX:n.olClientX,clientY:n.olClientY}}return{xy:t.xy,touches:e}},deactivate:function(){var t=!1;return OpenLayers.Handler.prototype.deactivate.apply(this,arguments)&&(this.clearTimer(),this.down=null,this.first=null,this.last=null,t=!0),t},CLASS_NAME:"OpenLayers.Handler.Click"}),OpenLayers.Handler.Drag=OpenLayers.Class(OpenLayers.Handler,{started:!1,stopDown:!0,dragging:!1,last:null,start:null,lastMoveEvt:null,oldOnselectstart:null,interval:0,timeoutId:null,documentDrag:!1,documentEvents:null,initialize:function(){if(OpenLayers.Handler.prototype.initialize.apply(this,arguments),this.documentDrag===!0){var t=this;this._docMove=function(e){t.mousemove({xy:{x:e.clientX,y:e.clientY},element:document})},this._docUp=function(e){t.mouseup({xy:{x:e.clientX,y:e.clientY}})}}},dragstart:function(t){var e=!0;return this.dragging=!1,this.checkModifiers(t)&&(OpenLayers.Event.isLeftClick(t)||OpenLayers.Event.isSingleTouch(t))?(this.started=!0,this.start=t.xy,this.last=t.xy,OpenLayers.Element.addClass(this.map.viewPortDiv,"olDragDown"),this.down(t),this.callback("down",[t.xy]),OpenLayers.Event.preventDefault(t),this.oldOnselectstart||(this.oldOnselectstart=document.onselectstart?document.onselectstart:OpenLayers.Function.True),document.onselectstart=OpenLayers.Function.False,e=!this.stopDown):(this.started=!1,this.start=null,this.last=null),e},dragmove:function(t){return this.lastMoveEvt=t,!this.started||this.timeoutId||t.xy.x==this.last.x&&t.xy.y==this.last.y||(this.documentDrag===!0&&this.documentEvents&&(t.element===document?(this.adjustXY(t),this.setEvent(t)):this.removeDocumentEvents()),this.interval>0&&(this.timeoutId=setTimeout(OpenLayers.Function.bind(this.removeTimeout,this),this.interval)),this.dragging=!0,this.move(t),this.callback("move",[t.xy]),this.oldOnselectstart||(this.oldOnselectstart=document.onselectstart,document.onselectstart=OpenLayers.Function.False),this.last=t.xy),!0},dragend:function(t){if(this.started){this.documentDrag===!0&&this.documentEvents&&(this.adjustXY(t),this.removeDocumentEvents());var e=this.start!=this.last;this.started=!1,this.dragging=!1,OpenLayers.Element.removeClass(this.map.viewPortDiv,"olDragDown"),this.up(t),this.callback("up",[t.xy]),e&&this.callback("done",[t.xy]),document.onselectstart=this.oldOnselectstart}return!0},down:function(){},move:function(){},up:function(){},out:function(){},mousedown:function(t){return this.dragstart(t)},touchstart:function(t){return this.startTouch(),this.dragstart(t)},mousemove:function(t){return this.dragmove(t)},touchmove:function(t){return this.dragmove(t)},removeTimeout:function(){this.timeoutId=null,this.dragging&&this.mousemove(this.lastMoveEvt)},mouseup:function(t){return this.dragend(t)},touchend:function(t){return t.xy=this.last,this.dragend(t)},mouseout:function(t){if(this.started&&OpenLayers.Util.mouseLeft(t,this.map.viewPortDiv))if(this.documentDrag===!0)this.addDocumentEvents();else{var e=this.start!=this.last;this.started=!1,this.dragging=!1,OpenLayers.Element.removeClass(this.map.viewPortDiv,"olDragDown"),this.out(t),this.callback("out",[]),e&&this.callback("done",[t.xy]),document.onselectstart&&(document.onselectstart=this.oldOnselectstart)}return!0},click:function(){return this.start==this.last},activate:function(){var t=!1;return OpenLayers.Handler.prototype.activate.apply(this,arguments)&&(this.dragging=!1,t=!0),t},deactivate:function(){var t=!1;return OpenLayers.Handler.prototype.deactivate.apply(this,arguments)&&(this.started=!1,this.dragging=!1,this.start=null,this.last=null,t=!0,OpenLayers.Element.removeClass(this.map.viewPortDiv,"olDragDown")),t},adjustXY:function(t){var e=OpenLayers.Util.pagePosition(this.map.viewPortDiv);t.xy.x-=e[0],t.xy.y-=e[1]},addDocumentEvents:function(){OpenLayers.Element.addClass(document.body,"olDragDown"),this.documentEvents=!0,OpenLayers.Event.observe(document,"mousemove",this._docMove),OpenLayers.Event.observe(document,"mouseup",this._docUp)},removeDocumentEvents:function(){OpenLayers.Element.removeClass(document.body,"olDragDown"),this.documentEvents=!1,OpenLayers.Event.stopObserving(document,"mousemove",this._docMove),OpenLayers.Event.stopObserving(document,"mouseup",this._docUp)},CLASS_NAME:"OpenLayers.Handler.Drag"}),OpenLayers.Control.OverviewMap=OpenLayers.Class(OpenLayers.Control,{element:null,ovmap:null,size:{w:180,h:90},layers:null,minRectSize:15,minRectDisplayClass:"RectReplacement",minRatio:8,maxRatio:32,mapOptions:null,autoPan:!1,handlers:null,resolutionFactor:1,maximized:!1,maximizeTitle:"",minimizeTitle:"",initialize:function(t){this.layers=[],this.handlers={},OpenLayers.Control.prototype.initialize.apply(this,[t])},destroy:function(){this.mapDiv&&(this.handlers.click&&this.handlers.click.destroy(),this.handlers.drag&&this.handlers.drag.destroy(),this.ovmap&&this.ovmap.viewPortDiv.removeChild(this.extentRectangle),this.extentRectangle=null,this.rectEvents&&(this.rectEvents.destroy(),this.rectEvents=null),this.ovmap&&(this.ovmap.destroy(),this.ovmap=null),this.element.removeChild(this.mapDiv),this.mapDiv=null,this.div.removeChild(this.element),this.element=null,this.maximizeDiv&&(this.div.removeChild(this.maximizeDiv),this.maximizeDiv=null),this.minimizeDiv&&(this.div.removeChild(this.minimizeDiv),this.minimizeDiv=null),this.map.events.un({buttonclick:this.onButtonClick,moveend:this.update,changebaselayer:this.baseLayerDraw,scope:this}),OpenLayers.Control.prototype.destroy.apply(this,arguments))},draw:function(){if(OpenLayers.Control.prototype.draw.apply(this,arguments),0===this.layers.length){if(!this.map.baseLayer)return this.map.events.register("changebaselayer",this,this.baseLayerDraw),this.div;var t=this.map.baseLayer.clone();this.layers=[t]}if(this.element=document.createElement("div"),this.element.className=this.displayClass+"Element",this.element.style.display="none",this.mapDiv=document.createElement("div"),this.mapDiv.style.width=this.size.w+"px",this.mapDiv.style.height=this.size.h+"px",this.mapDiv.style.position="relative",this.mapDiv.style.overflow="hidden",this.mapDiv.id=OpenLayers.Util.createUniqueID("overviewMap"),this.extentRectangle=document.createElement("div"),this.extentRectangle.style.position="absolute",this.extentRectangle.style.zIndex=1e3,this.extentRectangle.className=this.displayClass+"ExtentRectangle",this.element.appendChild(this.mapDiv),this.div.appendChild(this.element),this.outsideViewport)this.element.style.display="";else{this.div.className+=" "+this.displayClass+"Container";var e=OpenLayers.Util.getImageLocation("layer-switcher-maximize.png");this.maximizeDiv=OpenLayers.Util.createAlphaImageDiv(this.displayClass+"MaximizeButton",null,null,e,"absolute"),this.maximizeDiv.style.display="none",this.maximizeDiv.className=this.displayClass+"MaximizeButton olButton",this.maximizeTitle&&(this.maximizeDiv.title=this.maximizeTitle),this.div.appendChild(this.maximizeDiv);var e=OpenLayers.Util.getImageLocation("layer-switcher-minimize.png");this.minimizeDiv=OpenLayers.Util.createAlphaImageDiv("OpenLayers_Control_minimizeDiv",null,null,e,"absolute"),this.minimizeDiv.style.display="none",this.minimizeDiv.className=this.displayClass+"MinimizeButton olButton",this.minimizeTitle&&(this.minimizeDiv.title=this.minimizeTitle),this.div.appendChild(this.minimizeDiv),this.minimizeControl()}return this.map.getExtent()&&this.update(),this.map.events.on({buttonclick:this.onButtonClick,moveend:this.update,scope:this}),this.maximized&&this.maximizeControl(),this.div
},baseLayerDraw:function(){this.draw(),this.map.events.unregister("changebaselayer",this,this.baseLayerDraw)},rectDrag:function(t){var e=this.handlers.drag.last.x-t.x,i=this.handlers.drag.last.y-t.y;if(0!=e||0!=i){var n=this.rectPxBounds.top,s=this.rectPxBounds.left,r=Math.abs(this.rectPxBounds.getHeight()),o=this.rectPxBounds.getWidth(),a=Math.max(0,n-i);a=Math.min(a,this.ovmap.size.h-this.hComp-r);var l=Math.max(0,s-e);l=Math.min(l,this.ovmap.size.w-this.wComp-o),this.setRectPxBounds(new OpenLayers.Bounds(l,a+r,l+o,a))}},mapDivClick:function(t){var e=this.rectPxBounds.getCenterPixel(),i=t.xy.x-e.x,n=t.xy.y-e.y,s=this.rectPxBounds.top,r=this.rectPxBounds.left,o=Math.abs(this.rectPxBounds.getHeight()),a=this.rectPxBounds.getWidth(),l=Math.max(0,s+n);l=Math.min(l,this.ovmap.size.h-o);var h=Math.max(0,r+i);h=Math.min(h,this.ovmap.size.w-a),this.setRectPxBounds(new OpenLayers.Bounds(h,l+o,h+a,l)),this.updateMapToRect()},onButtonClick:function(t){t.buttonElement===this.minimizeDiv?this.minimizeControl():t.buttonElement===this.maximizeDiv&&this.maximizeControl()},maximizeControl:function(t){this.element.style.display="",this.showToggle(!1),null!=t&&OpenLayers.Event.stop(t)},minimizeControl:function(t){this.element.style.display="none",this.showToggle(!0),null!=t&&OpenLayers.Event.stop(t)},showToggle:function(t){this.maximizeDiv&&(this.maximizeDiv.style.display=t?"":"none"),this.minimizeDiv&&(this.minimizeDiv.style.display=t?"none":"")},update:function(){null==this.ovmap&&this.createMap(),(this.autoPan||!this.isSuitableOverview())&&this.updateOverview(),this.updateRectToMap()},isSuitableOverview:function(){var t=this.map.getExtent(),e=this.map.getMaxExtent(),i=new OpenLayers.Bounds(Math.max(t.left,e.left),Math.max(t.bottom,e.bottom),Math.min(t.right,e.right),Math.min(t.top,e.top));this.ovmap.getProjection()!=this.map.getProjection()&&(i=i.transform(this.map.getProjectionObject(),this.ovmap.getProjectionObject()));var n=this.ovmap.getResolution()/this.map.getResolution();return n>this.minRatio&&n<=this.maxRatio&&this.ovmap.getExtent().containsBounds(i)},updateOverview:function(){var t=this.map.getResolution(),e=this.ovmap.getResolution(),i=e/t;i>this.maxRatio?e=this.minRatio*t:i<=this.minRatio&&(e=this.maxRatio*t);var n;this.ovmap.getProjection()!=this.map.getProjection()?(n=this.map.center.clone(),n.transform(this.map.getProjectionObject(),this.ovmap.getProjectionObject())):n=this.map.center,this.ovmap.setCenter(n,this.ovmap.getZoomForResolution(e*this.resolutionFactor)),this.updateRectToMap()},createMap:function(){var t=OpenLayers.Util.extend({controls:[],maxResolution:"auto",fallThrough:!1},this.mapOptions);if(this.ovmap=new OpenLayers.Map(this.mapDiv,t),this.ovmap.viewPortDiv.appendChild(this.extentRectangle),OpenLayers.Event.stopObserving(window,"unload",this.ovmap.unloadDestroy),this.ovmap.addLayers(this.layers),this.ovmap.zoomToMaxExtent(),this.wComp=parseInt(OpenLayers.Element.getStyle(this.extentRectangle,"border-left-width"))+parseInt(OpenLayers.Element.getStyle(this.extentRectangle,"border-right-width")),this.wComp=this.wComp?this.wComp:2,this.hComp=parseInt(OpenLayers.Element.getStyle(this.extentRectangle,"border-top-width"))+parseInt(OpenLayers.Element.getStyle(this.extentRectangle,"border-bottom-width")),this.hComp=this.hComp?this.hComp:2,this.handlers.drag=new OpenLayers.Handler.Drag(this,{move:this.rectDrag,done:this.updateMapToRect},{map:this.ovmap}),this.handlers.click=new OpenLayers.Handler.Click(this,{click:this.mapDivClick},{single:!0,"double":!1,stopSingle:!0,stopDouble:!0,pixelTolerance:1,map:this.ovmap}),this.handlers.click.activate(),this.rectEvents=new OpenLayers.Events(this,this.extentRectangle,null,!0),this.rectEvents.register("mouseover",this,function(){this.handlers.drag.active||this.map.dragging||this.handlers.drag.activate()}),this.rectEvents.register("mouseout",this,function(){this.handlers.drag.dragging||this.handlers.drag.deactivate()}),this.ovmap.getProjection()!=this.map.getProjection()){var e=this.map.getProjectionObject().getUnits()||this.map.units||this.map.baseLayer.units,i=this.ovmap.getProjectionObject().getUnits()||this.ovmap.units||this.ovmap.baseLayer.units;this.resolutionFactor=e&&i?OpenLayers.INCHES_PER_UNIT[e]/OpenLayers.INCHES_PER_UNIT[i]:1}},updateRectToMap:function(){var t;t=this.ovmap.getProjection()!=this.map.getProjection()?this.map.getExtent().transform(this.map.getProjectionObject(),this.ovmap.getProjectionObject()):this.map.getExtent();var e=this.getRectBoundsFromMapBounds(t);e&&this.setRectPxBounds(e)},updateMapToRect:function(){var t=this.getMapBoundsFromRectBounds(this.rectPxBounds);this.ovmap.getProjection()!=this.map.getProjection()&&(t=t.transform(this.ovmap.getProjectionObject(),this.map.getProjectionObject())),this.map.panTo(t.getCenterLonLat())},setRectPxBounds:function(t){var e=Math.max(t.top,0),i=Math.max(t.left,0),n=Math.min(t.top+Math.abs(t.getHeight()),this.ovmap.size.h-this.hComp),s=Math.min(t.left+t.getWidth(),this.ovmap.size.w-this.wComp),r=Math.max(s-i,0),o=Math.max(n-e,0);if(r<this.minRectSize||o<this.minRectSize){this.extentRectangle.className=this.displayClass+this.minRectDisplayClass;var a=i+r/2-this.minRectSize/2,l=e+o/2-this.minRectSize/2;this.extentRectangle.style.top=Math.round(l)+"px",this.extentRectangle.style.left=Math.round(a)+"px",this.extentRectangle.style.height=this.minRectSize+"px",this.extentRectangle.style.width=this.minRectSize+"px"}else this.extentRectangle.className=this.displayClass+"ExtentRectangle",this.extentRectangle.style.top=Math.round(e)+"px",this.extentRectangle.style.left=Math.round(i)+"px",this.extentRectangle.style.height=Math.round(o)+"px",this.extentRectangle.style.width=Math.round(r)+"px";this.rectPxBounds=new OpenLayers.Bounds(Math.round(i),Math.round(n),Math.round(s),Math.round(e))},getRectBoundsFromMapBounds:function(t){var e=this.getOverviewPxFromLonLat({lon:t.left,lat:t.bottom}),i=this.getOverviewPxFromLonLat({lon:t.right,lat:t.top}),n=null;return e&&i&&(n=new OpenLayers.Bounds(e.x,e.y,i.x,i.y)),n},getMapBoundsFromRectBounds:function(t){var e=this.getLonLatFromOverviewPx({x:t.left,y:t.bottom}),i=this.getLonLatFromOverviewPx({x:t.right,y:t.top});return new OpenLayers.Bounds(e.lon,e.lat,i.lon,i.lat)},getLonLatFromOverviewPx:function(t){var e=this.ovmap.size,i=this.ovmap.getResolution(),n=this.ovmap.getExtent().getCenterLonLat(),s=t.x-e.w/2,r=t.y-e.h/2;return{lon:n.lon+s*i,lat:n.lat-r*i}},getOverviewPxFromLonLat:function(t){var e=this.ovmap.getResolution(),i=this.ovmap.getExtent();return i?{x:Math.round(1/e*(t.lon-i.left)),y:Math.round(1/e*(i.top-t.lat))}:void 0},CLASS_NAME:"OpenLayers.Control.OverviewMap"}),OpenLayers.Layer=OpenLayers.Class({id:null,name:null,div:null,opacity:1,alwaysInRange:null,RESOLUTION_PROPERTIES:["scales","resolutions","maxScale","minScale","maxResolution","minResolution","numZoomLevels","maxZoomLevel"],events:null,map:null,isBaseLayer:!1,alpha:!1,displayInLayerSwitcher:!0,visibility:!0,attribution:null,inRange:!1,imageSize:null,options:null,eventListeners:null,gutter:0,projection:null,units:null,scales:null,resolutions:null,maxExtent:null,minExtent:null,maxResolution:null,minResolution:null,numZoomLevels:null,minScale:null,maxScale:null,displayOutsideMaxExtent:!1,wrapDateLine:!1,metadata:null,initialize:function(t,e){this.metadata={},e=OpenLayers.Util.extend({},e),null!=this.alwaysInRange&&(e.alwaysInRange=this.alwaysInRange),this.addOptions(e),this.name=t,null==this.id&&(this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_"),this.div=OpenLayers.Util.createDiv(this.id),this.div.style.width="100%",this.div.style.height="100%",this.div.dir="ltr",this.events=new OpenLayers.Events(this,this.div),this.eventListeners instanceof Object&&this.events.on(this.eventListeners))},destroy:function(t){null==t&&(t=!0),null!=this.map&&this.map.removeLayer(this,t),this.projection=null,this.map=null,this.name=null,this.div=null,this.options=null,this.events&&(this.eventListeners&&this.events.un(this.eventListeners),this.events.destroy()),this.eventListeners=null,this.events=null},clone:function(t){return null==t&&(t=new OpenLayers.Layer(this.name,this.getOptions())),OpenLayers.Util.applyDefaults(t,this),t.map=null,t},getOptions:function(){var t={};for(var e in this.options)t[e]=this[e];return t},setName:function(t){t!=this.name&&(this.name=t,null!=this.map&&this.map.events.triggerEvent("changelayer",{layer:this,property:"name"}))},addOptions:function(t,e){if(null==this.options&&(this.options={}),t&&("string"==typeof t.projection&&(t.projection=new OpenLayers.Projection(t.projection)),t.projection&&OpenLayers.Util.applyDefaults(t,OpenLayers.Projection.defaults[t.projection.getCode()]),!t.maxExtent||t.maxExtent instanceof OpenLayers.Bounds||(t.maxExtent=new OpenLayers.Bounds(t.maxExtent)),!t.minExtent||t.minExtent instanceof OpenLayers.Bounds||(t.minExtent=new OpenLayers.Bounds(t.minExtent))),OpenLayers.Util.extend(this.options,t),OpenLayers.Util.extend(this,t),this.projection&&this.projection.getUnits()&&(this.units=this.projection.getUnits()),this.map){var i=this.map.getResolution(),n=this.RESOLUTION_PROPERTIES.concat(["projection","units","minExtent","maxExtent"]);for(var s in t)if(t.hasOwnProperty(s)&&OpenLayers.Util.indexOf(n,s)>=0){this.initResolutions(),e&&this.map.baseLayer===this&&(this.map.setCenter(this.map.getCenter(),this.map.getZoomForResolution(i),!1,!0),this.map.events.triggerEvent("changebaselayer",{layer:this}));break}}},onMapResize:function(){},redraw:function(){var t=!1;if(this.map){this.inRange=this.calculateInRange();var e=this.getExtent();if(e&&this.inRange&&this.visibility){var i=!0;this.moveTo(e,i,!1),this.events.triggerEvent("moveend",{zoomChanged:i}),t=!0}}return t},moveTo:function(){var t=this.visibility;this.isBaseLayer||(t=t&&this.inRange),this.display(t)},moveByPx:function(){},setMap:function(t){if(null==this.map){if(this.map=t,this.maxExtent=this.maxExtent||this.map.maxExtent,this.minExtent=this.minExtent||this.map.minExtent,this.projection=this.projection||this.map.projection,"string"==typeof this.projection&&(this.projection=new OpenLayers.Projection(this.projection)),this.units=this.projection.getUnits()||this.units||this.map.units,this.initResolutions(),!this.isBaseLayer){this.inRange=this.calculateInRange();var e=this.visibility&&this.inRange;this.div.style.display=e?"":"none"}this.setTileSize()}},afterAdd:function(){},removeMap:function(){},getImageSize:function(){return this.imageSize||this.tileSize},setTileSize:function(t){var e=t?t:this.tileSize?this.tileSize:this.map.getTileSize();this.tileSize=e,this.gutter&&(this.imageSize=new OpenLayers.Size(e.w+2*this.gutter,e.h+2*this.gutter))},getVisibility:function(){return this.visibility},setVisibility:function(t){t!=this.visibility&&(this.visibility=t,this.display(t),this.redraw(),null!=this.map&&this.map.events.triggerEvent("changelayer",{layer:this,property:"visibility"}),this.events.triggerEvent("visibilitychanged"))},display:function(t){t!=("none"!=this.div.style.display)&&(this.div.style.display=t&&this.calculateInRange()?"block":"none")},calculateInRange:function(){var t=!1;if(this.alwaysInRange)t=!0;else if(this.map){var e=this.map.getResolution();t=e>=this.minResolution&&e<=this.maxResolution}return t},setIsBaseLayer:function(t){t!=this.isBaseLayer&&(this.isBaseLayer=t,null!=this.map&&this.map.events.triggerEvent("changebaselayer",{layer:this}))},initResolutions:function(){var t,e,i,n={},s=!0;for(t=0,e=this.RESOLUTION_PROPERTIES.length;e>t;t++)i=this.RESOLUTION_PROPERTIES[t],n[i]=this.options[i],s&&this.options[i]&&(s=!1);if(null==this.options.alwaysInRange&&(this.alwaysInRange=s),null==n.resolutions&&(n.resolutions=this.resolutionsFromScales(n.scales)),null==n.resolutions&&(n.resolutions=this.calculateResolutions(n)),null==n.resolutions){for(t=0,e=this.RESOLUTION_PROPERTIES.length;e>t;t++)i=this.RESOLUTION_PROPERTIES[t],n[i]=null!=this.options[i]?this.options[i]:this.map[i];null==n.resolutions&&(n.resolutions=this.resolutionsFromScales(n.scales)),null==n.resolutions&&(n.resolutions=this.calculateResolutions(n))}var r;this.options.maxResolution&&"auto"!==this.options.maxResolution&&(r=this.options.maxResolution),this.options.minScale&&(r=OpenLayers.Util.getResolutionFromScale(this.options.minScale,this.units));var o;if(this.options.minResolution&&"auto"!==this.options.minResolution&&(o=this.options.minResolution),this.options.maxScale&&(o=OpenLayers.Util.getResolutionFromScale(this.options.maxScale,this.units)),n.resolutions&&(n.resolutions.sort(function(t,e){return e-t}),r||(r=n.resolutions[0]),!o)){var a=n.resolutions.length-1;o=n.resolutions[a]}if(this.resolutions=n.resolutions,this.resolutions){for(e=this.resolutions.length,this.scales=new Array(e),t=0;e>t;t++)this.scales[t]=OpenLayers.Util.getScaleFromResolution(this.resolutions[t],this.units);this.numZoomLevels=e}this.minResolution=o,o&&(this.maxScale=OpenLayers.Util.getScaleFromResolution(o,this.units)),this.maxResolution=r,r&&(this.minScale=OpenLayers.Util.getScaleFromResolution(r,this.units))},resolutionsFromScales:function(t){if(null!=t){var e,i,n;for(n=t.length,e=new Array(n),i=0;n>i;i++)e[i]=OpenLayers.Util.getResolutionFromScale(t[i],this.units);return e}},calculateResolutions:function(t){var e,i,n,s=t.maxResolution;null!=t.minScale?s=OpenLayers.Util.getResolutionFromScale(t.minScale,this.units):"auto"==s&&null!=this.maxExtent&&(e=this.map.getSize(),i=this.maxExtent.getWidth()/e.w,n=this.maxExtent.getHeight()/e.h,s=Math.max(i,n));var r=t.minResolution;if(null!=t.maxScale?r=OpenLayers.Util.getResolutionFromScale(t.maxScale,this.units):"auto"==t.minResolution&&null!=this.minExtent&&(e=this.map.getSize(),i=this.minExtent.getWidth()/e.w,n=this.minExtent.getHeight()/e.h,r=Math.max(i,n)),"number"!=typeof s&&"number"!=typeof r&&null!=this.maxExtent){var o=this.map.getTileSize();s=Math.max(this.maxExtent.getWidth()/o.w,this.maxExtent.getHeight()/o.h)}var a=t.maxZoomLevel,l=t.numZoomLevels;if("number"==typeof r&&"number"==typeof s&&void 0===l){var h=s/r;l=Math.floor(Math.log(h)/Math.log(2))+1}else void 0===l&&null!=a&&(l=a+1);if(!("number"!=typeof l||0>=l||"number"!=typeof s&&"number"!=typeof r)){var u=new Array(l),p=2;"number"==typeof r&&"number"==typeof s&&(p=Math.pow(s/r,1/(l-1)));var c;if("number"==typeof s)for(c=0;l>c;c++)u[c]=s/Math.pow(p,c);else for(c=0;l>c;c++)u[l-1-c]=r*Math.pow(p,c);return u}},getResolution:function(){var t=this.map.getZoom();return this.getResolutionForZoom(t)},getExtent:function(){return this.map.calculateBounds()},getZoomForExtent:function(t,e){var i=this.map.getSize(),n=Math.max(t.getWidth()/i.w,t.getHeight()/i.h);return this.getZoomForResolution(n,e)},getDataExtent:function(){},getResolutionForZoom:function(t){t=Math.max(0,Math.min(t,this.resolutions.length-1));var e;if(this.map.fractionalZoom){var i=Math.floor(t),n=Math.ceil(t);e=this.resolutions[i]-(t-i)*(this.resolutions[i]-this.resolutions[n])}else e=this.resolutions[Math.round(t)];return e},getZoomForResolution:function(t,e){var i,n,s;if(this.map.fractionalZoom){var r,o=0,a=this.resolutions.length-1,l=this.resolutions[o],h=this.resolutions[a];for(n=0,s=this.resolutions.length;s>n;++n)if(r=this.resolutions[n],r>=t&&(l=r,o=n),t>=r){h=r,a=n;break}var u=l-h;i=u>0?o+(l-t)/u:o}else{var p,c=Number.POSITIVE_INFINITY;for(n=0,s=this.resolutions.length;s>n;n++)if(e){if(p=Math.abs(this.resolutions[n]-t),p>c)break;c=p}else if(this.resolutions[n]<t)break;i=Math.max(0,n-1)}return i},getLonLatFromViewPortPx:function(t){var e=null,i=this.map;if(null!=t&&i.minPx){var n=i.getResolution(),s=i.getMaxExtent({restricted:!0}),r=(t.x-i.minPx.x)*n+s.left,o=(i.minPx.y-t.y)*n+s.top;e=new OpenLayers.LonLat(r,o),this.wrapDateLine&&(e=e.wrapDateLine(this.maxExtent))}return e},getViewPortPxFromLonLat:function(t,e){var i=null;if(null!=t){e=e||this.map.getResolution();var n=this.map.calculateBounds(null,e);i=new OpenLayers.Pixel(1/e*(t.lon-n.left),1/e*(n.top-t.lat))}return i},setOpacity:function(t){if(t!=this.opacity){this.opacity=t;for(var e=this.div.childNodes,i=0,n=e.length;n>i;++i){var s=e[i].firstChild||e[i],r=e[i].lastChild;r&&"iframe"===r.nodeName.toLowerCase()&&(s=r.parentNode),OpenLayers.Util.modifyDOMElement(s,null,null,null,null,null,null,t)}null!=this.map&&this.map.events.triggerEvent("changelayer",{layer:this,property:"opacity"})}},getZIndex:function(){return this.div.style.zIndex},setZIndex:function(t){this.div.style.zIndex=t},adjustBounds:function(t){if(this.gutter){var e=this.gutter*this.map.getResolution();t=new OpenLayers.Bounds(t.left-e,t.bottom-e,t.right+e,t.top+e)}if(this.wrapDateLine){var i={rightTolerance:this.getResolution(),leftTolerance:this.getResolution()};t=t.wrapDateLine(this.maxExtent,i)}return t},CLASS_NAME:"OpenLayers.Layer"}),OpenLayers.Layer.SphericalMercator={getExtent:function(){var t=null;return t=this.sphericalMercator?this.map.calculateBounds():OpenLayers.Layer.FixedZoomLevels.prototype.getExtent.apply(this)},getLonLatFromViewPortPx:function(){return OpenLayers.Layer.prototype.getLonLatFromViewPortPx.apply(this,arguments)},getViewPortPxFromLonLat:function(){return OpenLayers.Layer.prototype.getViewPortPxFromLonLat.apply(this,arguments)},initMercatorParameters:function(){this.RESOLUTIONS=[];for(var t=156543.03390625,e=0;e<=this.MAX_ZOOM_LEVEL;++e)this.RESOLUTIONS[e]=t/Math.pow(2,e);this.units="m",this.projection=this.projection||"EPSG:900913"},forwardMercator:function(){var t=new OpenLayers.Projection("EPSG:4326"),e=new OpenLayers.Projection("EPSG:900913");return function(i,n){var s=OpenLayers.Projection.transform({x:i,y:n},t,e);return new OpenLayers.LonLat(s.x,s.y)}}(),inverseMercator:function(){var t=new OpenLayers.Projection("EPSG:4326"),e=new OpenLayers.Projection("EPSG:900913");return function(i,n){var s=OpenLayers.Projection.transform({x:i,y:n},e,t);return new OpenLayers.LonLat(s.x,s.y)}}()},OpenLayers.Layer.EventPane=OpenLayers.Class(OpenLayers.Layer,{smoothDragPan:!0,isBaseLayer:!0,isFixed:!0,pane:null,mapObject:null,initialize:function(){OpenLayers.Layer.prototype.initialize.apply(this,arguments),null==this.pane&&(this.pane=OpenLayers.Util.createDiv(this.div.id+"_EventPane"))},destroy:function(){this.mapObject=null,this.pane=null,OpenLayers.Layer.prototype.destroy.apply(this,arguments)},setMap:function(){OpenLayers.Layer.prototype.setMap.apply(this,arguments),this.pane.style.zIndex=parseInt(this.div.style.zIndex)+1,this.pane.style.display=this.div.style.display,this.pane.style.width="100%",this.pane.style.height="100%","msie"==OpenLayers.BROWSER_NAME&&(this.pane.style.background="url("+OpenLayers.Util.getImageLocation("blank.gif")+")"),this.isFixed?this.map.viewPortDiv.appendChild(this.pane):this.map.layerContainerDiv.appendChild(this.pane),this.loadMapObject(),null==this.mapObject&&this.loadWarningMessage()},removeMap:function(){this.pane&&this.pane.parentNode&&this.pane.parentNode.removeChild(this.pane),OpenLayers.Layer.prototype.removeMap.apply(this,arguments)},loadWarningMessage:function(){this.div.style.backgroundColor="darkblue";var t=this.map.getSize(),e=Math.min(t.w,300),i=Math.min(t.h,200),n=new OpenLayers.Size(e,i),s=new OpenLayers.Pixel(t.w/2,t.h/2),r=s.add(-n.w/2,-n.h/2),o=OpenLayers.Util.createDiv(this.name+"_warning",r,n,null,null,null,"auto");o.style.padding="7px",o.style.backgroundColor="yellow",o.innerHTML=this.getWarningHTML(),this.div.appendChild(o)},getWarningHTML:function(){return""},display:function(){OpenLayers.Layer.prototype.display.apply(this,arguments),this.pane.style.display=this.div.style.display},setZIndex:function(){OpenLayers.Layer.prototype.setZIndex.apply(this,arguments),this.pane.style.zIndex=parseInt(this.div.style.zIndex)+1},moveByPx:function(t,e){OpenLayers.Layer.prototype.moveByPx.apply(this,arguments),this.dragPanMapObject?this.dragPanMapObject(t,-e):this.moveTo(this.map.getCachedCenter())},moveTo:function(t,e,i){if(OpenLayers.Layer.prototype.moveTo.apply(this,arguments),null!=this.mapObject){var n=this.map.getCenter(),s=this.map.getZoom();if(null!=n){var r=this.getMapObjectCenter(),o=this.getOLLonLatFromMapObjectLonLat(r),a=this.getMapObjectZoom(),l=this.getOLZoomFromMapObjectZoom(a);if(!n.equals(o)||s!=l)if(!e&&o&&this.dragPanMapObject&&this.smoothDragPan){var h=this.map.getViewPortPxFromLonLat(o),u=this.map.getViewPortPxFromLonLat(n);this.dragPanMapObject(u.x-h.x,h.y-u.y)}else{var p=this.getMapObjectLonLatFromOLLonLat(n),c=this.getMapObjectZoomFromOLZoom(s);this.setMapObjectCenter(p,c,i)}}}},getLonLatFromViewPortPx:function(t){var e=null;if(null!=this.mapObject&&null!=this.getMapObjectCenter()){var i=this.getMapObjectPixelFromOLPixel(t),n=this.getMapObjectLonLatFromMapObjectPixel(i);e=this.getOLLonLatFromMapObjectLonLat(n)}return e},getViewPortPxFromLonLat:function(t){var e=null;if(null!=this.mapObject&&null!=this.getMapObjectCenter()){var i=this.getMapObjectLonLatFromOLLonLat(t),n=this.getMapObjectPixelFromMapObjectLonLat(i);e=this.getOLPixelFromMapObjectPixel(n)}return e},getOLLonLatFromMapObjectLonLat:function(t){var e=null;if(null!=t){var i=this.getLongitudeFromMapObjectLonLat(t),n=this.getLatitudeFromMapObjectLonLat(t);e=new OpenLayers.LonLat(i,n)}return e},getMapObjectLonLatFromOLLonLat:function(t){var e=null;return null!=t&&(e=this.getMapObjectLonLatFromLonLat(t.lon,t.lat)),e},getOLPixelFromMapObjectPixel:function(t){var e=null;if(null!=t){var i=this.getXFromMapObjectPixel(t),n=this.getYFromMapObjectPixel(t);e=new OpenLayers.Pixel(i,n)}return e},getMapObjectPixelFromOLPixel:function(t){var e=null;return null!=t&&(e=this.getMapObjectPixelFromXY(t.x,t.y)),e},CLASS_NAME:"OpenLayers.Layer.EventPane"}),OpenLayers.Layer.FixedZoomLevels=OpenLayers.Class({initialize:function(){},initResolutions:function(){for(var t=["minZoomLevel","maxZoomLevel","numZoomLevels"],e=0,i=t.length;i>e;e++){var n=t[e];this[n]=null!=this.options[n]?this.options[n]:this.map[n]}(null==this.minZoomLevel||this.minZoomLevel<this.MIN_ZOOM_LEVEL)&&(this.minZoomLevel=this.MIN_ZOOM_LEVEL);var s,r=this.MAX_ZOOM_LEVEL-this.minZoomLevel+1;if(s=null==this.options.numZoomLevels&&null!=this.options.maxZoomLevel||null==this.numZoomLevels&&null!=this.maxZoomLevel?this.maxZoomLevel-this.minZoomLevel+1:this.numZoomLevels,this.numZoomLevels=null!=s?Math.min(s,r):r,this.maxZoomLevel=this.minZoomLevel+this.numZoomLevels-1,null!=this.RESOLUTIONS){var o=0;this.resolutions=[];for(var e=this.minZoomLevel;e<=this.maxZoomLevel;e++)this.resolutions[o++]=this.RESOLUTIONS[e];this.maxResolution=this.resolutions[0],this.minResolution=this.resolutions[this.resolutions.length-1]}},getResolution:function(){if(null!=this.resolutions)return OpenLayers.Layer.prototype.getResolution.apply(this,arguments);var t=null,e=this.map.getSize(),i=this.getExtent();return null!=e&&null!=i&&(t=Math.max(i.getWidth()/e.w,i.getHeight()/e.h)),t},getExtent:function(){var t=this.map.getSize(),e=this.getLonLatFromViewPortPx({x:0,y:0}),i=this.getLonLatFromViewPortPx({x:t.w,y:t.h});return null!=e&&null!=i?new OpenLayers.Bounds(e.lon,i.lat,i.lon,e.lat):null},getZoomForResolution:function(){if(null!=this.resolutions)return OpenLayers.Layer.prototype.getZoomForResolution.apply(this,arguments);var t=OpenLayers.Layer.prototype.getExtent.apply(this,[]);return this.getZoomForExtent(t)},getOLZoomFromMapObjectZoom:function(t){var e=null;return null!=t&&(e=t-this.minZoomLevel,this.map.baseLayer!==this&&(e=this.map.baseLayer.getZoomForResolution(this.getResolutionForZoom(e)))),e},getMapObjectZoomFromOLZoom:function(t){var e=null;return null!=t&&(e=t+this.minZoomLevel,this.map.baseLayer!==this&&(e=this.getZoomForResolution(this.map.baseLayer.getResolutionForZoom(e)))),e},CLASS_NAME:"OpenLayers.Layer.FixedZoomLevels"}),OpenLayers.Layer.Google=OpenLayers.Class(OpenLayers.Layer.EventPane,OpenLayers.Layer.FixedZoomLevels,{MIN_ZOOM_LEVEL:0,MAX_ZOOM_LEVEL:21,RESOLUTIONS:[1.40625,.703125,.3515625,.17578125,.087890625,.0439453125,.02197265625,.010986328125,.0054931640625,.00274658203125,.001373291015625,.0006866455078125,.00034332275390625,.000171661376953125,858306884765625e-19,4291534423828125e-20,2145767211914062e-20,1072883605957031e-20,536441802978515e-20,268220901489257e-20,1341104507446289e-21,6.705522537231445e-7],type:null,wrapDateLine:!0,sphericalMercator:!1,version:null,initialize:function(t,e){e=e||{},e.version||(e.version="function"==typeof GMap2?"2":"3");var i=OpenLayers.Layer.Google["v"+e.version.replace(/\./g,"_")];if(!i)throw"Unsupported Google Maps API version: "+e.version;OpenLayers.Util.applyDefaults(e,i),OpenLayers.Util.applyDefaults(e,i.DEFAULTS),e.maxExtent&&(e.maxExtent=e.maxExtent.clone()),OpenLayers.Layer.EventPane.prototype.initialize.apply(this,[t,e]),OpenLayers.Layer.FixedZoomLevels.prototype.initialize.apply(this,[t,e]),this.sphericalMercator&&(OpenLayers.Util.extend(this,OpenLayers.Layer.SphericalMercator),this.initMercatorParameters())},clone:function(){return new OpenLayers.Layer.Google(this.name,this.getOptions())},setVisibility:function(){var t=null==this.opacity?1:this.opacity;OpenLayers.Layer.EventPane.prototype.setVisibility.apply(this,arguments),this.setOpacity(t)},display:function(t){this._dragging||this.setGMapVisibility(t),OpenLayers.Layer.EventPane.prototype.display.apply(this,arguments)},moveTo:function(t,e,i){this._dragging=i,OpenLayers.Layer.EventPane.prototype.moveTo.apply(this,arguments),delete this._dragging},setOpacity:function(t){if(t!==this.opacity&&(null!=this.map&&this.map.events.triggerEvent("changelayer",{layer:this,property:"opacity"}),this.opacity=t),this.getVisibility()){var e=this.getMapContainer();OpenLayers.Util.modifyDOMElement(e,null,null,null,null,null,null,t)}},destroy:function(){if(this.map){this.setGMapVisibility(!1);var t=OpenLayers.Layer.Google.cache[this.map.id];t&&t.count<=1&&this.removeGMapElements()}OpenLayers.Layer.EventPane.prototype.destroy.apply(this,arguments)},removeGMapElements:function(){var t=OpenLayers.Layer.Google.cache[this.map.id];if(t){var e=this.mapObject&&this.getMapContainer();e&&e.parentNode&&e.parentNode.removeChild(e);var i=t.termsOfUse;i&&i.parentNode&&i.parentNode.removeChild(i);var n=t.poweredBy;n&&n.parentNode&&n.parentNode.removeChild(n),this.mapObject&&window.google&&google.maps&&google.maps.event&&google.maps.event.clearListeners&&google.maps.event.clearListeners(this.mapObject,"tilesloaded")}},removeMap:function(t){this.visibility&&this.mapObject&&this.setGMapVisibility(!1);var e=OpenLayers.Layer.Google.cache[t.id];e&&(e.count<=1?(this.removeGMapElements(),delete OpenLayers.Layer.Google.cache[t.id]):--e.count),delete this.termsOfUse,delete this.poweredBy,delete this.mapObject,delete this.dragObject,OpenLayers.Layer.EventPane.prototype.removeMap.apply(this,arguments)},getOLBoundsFromMapObjectBounds:function(t){var e=null;if(null!=t){var i=t.getSouthWest(),n=t.getNorthEast();this.sphericalMercator?(i=this.forwardMercator(i.lng(),i.lat()),n=this.forwardMercator(n.lng(),n.lat())):(i=new OpenLayers.LonLat(i.lng(),i.lat()),n=new OpenLayers.LonLat(n.lng(),n.lat())),e=new OpenLayers.Bounds(i.lon,i.lat,n.lon,n.lat)}return e},getWarningHTML:function(){return OpenLayers.i18n("googleWarning")},getMapObjectCenter:function(){return this.mapObject.getCenter()},getMapObjectZoom:function(){return this.mapObject.getZoom()},getLongitudeFromMapObjectLonLat:function(t){return this.sphericalMercator?this.forwardMercator(t.lng(),t.lat()).lon:t.lng()},getLatitudeFromMapObjectLonLat:function(t){var e=this.sphericalMercator?this.forwardMercator(t.lng(),t.lat()).lat:t.lat();return e},getXFromMapObjectPixel:function(t){return t.x},getYFromMapObjectPixel:function(t){return t.y},CLASS_NAME:"OpenLayers.Layer.Google"}),OpenLayers.Layer.Google.cache={},OpenLayers.Layer.Google.v2={termsOfUse:null,poweredBy:null,dragObject:null,loadMapObject:function(){this.type||(this.type=G_NORMAL_MAP);var t,e,i,n=OpenLayers.Layer.Google.cache[this.map.id];if(n)t=n.mapObject,e=n.termsOfUse,i=n.poweredBy,++n.count;else{var s=this.map.viewPortDiv,r=document.createElement("div");r.id=this.map.id+"_GMap2Container",r.style.position="absolute",r.style.width="100%",r.style.height="100%",s.appendChild(r);try{t=new GMap2(r),e=r.lastChild,s.appendChild(e),e.style.zIndex="1100",e.style.right="",e.style.bottom="",e.className="olLayerGoogleCopyright",i=r.lastChild,s.appendChild(i),i.style.zIndex="1100",i.style.right="",i.style.bottom="",i.className="olLayerGooglePoweredBy gmnoprint"}catch(o){throw o}OpenLayers.Layer.Google.cache[this.map.id]={mapObject:t,termsOfUse:e,poweredBy:i,count:1}}this.mapObject=t,this.termsOfUse=e,this.poweredBy=i,-1===OpenLayers.Util.indexOf(this.mapObject.getMapTypes(),this.type)&&this.mapObject.addMapType(this.type),"function"==typeof t.getDragObject?this.dragObject=t.getDragObject():this.dragPanMapObject=null,this.isBaseLayer===!1&&this.setGMapVisibility("none"!==this.div.style.display)},onMapResize:function(){if(this.visibility&&this.mapObject.isLoaded())this.mapObject.checkResize();else{if(!this._resized)var t=this,e=GEvent.addListener(this.mapObject,"load",function(){GEvent.removeListener(e),delete t._resized,t.mapObject.checkResize(),t.moveTo(t.map.getCenter(),t.map.getZoom())});this._resized=!0}},setGMapVisibility:function(t){var e=OpenLayers.Layer.Google.cache[this.map.id];if(e){var i=this.mapObject.getContainer();t===!0?(this.mapObject.setMapType(this.type),i.style.display="",this.termsOfUse.style.left="",this.termsOfUse.style.display="",this.poweredBy.style.display="",e.displayed=this.id):(e.displayed===this.id&&delete e.displayed,e.displayed||(i.style.display="none",this.termsOfUse.style.display="none",this.termsOfUse.style.left="-9999px",this.poweredBy.style.display="none"))}},getMapContainer:function(){return this.mapObject.getContainer()},getMapObjectBoundsFromOLBounds:function(t){var e=null;if(null!=t){var i=this.sphericalMercator?this.inverseMercator(t.bottom,t.left):new OpenLayers.LonLat(t.bottom,t.left),n=this.sphericalMercator?this.inverseMercator(t.top,t.right):new OpenLayers.LonLat(t.top,t.right);e=new GLatLngBounds(new GLatLng(i.lat,i.lon),new GLatLng(n.lat,n.lon))}return e},setMapObjectCenter:function(t,e){this.mapObject.setCenter(t,e)},dragPanMapObject:function(t,e){this.dragObject.moveBy(new GSize(-t,e))},getMapObjectLonLatFromMapObjectPixel:function(t){return this.mapObject.fromContainerPixelToLatLng(t)},getMapObjectPixelFromMapObjectLonLat:function(t){return this.mapObject.fromLatLngToContainerPixel(t)},getMapObjectZoomFromMapObjectBounds:function(t){return this.mapObject.getBoundsZoomLevel(t)},getMapObjectLonLatFromLonLat:function(t,e){var i;if(this.sphericalMercator){var n=this.inverseMercator(t,e);i=new GLatLng(n.lat,n.lon)}else i=new GLatLng(e,t);return i},getMapObjectPixelFromXY:function(t,e){return new GPoint(t,e)}},OpenLayers.Format.WFST=function(t){t=OpenLayers.Util.applyDefaults(t,OpenLayers.Format.WFST.DEFAULTS);var e=OpenLayers.Format.WFST["v"+t.version.replace(/\./g,"_")];if(!e)throw"Unsupported WFST version: "+t.version;return new e(t)},OpenLayers.Format.WFST.DEFAULTS={version:"1.0.0"},OpenLayers.Format.WFST.v1=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance",wfs:"http://www.opengis.net/wfs",gml:"http://www.opengis.net/gml",ogc:"http://www.opengis.net/ogc",ows:"http://www.opengis.net/ows"},defaultPrefix:"wfs",version:null,schemaLocations:null,srsName:null,extractAttributes:!0,xy:!0,stateName:null,initialize:function(t){this.stateName={},this.stateName[OpenLayers.State.INSERT]="wfs:Insert",this.stateName[OpenLayers.State.UPDATE]="wfs:Update",this.stateName[OpenLayers.State.DELETE]="wfs:Delete",OpenLayers.Format.XML.prototype.initialize.apply(this,[t])},getSrsName:function(t,e){var i=e&&e.srsName;return i||(i=t&&t.layer?t.layer.projection.getCode():this.srsName),i},read:function(t,e){e=e||{},OpenLayers.Util.applyDefaults(e,{output:"features"}),"string"==typeof t&&(t=OpenLayers.Format.XML.prototype.read.apply(this,[t])),t&&9==t.nodeType&&(t=t.documentElement);var i={};return t&&this.readNode(t,i,!0),i.features&&"features"===e.output&&(i=i.features),i},readers:{wfs:{FeatureCollection:function(t,e){e.features=[],this.readChildNodes(t,e)
}}},write:function(t,e){var i=this.writeNode("wfs:Transaction",{features:t,options:e}),n=this.schemaLocationAttr();return n&&this.setAttributeNS(i,this.namespaces.xsi,"xsi:schemaLocation",n),OpenLayers.Format.XML.prototype.write.apply(this,[i])},writers:{wfs:{GetFeature:function(t){var e=this.createElementNSPlus("wfs:GetFeature",{attributes:{service:"WFS",version:this.version,handle:t&&t.handle,outputFormat:t&&t.outputFormat,maxFeatures:t&&t.maxFeatures,"xsi:schemaLocation":this.schemaLocationAttr(t)}});if("string"==typeof this.featureType)this.writeNode("Query",t,e);else for(var i=0,n=this.featureType.length;n>i;i++)t.featureType=this.featureType[i],this.writeNode("Query",t,e);return e},Transaction:function(t){t=t||{};var e,i,n=t.options||{},s=this.createElementNSPlus("wfs:Transaction",{attributes:{service:"WFS",version:this.version,handle:n.handle}}),r=t.features;if(r){n.multi===!0&&OpenLayers.Util.extend(this.geometryTypes,{"OpenLayers.Geometry.Point":"MultiPoint","OpenLayers.Geometry.LineString":this.multiCurve===!0?"MultiCurve":"MultiLineString","OpenLayers.Geometry.Polygon":this.multiSurface===!0?"MultiSurface":"MultiPolygon"});var o,a;for(e=0,i=r.length;i>e;++e)a=r[e],o=this.stateName[a.state],o&&this.writeNode(o,{feature:a,options:n},s);n.multi===!0&&this.setGeometryTypes()}if(n.nativeElements)for(e=0,i=n.nativeElements.length;i>e;++e)this.writeNode("wfs:Native",n.nativeElements[e],s);return s},Native:function(t){var e=this.createElementNSPlus("wfs:Native",{attributes:{vendorId:t.vendorId,safeToIgnore:t.safeToIgnore},value:t.value});return e},Insert:function(t){var e=t.feature,i=t.options,n=this.createElementNSPlus("wfs:Insert",{attributes:{handle:i&&i.handle}});return this.srsName=this.getSrsName(e),this.writeNode("feature:_typeName",e,n),n},Update:function(t){var e=t.feature,i=t.options,n=this.createElementNSPlus("wfs:Update",{attributes:{handle:i&&i.handle,typeName:(this.featureNS?this.featurePrefix+":":"")+this.featureType}});this.featureNS&&n.setAttribute("xmlns:"+this.featurePrefix,this.featureNS);var s=e.modified;null===this.geometryName||s&&void 0===s.geometry||(this.srsName=this.getSrsName(e),this.writeNode("Property",{name:this.geometryName,value:e.geometry},n));for(var r in e.attributes)void 0===e.attributes[r]||s&&s.attributes&&(!s.attributes||void 0===s.attributes[r])||this.writeNode("Property",{name:r,value:e.attributes[r]},n);return this.writeNode("ogc:Filter",new OpenLayers.Filter.FeatureId({fids:[e.fid]}),n),n},Property:function(t){var e=this.createElementNSPlus("wfs:Property");return this.writeNode("Name",t.name,e),null!==t.value&&this.writeNode("Value",t.value,e),e},Name:function(t){return this.createElementNSPlus("wfs:Name",{value:t})},Value:function(t){var e;if(t instanceof OpenLayers.Geometry){e=this.createElementNSPlus("wfs:Value");var i=this.writeNode("feature:_geometry",t).firstChild;e.appendChild(i)}else e=this.createElementNSPlus("wfs:Value",{value:t});return e},Delete:function(t){var e=t.feature,i=t.options,n=this.createElementNSPlus("wfs:Delete",{attributes:{handle:i&&i.handle,typeName:(this.featureNS?this.featurePrefix+":":"")+this.featureType}});return this.featureNS&&n.setAttribute("xmlns:"+this.featurePrefix,this.featureNS),this.writeNode("ogc:Filter",new OpenLayers.Filter.FeatureId({fids:[e.fid]}),n),n}}},schemaLocationAttr:function(t){t=OpenLayers.Util.extend({featurePrefix:this.featurePrefix,schema:this.schema},t);var e=OpenLayers.Util.extend({},this.schemaLocations);t.schema&&(e[t.featurePrefix]=t.schema);var i,n=[];for(var s in e)i=this.namespaces[s],i&&n.push(i+" "+e[s]);var r=n.join(" ")||void 0;return r},setFilterProperty:function(t){if(t.filters)for(var e=0,i=t.filters.length;i>e;++e)OpenLayers.Format.WFST.v1.prototype.setFilterProperty.call(this,t.filters[e]);else t instanceof OpenLayers.Filter.Spatial&&!t.property&&(t.property=this.geometryName)},CLASS_NAME:"OpenLayers.Format.WFST.v1"}),OpenLayers.Format.GML.v3=OpenLayers.Class(OpenLayers.Format.GML.Base,{schemaLocation:"http://www.opengis.net/gml http://schemas.opengis.net/gml/3.1.1/profiles/gmlsfProfile/1.0.0/gmlsf.xsd",curve:!1,multiCurve:!0,surface:!1,multiSurface:!0,initialize:function(t){OpenLayers.Format.GML.Base.prototype.initialize.apply(this,[t])},readers:{gml:OpenLayers.Util.applyDefaults({_inherit:function(t,e,i){var n=parseInt(t.getAttribute("srsDimension"),10)||i&&i.srsDimension;n&&(e.srsDimension=n)},featureMembers:function(t,e){this.readChildNodes(t,e)},Curve:function(t,e){var i={points:[]};this.readers.gml._inherit.apply(this,[t,i,e]),this.readChildNodes(t,i),e.components||(e.components=[]),e.components.push(new OpenLayers.Geometry.LineString(i.points))},segments:function(t,e){this.readChildNodes(t,e)},LineStringSegment:function(t,e){var i={};this.readChildNodes(t,i),i.points&&Array.prototype.push.apply(e.points,i.points)},pos:function(t,e){var i,n=this.getChildValue(t).replace(this.regExes.trimSpace,""),s=n.split(this.regExes.splitSpace);i=this.xy?new OpenLayers.Geometry.Point(s[0],s[1],s[2]):new OpenLayers.Geometry.Point(s[1],s[0],s[2]),e.points=[i]},posList:function(t,e){for(var i,n,s,r=this.getChildValue(t).replace(this.regExes.trimSpace,""),o=r.split(this.regExes.splitSpace),a=e.srsDimension||parseInt(t.getAttribute("srsDimension")||t.getAttribute("dimension"),10)||2,l=o.length/a,h=new Array(l),u=0,p=o.length;p>u;u+=a)i=o[u],n=o[u+1],s=2==a?void 0:o[u+2],h[u/a]=this.xy?new OpenLayers.Geometry.Point(i,n,s):new OpenLayers.Geometry.Point(n,i,s);e.points=h},Surface:function(t,e){this.readChildNodes(t,e)},patches:function(t,e){this.readChildNodes(t,e)},PolygonPatch:function(t,e){this.readers.gml.Polygon.apply(this,[t,e])},exterior:function(t,e){var i={};this.readChildNodes(t,i),e.outer=i.components[0]},interior:function(t,e){var i={};this.readChildNodes(t,i),e.inner.push(i.components[0])},MultiCurve:function(t,e){var i={components:[]};this.readers.gml._inherit.apply(this,[t,i,e]),this.readChildNodes(t,i),i.components.length>0&&(e.components=[new OpenLayers.Geometry.MultiLineString(i.components)])},curveMember:function(t,e){this.readChildNodes(t,e)},MultiSurface:function(t,e){var i={components:[]};this.readers.gml._inherit.apply(this,[t,i,e]),this.readChildNodes(t,i),i.components.length>0&&(e.components=[new OpenLayers.Geometry.MultiPolygon(i.components)])},surfaceMember:function(t,e){this.readChildNodes(t,e)},surfaceMembers:function(t,e){this.readChildNodes(t,e)},pointMembers:function(t,e){this.readChildNodes(t,e)},lineStringMembers:function(t,e){this.readChildNodes(t,e)},polygonMembers:function(t,e){this.readChildNodes(t,e)},geometryMembers:function(t,e){this.readChildNodes(t,e)},Envelope:function(t,e){var i={points:new Array(2)};this.readChildNodes(t,i),e.components||(e.components=[]);var n=i.points[0],s=i.points[1];e.components.push(new OpenLayers.Bounds(n.x,n.y,s.x,s.y))},lowerCorner:function(t,e){var i={};this.readers.gml.pos.apply(this,[t,i]),e.points[0]=i.points[0]},upperCorner:function(t,e){var i={};this.readers.gml.pos.apply(this,[t,i]),e.points[1]=i.points[0]}},OpenLayers.Format.GML.Base.prototype.readers.gml),feature:OpenLayers.Format.GML.Base.prototype.readers.feature,wfs:OpenLayers.Format.GML.Base.prototype.readers.wfs},write:function(t){var e;e=OpenLayers.Util.isArray(t)?"featureMembers":"featureMember";var i=this.writeNode("gml:"+e,t);return this.setAttributeNS(i,this.namespaces.xsi,"xsi:schemaLocation",this.schemaLocation),OpenLayers.Format.XML.prototype.write.apply(this,[i])},writers:{gml:OpenLayers.Util.applyDefaults({featureMembers:function(t){for(var e=this.createElementNSPlus("gml:featureMembers"),i=0,n=t.length;n>i;++i)this.writeNode("feature:_typeName",t[i],e);return e},Point:function(t){var e=this.createElementNSPlus("gml:Point");return this.writeNode("pos",t,e),e},pos:function(t){var e=this.xy?t.x+" "+t.y:t.y+" "+t.x;return this.createElementNSPlus("gml:pos",{value:e})},LineString:function(t){var e=this.createElementNSPlus("gml:LineString");return this.writeNode("posList",t.components,e),e},Curve:function(t){var e=this.createElementNSPlus("gml:Curve");return this.writeNode("segments",t,e),e},segments:function(t){var e=this.createElementNSPlus("gml:segments");return this.writeNode("LineStringSegment",t,e),e},LineStringSegment:function(t){var e=this.createElementNSPlus("gml:LineStringSegment");return this.writeNode("posList",t.components,e),e},posList:function(t){for(var e,i=t.length,n=new Array(i),s=0;i>s;++s)e=t[s],n[s]=this.xy?e.x+" "+e.y:e.y+" "+e.x;return this.createElementNSPlus("gml:posList",{value:n.join(" ")})},Surface:function(t){var e=this.createElementNSPlus("gml:Surface");return this.writeNode("patches",t,e),e},patches:function(t){var e=this.createElementNSPlus("gml:patches");return this.writeNode("PolygonPatch",t,e),e},PolygonPatch:function(t){var e=this.createElementNSPlus("gml:PolygonPatch",{attributes:{interpolation:"planar"}});this.writeNode("exterior",t.components[0],e);for(var i=1,n=t.components.length;n>i;++i)this.writeNode("interior",t.components[i],e);return e},Polygon:function(t){var e=this.createElementNSPlus("gml:Polygon");this.writeNode("exterior",t.components[0],e);for(var i=1,n=t.components.length;n>i;++i)this.writeNode("interior",t.components[i],e);return e},exterior:function(t){var e=this.createElementNSPlus("gml:exterior");return this.writeNode("LinearRing",t,e),e},interior:function(t){var e=this.createElementNSPlus("gml:interior");return this.writeNode("LinearRing",t,e),e},LinearRing:function(t){var e=this.createElementNSPlus("gml:LinearRing");return this.writeNode("posList",t.components,e),e},MultiCurve:function(t){for(var e=this.createElementNSPlus("gml:MultiCurve"),i=t.components||[t],n=0,s=i.length;s>n;++n)this.writeNode("curveMember",i[n],e);return e},curveMember:function(t){var e=this.createElementNSPlus("gml:curveMember");return this.curve?this.writeNode("Curve",t,e):this.writeNode("LineString",t,e),e},MultiSurface:function(t){for(var e=this.createElementNSPlus("gml:MultiSurface"),i=t.components||[t],n=0,s=i.length;s>n;++n)this.writeNode("surfaceMember",i[n],e);return e},surfaceMember:function(t){var e=this.createElementNSPlus("gml:surfaceMember");return this.surface?this.writeNode("Surface",t,e):this.writeNode("Polygon",t,e),e},Envelope:function(t){var e=this.createElementNSPlus("gml:Envelope");return this.writeNode("lowerCorner",t,e),this.writeNode("upperCorner",t,e),this.srsName&&e.setAttribute("srsName",this.srsName),e},lowerCorner:function(t){var e=this.xy?t.left+" "+t.bottom:t.bottom+" "+t.left;return this.createElementNSPlus("gml:lowerCorner",{value:e})},upperCorner:function(t){var e=this.xy?t.right+" "+t.top:t.top+" "+t.right;return this.createElementNSPlus("gml:upperCorner",{value:e})}},OpenLayers.Format.GML.Base.prototype.writers.gml),feature:OpenLayers.Format.GML.Base.prototype.writers.feature,wfs:OpenLayers.Format.GML.Base.prototype.writers.wfs},setGeometryTypes:function(){this.geometryTypes={"OpenLayers.Geometry.Point":"Point","OpenLayers.Geometry.MultiPoint":"MultiPoint","OpenLayers.Geometry.LineString":this.curve===!0?"Curve":"LineString","OpenLayers.Geometry.MultiLineString":this.multiCurve===!1?"MultiLineString":"MultiCurve","OpenLayers.Geometry.Polygon":this.surface===!0?"Surface":"Polygon","OpenLayers.Geometry.MultiPolygon":this.multiSurface===!1?"MultiPolygon":"MultiSurface","OpenLayers.Geometry.Collection":"GeometryCollection"}},CLASS_NAME:"OpenLayers.Format.GML.v3"}),OpenLayers.Format.Filter.v1_1_0=OpenLayers.Class(OpenLayers.Format.GML.v3,OpenLayers.Format.Filter.v1,{VERSION:"1.1.0",schemaLocation:"http://www.opengis.net/ogc/filter/1.1.0/filter.xsd",initialize:function(t){OpenLayers.Format.GML.v3.prototype.initialize.apply(this,[t])},readers:{ogc:OpenLayers.Util.applyDefaults({PropertyIsEqualTo:function(t,e){var i=t.getAttribute("matchCase"),n=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.EQUAL_TO,matchCase:!("false"===i||"0"===i)});this.readChildNodes(t,n),e.filters.push(n)},PropertyIsNotEqualTo:function(t,e){var i=t.getAttribute("matchCase"),n=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.NOT_EQUAL_TO,matchCase:!("false"===i||"0"===i)});this.readChildNodes(t,n),e.filters.push(n)},PropertyIsLike:function(t,e){var i=new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.LIKE});this.readChildNodes(t,i);var n=t.getAttribute("wildCard"),s=t.getAttribute("singleChar"),r=t.getAttribute("escapeChar");i.value2regex(n,s,r),e.filters.push(i)}},OpenLayers.Format.Filter.v1.prototype.readers.ogc),gml:OpenLayers.Format.GML.v3.prototype.readers.gml,feature:OpenLayers.Format.GML.v3.prototype.readers.feature},writers:{ogc:OpenLayers.Util.applyDefaults({PropertyIsEqualTo:function(t){var e=this.createElementNSPlus("ogc:PropertyIsEqualTo",{attributes:{matchCase:t.matchCase}});return this.writeNode("PropertyName",t,e),this.writeOgcExpression(t.value,e),e},PropertyIsNotEqualTo:function(t){var e=this.createElementNSPlus("ogc:PropertyIsNotEqualTo",{attributes:{matchCase:t.matchCase}});return this.writeNode("PropertyName",t,e),this.writeOgcExpression(t.value,e),e},PropertyIsLike:function(t){var e=this.createElementNSPlus("ogc:PropertyIsLike",{attributes:{matchCase:t.matchCase,wildCard:"*",singleChar:".",escapeChar:"!"}});return this.writeNode("PropertyName",t,e),this.writeNode("Literal",t.regex2value(),e),e},BBOX:function(t){var e=this.createElementNSPlus("ogc:BBOX");t.property&&this.writeNode("PropertyName",t,e);var i=this.writeNode("gml:Envelope",t.value);return t.projection&&i.setAttribute("srsName",t.projection),e.appendChild(i),e},SortBy:function(t){for(var e=this.createElementNSPlus("ogc:SortBy"),i=0,n=t.length;n>i;i++)this.writeNode("ogc:SortProperty",t[i],e);return e},SortProperty:function(t){var e=this.createElementNSPlus("ogc:SortProperty");return this.writeNode("ogc:PropertyName",t,e),this.writeNode("ogc:SortOrder","DESC"==t.order?"DESC":"ASC",e),e},SortOrder:function(t){var e=this.createElementNSPlus("ogc:SortOrder",{value:t});return e}},OpenLayers.Format.Filter.v1.prototype.writers.ogc),gml:OpenLayers.Format.GML.v3.prototype.writers.gml,feature:OpenLayers.Format.GML.v3.prototype.writers.feature},writeSpatial:function(t,e){var i=this.createElementNSPlus("ogc:"+e);if(this.writeNode("PropertyName",t,i),t.value instanceof OpenLayers.Filter.Function)this.writeNode("Function",t.value,i);else{var n;n=t.value instanceof OpenLayers.Geometry?this.writeNode("feature:_geometry",t.value).firstChild:this.writeNode("gml:Envelope",t.value),t.projection&&n.setAttribute("srsName",t.projection),i.appendChild(n)}return i},CLASS_NAME:"OpenLayers.Format.Filter.v1_1_0"}),OpenLayers.Format.WFST.v1_1_0=OpenLayers.Class(OpenLayers.Format.Filter.v1_1_0,OpenLayers.Format.WFST.v1,{version:"1.1.0",schemaLocations:{wfs:"http://schemas.opengis.net/wfs/1.1.0/wfs.xsd"},initialize:function(t){OpenLayers.Format.Filter.v1_1_0.prototype.initialize.apply(this,[t]),OpenLayers.Format.WFST.v1.prototype.initialize.apply(this,[t])},readNode:function(){return OpenLayers.Format.GML.v3.prototype.readNode.apply(this,arguments)},readers:{wfs:OpenLayers.Util.applyDefaults({FeatureCollection:function(t,e){e.numberOfFeatures=parseInt(t.getAttribute("numberOfFeatures")),OpenLayers.Format.WFST.v1.prototype.readers.wfs.FeatureCollection.apply(this,arguments)},TransactionResponse:function(t,e){e.insertIds=[],e.success=!1,this.readChildNodes(t,e)},TransactionSummary:function(t,e){e.success=!0},InsertResults:function(t,e){this.readChildNodes(t,e)},Feature:function(t,e){var i={fids:[]};this.readChildNodes(t,i),e.insertIds.push(i.fids[0])}},OpenLayers.Format.WFST.v1.prototype.readers.wfs),gml:OpenLayers.Format.GML.v3.prototype.readers.gml,feature:OpenLayers.Format.GML.v3.prototype.readers.feature,ogc:OpenLayers.Format.Filter.v1_1_0.prototype.readers.ogc,ows:OpenLayers.Format.OWSCommon.v1_0_0.prototype.readers.ows},writers:{wfs:OpenLayers.Util.applyDefaults({GetFeature:function(t){var e=OpenLayers.Format.WFST.v1.prototype.writers.wfs.GetFeature.apply(this,arguments);return t&&this.setAttributes(e,{resultType:t.resultType,startIndex:t.startIndex,count:t.count}),e},Query:function(t){t=OpenLayers.Util.extend({featureNS:this.featureNS,featurePrefix:this.featurePrefix,featureType:this.featureType,srsName:this.srsName},t);var e=t.featurePrefix,i=this.createElementNSPlus("wfs:Query",{attributes:{typeName:(e?e+":":"")+t.featureType,srsName:t.srsName}});if(t.featureNS&&i.setAttribute("xmlns:"+e,t.featureNS),t.propertyNames)for(var n=0,s=t.propertyNames.length;s>n;n++)this.writeNode("wfs:PropertyName",{property:t.propertyNames[n]},i);return t.filter&&(OpenLayers.Format.WFST.v1_1_0.prototype.setFilterProperty.call(this,t.filter),this.writeNode("ogc:Filter",t.filter,i)),i},PropertyName:function(t){return this.createElementNSPlus("wfs:PropertyName",{value:t.property})}},OpenLayers.Format.WFST.v1.prototype.writers.wfs),gml:OpenLayers.Format.GML.v3.prototype.writers.gml,feature:OpenLayers.Format.GML.v3.prototype.writers.feature,ogc:OpenLayers.Format.Filter.v1_1_0.prototype.writers.ogc},CLASS_NAME:"OpenLayers.Format.WFST.v1_1_0"}),OpenLayers.Format.JSON=OpenLayers.Class(OpenLayers.Format,{indent:"    ",space:" ",newline:"\n",level:0,pretty:!1,nativeJSON:function(){return!(!window.JSON||"function"!=typeof JSON.parse||"function"!=typeof JSON.stringify)}(),read:function(json,filter){function walk(t,e){if(e&&"object"==typeof e)for(var i in e)e.hasOwnProperty(i)&&(e[i]=walk(i,e[i]));return filter(t,e)}var object;if(this.nativeJSON)object=JSON.parse(json,filter);else try{/^[\],:{}\s]*$/.test(json.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))&&(object=eval("("+json+")"),"function"==typeof filter&&(object=walk("",object)))}catch(e){}return this.keepData&&(this.data=object),object},write:function(t,e){this.pretty=!!e;var i=null,n=typeof t;if(this.serialize[n])try{i=!this.pretty&&this.nativeJSON?JSON.stringify(t):this.serialize[n].apply(this,[t])}catch(s){OpenLayers.Console.error("Trouble serializing: "+s)}return i},writeIndent:function(){var t=[];if(this.pretty)for(var e=0;e<this.level;++e)t.push(this.indent);return t.join("")},writeNewline:function(){return this.pretty?this.newline:""},writeSpace:function(){return this.pretty?this.space:""},serialize:{object:function(t){if(null==t)return"null";if(t.constructor==Date)return this.serialize.date.apply(this,[t]);if(t.constructor==Array)return this.serialize.array.apply(this,[t]);var e=["{"];this.level+=1;var i,n,s,r=!1;for(i in t)t.hasOwnProperty(i)&&(n=OpenLayers.Format.JSON.prototype.write.apply(this,[i,this.pretty]),s=OpenLayers.Format.JSON.prototype.write.apply(this,[t[i],this.pretty]),null!=n&&null!=s&&(r&&e.push(","),e.push(this.writeNewline(),this.writeIndent(),n,":",this.writeSpace(),s),r=!0));return this.level-=1,e.push(this.writeNewline(),this.writeIndent(),"}"),e.join("")},array:function(t){var e,i=["["];this.level+=1;for(var n=0,s=t.length;s>n;++n)e=OpenLayers.Format.JSON.prototype.write.apply(this,[t[n],this.pretty]),null!=e&&(n>0&&i.push(","),i.push(this.writeNewline(),this.writeIndent(),e));return this.level-=1,i.push(this.writeNewline(),this.writeIndent(),"]"),i.join("")},string:function(t){var e={"\b":"\\b","	":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};return/["\\\x00-\x1f]/.test(t)?'"'+t.replace(/([\x00-\x1f\\"])/g,function(t,i){var n=e[i];return n?n:(n=i.charCodeAt(),"\\u00"+Math.floor(n/16).toString(16)+(n%16).toString(16))})+'"':'"'+t+'"'},number:function(t){return isFinite(t)?String(t):"null"},"boolean":function(t){return String(t)},date:function(t){function e(t){return 10>t?"0"+t:t}return'"'+t.getFullYear()+"-"+e(t.getMonth()+1)+"-"+e(t.getDate())+"T"+e(t.getHours())+":"+e(t.getMinutes())+":"+e(t.getSeconds())+'"'}},CLASS_NAME:"OpenLayers.Format.JSON"}),OpenLayers.Format.WFSCapabilities=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,{defaultVersion:"1.1.0",CLASS_NAME:"OpenLayers.Format.WFSCapabilities"}),OpenLayers.Format.WFSCapabilities.v1=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{wfs:"http://www.opengis.net/wfs",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance",ows:"http://www.opengis.net/ows"},errorProperty:"featureTypeList",defaultPrefix:"wfs",read:function(t){"string"==typeof t&&(t=OpenLayers.Format.XML.prototype.read.apply(this,[t]));t&&9==t.nodeType&&(t=t.documentElement);var e={};return this.readNode(t,e),e},readers:{wfs:{WFS_Capabilities:function(t,e){this.readChildNodes(t,e)},FeatureTypeList:function(t,e){e.featureTypeList={featureTypes:[]},this.readChildNodes(t,e.featureTypeList)},FeatureType:function(t,e){var i={};this.readChildNodes(t,i),e.featureTypes.push(i)},Name:function(t,e){var i=this.getChildValue(t);if(i){var n=i.split(":");e.name=n.pop(),n.length>0&&(e.featureNS=this.lookupNamespaceURI(t,n[0]))}},Title:function(t,e){var i=this.getChildValue(t);i&&(e.title=i)},Abstract:function(t,e){var i=this.getChildValue(t);i&&(e["abstract"]=i)}}},CLASS_NAME:"OpenLayers.Format.WFSCapabilities.v1"}),OpenLayers.Format.EncodedPolyline=OpenLayers.Class(OpenLayers.Format,{geometryType:"linestring",initialize:function(t){OpenLayers.Format.prototype.initialize.apply(this,[t])},read:function(t){var e;if("linestring"==this.geometryType)e=OpenLayers.Geometry.LineString;else if("linearring"==this.geometryType)e=OpenLayers.Geometry.LinearRing;else if("multipoint"==this.geometryType)e=OpenLayers.Geometry.MultiPoint;else if("point"!=this.geometryType&&"polygon"!=this.geometryType)return null;for(var i=this.decodeDeltas(t,2),n=i.length,s=[],r=0;n>r+1;){var o=i[r++],a=i[r++];s.push(new OpenLayers.Geometry.Point(a,o))}return new OpenLayers.Feature.Vector("point"==this.geometryType?s[0]:"polygon"==this.geometryType?new OpenLayers.Geometry.Polygon([new OpenLayers.Geometry.LinearRing(s)]):new e(s))},decode:function(t,e,i){for(var n=i||1e5,s=this.decodeDeltas(t,e,n),r=s.length,o=[],a=0;r>a+(e-1);){for(var l=[],h=0;e>h;++h)l.push(s[a++]);o.push(l)}return o},write:function(t){var e;e=t.constructor==Array?t[0]:t;var i,n=e.geometry,s=n.CLASS_NAME.split(".")[2].toLowerCase();if("point"==s)i=new Array(n);else if("linestring"==s||"linearring"==s||"multipoint"==s)i=n.components;else{if("polygon"!=s)return null;i=n.components[0].components}for(var r=[],o=i.length,a=0;o>a;++a){var l=i[a];r.push(l.y),r.push(l.x)}return this.encodeDeltas(r,2)},encode:function(t,e,i){for(var n=i||1e5,s=[],r=t.length,o=0;r>o;++o)for(var a=t[o],l=0;e>l;++l)s.push(a[l]);return this.encodeDeltas(s,e,n)},encodeDeltas:function(t,e,i){var n,s=i||1e5,r=new Array(e);for(n=0;e>n;++n)r[n]=0;for(var o=t.length,a=0;o>a;)for(n=0;e>n;++n,++a){var l=t[a],h=l-r[n];r[n]=l,t[a]=h}return this.encodeFloats(t,s)},decodeDeltas:function(t,e,i){var n,s=i||1e5,r=new Array(e);for(n=0;e>n;++n)r[n]=0;for(var o=this.decodeFloats(t,s),a=o.length,l=0;a>l;)for(n=0;e>n;++n,++l)r[n]+=o[l],o[l]=r[n];return o},encodeFloats:function(t,e){for(var i=e||1e5,n=t.length,s=0;n>s;++s)t[s]=Math.round(t[s]*i);return this.encodeSignedIntegers(t)},decodeFloats:function(t,e){for(var i=e||1e5,n=this.decodeSignedIntegers(t),s=n.length,r=0;s>r;++r)n[r]/=i;return n},encodeSignedIntegers:function(t){for(var e=t.length,i=0;e>i;++i){var n=t[i],s=n<<1;0>n&&(s=~s),t[i]=s}return this.encodeUnsignedIntegers(t)},decodeSignedIntegers:function(t){for(var e=this.decodeUnsignedIntegers(t),i=e.length,n=0;i>n;++n){var s=e[n];e[n]=1&s?~(s>>1):s>>1}return e},encodeUnsignedIntegers:function(t){for(var e="",i=t.length,n=0;i>n;++n)e+=this.encodeUnsignedInteger(t[n]);return e},decodeUnsignedIntegers:function(t){for(var e=[],i=0,n=0,s=t.length,r=0;s>r;++r){var o=t.charCodeAt(r)-63;i|=(31&o)<<n,32>o?(e.push(i),i=0,n=0):n+=5}return e},encodeFloat:function(t,e){return t=Math.round(t*(e||1e5)),this.encodeSignedInteger(t)},decodeFloat:function(t,e){var i=this.decodeSignedInteger(t);return i/(e||1e5)},encodeSignedInteger:function(t){var e=t<<1;return 0>t&&(e=~e),this.encodeUnsignedInteger(e)},decodeSignedInteger:function(t){var e=this.decodeUnsignedInteger(t);return 1&e?~(e>>1):e>>1},encodeUnsignedInteger:function(t){for(var e,i="";t>=32;)e=(32|31&t)+63,i+=String.fromCharCode(e),t>>=5;return e=t+63,i+=String.fromCharCode(e)},decodeUnsignedInteger:function(t){for(var e=0,i=0,n=t.length,s=0;n>s;++s){var r=t.charCodeAt(s)-63;if(e|=(31&r)<<i,32>r)break;i+=5}return e},CLASS_NAME:"OpenLayers.Format.EncodedPolyline"}),OpenLayers.Control.Panel=OpenLayers.Class(OpenLayers.Control,{controls:null,autoActivate:!0,defaultControl:null,saveState:!1,allowDepress:!1,activeState:null,initialize:function(t){OpenLayers.Control.prototype.initialize.apply(this,[t]),this.controls=[],this.activeState={}},destroy:function(){this.map&&this.map.events.unregister("buttonclick",this,this.onButtonClick),OpenLayers.Control.prototype.destroy.apply(this,arguments);for(var t,e=this.controls.length-1;e>=0;e--)t=this.controls[e],t.events&&t.events.un({activate:this.iconOn,deactivate:this.iconOff}),t.panel_div=null;this.activeState=null},activate:function(){if(OpenLayers.Control.prototype.activate.apply(this,arguments)){for(var t,e=0,i=this.controls.length;i>e;e++)t=this.controls[e],(t===this.defaultControl||this.saveState&&this.activeState[t.id])&&t.activate();return this.saveState===!0&&(this.defaultControl=null),this.redraw(),!0}return!1},deactivate:function(){if(OpenLayers.Control.prototype.deactivate.apply(this,arguments)){for(var t,e=0,i=this.controls.length;i>e;e++)t=this.controls[e],this.activeState[t.id]=t.deactivate();return this.redraw(),!0}return!1},draw:function(){return OpenLayers.Control.prototype.draw.apply(this,arguments),this.outsideViewport?(this.events.attachToElement(this.div),this.events.register("buttonclick",this,this.onButtonClick)):this.map.events.register("buttonclick",this,this.onButtonClick),this.addControlsToMap(this.controls),this.div},redraw:function(){for(var t=this.div.childNodes.length,e=t-1;e>=0;e--)this.div.removeChild(this.div.childNodes[e]);if(this.div.innerHTML="",this.active)for(var e=0,i=this.controls.length;i>e;e++)this.div.appendChild(this.controls[e].panel_div)},activateControl:function(t){if(!this.active)return!1;if(t.type==OpenLayers.Control.TYPE_BUTTON)return void t.trigger();if(t.type==OpenLayers.Control.TYPE_TOGGLE)return void(t.active?t.deactivate():t.activate());if(this.allowDepress&&t.active)t.deactivate();else{for(var e,i=0,n=this.controls.length;n>i;i++)e=this.controls[i],e==t||e.type!==OpenLayers.Control.TYPE_TOOL&&null!=e.type||e.deactivate();t.activate()}},addControls:function(t){OpenLayers.Util.isArray(t)||(t=[t]),this.controls=this.controls.concat(t);for(var e=0,i=t.length;i>e;e++){var n=t[e],s=this.createControlMarkup(n);OpenLayers.Element.addClass(s,n.displayClass+"ItemInactive"),OpenLayers.Element.addClass(s,"olButton"),""==n.title||s.title||(s.title=n.title),n.panel_div=s}this.map&&(this.addControlsToMap(t),this.redraw())},createControlMarkup:function(){return document.createElement("div")},addControlsToMap:function(t){for(var e,i=0,n=t.length;n>i;i++)e=t[i],e.autoActivate===!0?(e.autoActivate=!1,this.map.addControl(e),e.autoActivate=!0):(this.map.addControl(e),e.deactivate()),e.events.on({activate:this.iconOn,deactivate:this.iconOff})},iconOn:function(){var t=this.panel_div,e=new RegExp("\\b("+this.displayClass+"Item)Inactive\\b");t.className=t.className.replace(e,"$1Active")},iconOff:function(){var t=this.panel_div,e=new RegExp("\\b("+this.displayClass+"Item)Active\\b");t.className=t.className.replace(e,"$1Inactive")},onButtonClick:function(t){for(var e=this.controls,i=t.buttonElement,n=e.length-1;n>=0;--n)if(e[n].panel_div===i){this.activateControl(e[n]);break}},getControlsBy:function(t,e){var i="function"==typeof e.test,n=OpenLayers.Array.filter(this.controls,function(n){return n[t]==e||i&&e.test(n[t])});return n},getControlsByName:function(t){return this.getControlsBy("name",t)},getControlsByClass:function(t){return this.getControlsBy("CLASS_NAME",t)},CLASS_NAME:"OpenLayers.Control.Panel"}),OpenLayers.Control.Button=OpenLayers.Class(OpenLayers.Control,{type:OpenLayers.Control.TYPE_BUTTON,trigger:function(){},CLASS_NAME:"OpenLayers.Control.Button"}),OpenLayers.Control.ZoomIn=OpenLayers.Class(OpenLayers.Control.Button,{trigger:function(){this.map&&this.map.zoomIn()},CLASS_NAME:"OpenLayers.Control.ZoomIn"}),OpenLayers.Control.ZoomOut=OpenLayers.Class(OpenLayers.Control.Button,{trigger:function(){this.map&&this.map.zoomOut()},CLASS_NAME:"OpenLayers.Control.ZoomOut"}),OpenLayers.Control.ZoomToMaxExtent=OpenLayers.Class(OpenLayers.Control.Button,{trigger:function(){this.map&&this.map.zoomToMaxExtent()},CLASS_NAME:"OpenLayers.Control.ZoomToMaxExtent"}),OpenLayers.Control.ZoomPanel=OpenLayers.Class(OpenLayers.Control.Panel,{initialize:function(t){OpenLayers.Control.Panel.prototype.initialize.apply(this,[t]),this.addControls([new OpenLayers.Control.ZoomIn,new OpenLayers.Control.ZoomToMaxExtent,new OpenLayers.Control.ZoomOut])},CLASS_NAME:"OpenLayers.Control.ZoomPanel"}),OpenLayers.Layer.HTTPRequest=OpenLayers.Class(OpenLayers.Layer,{URL_HASH_FACTOR:(Math.sqrt(5)-1)/2,url:null,params:null,reproject:!1,initialize:function(t,e,i,n){OpenLayers.Layer.prototype.initialize.apply(this,[t,n]),this.url=e,this.params||(this.params=OpenLayers.Util.extend({},i))},destroy:function(){this.url=null,this.params=null,OpenLayers.Layer.prototype.destroy.apply(this,arguments)},clone:function(t){return null==t&&(t=new OpenLayers.Layer.HTTPRequest(this.name,this.url,this.params,this.getOptions())),t=OpenLayers.Layer.prototype.clone.apply(this,[t])},setUrl:function(t){this.url=t},mergeNewParams:function(t){this.params=OpenLayers.Util.extend(this.params,t);var e=this.redraw();return null!=this.map&&this.map.events.triggerEvent("changelayer",{layer:this,property:"params"}),e},redraw:function(t){return t?this.mergeNewParams({_olSalt:Math.random()}):OpenLayers.Layer.prototype.redraw.apply(this,[])},selectUrl:function(t,e){for(var i=1,n=0,s=t.length;s>n;n++)i*=t.charCodeAt(n)*this.URL_HASH_FACTOR,i-=Math.floor(i);return e[Math.floor(i*e.length)]},getFullRequestString:function(t,e){var i=e||this.url,n=OpenLayers.Util.extend({},this.params);n=OpenLayers.Util.extend(n,t);var s=OpenLayers.Util.getParameterString(n);OpenLayers.Util.isArray(i)&&(i=this.selectUrl(s,i));var r=OpenLayers.Util.upperCaseObject(OpenLayers.Util.getParameters(i));for(var o in n)o.toUpperCase()in r&&delete n[o];return s=OpenLayers.Util.getParameterString(n),OpenLayers.Util.urlAppend(i,s)},CLASS_NAME:"OpenLayers.Layer.HTTPRequest"}),OpenLayers.Tile=OpenLayers.Class({events:null,eventListeners:null,id:null,layer:null,url:null,bounds:null,size:null,position:null,isLoading:!1,initialize:function(t,e,i,n,s,r){this.layer=t,this.position=e.clone(),this.setBounds(i),this.url=n,s&&(this.size=s.clone()),this.id=OpenLayers.Util.createUniqueID("Tile_"),OpenLayers.Util.extend(this,r),this.events=new OpenLayers.Events(this),this.eventListeners instanceof Object&&this.events.on(this.eventListeners)},unload:function(){this.isLoading&&(this.isLoading=!1,this.events.triggerEvent("unload"))},destroy:function(){this.layer=null,this.bounds=null,this.size=null,this.position=null,this.eventListeners&&this.events.un(this.eventListeners),this.events.destroy(),this.eventListeners=null,this.events=null},draw:function(t){t||this.clear();var e=this.shouldDraw();return e&&!t&&this.events.triggerEvent("beforedraw")===!1&&(e=null),e},shouldDraw:function(){var t=!1,e=this.layer.maxExtent;if(e){var i=this.layer.map,n=i.baseLayer.wrapDateLine&&i.getMaxExtent();this.bounds.intersectsBounds(e,{inclusive:!1,worldBounds:n})&&(t=!0)}return t||this.layer.displayOutsideMaxExtent},setBounds:function(t){if(t=t.clone(),this.layer.map.baseLayer.wrapDateLine){var e=this.layer.map.getMaxExtent(),i=this.layer.map.getResolution();t=t.wrapDateLine(e,{leftTolerance:i,rightTolerance:i})}this.bounds=t},moveTo:function(t,e,i){null==i&&(i=!0),this.setBounds(t),this.position=e.clone(),i&&this.draw()},clear:function(){},CLASS_NAME:"OpenLayers.Tile"}),OpenLayers.Tile.Image=OpenLayers.Class(OpenLayers.Tile,{url:null,imgDiv:null,frame:null,imageReloadAttempts:null,layerAlphaHack:null,asyncRequestId:null,maxGetUrlLength:null,canvasContext:null,crossOriginKeyword:null,initialize:function(t,e,i,n){OpenLayers.Tile.prototype.initialize.apply(this,arguments),this.url=n,this.layerAlphaHack=this.layer.alpha&&OpenLayers.Util.alphaHack(),(null!=this.maxGetUrlLength||this.layer.gutter||this.layerAlphaHack)&&(this.frame=document.createElement("div"),this.frame.style.position="absolute",this.frame.style.overflow="hidden"),null!=this.maxGetUrlLength&&OpenLayers.Util.extend(this,OpenLayers.Tile.Image.IFrame)
},destroy:function(){this.imgDiv&&(this.clear(),this.imgDiv=null,this.frame=null),this.asyncRequestId=null,OpenLayers.Tile.prototype.destroy.apply(this,arguments)},draw:function(){var t=OpenLayers.Tile.prototype.draw.apply(this,arguments);return t?(this.layer!=this.layer.map.baseLayer&&this.layer.reproject&&(this.bounds=this.getBoundsFromBaseLayer(this.position)),this.isLoading?this._loadEvent="reload":(this.isLoading=!0,this._loadEvent="loadstart"),this.renderTile(),this.positionTile()):t===!1&&this.unload(),t},renderTile:function(){if(this.layer.async){var t=this.asyncRequestId=(this.asyncRequestId||0)+1;this.layer.getURLasync(this.bounds,function(e){t==this.asyncRequestId&&(this.url=e,this.initImage())},this)}else this.url=this.layer.getURL(this.bounds),this.initImage()},positionTile:function(){var t=this.getTile().style,e=this.frame?this.size:this.layer.getImageSize(this.bounds),i=1;this.layer instanceof OpenLayers.Layer.Grid&&(i=this.layer.getServerResolution()/this.layer.map.getResolution()),t.left=this.position.x+"px",t.top=this.position.y+"px",t.width=Math.round(i*e.w)+"px",t.height=Math.round(i*e.h)+"px"},clear:function(){OpenLayers.Tile.prototype.clear.apply(this,arguments);var t=this.imgDiv;if(t){var e=this.getTile();e.parentNode===this.layer.div&&this.layer.div.removeChild(e),this.setImgSrc(),this.layerAlphaHack===!0&&(t.style.filter=""),OpenLayers.Element.removeClass(t,"olImageLoadError")}this.canvasContext=null},getImage:function(){if(!this.imgDiv){this.imgDiv=OpenLayers.Tile.Image.IMAGE.cloneNode(!1);var t=this.imgDiv.style;if(this.frame){var e=0,i=0;this.layer.gutter&&(e=this.layer.gutter/this.layer.tileSize.w*100,i=this.layer.gutter/this.layer.tileSize.h*100),t.left=-e+"%",t.top=-i+"%",t.width=2*e+100+"%",t.height=2*i+100+"%"}t.visibility="hidden",t.opacity=0,this.layer.opacity<1&&(t.filter="alpha(opacity="+100*this.layer.opacity+")"),t.position="absolute",this.layerAlphaHack&&(t.paddingTop=t.height,t.height="0",t.width="100%"),this.frame&&this.frame.appendChild(this.imgDiv)}return this.imgDiv},setImage:function(t){this.imgDiv=t},initImage:function(){if(!this.url&&!this.imgDiv)return void(this.isLoading=!1);this.events.triggerEvent("beforeload"),this.layer.div.appendChild(this.getTile()),this.events.triggerEvent(this._loadEvent);var t=this.getImage(),e=t.getAttribute("src")||"";this.url&&OpenLayers.Util.isEquivalentUrl(e,this.url)?this._loadTimeout=window.setTimeout(OpenLayers.Function.bind(this.onImageLoad,this),0):(this.stopLoading(),this.crossOriginKeyword&&t.removeAttribute("crossorigin"),OpenLayers.Event.observe(t,"load",OpenLayers.Function.bind(this.onImageLoad,this)),OpenLayers.Event.observe(t,"error",OpenLayers.Function.bind(this.onImageError,this)),this.imageReloadAttempts=0,this.setImgSrc(this.url))},setImgSrc:function(t){var e=this.imgDiv;t?(e.style.visibility="hidden",e.style.opacity=0,this.crossOriginKeyword&&("data:"!==t.substr(0,5)?e.setAttribute("crossorigin",this.crossOriginKeyword):e.removeAttribute("crossorigin")),e.src=t):(this.stopLoading(),this.imgDiv=null,e.parentNode&&e.parentNode.removeChild(e))},getTile:function(){return this.frame?this.frame:this.getImage()},createBackBuffer:function(){if(this.imgDiv&&!this.isLoading){var t;return this.frame?(t=this.frame.cloneNode(!1),t.appendChild(this.imgDiv)):t=this.imgDiv,this.imgDiv=null,t}},onImageLoad:function(){var t=this.imgDiv;this.stopLoading(),t.style.visibility="inherit",t.style.opacity=this.layer.opacity,this.isLoading=!1,this.canvasContext=null,this.events.triggerEvent("loadend"),this.layerAlphaHack===!0&&(t.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+t.src+"', sizingMethod='scale')")},onImageError:function(){var t=this.imgDiv;null!=t.src&&(this.imageReloadAttempts++,this.imageReloadAttempts<=OpenLayers.IMAGE_RELOAD_ATTEMPTS?this.setImgSrc(this.layer.getURL(this.bounds)):(OpenLayers.Element.addClass(t,"olImageLoadError"),this.events.triggerEvent("loaderror"),this.onImageLoad()))},stopLoading:function(){OpenLayers.Event.stopObservingElement(this.imgDiv),window.clearTimeout(this._loadTimeout),delete this._loadTimeout},getCanvasContext:function(){if(OpenLayers.CANVAS_SUPPORTED&&this.imgDiv&&!this.isLoading){if(!this.canvasContext){var t=document.createElement("canvas");t.width=this.size.w,t.height=this.size.h,this.canvasContext=t.getContext("2d"),this.canvasContext.drawImage(this.imgDiv,0,0)}return this.canvasContext}},CLASS_NAME:"OpenLayers.Tile.Image"}),OpenLayers.Tile.Image.IMAGE=function(){var t=new Image;return t.className="olTileImage",t.galleryImg="no",t}(),OpenLayers.Layer.Grid=OpenLayers.Class(OpenLayers.Layer.HTTPRequest,{tileSize:null,tileOriginCorner:"bl",tileOrigin:null,tileOptions:null,tileClass:OpenLayers.Tile.Image,grid:null,singleTile:!1,ratio:1.5,buffer:0,transitionEffect:"resize",numLoadingTiles:0,serverResolutions:null,loading:!1,backBuffer:null,gridResolution:null,backBufferResolution:null,backBufferLonLat:null,backBufferTimerId:null,removeBackBufferDelay:null,className:null,gridLayout:null,rowSign:null,transitionendEvents:["transitionend","webkitTransitionEnd","otransitionend","oTransitionEnd"],initialize:function(){OpenLayers.Layer.HTTPRequest.prototype.initialize.apply(this,arguments),this.grid=[],this._removeBackBuffer=OpenLayers.Function.bind(this.removeBackBuffer,this),this.initProperties(),this.rowSign="t"===this.tileOriginCorner.substr(0,1)?1:-1},initProperties:function(){void 0===this.options.removeBackBufferDelay&&(this.removeBackBufferDelay=this.singleTile?0:2500),void 0===this.options.className&&(this.className=this.singleTile?"olLayerGridSingleTile":"olLayerGrid")},setMap:function(t){OpenLayers.Layer.HTTPRequest.prototype.setMap.call(this,t),OpenLayers.Element.addClass(this.div,this.className)},removeMap:function(){this.removeBackBuffer()},destroy:function(){this.removeBackBuffer(),this.clearGrid(),this.grid=null,this.tileSize=null,OpenLayers.Layer.HTTPRequest.prototype.destroy.apply(this,arguments)},clearGrid:function(){if(this.grid){for(var t=0,e=this.grid.length;e>t;t++)for(var i=this.grid[t],n=0,s=i.length;s>n;n++){var r=i[n];this.destroyTile(r)}this.grid=[],this.gridResolution=null,this.gridLayout=null}},addOptions:function(t){var e=void 0!==t.singleTile&&t.singleTile!==this.singleTile;OpenLayers.Layer.HTTPRequest.prototype.addOptions.apply(this,arguments),this.map&&e&&(this.initProperties(),this.clearGrid(),this.tileSize=this.options.tileSize,this.setTileSize(),this.moveTo(null,!0))},clone:function(t){return null==t&&(t=new OpenLayers.Layer.Grid(this.name,this.url,this.params,this.getOptions())),t=OpenLayers.Layer.HTTPRequest.prototype.clone.apply(this,[t]),null!=this.tileSize&&(t.tileSize=this.tileSize.clone()),t.grid=[],t.gridResolution=null,t.backBuffer=null,t.backBufferTimerId=null,t.loading=!1,t.numLoadingTiles=0,t},moveTo:function(t,e,i){if(OpenLayers.Layer.HTTPRequest.prototype.moveTo.apply(this,arguments),t=t||this.map.getExtent(),null!=t){{var n=!this.grid.length||e,s=this.getTilesBounds(),r=this.map.getResolution();this.getServerResolution(r)}this.singleTile?(n||!i&&!s.containsBounds(t))&&(e&&"resize"!==this.transitionEffect&&this.removeBackBuffer(),e&&"resize"!==this.transitionEffect||this.applyBackBuffer(r),this.initSingleTile(t)):(n=n||!s.intersectsBounds(t,{worldBounds:this.map.baseLayer.wrapDateLine&&this.map.getMaxExtent()}),n?(!e||"resize"!==this.transitionEffect&&this.gridResolution!==r||this.applyBackBuffer(r),this.initGriddedTiles(t)):this.moveGriddedTiles())}},getTileData:function(t){var e=null,i=t.lon,n=t.lat,s=this.grid.length;if(this.map&&s){var r=this.map.getResolution(),o=this.tileSize.w,a=this.tileSize.h,l=this.grid[0][0].bounds,h=l.left,u=l.top;if(h>i&&this.map.baseLayer.wrapDateLine){var p=this.map.getMaxExtent().getWidth(),c=Math.ceil((h-i)/p);i+=p*c}var d=(i-h)/(r*o),m=(u-n)/(r*a),f=Math.floor(d),y=Math.floor(m);if(y>=0&&s>y){var g=this.grid[y][f];g&&(e={tile:g,i:Math.floor((d-f)*o),j:Math.floor((m-y)*a)})}}return e},destroyTile:function(t){this.removeTileMonitoringHooks(t),t.destroy()},getServerResolution:function(t){var e=Number.POSITIVE_INFINITY;if(t=t||this.map.getResolution(),this.serverResolutions&&-1===OpenLayers.Util.indexOf(this.serverResolutions,t)){var i,n,s,r;for(i=this.serverResolutions.length-1;i>=0&&(s=this.serverResolutions[i],n=Math.abs(s-t),!(n>e));i--)e=n,r=s;t=r}return t},getServerZoom:function(){var t=this.getServerResolution();return this.serverResolutions?OpenLayers.Util.indexOf(this.serverResolutions,t):this.map.getZoomForResolution(t)+(this.zoomOffset||0)},applyBackBuffer:function(t){null!==this.backBufferTimerId&&this.removeBackBuffer();var e=this.backBuffer;if(!e){if(e=this.createBackBuffer(),!e)return;t===this.gridResolution?this.div.insertBefore(e,this.div.firstChild):this.map.baseLayer.div.parentNode.insertBefore(e,this.map.baseLayer.div),this.backBuffer=e;var i=this.grid[0][0].bounds;this.backBufferLonLat={lon:i.left,lat:i.top},this.backBufferResolution=this.gridResolution}for(var n,s=this.backBufferResolution/t,r=e.childNodes,o=r.length-1;o>=0;--o)n=r[o],n.style.top=(s*n._i*n._h|0)+"px",n.style.left=(s*n._j*n._w|0)+"px",n.style.width=Math.round(s*n._w)+"px",n.style.height=Math.round(s*n._h)+"px";var a=this.getViewPortPxFromLonLat(this.backBufferLonLat,t),l=this.map.layerContainerOriginPx.x,h=this.map.layerContainerOriginPx.y;e.style.left=Math.round(a.x-l)+"px",e.style.top=Math.round(a.y-h)+"px"},createBackBuffer:function(){var t;if(this.grid.length>0){t=document.createElement("div"),t.id=this.div.id+"_bb",t.className="olBackBuffer",t.style.position="absolute";var e=this.map;t.style.zIndex="resize"===this.transitionEffect?this.getZIndex()-1:e.Z_INDEX_BASE.BaseLayer-(e.getNumLayers()-e.getLayerIndex(this));for(var i=0,n=this.grid.length;n>i;i++)for(var s=0,r=this.grid[i].length;r>s;s++){var o=this.grid[i][s],a=this.grid[i][s].createBackBuffer();a&&(a._i=i,a._j=s,a._w=o.size.w,a._h=o.size.h,a.id=o.id+"_bb",t.appendChild(a))}}return t},removeBackBuffer:function(){if(this._transitionElement){for(var t=this.transitionendEvents.length-1;t>=0;--t)OpenLayers.Event.stopObserving(this._transitionElement,this.transitionendEvents[t],this._removeBackBuffer);delete this._transitionElement}this.backBuffer&&(this.backBuffer.parentNode&&this.backBuffer.parentNode.removeChild(this.backBuffer),this.backBuffer=null,this.backBufferResolution=null,null!==this.backBufferTimerId&&(window.clearTimeout(this.backBufferTimerId),this.backBufferTimerId=null))},moveByPx:function(){this.singleTile||this.moveGriddedTiles()},setTileSize:function(t){this.singleTile&&(t=this.map.getSize(),t.h=parseInt(t.h*this.ratio,10),t.w=parseInt(t.w*this.ratio,10)),OpenLayers.Layer.HTTPRequest.prototype.setTileSize.apply(this,[t])},getTilesBounds:function(){var t=null,e=this.grid.length;if(e){var i=this.grid[e-1][0].bounds,n=this.grid[0].length*i.getWidth(),s=this.grid.length*i.getHeight();t=new OpenLayers.Bounds(i.left,i.bottom,i.left+n,i.bottom+s)}return t},initSingleTile:function(t){this.events.triggerEvent("retile");var e=t.getCenterLonLat(),i=t.getWidth()*this.ratio,n=t.getHeight()*this.ratio,s=new OpenLayers.Bounds(e.lon-i/2,e.lat-n/2,e.lon+i/2,e.lat+n/2),r=this.map.getLayerPxFromLonLat({lon:s.left,lat:s.top});this.grid.length||(this.grid[0]=[]);var o=this.grid[0][0];o?o.moveTo(s,r):(o=this.addTile(s,r),this.addTileMonitoringHooks(o),o.draw(),this.grid[0][0]=o),this.removeExcessTiles(1,1),this.gridResolution=this.getServerResolution()},calculateGridLayout:function(t,e,i){var n=i*this.tileSize.w,s=i*this.tileSize.h,r=t.left-e.lon,o=Math.floor(r/n)-this.buffer,a=this.rowSign,l=a*(e.lat-t.top+s),h=Math[~a?"floor":"ceil"](l/s)-this.buffer*a;return{tilelon:n,tilelat:s,startcol:o,startrow:h}},getTileOrigin:function(){var t=this.tileOrigin;if(!t){var e=this.getMaxExtent(),i={tl:["left","top"],tr:["right","top"],bl:["left","bottom"],br:["right","bottom"]}[this.tileOriginCorner];t=new OpenLayers.LonLat(e[i[0]],e[i[1]])}return t},getTileBoundsForGridIndex:function(t,e){var i=this.getTileOrigin(),n=this.gridLayout,s=n.tilelon,r=n.tilelat,o=n.startcol,a=n.startrow,l=this.rowSign;return new OpenLayers.Bounds(i.lon+(o+e)*s,i.lat-(a+t*l)*r*l,i.lon+(o+e+1)*s,i.lat-(a+(t-1)*l)*r*l)},initGriddedTiles:function(t){this.events.triggerEvent("retile");var e=this.map.getSize(),i=this.getTileOrigin(),n=this.map.getResolution(),s=this.getServerResolution(),r=n/s,o={w:this.tileSize.w/r,h:this.tileSize.h/r},a=Math.ceil(e.h/o.h)+2*this.buffer+1,l=Math.ceil(e.w/o.w)+2*this.buffer+1,h=this.calculateGridLayout(t,i,s);this.gridLayout=h;var u=h.tilelon,p=h.tilelat,c=this.map.layerContainerOriginPx.x,d=this.map.layerContainerOriginPx.y,m=this.getTileBoundsForGridIndex(0,0),f=this.map.getViewPortPxFromLonLat(new OpenLayers.LonLat(m.left,m.top));f.x=Math.round(f.x)-c,f.y=Math.round(f.y)-d;var y=[],g=this.map.getCenter(),v=0;do{var L=this.grid[v];L||(L=[],this.grid.push(L));var _=0;do{m=this.getTileBoundsForGridIndex(v,_);var O=f.clone();O.x=O.x+_*Math.round(o.w),O.y=O.y+v*Math.round(o.h);var b=L[_];b?b.moveTo(m,O,!1):(b=this.addTile(m,O),this.addTileMonitoringHooks(b),L.push(b));var w=m.getCenterLonLat();y.push({tile:b,distance:Math.pow(w.lon-g.lon,2)+Math.pow(w.lat-g.lat,2)}),_+=1}while(m.right<=t.right+u*this.buffer||l>_);v+=1}while(m.bottom>=t.bottom-p*this.buffer||a>v);this.removeExcessTiles(v,_);var n=this.getServerResolution();this.gridResolution=n,y.sort(function(t,e){return t.distance-e.distance});for(var x=0,S=y.length;S>x;++x)y[x].tile.draw()},getMaxExtent:function(){return this.maxExtent},addTile:function(t,e){var i=new this.tileClass(this,e,t,null,this.tileSize,this.tileOptions);return this.events.triggerEvent("addtile",{tile:i}),i},addTileMonitoringHooks:function(t){var e="olTileReplacing";t.onLoadStart=function(){this.loading===!1&&(this.loading=!0,this.events.triggerEvent("loadstart")),this.events.triggerEvent("tileloadstart",{tile:t}),this.numLoadingTiles++,!this.singleTile&&this.backBuffer&&this.gridResolution===this.backBufferResolution&&OpenLayers.Element.addClass(t.getTile(),e)},t.onLoadEnd=function(i){this.numLoadingTiles--;var n="unload"===i.type;if(this.events.triggerEvent("tileloaded",{tile:t,aborted:n}),!this.singleTile&&!n&&this.backBuffer&&this.gridResolution===this.backBufferResolution){var s=t.getTile();if("none"===OpenLayers.Element.getStyle(s,"display")){var r=document.getElementById(t.id+"_bb");r&&r.parentNode.removeChild(r)}OpenLayers.Element.removeClass(s,e)}if(0===this.numLoadingTiles){if(this.backBuffer)if(0===this.backBuffer.childNodes.length)this.removeBackBuffer();else{this._transitionElement=n?this.div.lastChild:t.imgDiv;for(var o=this.transitionendEvents,a=o.length-1;a>=0;--a)OpenLayers.Event.observe(this._transitionElement,o[a],this._removeBackBuffer);this.backBufferTimerId=window.setTimeout(this._removeBackBuffer,this.removeBackBufferDelay)}this.loading=!1,this.events.triggerEvent("loadend")}},t.onLoadError=function(){this.events.triggerEvent("tileerror",{tile:t})},t.events.on({loadstart:t.onLoadStart,loadend:t.onLoadEnd,unload:t.onLoadEnd,loaderror:t.onLoadError,scope:this})},removeTileMonitoringHooks:function(t){t.unload(),t.events.un({loadstart:t.onLoadStart,loadend:t.onLoadEnd,unload:t.onLoadEnd,loaderror:t.onLoadError,scope:this})},moveGriddedTiles:function(){for(var t=this.buffer+1;;){var e=this.grid[0][0],i={x:e.position.x+this.map.layerContainerOriginPx.x,y:e.position.y+this.map.layerContainerOriginPx.y},n=this.getServerResolution()/this.map.getResolution(),s={w:Math.round(this.tileSize.w*n),h:Math.round(this.tileSize.h*n)};if(i.x>-s.w*(t-1))this.shiftColumn(!0,s);else if(i.x<-s.w*t)this.shiftColumn(!1,s);else if(i.y>-s.h*(t-1))this.shiftRow(!0,s);else{if(!(i.y<-s.h*t))break;this.shiftRow(!1,s)}}},shiftRow:function(t,e){var i=this.grid,n=t?0:i.length-1,s=t?-1:1,r=this.rowSign,o=this.gridLayout;o.startrow+=s*r;for(var a=i[n],l=i[t?"pop":"shift"](),h=0,u=l.length;u>h;h++){var p=l[h],c=a[h].position.clone();c.y+=e.h*s,p.moveTo(this.getTileBoundsForGridIndex(n,h),c)}i[t?"unshift":"push"](l)},shiftColumn:function(t,e){var i=this.grid,n=t?0:i[0].length-1,s=t?-1:1,r=this.gridLayout;r.startcol+=s;for(var o=0,a=i.length;a>o;o++){var l=i[o],h=l[n].position.clone(),u=l[t?"pop":"shift"]();h.x+=e.w*s,u.moveTo(this.getTileBoundsForGridIndex(o,n),h),l[t?"unshift":"push"](u)}},removeExcessTiles:function(t,e){for(var i,n;this.grid.length>t;){var s=this.grid.pop();for(i=0,n=s.length;n>i;i++){var r=s[i];this.destroyTile(r)}}for(i=0,n=this.grid.length;n>i;i++)for(;this.grid[i].length>e;){var s=this.grid[i],r=s.pop();this.destroyTile(r)}},onMapResize:function(){this.singleTile&&(this.clearGrid(),this.setTileSize())},getTileBounds:function(t){var e=this.maxExtent,i=this.getResolution(),n=i*this.tileSize.w,s=i*this.tileSize.h,r=this.getLonLatFromViewPortPx(t),o=e.left+n*Math.floor((r.lon-e.left)/n),a=e.bottom+s*Math.floor((r.lat-e.bottom)/s);return new OpenLayers.Bounds(o,a,o+n,a+s)},CLASS_NAME:"OpenLayers.Layer.Grid"}),OpenLayers.Format.ArcXML=OpenLayers.Class(OpenLayers.Format.XML,{fontStyleKeys:["antialiasing","blockout","font","fontcolor","fontsize","fontstyle","glowing","interval","outline","printmode","shadow","transparency"],request:null,response:null,initialize:function(t){if(this.request=new OpenLayers.Format.ArcXML.Request,this.response=new OpenLayers.Format.ArcXML.Response,t)if("feature"==t.requesttype){this.request.get_image=null;var e=this.request.get_feature.query;this.addCoordSys(e.featurecoordsys,t.featureCoordSys),this.addCoordSys(e.filtercoordsys,t.filterCoordSys),t.polygon?(e.isspatial=!0,e.spatialfilter.polygon=t.polygon):t.envelope&&(e.isspatial=!0,e.spatialfilter.envelope={minx:0,miny:0,maxx:0,maxy:0},this.parseEnvelope(e.spatialfilter.envelope,t.envelope))}else if("image"==t.requesttype){this.request.get_feature=null;var i=this.request.get_image.properties;this.parseEnvelope(i.envelope,t.envelope),this.addLayers(i.layerlist,t.layers),this.addImageSize(i.imagesize,t.tileSize),this.addCoordSys(i.featurecoordsys,t.featureCoordSys),this.addCoordSys(i.filtercoordsys,t.filterCoordSys)}else this.request=null;OpenLayers.Format.XML.prototype.initialize.apply(this,[t])},parseEnvelope:function(t,e){e&&4==e.length&&(t.minx=e[0],t.miny=e[1],t.maxx=e[2],t.maxy=e[3])},addLayers:function(t,e){for(var i=0,n=e.length;n>i;i++)t.push(e[i])},addImageSize:function(t,e){null!==e&&(t.width=e.w,t.height=e.h,t.printwidth=e.w,t.printheight=e.h)},addCoordSys:function(t,e){"string"==typeof e?(t.id=parseInt(e),t.string=e):"object"==typeof e&&null!==e.proj?(t.id=e.proj.srsProjNumber,t.string=e.proj.srsCode):t=e},iserror:function(t){var e=null;if(t){t=OpenLayers.Format.XML.prototype.read.apply(this,[t]);var i=t.documentElement.getElementsByTagName("ERROR");e=null!==i&&i.length>0}else e=""!==this.response.error;return e},read:function(t){"string"==typeof t&&(t=OpenLayers.Format.XML.prototype.read.apply(this,[t]));var e=null;if(t&&t.documentElement&&(e="ARCXML"==t.documentElement.nodeName?t.documentElement:t.documentElement.getElementsByTagName("ARCXML")[0]),!e||"parsererror"===e.firstChild.nodeName){var i,n;try{i=t.firstChild.nodeValue,n=t.firstChild.childNodes[1].firstChild.nodeValue}catch(s){}throw{message:"Error parsing the ArcXML request",error:i,source:n}}var r=this.parseResponse(e);return r},write:function(t){t||(t=this.request);var e=this.createElementNS("","ARCXML");e.setAttribute("version","1.1");var i=this.createElementNS("","REQUEST");if(null!=t.get_image){var n=this.createElementNS("","GET_IMAGE");i.appendChild(n);var s=this.createElementNS("","PROPERTIES");n.appendChild(s);var r=t.get_image.properties;if(null!=r.featurecoordsys){var o=this.createElementNS("","FEATURECOORDSYS");s.appendChild(o),0===r.featurecoordsys.id?o.setAttribute("string",r.featurecoordsys.string):o.setAttribute("id",r.featurecoordsys.id)}if(null!=r.filtercoordsys){var a=this.createElementNS("","FILTERCOORDSYS");s.appendChild(a),0===r.filtercoordsys.id?a.setAttribute("string",r.filtercoordsys.string):a.setAttribute("id",r.filtercoordsys.id)}if(null!=r.envelope){var l=this.createElementNS("","ENVELOPE");s.appendChild(l),l.setAttribute("minx",r.envelope.minx),l.setAttribute("miny",r.envelope.miny),l.setAttribute("maxx",r.envelope.maxx),l.setAttribute("maxy",r.envelope.maxy)}var h=this.createElementNS("","IMAGESIZE");if(s.appendChild(h),h.setAttribute("height",r.imagesize.height),h.setAttribute("width",r.imagesize.width),(r.imagesize.height!=r.imagesize.printheight||r.imagesize.width!=r.imagesize.printwidth)&&(h.setAttribute("printheight",r.imagesize.printheight),h.setArrtibute("printwidth",r.imagesize.printwidth)),null!=r.background){var u=this.createElementNS("","BACKGROUND");s.appendChild(u),u.setAttribute("color",r.background.color.r+","+r.background.color.g+","+r.background.color.b),null!==r.background.transcolor&&u.setAttribute("transcolor",r.background.transcolor.r+","+r.background.transcolor.g+","+r.background.transcolor.b)}if(null!=r.layerlist&&r.layerlist.length>0){var p=this.createElementNS("","LAYERLIST");s.appendChild(p);for(var c=0;c<r.layerlist.length;c++){var d=this.createElementNS("","LAYERDEF");if(p.appendChild(d),d.setAttribute("id",r.layerlist[c].id),d.setAttribute("visible",r.layerlist[c].visible),"object"==typeof r.layerlist[c].query){var m=r.layerlist[c].query;if(m.where.length<0)continue;var f=null;f="boolean"==typeof m.spatialfilter&&m.spatialfilter?this.createElementNS("","SPATIALQUERY"):this.createElementNS("","QUERY"),f.setAttribute("where",m.where),"number"==typeof m.accuracy&&m.accuracy>0&&f.setAttribute("accuracy",m.accuracy),"number"==typeof m.featurelimit&&m.featurelimit<2e3&&f.setAttribute("featurelimit",m.featurelimit),"string"==typeof m.subfields&&"#ALL#"!=m.subfields&&f.setAttribute("subfields",m.subfields),"string"==typeof m.joinexpression&&m.joinexpression.length>0&&f.setAttribute("joinexpression",m.joinexpression),"string"==typeof m.jointables&&m.jointables.length>0&&f.setAttribute("jointables",m.jointables),d.appendChild(f)}"object"==typeof r.layerlist[c].renderer&&this.addRenderer(d,r.layerlist[c].renderer)}}}else if(null!=t.get_feature){var n=this.createElementNS("","GET_FEATURES");if(n.setAttribute("outputmode","newxml"),n.setAttribute("checkesc","true"),t.get_feature.geometry?n.setAttribute("geometry",t.get_feature.geometry):n.setAttribute("geometry","false"),t.get_feature.compact&&n.setAttribute("compact",t.get_feature.compact),"number"==t.get_feature.featurelimit&&n.setAttribute("featurelimit",t.get_feature.featurelimit),n.setAttribute("globalenvelope","true"),i.appendChild(n),null!=t.get_feature.layer&&t.get_feature.layer.length>0){var y=this.createElementNS("","LAYER");y.setAttribute("id",t.get_feature.layer),n.appendChild(y)}var g=t.get_feature.query;if(null!=g){var v=null;if(v=g.isspatial?this.createElementNS("","SPATIALQUERY"):this.createElementNS("","QUERY"),n.appendChild(v),"number"==typeof g.accuracy&&v.setAttribute("accuracy",g.accuracy),null!=g.featurecoordsys){var L=this.createElementNS("","FEATURECOORDSYS");0==g.featurecoordsys.id?L.setAttribute("string",g.featurecoordsys.string):L.setAttribute("id",g.featurecoordsys.id),v.appendChild(L)}if(null!=g.filtercoordsys){var _=this.createElementNS("","FILTERCOORDSYS");0===g.filtercoordsys.id?_.setAttribute("string",g.filtercoordsys.string):_.setAttribute("id",g.filtercoordsys.id),v.appendChild(_)}if(g.buffer>0){var O=this.createElementNS("","BUFFER");O.setAttribute("distance",g.buffer),v.appendChild(O)}if(g.isspatial){var b=this.createElementNS("","SPATIALFILTER");if(b.setAttribute("relation",g.spatialfilter.relation),v.appendChild(b),g.spatialfilter.envelope){var w=this.createElementNS("","ENVELOPE");w.setAttribute("minx",g.spatialfilter.envelope.minx),w.setAttribute("miny",g.spatialfilter.envelope.miny),w.setAttribute("maxx",g.spatialfilter.envelope.maxx),w.setAttribute("maxy",g.spatialfilter.envelope.maxy),b.appendChild(w)}else"object"==typeof g.spatialfilter.polygon&&b.appendChild(this.writePolygonGeometry(g.spatialfilter.polygon))}null!=g.where&&g.where.length>0&&v.setAttribute("where",g.where)}}return e.appendChild(i),OpenLayers.Format.XML.prototype.write.apply(this,[e])},addGroupRenderer:function(t,e){var i=this.createElementNS("","GROUPRENDERER");t.appendChild(i);for(var n=0;n<e.length;n++){var s=e[n];this.addRenderer(i,s)}},addRenderer:function(t,e){if(OpenLayers.Util.isArray(e))this.addGroupRenderer(t,e);else{var i=this.createElementNS("",e.type.toUpperCase()+"RENDERER");t.appendChild(i),"VALUEMAPRENDERER"==i.tagName?this.addValueMapRenderer(i,e):"VALUEMAPLABELRENDERER"==i.tagName?this.addValueMapLabelRenderer(i,e):"SIMPLELABELRENDERER"==i.tagName?this.addSimpleLabelRenderer(i,e):"SCALEDEPENDENTRENDERER"==i.tagName&&this.addScaleDependentRenderer(i,e)}},addScaleDependentRenderer:function(t,e){("string"==typeof e.lower||"number"==typeof e.lower)&&t.setAttribute("lower",e.lower),("string"==typeof e.upper||"number"==typeof e.upper)&&t.setAttribute("upper",e.upper),this.addRenderer(t,e.renderer)},addValueMapLabelRenderer:function(t,e){if(t.setAttribute("lookupfield",e.lookupfield),t.setAttribute("labelfield",e.labelfield),"object"==typeof e.exacts)for(var i=0,n=e.exacts.length;n>i;i++){var s=e.exacts[i],r=this.createElementNS("","EXACT");if("string"==typeof s.value&&r.setAttribute("value",s.value),"string"==typeof s.label&&r.setAttribute("label",s.label),"string"==typeof s.method&&r.setAttribute("method",s.method),t.appendChild(r),"object"==typeof s.symbol){var o=null;if("text"==s.symbol.type&&(o=this.createElementNS("","TEXTSYMBOL")),null!=o){for(var a=this.fontStyleKeys,l=0,h=a.length;h>l;l++){var u=a[l];s.symbol[u]&&o.setAttribute(u,s.symbol[u])}r.appendChild(o)}}}},addValueMapRenderer:function(t,e){if(t.setAttribute("lookupfield",e.lookupfield),"object"==typeof e.ranges)for(var i=0,n=e.ranges.length;n>i;i++){var s=e.ranges[i],r=this.createElementNS("","RANGE");if(r.setAttribute("lower",s.lower),r.setAttribute("upper",s.upper),t.appendChild(r),"object"==typeof s.symbol){var o=null;"simplepolygon"==s.symbol.type&&(o=this.createElementNS("","SIMPLEPOLYGONSYMBOL")),null!=o&&("string"==typeof s.symbol.boundarycolor&&o.setAttribute("boundarycolor",s.symbol.boundarycolor),"string"==typeof s.symbol.fillcolor&&o.setAttribute("fillcolor",s.symbol.fillcolor),"number"==typeof s.symbol.filltransparency&&o.setAttribute("filltransparency",s.symbol.filltransparency),r.appendChild(o))}}else if("object"==typeof e.exacts)for(var a=0,l=e.exacts.length;l>a;a++){var h=e.exacts[a],u=this.createElementNS("","EXACT");if("string"==typeof h.value&&u.setAttribute("value",h.value),"string"==typeof h.label&&u.setAttribute("label",h.label),"string"==typeof h.method&&u.setAttribute("method",h.method),t.appendChild(u),"object"==typeof h.symbol){var o=null;"simplemarker"==h.symbol.type&&(o=this.createElementNS("","SIMPLEMARKERSYMBOL")),null!=o&&("string"==typeof h.symbol.antialiasing&&o.setAttribute("antialiasing",h.symbol.antialiasing),"string"==typeof h.symbol.color&&o.setAttribute("color",h.symbol.color),"string"==typeof h.symbol.outline&&o.setAttribute("outline",h.symbol.outline),"string"==typeof h.symbol.overlap&&o.setAttribute("overlap",h.symbol.overlap),"string"==typeof h.symbol.shadow&&o.setAttribute("shadow",h.symbol.shadow),"number"==typeof h.symbol.transparency&&o.setAttribute("transparency",h.symbol.transparency),"string"==typeof h.symbol.usecentroid&&o.setAttribute("usecentroid",h.symbol.usecentroid),"number"==typeof h.symbol.width&&o.setAttribute("width",h.symbol.width),u.appendChild(o))}}},addSimpleLabelRenderer:function(t,e){t.setAttribute("field",e.field);for(var i=["featureweight","howmanylabels","labelbufferratio","labelpriorities","labelweight","linelabelposition","rotationalangles"],n=0,s=i.length;s>n;n++){var r=i[n];e[r]&&t.setAttribute(r,e[r])}if("text"==e.symbol.type){var o=e.symbol,a=this.createElementNS("","TEXTSYMBOL");t.appendChild(a);for(var i=this.fontStyleKeys,n=0,s=i.length;s>n;n++){var r=i[n];o[r]&&a.setAttribute(r,e[r])}}},writePolygonGeometry:function(t){if(!(t instanceof OpenLayers.Geometry.Polygon))throw{message:"Cannot write polygon geometry to ArcXML with an "+t.CLASS_NAME+" object.",geometry:t};for(var e=this.createElementNS("","POLYGON"),i=0,n=t.components.length;n>i;i++){for(var s=t.components[i],r=this.createElementNS("","RING"),o=0,a=s.components.length;a>o;o++){var l=s.components[o],h=this.createElementNS("","POINT");h.setAttribute("x",l.x),h.setAttribute("y",l.y),r.appendChild(h)}e.appendChild(r)}return e},parseResponse:function(t){if("string"==typeof t){var e=new OpenLayers.Format.XML;t=e.read(t)}var i=new OpenLayers.Format.ArcXML.Response,n=t.getElementsByTagName("ERROR");if(null!=n&&n.length>0)i.error=this.getChildValue(n,"Unknown error.");else{var s=t.getElementsByTagName("RESPONSE");if(null==s||0==s.length)return i.error="No RESPONSE tag found in ArcXML response.",i;var r=s[0].firstChild.nodeName;if("#text"==r&&(r=s[0].firstChild.nextSibling.nodeName),"IMAGE"==r){var o=t.getElementsByTagName("ENVELOPE"),a=t.getElementsByTagName("OUTPUT");if(null==o||0==o.length)i.error="No ENVELOPE tag found in ArcXML response.";else if(null==a||0==a.length)i.error="No OUTPUT tag found in ArcXML response.";else{var l=this.parseAttributes(o[0]),h=this.parseAttributes(a[0]);i.image="string"==typeof h.type?{envelope:l,output:{type:h.type,data:this.getChildValue(a[0])}}:{envelope:l,output:h}}}else if("FEATURES"==r){var u=s[0].getElementsByTagName("FEATURES"),p=u[0].getElementsByTagName("FEATURECOUNT");if(i.features.featurecount=p[0].getAttribute("count"),i.features.featurecount>0){var c=u[0].getElementsByTagName("ENVELOPE");i.features.envelope=this.parseAttributes(c[0],"number");for(var d=u[0].getElementsByTagName("FEATURE"),m=0;m<d.length;m++){for(var f=new OpenLayers.Feature.Vector,y=d[m].getElementsByTagName("FIELD"),g=0;g<y.length;g++){var v=y[g].getAttribute("name"),L=y[g].getAttribute("value");f.attributes[v]=L}var _=d[m].getElementsByTagName("POLYGON");if(_.length>0){for(var O=_[0].getElementsByTagName("RING"),b=[],w=0;w<O.length;w++){var x=[];x.push(this.parsePointGeometry(O[w]));for(var S=O[w].getElementsByTagName("HOLE"),C=0;C<S.length;C++)x.push(this.parsePointGeometry(S[C]));S=null,b.push(new OpenLayers.Geometry.Polygon(x)),x=null}O=null,f.geometry=1==b.length?b[0]:new OpenLayers.Geometry.MultiPolygon(b)}i.features.feature.push(f)}}}else i.error="Unidentified response type."}return i},parseAttributes:function(t,e){for(var i={},n=0;n<t.attributes.length;n++)i[t.attributes[n].nodeName]="number"==e?parseFloat(t.attributes[n].nodeValue):t.attributes[n].nodeValue;return i},parsePointGeometry:function(t){var e=[],i=t.getElementsByTagName("COORDS");if(i.length>0){var n=this.getChildValue(i[0]);n=n.split(/;/);for(var s=0;s<n.length;s++){var r=n[s].split(/ /);e.push(new OpenLayers.Geometry.Point(r[0],r[1]))}i=null}else{var o=t.getElementsByTagName("POINT");if(o.length>0)for(var a=0;a<o.length;a++)e.push(new OpenLayers.Geometry.Point(parseFloat(o[a].getAttribute("x")),parseFloat(o[a].getAttribute("y"))));o=null}return new OpenLayers.Geometry.LinearRing(e)},CLASS_NAME:"OpenLayers.Format.ArcXML"}),OpenLayers.Format.ArcXML.Request=OpenLayers.Class({initialize:function(){var t={get_image:{properties:{background:null,draw:!0,envelope:{minx:0,miny:0,maxx:0,maxy:0},featurecoordsys:{id:0,string:"",datumtransformid:0,datumtransformstring:""},filtercoordsys:{id:0,string:"",datumtransformid:0,datumtransformstring:""},imagesize:{height:0,width:0,dpi:96,printheight:0,printwidth:0,scalesymbols:!1},layerlist:[],output:{baseurl:"",legendbaseurl:"",legendname:"",legendpath:"",legendurl:"",name:"",path:"",type:"jpg",url:""}}},get_feature:{layer:"",query:{isspatial:!1,featurecoordsys:{id:0,string:"",datumtransformid:0,datumtransformstring:""},filtercoordsys:{id:0,string:"",datumtransformid:0,datumtransformstring:""},buffer:0,where:"",spatialfilter:{relation:"envelope_intersection",envelope:null}}},environment:{separators:{cs:" ",ts:";"}},layer:[],workspaces:[]};return OpenLayers.Util.extend(this,t)},CLASS_NAME:"OpenLayers.Format.ArcXML.Request"}),OpenLayers.Format.ArcXML.Response=OpenLayers.Class({initialize:function(){var t={image:{envelope:null,output:""},features:{featurecount:0,envelope:null,feature:[]},error:""};
return OpenLayers.Util.extend(this,t)},CLASS_NAME:"OpenLayers.Format.ArcXML.Response"}),OpenLayers.Layer.ArcIMS=OpenLayers.Class(OpenLayers.Layer.Grid,{DEFAULT_PARAMS:{ClientVersion:"9.2",ServiceName:""},featureCoordSys:"4326",filterCoordSys:"4326",layers:null,async:!0,name:"ArcIMS",isBaseLayer:!0,DEFAULT_OPTIONS:{tileSize:new OpenLayers.Size(512,512),featureCoordSys:"4326",filterCoordSys:"4326",layers:null,isBaseLayer:!0,async:!0,name:"ArcIMS"},initialize:function(t,e,i){this.tileSize=new OpenLayers.Size(512,512),this.params=OpenLayers.Util.applyDefaults({ServiceName:i.serviceName},this.DEFAULT_PARAMS),this.options=OpenLayers.Util.applyDefaults(i,this.DEFAULT_OPTIONS),OpenLayers.Layer.Grid.prototype.initialize.apply(this,[t,e,this.params,i]),this.transparent&&(this.isBaseLayer||(this.isBaseLayer=!1),"image/jpeg"==this.format&&(this.format=OpenLayers.Util.alphaHack()?"image/gif":"image/png")),null===this.options.layers&&(this.options.layers=[])},getURL:function(t){var e="";t=this.adjustBounds(t);var i=new OpenLayers.Format.ArcXML(OpenLayers.Util.extend(this.options,{requesttype:"image",envelope:t.toArray(),tileSize:this.tileSize})),n=new OpenLayers.Request.POST({url:this.getFullRequestString(),data:i.write(),async:!1});if(null!=n){var s=n.responseXML;s&&s.documentElement||(s=n.responseText);var r=new OpenLayers.Format.ArcXML,o=r.read(s);e=this.getUrlOrImage(o.image.output)}return e},getURLasync:function(t,e,i){t=this.adjustBounds(t);var n=new OpenLayers.Format.ArcXML(OpenLayers.Util.extend(this.options,{requesttype:"image",envelope:t.toArray(),tileSize:this.tileSize}));OpenLayers.Request.POST({url:this.getFullRequestString(),async:!0,data:n.write(),callback:function(t){var n=t.responseXML;n&&n.documentElement||(n=t.responseText);var s=new OpenLayers.Format.ArcXML,r=s.read(n);e.call(i,this.getUrlOrImage(r.image.output))},scope:this})},getUrlOrImage:function(t){var e="";return t.url?e=t.url:t.data&&(e="data:image/"+t.type+";base64,"+t.data),e},setLayerQuery:function(t,e){for(var i=0;i<this.options.layers.length;i++)if(t==this.options.layers[i].id)return void(this.options.layers[i].query=e);this.options.layers.push({id:t,visible:!0,query:e})},getFeatureInfo:function(t,e,i){var n=i.buffer||1,s=i.callback||function(){},r=i.scope||window,o={};OpenLayers.Util.extend(o,this.options),o.requesttype="feature",t instanceof OpenLayers.LonLat?(o.polygon=null,o.envelope=[t.lon-n,t.lat-n,t.lon+n,t.lat+n]):t instanceof OpenLayers.Geometry.Polygon&&(o.envelope=null,o.polygon=t);var a=new OpenLayers.Format.ArcXML(o);if(OpenLayers.Util.extend(a.request.get_feature,i),a.request.get_feature.layer=e.id,"number"==typeof e.query.accuracy)a.request.get_feature.query.accuracy=e.query.accuracy;else{var l=this.map.getCenter(),h=this.map.getViewPortPxFromLonLat(l);h.x++;var u=this.map.getLonLatFromPixel(h);a.request.get_feature.query.accuracy=u.lon-l.lon}a.request.get_feature.query.where=e.query.where,a.request.get_feature.query.spatialfilter.relation="area_intersection",OpenLayers.Request.POST({url:this.getFullRequestString({CustomService:"Query"}),data:a.write(),callback:function(t){var e=a.parseResponse(t.responseText);a.iserror()?s.call(r,null):s.call(r,e.features)}})},clone:function(t){return null==t&&(t=new OpenLayers.Layer.ArcIMS(this.name,this.url,this.getOptions())),t=OpenLayers.Layer.Grid.prototype.clone.apply(this,[t])},CLASS_NAME:"OpenLayers.Layer.ArcIMS"}),OpenLayers.Control.PanZoom=OpenLayers.Class(OpenLayers.Control,{slideFactor:50,slideRatio:null,buttons:null,position:null,initialize:function(){this.position=new OpenLayers.Pixel(OpenLayers.Control.PanZoom.X,OpenLayers.Control.PanZoom.Y),OpenLayers.Control.prototype.initialize.apply(this,arguments)},destroy:function(){this.map&&this.map.events.unregister("buttonclick",this,this.onButtonClick),this.removeButtons(),this.buttons=null,this.position=null,OpenLayers.Control.prototype.destroy.apply(this,arguments)},setMap:function(){OpenLayers.Control.prototype.setMap.apply(this,arguments),this.map.events.register("buttonclick",this,this.onButtonClick)},draw:function(t){OpenLayers.Control.prototype.draw.apply(this,arguments),t=this.position,this.buttons=[];var e={w:18,h:18},i=new OpenLayers.Pixel(t.x+e.w/2,t.y);return this._addButton("panup","north-mini.png",i,e),t.y=i.y+e.h,this._addButton("panleft","west-mini.png",t,e),this._addButton("panright","east-mini.png",t.add(e.w,0),e),this._addButton("pandown","south-mini.png",i.add(0,2*e.h),e),this._addButton("zoomin","zoom-plus-mini.png",i.add(0,3*e.h+5),e),this._addButton("zoomworld","zoom-world-mini.png",i.add(0,4*e.h+5),e),this._addButton("zoomout","zoom-minus-mini.png",i.add(0,5*e.h+5),e),this.div},_addButton:function(t,e,i,n){var s=OpenLayers.Util.getImageLocation(e),r=OpenLayers.Util.createAlphaImageDiv(this.id+"_"+t,i,n,s,"absolute");return r.style.cursor="pointer",this.div.appendChild(r),r.action=t,r.className="olButton",this.buttons.push(r),r},_removeButton:function(t){this.div.removeChild(t),OpenLayers.Util.removeItem(this.buttons,t)},removeButtons:function(){for(var t=this.buttons.length-1;t>=0;--t)this._removeButton(this.buttons[t])},onButtonClick:function(t){var e=t.buttonElement;switch(e.action){case"panup":this.map.pan(0,-this.getSlideFactor("h"));break;case"pandown":this.map.pan(0,this.getSlideFactor("h"));break;case"panleft":this.map.pan(-this.getSlideFactor("w"),0);break;case"panright":this.map.pan(this.getSlideFactor("w"),0);break;case"zoomin":this.map.zoomIn();break;case"zoomout":this.map.zoomOut();break;case"zoomworld":this.map.zoomToMaxExtent()}},getSlideFactor:function(t){return this.slideRatio?this.map.getSize()[t]*this.slideRatio:this.slideFactor},CLASS_NAME:"OpenLayers.Control.PanZoom"}),OpenLayers.Control.PanZoom.X=4,OpenLayers.Control.PanZoom.Y=4,OpenLayers.Control.PanZoomBar=OpenLayers.Class(OpenLayers.Control.PanZoom,{zoomStopWidth:18,zoomStopHeight:11,slider:null,sliderEvents:null,zoombarDiv:null,zoomWorldIcon:!1,panIcons:!0,forceFixedZoomLevel:!1,mouseDragStart:null,deltaY:null,zoomStart:null,destroy:function(){this._removeZoomBar(),this.map.events.un({changebaselayer:this.redraw,updatesize:this.redraw,scope:this}),OpenLayers.Control.PanZoom.prototype.destroy.apply(this,arguments),delete this.mouseDragStart,delete this.zoomStart},setMap:function(){OpenLayers.Control.PanZoom.prototype.setMap.apply(this,arguments),this.map.events.on({changebaselayer:this.redraw,updatesize:this.redraw,scope:this})},redraw:function(){null!=this.div&&(this.removeButtons(),this._removeZoomBar()),this.draw()},draw:function(t){OpenLayers.Control.prototype.draw.apply(this,arguments),t=this.position.clone(),this.buttons=[];var e={w:18,h:18};if(this.panIcons){var i=new OpenLayers.Pixel(t.x+e.w/2,t.y),n=e.w;this.zoomWorldIcon&&(i=new OpenLayers.Pixel(t.x+e.w,t.y)),this._addButton("panup","north-mini.png",i,e),t.y=i.y+e.h,this._addButton("panleft","west-mini.png",t,e),this.zoomWorldIcon&&(this._addButton("zoomworld","zoom-world-mini.png",t.add(e.w,0),e),n*=2),this._addButton("panright","east-mini.png",t.add(n,0),e),this._addButton("pandown","south-mini.png",i.add(0,2*e.h),e),this._addButton("zoomin","zoom-plus-mini.png",i.add(0,3*e.h+5),e),i=this._addZoomBar(i.add(0,4*e.h+5)),this._addButton("zoomout","zoom-minus-mini.png",i,e)}else this._addButton("zoomin","zoom-plus-mini.png",t,e),i=this._addZoomBar(t.add(0,e.h)),this._addButton("zoomout","zoom-minus-mini.png",i,e),this.zoomWorldIcon&&(i=i.add(0,e.h+3),this._addButton("zoomworld","zoom-world-mini.png",i,e));return this.div},_addZoomBar:function(t){var e=OpenLayers.Util.getImageLocation("slider.png"),i=this.id+"_"+this.map.id,n=this.map.getMinZoom(),s=this.map.getNumZoomLevels()-1-this.map.getZoom(),r=OpenLayers.Util.createAlphaImageDiv(i,t.add(-1,s*this.zoomStopHeight),{w:20,h:9},e,"absolute");r.style.cursor="move",this.slider=r,this.sliderEvents=new OpenLayers.Events(this,r,null,!0,{includeXY:!0}),this.sliderEvents.on({touchstart:this.zoomBarDown,touchmove:this.zoomBarDrag,touchend:this.zoomBarUp,mousedown:this.zoomBarDown,mousemove:this.zoomBarDrag,mouseup:this.zoomBarUp});var o={w:this.zoomStopWidth,h:this.zoomStopHeight*(this.map.getNumZoomLevels()-n)},e=OpenLayers.Util.getImageLocation("zoombar.png"),a=null;if(OpenLayers.Util.alphaHack()){var i=this.id+"_"+this.map.id;a=OpenLayers.Util.createAlphaImageDiv(i,t,{w:o.w,h:this.zoomStopHeight},e,"absolute",null,"crop"),a.style.height=o.h+"px"}else a=OpenLayers.Util.createDiv("OpenLayers_Control_PanZoomBar_Zoombar"+this.map.id,t,o,e);return a.style.cursor="pointer",a.className="olButton",this.zoombarDiv=a,this.div.appendChild(a),this.startTop=parseInt(a.style.top),this.div.appendChild(r),this.map.events.register("zoomend",this,this.moveZoomBar),t=t.add(0,this.zoomStopHeight*(this.map.getNumZoomLevels()-n))},_removeZoomBar:function(){this.sliderEvents.un({touchstart:this.zoomBarDown,touchmove:this.zoomBarDrag,touchend:this.zoomBarUp,mousedown:this.zoomBarDown,mousemove:this.zoomBarDrag,mouseup:this.zoomBarUp}),this.sliderEvents.destroy(),this.div.removeChild(this.zoombarDiv),this.zoombarDiv=null,this.div.removeChild(this.slider),this.slider=null,this.map.events.unregister("zoomend",this,this.moveZoomBar)},onButtonClick:function(t){if(OpenLayers.Control.PanZoom.prototype.onButtonClick.apply(this,arguments),t.buttonElement===this.zoombarDiv){var e=t.buttonXY.y/this.zoomStopHeight;(this.forceFixedZoomLevel||!this.map.fractionalZoom)&&(e=Math.floor(e));var i=this.map.getNumZoomLevels()-1-e;i=Math.min(Math.max(i,0),this.map.getNumZoomLevels()-1),this.map.zoomTo(i)}},passEventToSlider:function(t){this.sliderEvents.handleBrowserEvent(t)},zoomBarDown:function(t){(OpenLayers.Event.isLeftClick(t)||OpenLayers.Event.isSingleTouch(t))&&(this.map.events.on({touchmove:this.passEventToSlider,mousemove:this.passEventToSlider,mouseup:this.passEventToSlider,scope:this}),this.mouseDragStart=t.xy.clone(),this.zoomStart=t.xy.clone(),this.div.style.cursor="move",this.zoombarDiv.offsets=null,OpenLayers.Event.stop(t))},zoomBarDrag:function(t){if(null!=this.mouseDragStart){var e=this.mouseDragStart.y-t.xy.y,i=OpenLayers.Util.pagePosition(this.zoombarDiv);if(t.clientY-i[1]>0&&t.clientY-i[1]<parseInt(this.zoombarDiv.style.height)-2){var n=parseInt(this.slider.style.top)-e;this.slider.style.top=n+"px",this.mouseDragStart=t.xy.clone()}this.deltaY=this.zoomStart.y-t.xy.y,OpenLayers.Event.stop(t)}},zoomBarUp:function(t){if((OpenLayers.Event.isLeftClick(t)||"touchend"===t.type)&&this.mouseDragStart){this.div.style.cursor="",this.map.events.un({touchmove:this.passEventToSlider,mouseup:this.passEventToSlider,mousemove:this.passEventToSlider,scope:this});var e=this.map.zoom;!this.forceFixedZoomLevel&&this.map.fractionalZoom?(e+=this.deltaY/this.zoomStopHeight,e=Math.min(Math.max(e,0),this.map.getNumZoomLevels()-1)):(e+=this.deltaY/this.zoomStopHeight,e=Math.max(Math.round(e),0)),this.map.zoomTo(e),this.mouseDragStart=null,this.zoomStart=null,this.deltaY=0,OpenLayers.Event.stop(t)}},moveZoomBar:function(){var t=(this.map.getNumZoomLevels()-1-this.map.getZoom())*this.zoomStopHeight+this.startTop+1;this.slider.style.top=t+"px"},CLASS_NAME:"OpenLayers.Control.PanZoomBar"}),OpenLayers.Format.WFSCapabilities.v1_1_0=OpenLayers.Class(OpenLayers.Format.WFSCapabilities.v1,{regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},readers:{wfs:OpenLayers.Util.applyDefaults({DefaultSRS:function(t,e){var i=this.getChildValue(t);i&&(e.srs=i)}},OpenLayers.Format.WFSCapabilities.v1.prototype.readers.wfs),ows:OpenLayers.Format.OWSCommon.v1.prototype.readers.ows},CLASS_NAME:"OpenLayers.Format.WFSCapabilities.v1_1_0"}),OpenLayers.Layer.Image=OpenLayers.Class(OpenLayers.Layer,{isBaseLayer:!0,url:null,extent:null,size:null,tile:null,aspectRatio:null,initialize:function(t,e,i,n,s){this.url=e,this.extent=i,this.maxExtent=i,this.size=n,OpenLayers.Layer.prototype.initialize.apply(this,[t,s]),this.aspectRatio=this.extent.getHeight()/this.size.h/(this.extent.getWidth()/this.size.w)},destroy:function(){this.tile&&(this.removeTileMonitoringHooks(this.tile),this.tile.destroy(),this.tile=null),OpenLayers.Layer.prototype.destroy.apply(this,arguments)},clone:function(t){return null==t&&(t=new OpenLayers.Layer.Image(this.name,this.url,this.extent,this.size,this.getOptions())),t=OpenLayers.Layer.prototype.clone.apply(this,[t])},setMap:function(){null==this.options.maxResolution&&(this.options.maxResolution=this.aspectRatio*this.extent.getWidth()/this.size.w),OpenLayers.Layer.prototype.setMap.apply(this,arguments)},moveTo:function(t,e){OpenLayers.Layer.prototype.moveTo.apply(this,arguments);var i=null==this.tile;if(e||i){this.setTileSize();var n=this.map.getLayerPxFromLonLat({lon:this.extent.left,lat:this.extent.top});i?(this.tile=new OpenLayers.Tile.Image(this,n,this.extent,null,this.tileSize),this.addTileMonitoringHooks(this.tile)):(this.tile.size=this.tileSize.clone(),this.tile.position=n.clone()),this.tile.draw()}},setTileSize:function(){var t=this.extent.getWidth()/this.map.getResolution(),e=this.extent.getHeight()/this.map.getResolution();this.tileSize=new OpenLayers.Size(t,e)},addTileMonitoringHooks:function(t){t.onLoadStart=function(){this.events.triggerEvent("loadstart")},t.events.register("loadstart",this,t.onLoadStart),t.onLoadEnd=function(){this.events.triggerEvent("loadend")},t.events.register("loadend",this,t.onLoadEnd),t.events.register("unload",this,t.onLoadEnd)},removeTileMonitoringHooks:function(t){t.unload(),t.events.un({loadstart:t.onLoadStart,loadend:t.onLoadEnd,unload:t.onLoadEnd,scope:this})},setUrl:function(t){this.url=t,this.tile.draw()},getURL:function(){return this.url},CLASS_NAME:"OpenLayers.Layer.Image"}),OpenLayers.Strategy=OpenLayers.Class({layer:null,options:null,active:null,autoActivate:!0,autoDestroy:!0,initialize:function(t){OpenLayers.Util.extend(this,t),this.options=t,this.active=!1},destroy:function(){this.deactivate(),this.layer=null,this.options=null},setLayer:function(t){this.layer=t},activate:function(){return this.active?!1:(this.active=!0,!0)},deactivate:function(){return this.active?(this.active=!1,!0):!1},CLASS_NAME:"OpenLayers.Strategy"}),OpenLayers.Strategy.Save=OpenLayers.Class(OpenLayers.Strategy,{events:null,auto:!1,timer:null,initialize:function(t){OpenLayers.Strategy.prototype.initialize.apply(this,[t]),this.events=new OpenLayers.Events(this)},activate:function(){var t=OpenLayers.Strategy.prototype.activate.call(this);return t&&this.auto&&("number"==typeof this.auto?this.timer=window.setInterval(OpenLayers.Function.bind(this.save,this),1e3*this.auto):this.layer.events.on({featureadded:this.triggerSave,afterfeaturemodified:this.triggerSave,scope:this})),t},deactivate:function(){var t=OpenLayers.Strategy.prototype.deactivate.call(this);return t&&this.auto&&("number"==typeof this.auto?window.clearInterval(this.timer):this.layer.events.un({featureadded:this.triggerSave,afterfeaturemodified:this.triggerSave,scope:this})),t},triggerSave:function(t){var e=t.feature;(e.state===OpenLayers.State.INSERT||e.state===OpenLayers.State.UPDATE||e.state===OpenLayers.State.DELETE)&&this.save([t.feature])},save:function(t){t||(t=this.layer.features),this.events.triggerEvent("start",{features:t});var e=this.layer.projection,i=this.layer.map.getProjectionObject();if(!i.equals(e)){for(var n,s,r=t.length,o=new Array(r),a=0;r>a;++a)n=t[a],s=n.clone(),s.fid=n.fid,s.state=n.state,n.url&&(s.url=n.url),s._original=n,s.geometry.transform(i,e),o[a]=s;t=o}this.layer.protocol.commit(t,{callback:this.onCommit,scope:this})},onCommit:function(t){var e={response:t};if(t.success()){for(var i,n,s=t.reqFeatures,r=[],o=t.insertIds||[],a=0,l=0,h=s.length;h>l;++l)n=s[l],n=n._original||n,i=n.state,i&&(i==OpenLayers.State.DELETE?r.push(n):i==OpenLayers.State.INSERT&&(n.fid=o[a],++a),n.state=null);r.length>0&&this.layer.destroyFeatures(r),this.events.triggerEvent("success",e)}else this.events.triggerEvent("fail",e)},CLASS_NAME:"OpenLayers.Strategy.Save"}),OpenLayers.Events.featureclick=OpenLayers.Class({cache:null,map:null,provides:["featureclick","nofeatureclick","featureover","featureout"],initialize:function(t){if(this.target=t,t.object instanceof OpenLayers.Map)this.setMap(t.object);else{if(!(t.object instanceof OpenLayers.Layer.Vector))throw"Listeners for '"+this.provides.join("', '")+"' events can only be registered for OpenLayers.Layer.Vector or OpenLayers.Map instances";t.object.map?this.setMap(t.object.map):t.object.events.register("added",this,function(){this.setMap(t.object.map)})}for(var e=this.provides.length-1;e>=0;--e)t.extensions[this.provides[e]]=!0},setMap:function(t){this.map=t,this.cache={},t.events.register("mousedown",this,this.start,{extension:!0}),t.events.register("mouseup",this,this.onClick,{extension:!0}),t.events.register("touchstart",this,this.start,{extension:!0}),t.events.register("touchmove",this,this.cancel,{extension:!0}),t.events.register("touchend",this,this.onClick,{extension:!0}),t.events.register("mousemove",this,this.onMousemove,{extension:!0})},start:function(t){this.startEvt=t},cancel:function(){delete this.startEvt},onClick:function(t){if(this.startEvt&&("touchend"===t.type||OpenLayers.Event.isLeftClick(t))){var e=this.getFeatures(this.startEvt);delete this.startEvt;for(var i,n,s,r={},o=0,a=e.length;a>o&&(i=e[o],n=i.layer,r[n.id]=!0,s=this.triggerEvent("featureclick",{feature:i}),s!==!1);++o);for(o=0,a=this.map.layers.length;a>o;++o)n=this.map.layers[o],n instanceof OpenLayers.Layer.Vector&&!r[n.id]&&this.triggerEvent("nofeatureclick",{layer:n})}},onMousemove:function(t){delete this.startEvt;for(var e,i=this.getFeatures(t),n={},s=[],r=0,o=i.length;o>r;++r)e=i[r],n[e.id]=e,this.cache[e.id]||s.push(e);var a=[];for(var l in this.cache)e=this.cache[l],e.layer&&e.layer.map?n[e.id]||a.push(e):delete this.cache[l];var h;for(r=0,o=s.length;o>r&&(e=s[r],this.cache[e.id]=e,h=this.triggerEvent("featureover",{feature:e}),h!==!1);++r);for(r=0,o=a.length;o>r&&(e=a[r],delete this.cache[e.id],h=this.triggerEvent("featureout",{feature:e}),h!==!1);++r);},triggerEvent:function(t,e){var i=e.feature?e.feature.layer:e.layer,n=this.target.object;return n instanceof OpenLayers.Map||n===i?this.target.triggerEvent(t,e):void 0},getFeatures:function(t){var e,i,n,s,r,o=t.clientX,a=t.clientY,l=[],h=[],u=[];for(s=this.map.layers.length-1;s>=0;--s)if(e=this.map.layers[s],"none"!==e.div.style.display)if(e.renderer instanceof OpenLayers.Renderer.Elements){if(e instanceof OpenLayers.Layer.Vector)for(i=document.elementFromPoint(o,a);i&&i._featureId;)n=e.getFeatureById(i._featureId),n?(l.push(n),i.style.display="none",h.push(i),i=document.elementFromPoint(o,a)):i=!1;u.push(e),e.div.style.display="none"}else e.renderer instanceof OpenLayers.Renderer.Canvas&&(n=e.renderer.getFeatureIdFromEvent(t),n&&(l.push(n),u.push(e)));for(s=0,r=h.length;r>s;++s)h[s].style.display="";for(s=u.length-1;s>=0;--s)u[s].div.style.display="block";return l},destroy:function(){for(var t=this.provides.length-1;t>=0;--t)delete this.target.extensions[this.provides[t]];this.map.events.un({mousemove:this.onMousemove,mousedown:this.start,mouseup:this.onClick,touchstart:this.start,touchmove:this.cancel,touchend:this.onClick,scope:this}),delete this.cache,delete this.map,delete this.target}}),OpenLayers.Events.nofeatureclick=OpenLayers.Events.featureclick,OpenLayers.Events.featureover=OpenLayers.Events.featureclick,OpenLayers.Events.featureout=OpenLayers.Events.featureclick,OpenLayers.Format.GPX=OpenLayers.Class(OpenLayers.Format.XML,{defaultDesc:"No description available",extractWaypoints:!0,extractTracks:!0,extractRoutes:!0,extractAttributes:!0,namespaces:{gpx:"http://www.topografix.com/GPX/1/1",xsi:"http://www.w3.org/2001/XMLSchema-instance"},schemaLocation:"http://www.topografix.com/GPX/1/1 http://www.topografix.com/GPX/1/1/gpx.xsd",creator:"OpenLayers",initialize:function(t){this.externalProjection=new OpenLayers.Projection("EPSG:4326"),OpenLayers.Format.XML.prototype.initialize.apply(this,[t])},read:function(t){"string"==typeof t&&(t=OpenLayers.Format.XML.prototype.read.apply(this,[t]));var e=[];if(this.extractTracks)for(var i=t.getElementsByTagName("trk"),n=0,s=i.length;s>n;n++){var r={};this.extractAttributes&&(r=this.parseAttributes(i[n]));for(var o=this.getElementsByTagNameNS(i[n],i[n].namespaceURI,"trkseg"),a=0,l=o.length;l>a;a++){var h=this.extractSegment(o[a],"trkpt");e.push(new OpenLayers.Feature.Vector(h,r))}}if(this.extractRoutes)for(var u=t.getElementsByTagName("rte"),p=0,c=u.length;c>p;p++){var r={};this.extractAttributes&&(r=this.parseAttributes(u[p]));var d=this.extractSegment(u[p],"rtept");e.push(new OpenLayers.Feature.Vector(d,r))}if(this.extractWaypoints)for(var m=t.getElementsByTagName("wpt"),f=0,s=m.length;s>f;f++){var r={};this.extractAttributes&&(r=this.parseAttributes(m[f]));var y=new OpenLayers.Geometry.Point(m[f].getAttribute("lon"),m[f].getAttribute("lat"));e.push(new OpenLayers.Feature.Vector(y,r))}if(this.internalProjection&&this.externalProjection)for(var g=0,v=e.length;v>g;g++)e[g].geometry.transform(this.externalProjection,this.internalProjection);return e},extractSegment:function(t,e){for(var i=this.getElementsByTagNameNS(t,t.namespaceURI,e),n=[],s=0,r=i.length;r>s;s++)n.push(new OpenLayers.Geometry.Point(i[s].getAttribute("lon"),i[s].getAttribute("lat")));return new OpenLayers.Geometry.LineString(n)},parseAttributes:function(t){for(var e,i,n={},s=t.firstChild;s;)1==s.nodeType&&s.firstChild&&(e=s.firstChild,(3==e.nodeType||4==e.nodeType)&&(i=s.prefix?s.nodeName.split(":")[1]:s.nodeName,"trkseg"!=i&&"rtept"!=i&&(n[i]=e.nodeValue))),s=s.nextSibling;return n},write:function(t,e){t=OpenLayers.Util.isArray(t)?t:[t];var i=this.createElementNS(this.namespaces.gpx,"gpx");i.setAttribute("version","1.1"),i.setAttribute("creator",this.creator),this.setAttributes(i,{"xsi:schemaLocation":this.schemaLocation}),e&&"object"==typeof e&&i.appendChild(this.buildMetadataNode(e));for(var n=0,s=t.length;s>n;n++)i.appendChild(this.buildFeatureNode(t[n]));return OpenLayers.Format.XML.prototype.write.apply(this,[i])},buildMetadataNode:function(t){for(var e=["name","desc","author"],i=this.createElementNS(this.namespaces.gpx,"metadata"),n=0;n<e.length;n++){var s=e[n];if(t[s]){var r=this.createElementNS(this.namespaces.gpx,s);r.appendChild(this.createTextNode(t[s])),i.appendChild(r)}}return i},buildFeatureNode:function(t){var e=t.geometry;if(e=e.clone(),this.internalProjection&&this.externalProjection&&e.transform(this.internalProjection,this.externalProjection),"OpenLayers.Geometry.Point"==e.CLASS_NAME){var i=this.buildWptNode(e);return this.appendAttributesNode(i,t),i}var n=this.createElementNS(this.namespaces.gpx,"trk");this.appendAttributesNode(n,t);var s=this.buildTrkSegNode(e);s=OpenLayers.Util.isArray(s)?s:[s];for(var r=0,o=s.length;o>r;r++)n.appendChild(s[r]);return n},buildTrkSegNode:function(t){var e,i,n,s,r;if("OpenLayers.Geometry.LineString"==t.CLASS_NAME||"OpenLayers.Geometry.LinearRing"==t.CLASS_NAME){for(e=this.createElementNS(this.namespaces.gpx,"trkseg"),i=0,n=t.components.length;n>i;i++)s=t.components[i],e.appendChild(this.buildTrkPtNode(s));return e}for(r=[],i=0,n=t.components.length;n>i;i++)r.push(this.buildTrkSegNode(t.components[i]));return r},buildTrkPtNode:function(t){var e=this.createElementNS(this.namespaces.gpx,"trkpt");return e.setAttribute("lon",t.x),e.setAttribute("lat",t.y),e},buildWptNode:function(t){var e=this.createElementNS(this.namespaces.gpx,"wpt");return e.setAttribute("lon",t.x),e.setAttribute("lat",t.y),e},appendAttributesNode:function(t,e){var i=this.createElementNS(this.namespaces.gpx,"name");i.appendChild(this.createTextNode(e.attributes.name||e.id)),t.appendChild(i);var n=this.createElementNS(this.namespaces.gpx,"desc");n.appendChild(this.createTextNode(e.attributes.description||this.defaultDesc)),t.appendChild(n)},CLASS_NAME:"OpenLayers.Format.GPX"}),OpenLayers.Format.WFSDescribeFeatureType=OpenLayers.Class(OpenLayers.Format.XML,{regExes:{trimSpace:/^\s*|\s*$/g},namespaces:{xsd:"http://www.w3.org/2001/XMLSchema"},readers:{xsd:{schema:function(t,e){var i,n,s=[],r={},o={complexTypes:s,customTypes:r};this.readChildNodes(t,o);var a,l,h=t.attributes;for(i=0,n=h.length;n>i;++i)a=h[i],l=a.name,0===l.indexOf("xmlns")?this.setNamespace(l.split(":")[1]||"",a.value):e[l]=a.value;e.featureTypes=s,e.targetPrefix=this.namespaceAlias[e.targetNamespace];var u,p;for(i=0,n=s.length;n>i;++i)u=s[i],p=r[u.typeName],r[u.typeName]&&(u.typeName=p.name)},complexType:function(t,e){var i={typeName:t.getAttribute("name")};this.readChildNodes(t,i),e.complexTypes.push(i)},complexContent:function(t,e){this.readChildNodes(t,e)},extension:function(t,e){this.readChildNodes(t,e)},sequence:function(t,e){var i={elements:[]};this.readChildNodes(t,i),e.properties=i.elements},element:function(t,e){var i;if(e.elements){for(var n,s={},r=t.attributes,o=0,a=r.length;a>o;++o)n=r[o],s[n.name]=n.value;i=s.type,i||(i={},this.readChildNodes(t,i),s.restriction=i,s.type=i.base);var l=i.base||i;s.localType=l.split(":").pop(),e.elements.push(s),this.readChildNodes(t,s)}if(e.complexTypes){i=t.getAttribute("type");var h=i.split(":").pop();e.customTypes[h]={name:t.getAttribute("name"),type:i}}},annotation:function(t,e){e.annotation={},this.readChildNodes(t,e.annotation)},appinfo:function(t,e){e.appinfo||(e.appinfo=[]),e.appinfo.push(this.getChildValue(t))},documentation:function(t,e){e.documentation||(e.documentation=[]);var i=this.getChildValue(t);e.documentation.push({lang:t.getAttribute("xml:lang"),textContent:i.replace(this.regExes.trimSpace,"")})},simpleType:function(t,e){this.readChildNodes(t,e)},restriction:function(t,e){e.base=t.getAttribute("base"),this.readRestriction(t,e)}}},readRestriction:function(t,e){for(var i,n,s,r=t.childNodes,o=0,a=r.length;a>o;++o)i=r[o],1==i.nodeType&&(n=i.nodeName.split(":").pop(),s=i.getAttribute("value"),e[n]?("string"==typeof e[n]&&(e[n]=[e[n]]),e[n].push(s)):e[n]=s)},read:function(t){"string"==typeof t&&(t=OpenLayers.Format.XML.prototype.read.apply(this,[t])),t&&9==t.nodeType&&(t=t.documentElement);var e={};if("ExceptionReport"===t.nodeName.split(":").pop()){var i=new OpenLayers.Format.OGCExceptionReport;e.error=i.read(t)}else this.readNode(t,e);return e},CLASS_NAME:"OpenLayers.Format.WFSDescribeFeatureType"}),OpenLayers.Renderer=OpenLayers.Class({container:null,root:null,extent:null,locked:!1,size:null,resolution:null,map:null,featureDx:0,initialize:function(t,e){this.container=OpenLayers.Util.getElement(t),OpenLayers.Util.extend(this,e)},destroy:function(){this.container=null,this.extent=null,this.size=null,this.resolution=null,this.map=null},supported:function(){return!1},setExtent:function(t,e){if(this.extent=t.clone(),this.map.baseLayer&&this.map.baseLayer.wrapDateLine){var i=t.getWidth()/this.map.getExtent().getWidth(),t=t.scale(1/i);this.extent=t.wrapDateLine(this.map.getMaxExtent()).scale(i)}return e&&(this.resolution=null),!0},setSize:function(t){this.size=t.clone(),this.resolution=null},getResolution:function(){return this.resolution=this.resolution||this.map.getResolution(),this.resolution},drawFeature:function(t,e){if(null==e&&(e=t.style),t.geometry){var i=t.geometry.getBounds();if(i){var n;this.map.baseLayer&&this.map.baseLayer.wrapDateLine&&(n=this.map.getMaxExtent()),i.intersectsBounds(this.extent,{worldBounds:n})?this.calculateFeatureDx(i,n):e={display:"none"};var s=this.drawGeometry(t.geometry,e,t.id);if("none"!=e.display&&e.label&&s!==!1){var r=t.geometry.getCentroid();if(e.labelXOffset||e.labelYOffset){var o=isNaN(e.labelXOffset)?0:e.labelXOffset,a=isNaN(e.labelYOffset)?0:e.labelYOffset,l=this.getResolution();r.move(o*l,a*l)}this.drawText(t.id,e,r)}else this.removeText(t.id);return s}}},calculateFeatureDx:function(t,e){if(this.featureDx=0,e){var i=e.getWidth(),n=(this.extent.left+this.extent.right)/2,s=(t.left+t.right)/2,r=Math.round((s-n)/i);this.featureDx=r*i}},drawGeometry:function(){},drawText:function(){},removeText:function(){},clear:function(){},getFeatureIdFromEvent:function(){},eraseFeatures:function(t){OpenLayers.Util.isArray(t)||(t=[t]);for(var e=0,i=t.length;i>e;++e){var n=t[e];this.eraseGeometry(n.geometry,n.id),this.removeText(n.id)}},eraseGeometry:function(){},moveRoot:function(){},getRenderLayerId:function(){return this.container.id},applyDefaultSymbolizer:function(t){var e=OpenLayers.Util.extend({},OpenLayers.Renderer.defaultSymbolizer);return t.stroke===!1&&(delete e.strokeWidth,delete e.strokeColor),t.fill===!1&&delete e.fillColor,OpenLayers.Util.extend(e,t),e},CLASS_NAME:"OpenLayers.Renderer"}),OpenLayers.Renderer.defaultSymbolizer={fillColor:"#000000",strokeColor:"#000000",strokeWidth:2,fillOpacity:1,strokeOpacity:1,pointRadius:0,labelAlign:"cm"},OpenLayers.Renderer.symbol={star:[350,75,379,161,469,161,397,215,423,301,350,250,277,301,303,215,231,161,321,161,350,75],cross:[4,0,6,0,6,4,10,4,10,6,6,6,6,10,4,10,4,6,0,6,0,4,4,4,4,0],x:[0,0,25,0,50,35,75,0,100,0,65,50,100,100,75,100,50,65,25,100,0,100,35,50,0,0],square:[0,0,0,1,1,1,1,0,0,0],triangle:[0,10,10,10,5,0,0,10]},OpenLayers.Renderer.Canvas=OpenLayers.Class(OpenLayers.Renderer,{hitDetection:!0,hitOverflow:0,canvas:null,features:null,pendingRedraw:!1,cachedSymbolBounds:{},initialize:function(){OpenLayers.Renderer.prototype.initialize.apply(this,arguments),this.root=document.createElement("canvas"),this.container.appendChild(this.root),this.canvas=this.root.getContext("2d"),this.features={},this.hitDetection&&(this.hitCanvas=document.createElement("canvas"),this.hitContext=this.hitCanvas.getContext("2d"))},setExtent:function(){return OpenLayers.Renderer.prototype.setExtent.apply(this,arguments),!1},eraseGeometry:function(t,e){this.eraseFeatures(this.features[e][0])},supported:function(){return OpenLayers.CANVAS_SUPPORTED},setSize:function(t){this.size=t.clone();var e=this.root;if(e.style.width=t.w+"px",e.style.height=t.h+"px",e.width=t.w,e.height=t.h,this.resolution=null,this.hitDetection){var i=this.hitCanvas;i.style.width=t.w+"px",i.style.height=t.h+"px",i.width=t.w,i.height=t.h}},drawFeature:function(t,e){var i;if(t.geometry){e=this.applyDefaultSymbolizer(e||t.style);var n,s=t.geometry.getBounds();this.map.baseLayer&&this.map.baseLayer.wrapDateLine&&(n=this.map.getMaxExtent());var r=s&&s.intersectsBounds(this.extent,{worldBounds:n});i="none"!==e.display&&!!s&&r,i?this.features[t.id]=[t,e]:delete this.features[t.id],this.pendingRedraw=!0}return this.pendingRedraw&&!this.locked&&(this.redraw(),this.pendingRedraw=!1),i},drawGeometry:function(t,e,i){var n=t.CLASS_NAME;if("OpenLayers.Geometry.Collection"!=n&&"OpenLayers.Geometry.MultiPoint"!=n&&"OpenLayers.Geometry.MultiLineString"!=n&&"OpenLayers.Geometry.MultiPolygon"!=n)switch(t.CLASS_NAME){case"OpenLayers.Geometry.Point":this.drawPoint(t,e,i);break;case"OpenLayers.Geometry.LineString":this.drawLineString(t,e,i);break;case"OpenLayers.Geometry.LinearRing":this.drawLinearRing(t,e,i);break;case"OpenLayers.Geometry.Polygon":this.drawPolygon(t,e,i)}else for(var s=0;s<t.components.length;s++)this.drawGeometry(t.components[s],e,i)},drawExternalGraphic:function(t,e,i){var n=new Image,s=e.title||e.graphicTitle;s&&(n.title=s);var r=e.graphicWidth||e.graphicHeight,o=e.graphicHeight||e.graphicWidth;r=r?r:2*e.pointRadius,o=o?o:2*e.pointRadius;var a=void 0!=e.graphicXOffset?e.graphicXOffset:-(.5*r),l=void 0!=e.graphicYOffset?e.graphicYOffset:-(.5*o),h=e.graphicOpacity||e.fillOpacity,u=function(){if(this.features[i]){var e=this.getLocalXY(t),s=e[0],u=e[1];if(!isNaN(s)&&!isNaN(u)){var p=s+a|0,c=u+l|0,d=this.canvas;d.globalAlpha=h;var m=OpenLayers.Renderer.Canvas.drawImageScaleFactor||(OpenLayers.Renderer.Canvas.drawImageScaleFactor=/android 2.1/.test(navigator.userAgent.toLowerCase())?320/window.screen.width:1);d.drawImage(n,p*m,c*m,r*m,o*m),this.hitDetection&&(this.setHitContextStyle("fill",i),this.hitContext.fillRect(p,c,r,o))}}};n.onload=OpenLayers.Function.bind(u,this),n.src=e.externalGraphic},drawNamedSymbol:function(t,e,i){var n,s,r,o,a,l,h,u,p,c=Math.PI/180,d=OpenLayers.Renderer.symbol[e.graphicName];if(!d)throw new Error(e.graphicName+" is not a valid symbol name");if(d.length&&!(d.length<2)){var m=this.getLocalXY(t),f=m[0],y=m[1];
if(!isNaN(f)&&!isNaN(y)){if(this.canvas.lineCap="round",this.canvas.lineJoin="round",this.hitDetection&&(this.hitContext.lineCap="round",this.hitContext.lineJoin="round"),e.graphicName in this.cachedSymbolBounds)l=this.cachedSymbolBounds[e.graphicName];else{for(l=new OpenLayers.Bounds,a=0;a<d.length;a+=2)l.extend(new OpenLayers.LonLat(d[a],d[a+1]));this.cachedSymbolBounds[e.graphicName]=l}if(this.canvas.save(),this.hitDetection&&this.hitContext.save(),this.canvas.translate(f,y),this.hitDetection&&this.hitContext.translate(f,y),u=c*e.rotation,isNaN(u)||(this.canvas.rotate(u),this.hitDetection&&this.hitContext.rotate(u)),h=2*e.pointRadius/Math.max(l.getWidth(),l.getHeight()),this.canvas.scale(h,h),this.hitDetection&&this.hitContext.scale(h,h),r=l.getCenterLonLat().lon,o=l.getCenterLonLat().lat,this.canvas.translate(-r,-o),this.hitDetection&&this.hitContext.translate(-r,-o),p=e.strokeWidth,e.strokeWidth=p/h,e.fill!==!1){for(this.setCanvasStyle("fill",e),this.canvas.beginPath(),a=0;a<d.length;a+=2)n=d[a],s=d[a+1],0==a&&this.canvas.moveTo(n,s),this.canvas.lineTo(n,s);if(this.canvas.closePath(),this.canvas.fill(),this.hitDetection){for(this.setHitContextStyle("fill",i,e),this.hitContext.beginPath(),a=0;a<d.length;a+=2)n=d[a],s=d[a+1],0==a&&this.canvas.moveTo(n,s),this.hitContext.lineTo(n,s);this.hitContext.closePath(),this.hitContext.fill()}}if(e.stroke!==!1){for(this.setCanvasStyle("stroke",e),this.canvas.beginPath(),a=0;a<d.length;a+=2)n=d[a],s=d[a+1],0==a&&this.canvas.moveTo(n,s),this.canvas.lineTo(n,s);if(this.canvas.closePath(),this.canvas.stroke(),this.hitDetection){for(this.setHitContextStyle("stroke",i,e,h),this.hitContext.beginPath(),a=0;a<d.length;a+=2)n=d[a],s=d[a+1],0==a&&this.hitContext.moveTo(n,s),this.hitContext.lineTo(n,s);this.hitContext.closePath(),this.hitContext.stroke()}}e.strokeWidth=p,this.canvas.restore(),this.hitDetection&&this.hitContext.restore(),this.setCanvasStyle("reset")}}},setCanvasStyle:function(t,e){"fill"===t?(this.canvas.globalAlpha=e.fillOpacity,this.canvas.fillStyle=e.fillColor):"stroke"===t?(this.canvas.globalAlpha=e.strokeOpacity,this.canvas.strokeStyle=e.strokeColor,this.canvas.lineWidth=e.strokeWidth):(this.canvas.globalAlpha=0,this.canvas.lineWidth=1)},featureIdToHex:function(t){var e=Number(t.split("_").pop())+1;e>=16777216&&(this.hitOverflow=e-16777215,e=e%16777216+1);var i="000000"+e.toString(16),n=i.length;return i="#"+i.substring(n-6,n)},setHitContextStyle:function(t,e,i,n){var s=this.featureIdToHex(e);"fill"==t?(this.hitContext.globalAlpha=1,this.hitContext.fillStyle=s):"stroke"==t?(this.hitContext.globalAlpha=1,this.hitContext.strokeStyle=s,"undefined"==typeof n?this.hitContext.lineWidth=i.strokeWidth+2:isNaN(n)||(this.hitContext.lineWidth=i.strokeWidth+2/n)):(this.hitContext.globalAlpha=0,this.hitContext.lineWidth=1)},drawPoint:function(t,e,i){if(e.graphic!==!1)if(e.externalGraphic)this.drawExternalGraphic(t,e,i);else if(e.graphicName&&"circle"!=e.graphicName)this.drawNamedSymbol(t,e,i);else{var n=this.getLocalXY(t),s=n[0],r=n[1];if(!isNaN(s)&&!isNaN(r)){var o=2*Math.PI,a=e.pointRadius;e.fill!==!1&&(this.setCanvasStyle("fill",e),this.canvas.beginPath(),this.canvas.arc(s,r,a,0,o,!0),this.canvas.fill(),this.hitDetection&&(this.setHitContextStyle("fill",i,e),this.hitContext.beginPath(),this.hitContext.arc(s,r,a,0,o,!0),this.hitContext.fill())),e.stroke!==!1&&(this.setCanvasStyle("stroke",e),this.canvas.beginPath(),this.canvas.arc(s,r,a,0,o,!0),this.canvas.stroke(),this.hitDetection&&(this.setHitContextStyle("stroke",i,e),this.hitContext.beginPath(),this.hitContext.arc(s,r,a,0,o,!0),this.hitContext.stroke()),this.setCanvasStyle("reset"))}}},drawLineString:function(t,e,i){e=OpenLayers.Util.applyDefaults({fill:!1},e),this.drawLinearRing(t,e,i)},drawLinearRing:function(t,e,i){e.fill!==!1&&(this.setCanvasStyle("fill",e),this.renderPath(this.canvas,t,e,i,"fill"),this.hitDetection&&(this.setHitContextStyle("fill",i,e),this.renderPath(this.hitContext,t,e,i,"fill"))),e.stroke!==!1&&(this.setCanvasStyle("stroke",e),this.renderPath(this.canvas,t,e,i,"stroke"),this.hitDetection&&(this.setHitContextStyle("stroke",i,e),this.renderPath(this.hitContext,t,e,i,"stroke"))),this.setCanvasStyle("reset")},renderPath:function(t,e,i,n,s){var r=e.components,o=r.length;t.beginPath();var a=this.getLocalXY(r[0]),l=a[0],h=a[1];if(!isNaN(l)&&!isNaN(h)){t.moveTo(a[0],a[1]);for(var u=1;o>u;++u){var p=this.getLocalXY(r[u]);t.lineTo(p[0],p[1])}"fill"===s?t.fill():t.stroke()}},drawPolygon:function(t,e,i){var n=t.components,s=n.length;this.drawLinearRing(n[0],e,i);for(var r=1;s>r;++r)this.canvas.globalCompositeOperation="destination-out",this.hitDetection&&(this.hitContext.globalCompositeOperation="destination-out"),this.drawLinearRing(n[r],OpenLayers.Util.applyDefaults({stroke:!1,fillOpacity:1},e),i),this.canvas.globalCompositeOperation="source-over",this.hitDetection&&(this.hitContext.globalCompositeOperation="source-over"),this.drawLinearRing(n[r],OpenLayers.Util.applyDefaults({fill:!1},e),i)},drawText:function(t,e){var i=this.getLocalXY(t);this.setCanvasStyle("reset"),this.canvas.fillStyle=e.fontColor,this.canvas.globalAlpha=e.fontOpacity||1;var n=[e.fontStyle?e.fontStyle:"normal","normal",e.fontWeight?e.fontWeight:"normal",e.fontSize?e.fontSize:"1em",e.fontFamily?e.fontFamily:"sans-serif"].join(" "),s=e.label.split("\n"),r=s.length;if(this.canvas.fillText){this.canvas.font=n,this.canvas.textAlign=OpenLayers.Renderer.Canvas.LABEL_ALIGN[e.labelAlign[0]]||"center",this.canvas.textBaseline=OpenLayers.Renderer.Canvas.LABEL_ALIGN[e.labelAlign[1]]||"middle";var o=OpenLayers.Renderer.Canvas.LABEL_FACTOR[e.labelAlign[1]];null==o&&(o=-.5);var a=this.canvas.measureText("Mg").height||this.canvas.measureText("xx").width;i[1]+=a*o*(r-1);for(var l=0;r>l;l++)e.labelOutlineWidth&&(this.canvas.save(),this.canvas.globalAlpha=e.labelOutlineOpacity||e.fontOpacity||1,this.canvas.strokeStyle=e.labelOutlineColor,this.canvas.lineWidth=e.labelOutlineWidth,this.canvas.strokeText(s[l],i[0],i[1]+a*l+1),this.canvas.restore()),this.canvas.fillText(s[l],i[0],i[1]+a*l)}else if(this.canvas.mozDrawText){this.canvas.mozTextStyle=n;var h=OpenLayers.Renderer.Canvas.LABEL_FACTOR[e.labelAlign[0]];null==h&&(h=-.5);var o=OpenLayers.Renderer.Canvas.LABEL_FACTOR[e.labelAlign[1]];null==o&&(o=-.5);var a=this.canvas.mozMeasureText("xx");i[1]+=a*(1+o*r);for(var l=0;r>l;l++){var u=i[0]+h*this.canvas.mozMeasureText(s[l]),p=i[1]+l*a;this.canvas.translate(u,p),this.canvas.mozDrawText(s[l]),this.canvas.translate(-u,-p)}}this.setCanvasStyle("reset")},getLocalXY:function(t){var e=this.getResolution(),i=this.extent,n=(t.x-this.featureDx)/e+-i.left/e,s=i.top/e-t.y/e;return[n,s]},clear:function(){var t=this.root.height,e=this.root.width;this.canvas.clearRect(0,0,e,t),this.features={},this.hitDetection&&this.hitContext.clearRect(0,0,e,t)},getFeatureIdFromEvent:function(t){var e,i;if(this.hitDetection&&"none"!==this.root.style.display&&!this.map.dragging){var n=t.xy,s=0|n.x,r=0|n.y,o=this.hitContext.getImageData(s,r,1,1).data;if(255===o[3]){var a=o[2]+256*(o[1]+256*o[0]);if(a){e="OpenLayers_Feature_Vector_"+(a-1+this.hitOverflow);try{i=this.features[e][0]}catch(l){}}}}return i},eraseFeatures:function(t){OpenLayers.Util.isArray(t)||(t=[t]);for(var e=0;e<t.length;++e)delete this.features[t[e].id];this.redraw()},redraw:function(){if(!this.locked){var t=this.root.height,e=this.root.width;this.canvas.clearRect(0,0,e,t),this.hitDetection&&this.hitContext.clearRect(0,0,e,t);var i,n,s,r=[],o=this.map.baseLayer&&this.map.baseLayer.wrapDateLine&&this.map.getMaxExtent();for(var a in this.features)this.features.hasOwnProperty(a)&&(i=this.features[a][0],n=i.geometry,this.calculateFeatureDx(n.getBounds(),o),s=this.features[a][1],this.drawGeometry(n,s,i.id),s.label&&r.push([i,s]));for(var l,h=0,u=r.length;u>h;++h)l=r[h],this.drawText(l[0].geometry.getCentroid(),l[1])}},CLASS_NAME:"OpenLayers.Renderer.Canvas"}),OpenLayers.Renderer.Canvas.LABEL_ALIGN={l:"left",r:"right",t:"top",b:"bottom"},OpenLayers.Renderer.Canvas.LABEL_FACTOR={l:0,r:-1,t:0,b:-1},OpenLayers.Renderer.Canvas.drawImageScaleFactor=null,OpenLayers.Format.OSM=OpenLayers.Class(OpenLayers.Format.XML,{checkTags:!1,interestingTagsExclude:null,areaTags:null,initialize:function(t){var e={interestingTagsExclude:["source","source_ref","source:ref","history","attribution","created_by"],areaTags:["area","building","leisure","tourism","ruins","historic","landuse","military","natural","sport"]};e=OpenLayers.Util.extend(e,t);for(var i={},n=0;n<e.interestingTagsExclude.length;n++)i[e.interestingTagsExclude[n]]=!0;e.interestingTagsExclude=i;for(var s={},n=0;n<e.areaTags.length;n++)s[e.areaTags[n]]=!0;e.areaTags=s,this.externalProjection=new OpenLayers.Projection("EPSG:4326"),OpenLayers.Format.XML.prototype.initialize.apply(this,[e])},read:function(t){"string"==typeof t&&(t=OpenLayers.Format.XML.prototype.read.apply(this,[t]));for(var e=this.getNodes(t),i=this.getWays(t),n=new Array(i.length),s=0;s<i.length;s++){for(var r=new Array(i[s].nodes.length),o=this.isWayArea(i[s])?1:0,a=0;a<i[s].nodes.length;a++){var l=e[i[s].nodes[a]],h=new OpenLayers.Geometry.Point(l.lon,l.lat);h.osm_id=parseInt(i[s].nodes[a]),r[a]=h,l.used=!0}var u=null;u=o?new OpenLayers.Geometry.Polygon(new OpenLayers.Geometry.LinearRing(r)):new OpenLayers.Geometry.LineString(r),this.internalProjection&&this.externalProjection&&u.transform(this.externalProjection,this.internalProjection);var p=new OpenLayers.Feature.Vector(u,i[s].tags);p.osm_id=parseInt(i[s].id),p.fid="way."+p.osm_id,n[s]=p}for(var c in e){var l=e[c];if(!l.used||this.checkTags){var d=null;if(this.checkTags){var m=this.getTags(l.node,!0);if(l.used&&!m[1])continue;d=m[0]}else d=this.getTags(l.node);var p=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Point(l.lon,l.lat),d);this.internalProjection&&this.externalProjection&&p.geometry.transform(this.externalProjection,this.internalProjection),p.osm_id=parseInt(c),p.fid="node."+p.osm_id,n.push(p)}l.node=null}return n},getNodes:function(t){for(var e=t.getElementsByTagName("node"),i={},n=0;n<e.length;n++){var s=e[n],r=s.getAttribute("id");i[r]={lat:s.getAttribute("lat"),lon:s.getAttribute("lon"),node:s}}return i},getWays:function(t){for(var e=t.getElementsByTagName("way"),i=[],n=0;n<e.length;n++){var s=e[n],r={id:s.getAttribute("id")};r.tags=this.getTags(s);var o=s.getElementsByTagName("nd");r.nodes=new Array(o.length);for(var a=0;a<o.length;a++)r.nodes[a]=o[a].getAttribute("ref");i.push(r)}return i},getTags:function(t,e){for(var i=t.getElementsByTagName("tag"),n={},s=!1,r=0;r<i.length;r++){var o=i[r].getAttribute("k");n[o]=i[r].getAttribute("v"),e&&(this.interestingTagsExclude[o]||(s=!0))}return e?[n,s]:n},isWayArea:function(t){var e=!1,i=!1;if(t.nodes[0]==t.nodes[t.nodes.length-1]&&(e=!0),this.checkTags)for(var n in t.tags)if(this.areaTags[n]){i=!0;break}return e&&(this.checkTags?i:!0)},write:function(t){OpenLayers.Util.isArray(t)||(t=[t]),this.osm_id=1,this.created_nodes={};var e=this.createElementNS(null,"osm");e.setAttribute("version","0.5"),e.setAttribute("generator","OpenLayers "+OpenLayers.VERSION_NUMBER);for(var i=t.length-1;i>=0;i--)for(var n=this.createFeatureNodes(t[i]),s=0;s<n.length;s++)e.appendChild(n[s]);return OpenLayers.Format.XML.prototype.write.apply(this,[e])},createFeatureNodes:function(t){var e=[],i=t.geometry.CLASS_NAME,n=i.substring(i.lastIndexOf(".")+1);n=n.toLowerCase();var s=this.createXML[n];return s&&(e=s.apply(this,[t])),e},createXML:{point:function(t){var e=null,i=t.geometry?t.geometry:t;this.internalProjection&&this.externalProjection&&(i=i.clone(),i.transform(this.internalProjection,this.externalProjection));var n=!1;if(t.osm_id?(e=t.osm_id,this.created_nodes[e]&&(n=!0)):(e=-this.osm_id,this.osm_id++),n)s=this.created_nodes[e];else var s=this.createElementNS(null,"node");return this.created_nodes[e]=s,s.setAttribute("id",e),s.setAttribute("lon",i.x),s.setAttribute("lat",i.y),t.attributes&&this.serializeTags(t,s),this.setState(t,s),n?[]:[s]},linestring:function(t){var e,i=[],n=t.geometry;t.osm_id?e=t.osm_id:(e=-this.osm_id,this.osm_id++);var s=this.createElementNS(null,"way");s.setAttribute("id",e);for(var r=0;r<n.components.length;r++){var o=this.createXML.point.apply(this,[n.components[r]]);if(o.length){o=o[0];var a=o.getAttribute("id");i.push(o)}else a=n.components[r].osm_id,o=this.created_nodes[a];this.setState(t,o);var l=this.createElementNS(null,"nd");l.setAttribute("ref",a),s.appendChild(l)}return this.serializeTags(t,s),i.push(s),i},polygon:function(t){var e=OpenLayers.Util.extend({area:"yes"},t.attributes),i=new OpenLayers.Feature.Vector(t.geometry.components[0],e);return i.osm_id=t.osm_id,this.createXML.linestring.apply(this,[i])}},serializeTags:function(t,e){for(var i in t.attributes){var n=this.createElementNS(null,"tag");n.setAttribute("k",i),n.setAttribute("v",t.attributes[i]),e.appendChild(n)}},setState:function(t,e){if(t.state){var i=null;switch(t.state){case OpenLayers.State.UPDATE:i="modify";case OpenLayers.State.DELETE:i="delete"}i&&e.setAttribute("action",i)}},CLASS_NAME:"OpenLayers.Format.OSM"}),OpenLayers.Handler.Keyboard=OpenLayers.Class(OpenLayers.Handler,{KEY_EVENTS:["keydown","keyup"],eventListener:null,observeElement:null,initialize:function(){OpenLayers.Handler.prototype.initialize.apply(this,arguments),this.eventListener=OpenLayers.Function.bindAsEventListener(this.handleKeyEvent,this)},destroy:function(){this.deactivate(),this.eventListener=null,OpenLayers.Handler.prototype.destroy.apply(this,arguments)},activate:function(){if(OpenLayers.Handler.prototype.activate.apply(this,arguments)){this.observeElement=this.observeElement||document;for(var t=0,e=this.KEY_EVENTS.length;e>t;t++)OpenLayers.Event.observe(this.observeElement,this.KEY_EVENTS[t],this.eventListener);return!0}return!1},deactivate:function(){var t=!1;if(OpenLayers.Handler.prototype.deactivate.apply(this,arguments)){for(var e=0,i=this.KEY_EVENTS.length;i>e;e++)OpenLayers.Event.stopObserving(this.observeElement,this.KEY_EVENTS[e],this.eventListener);t=!0}return t},handleKeyEvent:function(t){this.checkModifiers(t)&&this.callback(t.type,[t])},CLASS_NAME:"OpenLayers.Handler.Keyboard"}),OpenLayers.Control.ModifyFeature=OpenLayers.Class(OpenLayers.Control,{documentDrag:!1,geometryTypes:null,clickout:!0,toggle:!0,standalone:!1,layer:null,feature:null,vertex:null,vertices:null,virtualVertices:null,handlers:null,deleteCodes:null,virtualStyle:null,vertexRenderIntent:null,mode:null,createVertices:!0,modified:!1,radiusHandle:null,dragHandle:null,onModificationStart:function(){},onModification:function(){},onModificationEnd:function(){},initialize:function(t,e){e=e||{},this.layer=t,this.vertices=[],this.virtualVertices=[],this.virtualStyle=OpenLayers.Util.extend({},this.layer.style||this.layer.styleMap.createSymbolizer(null,e.vertexRenderIntent)),this.virtualStyle.fillOpacity=.3,this.virtualStyle.strokeOpacity=.3,this.deleteCodes=[46,68],this.mode=OpenLayers.Control.ModifyFeature.RESHAPE,OpenLayers.Control.prototype.initialize.apply(this,[e]),OpenLayers.Util.isArray(this.deleteCodes)||(this.deleteCodes=[this.deleteCodes]);var i={down:function(){this.vertex=null;var t=this.layer.getFeatureFromEvent(this.handlers.drag.evt);t?this.dragStart(t):this.clickout&&(this._unselect=this.feature)},move:function(t){delete this._unselect,this.vertex&&this.dragVertex(this.vertex,t)},up:function(){this.handlers.drag.stopDown=!1,this._unselect&&(this.unselectFeature(this._unselect),delete this._unselect)},done:function(){this.vertex&&this.dragComplete(this.vertex)}},n={documentDrag:this.documentDrag,stopDown:!1},s={keydown:this.handleKeypress};this.handlers={keyboard:new OpenLayers.Handler.Keyboard(this,s),drag:new OpenLayers.Handler.Drag(this,i,n)}},destroy:function(){this.map&&this.map.events.un({removelayer:this.handleMapEvents,changelayer:this.handleMapEvents,scope:this}),this.layer=null,OpenLayers.Control.prototype.destroy.apply(this,[])},activate:function(){return this.moveLayerToTop(),this.map.events.on({removelayer:this.handleMapEvents,changelayer:this.handleMapEvents,scope:this}),this.handlers.keyboard.activate()&&this.handlers.drag.activate()&&OpenLayers.Control.prototype.activate.apply(this,arguments)},deactivate:function(){var t=!1;if(OpenLayers.Control.prototype.deactivate.apply(this,arguments)){this.moveLayerBack(),this.map.events.un({removelayer:this.handleMapEvents,changelayer:this.handleMapEvents,scope:this}),this.layer.removeFeatures(this.vertices,{silent:!0}),this.layer.removeFeatures(this.virtualVertices,{silent:!0}),this.vertices=[],this.handlers.drag.deactivate(),this.handlers.keyboard.deactivate();var e=this.feature;e&&e.geometry&&e.layer&&this.unselectFeature(e),t=!0}return t},beforeSelectFeature:function(t){return this.layer.events.triggerEvent("beforefeaturemodified",{feature:t})},selectFeature:function(t){if(!(this.feature===t||this.geometryTypes&&-1==OpenLayers.Util.indexOf(this.geometryTypes,t.geometry.CLASS_NAME))){this.beforeSelectFeature(t)!==!1&&(this.feature&&this.unselectFeature(this.feature),this.feature=t,this.layer.selectedFeatures.push(t),this.layer.drawFeature(t,"select"),this.modified=!1,this.resetVertices(),this.onModificationStart(this.feature));var e=t.modified;!t.geometry||e&&e.geometry||(this._originalGeometry=t.geometry.clone())}},unselectFeature:function(t){this.layer.removeFeatures(this.vertices,{silent:!0}),this.vertices=[],this.layer.destroyFeatures(this.virtualVertices,{silent:!0}),this.virtualVertices=[],this.dragHandle&&(this.layer.destroyFeatures([this.dragHandle],{silent:!0}),delete this.dragHandle),this.radiusHandle&&(this.layer.destroyFeatures([this.radiusHandle],{silent:!0}),delete this.radiusHandle),this.layer.drawFeature(this.feature,"default"),this.feature=null,OpenLayers.Util.removeItem(this.layer.selectedFeatures,t),this.onModificationEnd(t),this.layer.events.triggerEvent("afterfeaturemodified",{feature:t,modified:this.modified}),this.modified=!1},dragStart:function(t){var e="OpenLayers.Geometry.Point"==t.geometry.CLASS_NAME;this.standalone||(t._sketch||!e)&&t._sketch||(this.toggle&&this.feature===t&&(this._unselect=t),this.selectFeature(t)),(t._sketch||e)&&(this.vertex=t,this.handlers.drag.stopDown=!0)},dragVertex:function(t,e){var i=this.map.getLonLatFromViewPortPx(e),n=t.geometry;n.move(i.lon-n.x,i.lat-n.y),this.modified=!0,"OpenLayers.Geometry.Point"==this.feature.geometry.CLASS_NAME?this.layer.events.triggerEvent("vertexmodified",{vertex:t.geometry,feature:this.feature,pixel:e}):(t._index?(t.geometry.parent.addComponent(t.geometry,t._index),delete t._index,OpenLayers.Util.removeItem(this.virtualVertices,t),this.vertices.push(t)):t==this.dragHandle?(this.layer.removeFeatures(this.vertices,{silent:!0}),this.vertices=[],this.radiusHandle&&(this.layer.destroyFeatures([this.radiusHandle],{silent:!0}),this.radiusHandle=null)):t!==this.radiusHandle&&this.layer.events.triggerEvent("vertexmodified",{vertex:t.geometry,feature:this.feature,pixel:e}),this.virtualVertices.length>0&&(this.layer.destroyFeatures(this.virtualVertices,{silent:!0}),this.virtualVertices=[]),this.layer.drawFeature(this.feature,this.standalone?void 0:"select")),this.layer.drawFeature(t)},dragComplete:function(){this.resetVertices(),this.setFeatureState(),this.onModification(this.feature),this.layer.events.triggerEvent("featuremodified",{feature:this.feature})},setFeatureState:function(){if(this.feature.state!=OpenLayers.State.INSERT&&this.feature.state!=OpenLayers.State.DELETE&&(this.feature.state=OpenLayers.State.UPDATE,this.modified&&this._originalGeometry)){var t=this.feature;t.modified=OpenLayers.Util.extend(t.modified,{geometry:this._originalGeometry}),delete this._originalGeometry}},resetVertices:function(){this.vertices.length>0&&(this.layer.removeFeatures(this.vertices,{silent:!0}),this.vertices=[]),this.virtualVertices.length>0&&(this.layer.removeFeatures(this.virtualVertices,{silent:!0}),this.virtualVertices=[]),this.dragHandle&&(this.layer.destroyFeatures([this.dragHandle],{silent:!0}),this.dragHandle=null),this.radiusHandle&&(this.layer.destroyFeatures([this.radiusHandle],{silent:!0}),this.radiusHandle=null),this.feature&&"OpenLayers.Geometry.Point"!=this.feature.geometry.CLASS_NAME&&(this.mode&OpenLayers.Control.ModifyFeature.DRAG&&this.collectDragHandle(),this.mode&(OpenLayers.Control.ModifyFeature.ROTATE|OpenLayers.Control.ModifyFeature.RESIZE)&&this.collectRadiusHandle(),this.mode&OpenLayers.Control.ModifyFeature.RESHAPE&&(this.mode&OpenLayers.Control.ModifyFeature.RESIZE||this.collectVertices()))},handleKeypress:function(t){var e=t.keyCode;if(this.feature&&-1!=OpenLayers.Util.indexOf(this.deleteCodes,e)){var i=this.layer.getFeatureFromEvent(this.handlers.drag.evt);i&&-1!=OpenLayers.Util.indexOf(this.vertices,i)&&!this.handlers.drag.dragging&&i.geometry.parent&&(i.geometry.parent.removeComponent(i.geometry),this.layer.events.triggerEvent("vertexremoved",{vertex:i.geometry,feature:this.feature,pixel:t.xy}),this.layer.drawFeature(this.feature,this.standalone?void 0:"select"),this.modified=!0,this.resetVertices(),this.setFeatureState(),this.onModification(this.feature),this.layer.events.triggerEvent("featuremodified",{feature:this.feature}))}},collectVertices:function(){function t(i){var n,s,r,o;if("OpenLayers.Geometry.Point"==i.CLASS_NAME)s=new OpenLayers.Feature.Vector(i),s._sketch=!0,s.renderIntent=e.vertexRenderIntent,e.vertices.push(s);else{var a=i.components.length;for("OpenLayers.Geometry.LinearRing"==i.CLASS_NAME&&(a-=1),n=0;a>n;++n)r=i.components[n],"OpenLayers.Geometry.Point"==r.CLASS_NAME?(s=new OpenLayers.Feature.Vector(r),s._sketch=!0,s.renderIntent=e.vertexRenderIntent,e.vertices.push(s)):t(r);if(e.createVertices&&"OpenLayers.Geometry.MultiPoint"!=i.CLASS_NAME)for(n=0,o=i.components.length;o-1>n;++n){var l=i.components[n],h=i.components[n+1];if("OpenLayers.Geometry.Point"==l.CLASS_NAME&&"OpenLayers.Geometry.Point"==h.CLASS_NAME){var u=(l.x+h.x)/2,p=(l.y+h.y)/2,c=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Point(u,p),null,e.virtualStyle);c.geometry.parent=i,c._index=n+1,c._sketch=!0,e.virtualVertices.push(c)}}}}this.vertices=[],this.virtualVertices=[];var e=this;t.call(this,this.feature.geometry),this.layer.addFeatures(this.virtualVertices,{silent:!0}),this.layer.addFeatures(this.vertices,{silent:!0})},collectDragHandle:function(){var t=this.feature.geometry,e=t.getBounds().getCenterLonLat(),i=new OpenLayers.Geometry.Point(e.lon,e.lat),n=new OpenLayers.Feature.Vector(i);i.move=function(e,i){OpenLayers.Geometry.Point.prototype.move.call(this,e,i),t.move(e,i)},n._sketch=!0,this.dragHandle=n,this.dragHandle.renderIntent=this.vertexRenderIntent,this.layer.addFeatures([this.dragHandle],{silent:!0})},collectRadiusHandle:function(){var t=this.feature.geometry,e=t.getBounds(),i=e.getCenterLonLat(),n=new OpenLayers.Geometry.Point(i.lon,i.lat),s=new OpenLayers.Geometry.Point(e.right,e.bottom),r=new OpenLayers.Feature.Vector(s),o=this.mode&OpenLayers.Control.ModifyFeature.RESIZE,a=this.mode&OpenLayers.Control.ModifyFeature.RESHAPE,l=this.mode&OpenLayers.Control.ModifyFeature.ROTATE;s.move=function(e,i){OpenLayers.Geometry.Point.prototype.move.call(this,e,i);var s=this.x-n.x,r=this.y-n.y,h=s-e,u=r-i;if(l){var p=Math.atan2(u,h),c=Math.atan2(r,s),d=c-p;d*=180/Math.PI,t.rotate(d,n)}if(o){var m,f;if(a)m=r/u,f=s/h/m;else{var y=Math.sqrt(h*h+u*u),g=Math.sqrt(s*s+r*r);m=g/y}t.resize(m,n,f)}},r._sketch=!0,this.radiusHandle=r,this.radiusHandle.renderIntent=this.vertexRenderIntent,this.layer.addFeatures([this.radiusHandle],{silent:!0})},setMap:function(t){this.handlers.drag.setMap(t),OpenLayers.Control.prototype.setMap.apply(this,arguments)},handleMapEvents:function(t){("removelayer"==t.type||"order"==t.property)&&this.moveLayerToTop()},moveLayerToTop:function(){var t=Math.max(this.map.Z_INDEX_BASE.Feature-1,this.layer.getZIndex())+1;this.layer.setZIndex(t)},moveLayerBack:function(){var t=this.layer.getZIndex()-1;t>=this.map.Z_INDEX_BASE.Feature?this.layer.setZIndex(t):this.map.setLayerZIndex(this.layer,this.map.getLayerIndex(this.layer))},CLASS_NAME:"OpenLayers.Control.ModifyFeature"}),OpenLayers.Control.ModifyFeature.RESHAPE=1,OpenLayers.Control.ModifyFeature.RESIZE=2,OpenLayers.Control.ModifyFeature.ROTATE=4,OpenLayers.Control.ModifyFeature.DRAG=8,OpenLayers.Layer.XYZ=OpenLayers.Class(OpenLayers.Layer.Grid,{isBaseLayer:!0,sphericalMercator:!1,zoomOffset:0,serverResolutions:null,initialize:function(t,e,i){(i&&i.sphericalMercator||this.sphericalMercator)&&(i=OpenLayers.Util.extend({projection:"EPSG:900913",numZoomLevels:19},i)),OpenLayers.Layer.Grid.prototype.initialize.apply(this,[t||this.name,e||this.url,{},i])},clone:function(t){return null==t&&(t=new OpenLayers.Layer.XYZ(this.name,this.url,this.getOptions())),t=OpenLayers.Layer.Grid.prototype.clone.apply(this,[t])},getURL:function(t){var e=this.getXYZ(t),i=this.url;if(OpenLayers.Util.isArray(i)){var n=""+e.x+e.y+e.z;i=this.selectUrl(n,i)}return OpenLayers.String.format(i,e)},getXYZ:function(t){var e=this.getServerResolution(),i=Math.round((t.left-this.maxExtent.left)/(e*this.tileSize.w)),n=Math.round((this.maxExtent.top-t.top)/(e*this.tileSize.h)),s=this.getServerZoom();if(this.wrapDateLine){var r=Math.pow(2,s);i=(i%r+r)%r}return{x:i,y:n,z:s}},setMap:function(){OpenLayers.Layer.Grid.prototype.setMap.apply(this,arguments),this.tileOrigin||(this.tileOrigin=new OpenLayers.LonLat(this.maxExtent.left,this.maxExtent.bottom))},CLASS_NAME:"OpenLayers.Layer.XYZ"}),OpenLayers.Layer.Bing=OpenLayers.Class(OpenLayers.Layer.XYZ,{key:null,serverResolutions:[156543.03390625,78271.516953125,39135.7584765625,19567.87923828125,9783.939619140625,4891.9698095703125,2445.9849047851562,1222.9924523925781,611.4962261962891,305.74811309814453,152.87405654907226,76.43702827453613,38.218514137268066,19.109257068634033,9.554628534317017,4.777314267158508,2.388657133579254,1.194328566789627,.5971642833948135,.29858214169740677,.14929107084870338,.07464553542435169],attributionTemplate:'<span class="olBingAttribution ${type}"><div><a target="_blank" href="http://www.bing.com/maps/"><img src="${logo}" /></a></div>${copyrights}<a style="white-space: nowrap" target="_blank" href="http://www.microsoft.com/maps/product/terms.html">Terms of Use</a></span>',metadata:null,protocolRegex:/^http:/i,type:"Road",culture:"en-US",metadataParams:null,tileOptions:null,protocol:~window.location.href.indexOf("http")?"":"http:",initialize:function(t){t=OpenLayers.Util.applyDefaults({sphericalMercator:!0},t);var e=t.name||"Bing "+(t.type||this.type),i=[e,null,t];OpenLayers.Layer.XYZ.prototype.initialize.apply(this,i),this.tileOptions=OpenLayers.Util.extend({crossOriginKeyword:"anonymous"},this.options.tileOptions),this.loadMetadata()},loadMetadata:function(){this._callbackId="_callback_"+this.id.replace(/\./g,"_"),window[this._callbackId]=OpenLayers.Function.bind(OpenLayers.Layer.Bing.processMetadata,this);var t=OpenLayers.Util.applyDefaults({key:this.key,jsonp:this._callbackId,include:"ImageryProviders"},this.metadataParams),e=this.protocol+"//dev.virtualearth.net/REST/v1/Imagery/Metadata/"+this.type+"?"+OpenLayers.Util.getParameterString(t),i=document.createElement("script");i.type="text/javascript",i.src=e,i.id=this._callbackId,document.getElementsByTagName("head")[0].appendChild(i)},initLayer:function(){var t=this.metadata.resourceSets[0].resources[0],e=t.imageUrl.replace("{quadkey}","${quadkey}");e=e.replace("{culture}",this.culture),e=e.replace(this.protocolRegex,this.protocol),this.url=[];for(var i=0;i<t.imageUrlSubdomains.length;++i)this.url.push(e.replace("{subdomain}",t.imageUrlSubdomains[i]));this.addOptions({maxResolution:Math.min(this.serverResolutions[t.zoomMin],this.maxResolution||Number.POSITIVE_INFINITY),numZoomLevels:Math.min(t.zoomMax+1-t.zoomMin,this.numZoomLevels)},!0),this.isBaseLayer||this.redraw(),this.updateAttribution()},getURL:function(t){if(this.url){for(var e=this.getXYZ(t),i=e.x,n=e.y,s=e.z,r=[],o=s;o>0;--o){var a="0",l=1<<o-1;0!=(i&l)&&a++,0!=(n&l)&&(a++,a++),r.push(a)}var h=r.join(""),u=this.selectUrl(""+i+n+s,this.url);return OpenLayers.String.format(u,{quadkey:h})}},updateAttribution:function(){var t=this.metadata;if(t.resourceSets&&this.map&&this.map.center){var e,i,n,s,r,o,a,l=t.resourceSets[0].resources[0],h=this.map.getExtent().transform(this.map.getProjectionObject(),new OpenLayers.Projection("EPSG:4326")),u=l.imageryProviders||[],p=OpenLayers.Util.indexOf(this.serverResolutions,this.getServerResolution()),c="";for(i=0,n=u.length;n>i;++i)for(e=u[i],s=0,r=e.coverageAreas.length;r>s;++s)a=e.coverageAreas[s],o=OpenLayers.Bounds.fromArray(a.bbox,!0),h.intersectsBounds(o)&&p<=a.zoomMax&&p>=a.zoomMin&&(c+=e.attribution+" ");var d=t.brandLogoUri.replace(this.protocolRegex,this.protocol);this.attribution=OpenLayers.String.format(this.attributionTemplate,{type:this.type.toLowerCase(),logo:d,copyrights:c}),this.map&&this.map.events.triggerEvent("changelayer",{layer:this,property:"attribution"})}},setMap:function(){OpenLayers.Layer.XYZ.prototype.setMap.apply(this,arguments),this.map.events.register("moveend",this,this.updateAttribution)},clone:function(t){return null==t&&(t=new OpenLayers.Layer.Bing(this.options)),t=OpenLayers.Layer.XYZ.prototype.clone.apply(this,[t])},destroy:function(){this.map&&this.map.events.unregister("moveend",this,this.updateAttribution),OpenLayers.Layer.XYZ.prototype.destroy.apply(this,arguments)},CLASS_NAME:"OpenLayers.Layer.Bing"}),OpenLayers.Layer.Bing.processMetadata=function(t){this.metadata=t,this.initLayer();var e=document.getElementById(this._callbackId);e.parentNode.removeChild(e),window[this._callbackId]=void 0,delete this._callbackId},OpenLayers.Format.SOSGetFeatureOfInterest=OpenLayers.Class(OpenLayers.Format.XML,{VERSION:"1.0.0",namespaces:{sos:"http://www.opengis.net/sos/1.0",gml:"http://www.opengis.net/gml",sa:"http://www.opengis.net/sampling/1.0",xsi:"http://www.w3.org/2001/XMLSchema-instance"},schemaLocation:"http://www.opengis.net/sos/1.0 http://schemas.opengis.net/sos/1.0.0/sosAll.xsd",defaultPrefix:"sos",regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},read:function(t){"string"==typeof t&&(t=OpenLayers.Format.XML.prototype.read.apply(this,[t])),t&&9==t.nodeType&&(t=t.documentElement);var e={features:[]};this.readNode(t,e);for(var i=[],n=0,s=e.features.length;s>n;n++){var r=e.features[n];this.internalProjection&&this.externalProjection&&r.components[0]&&r.components[0].transform(this.externalProjection,this.internalProjection);var o=new OpenLayers.Feature.Vector(r.components[0],r.attributes);i.push(o)}return i},readers:{sa:{SamplingPoint:function(t,e){if(!e.attributes){var i={attributes:{}};e.features.push(i),e=i}e.attributes.id=this.getAttributeNS(t,this.namespaces.gml,"id"),this.readChildNodes(t,e)},position:function(t,e){this.readChildNodes(t,e)}},gml:OpenLayers.Util.applyDefaults({FeatureCollection:function(t,e){this.readChildNodes(t,e)},featureMember:function(t,e){var i={attributes:{}};e.features.push(i),this.readChildNodes(t,i)},name:function(t,e){e.attributes.name=this.getChildValue(t)},pos:function(t,e){this.externalProjection||(this.externalProjection=new OpenLayers.Projection(t.getAttribute("srsName"))),OpenLayers.Format.GML.v3.prototype.readers.gml.pos.apply(this,[t,e])}},OpenLayers.Format.GML.v3.prototype.readers.gml)},writers:{sos:{GetFeatureOfInterest:function(t){for(var e=this.createElementNSPlus("GetFeatureOfInterest",{attributes:{version:this.VERSION,service:"SOS","xsi:schemaLocation":this.schemaLocation}}),i=0,n=t.fois.length;n>i;i++)this.writeNode("FeatureOfInterestId",{foi:t.fois[i]},e);return e},FeatureOfInterestId:function(t){var e=this.createElementNSPlus("FeatureOfInterestId",{value:t.foi});return e}}},CLASS_NAME:"OpenLayers.Format.SOSGetFeatureOfInterest"}),OpenLayers.Format.SOSGetObservation=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{ows:"http://www.opengis.net/ows",gml:"http://www.opengis.net/gml",sos:"http://www.opengis.net/sos/1.0",ogc:"http://www.opengis.net/ogc",om:"http://www.opengis.net/om/1.0",sa:"http://www.opengis.net/sampling/1.0",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance"},regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},VERSION:"1.0.0",schemaLocation:"http://www.opengis.net/sos/1.0 http://schemas.opengis.net/sos/1.0.0/sosGetObservation.xsd",defaultPrefix:"sos",read:function(t){"string"==typeof t&&(t=OpenLayers.Format.XML.prototype.read.apply(this,[t])),t&&9==t.nodeType&&(t=t.documentElement);
var e={measurements:[],observations:[]};return this.readNode(t,e),e},write:function(t){var e=this.writeNode("sos:GetObservation",t);return e.setAttribute("xmlns:om",this.namespaces.om),e.setAttribute("xmlns:ogc",this.namespaces.ogc),this.setAttributeNS(e,this.namespaces.xsi,"xsi:schemaLocation",this.schemaLocation),OpenLayers.Format.XML.prototype.write.apply(this,[e])},readers:{om:{ObservationCollection:function(t,e){e.id=this.getAttributeNS(t,this.namespaces.gml,"id"),this.readChildNodes(t,e)},member:function(t,e){this.readChildNodes(t,e)},Measurement:function(t,e){var i={};e.measurements.push(i),this.readChildNodes(t,i)},Observation:function(t,e){var i={};e.observations.push(i),this.readChildNodes(t,i)},samplingTime:function(t,e){var i={};e.samplingTime=i,this.readChildNodes(t,i)},observedProperty:function(t,e){e.observedProperty=this.getAttributeNS(t,this.namespaces.xlink,"href"),this.readChildNodes(t,e)},procedure:function(t,e){e.procedure=this.getAttributeNS(t,this.namespaces.xlink,"href"),this.readChildNodes(t,e)},featureOfInterest:function(t,e){var i={features:[]};e.fois=[],e.fois.push(i),this.readChildNodes(t,i);for(var n=[],s=0,r=i.features.length;r>s;s++){var o=i.features[s];n.push(new OpenLayers.Feature.Vector(o.components[0],o.attributes))}i.features=n},result:function(t,e){var i={};e.result=i,""!==this.getChildValue(t)?(i.value=this.getChildValue(t),i.uom=t.getAttribute("uom")):this.readChildNodes(t,i)}},sa:OpenLayers.Format.SOSGetFeatureOfInterest.prototype.readers.sa,gml:OpenLayers.Util.applyDefaults({TimeInstant:function(t,e){var i={};e.timeInstant=i,this.readChildNodes(t,i)},timePosition:function(t,e){e.timePosition=this.getChildValue(t)}},OpenLayers.Format.SOSGetFeatureOfInterest.prototype.readers.gml)},writers:{sos:{GetObservation:function(t){var e=this.createElementNSPlus("GetObservation",{attributes:{version:this.VERSION,service:"SOS"}});this.writeNode("offering",t,e),t.eventTime&&this.writeNode("eventTime",t,e);for(var i in t.procedures)this.writeNode("procedure",t.procedures[i],e);for(var n in t.observedProperties)this.writeNode("observedProperty",t.observedProperties[n],e);return t.foi&&this.writeNode("featureOfInterest",t.foi,e),this.writeNode("responseFormat",t,e),t.resultModel&&this.writeNode("resultModel",t,e),t.responseMode&&this.writeNode("responseMode",t,e),e},featureOfInterest:function(t){var e=this.createElementNSPlus("featureOfInterest");return this.writeNode("ObjectID",t.objectId,e),e},ObjectID:function(t){return this.createElementNSPlus("ObjectID",{value:t})},responseFormat:function(t){return this.createElementNSPlus("responseFormat",{value:t.responseFormat})},procedure:function(t){return this.createElementNSPlus("procedure",{value:t})},offering:function(t){return this.createElementNSPlus("offering",{value:t.offering})},observedProperty:function(t){return this.createElementNSPlus("observedProperty",{value:t})},eventTime:function(t){var e=this.createElementNSPlus("eventTime");return"latest"===t.eventTime&&this.writeNode("ogc:TM_Equals",t,e),e},resultModel:function(t){return this.createElementNSPlus("resultModel",{value:t.resultModel})},responseMode:function(t){return this.createElementNSPlus("responseMode",{value:t.responseMode})}},ogc:{TM_Equals:function(t){var e=this.createElementNSPlus("ogc:TM_Equals");return this.writeNode("ogc:PropertyName",{property:"urn:ogc:data:time:iso8601"},e),"latest"===t.eventTime&&this.writeNode("gml:TimeInstant",{value:"latest"},e),e},PropertyName:function(t){return this.createElementNSPlus("ogc:PropertyName",{value:t.property})}},gml:{TimeInstant:function(t){var e=this.createElementNSPlus("gml:TimeInstant");return this.writeNode("gml:timePosition",t,e),e},timePosition:function(t){var e=this.createElementNSPlus("gml:timePosition",{value:t.value});return e}}},CLASS_NAME:"OpenLayers.Format.SOSGetObservation"}),OpenLayers.Handler.MouseWheel=OpenLayers.Class(OpenLayers.Handler,{wheelListener:null,interval:0,maxDelta:Number.POSITIVE_INFINITY,delta:0,cumulative:!0,initialize:function(){OpenLayers.Handler.prototype.initialize.apply(this,arguments),this.wheelListener=OpenLayers.Function.bindAsEventListener(this.onWheelEvent,this)},destroy:function(){OpenLayers.Handler.prototype.destroy.apply(this,arguments),this.wheelListener=null},onWheelEvent:function(t){if(this.map&&this.checkModifiers(t)){for(var e=!1,i=!1,n=!1,s=OpenLayers.Event.element(t);null!=s&&!n&&!e;){if(!e)try{var r;if(s.currentStyle)r=s.currentStyle.overflow;else{var o=document.defaultView.getComputedStyle(s,null);r=o.getPropertyValue("overflow")}e=r&&"auto"==r||"scroll"==r}catch(a){}if(!i&&(i=OpenLayers.Element.hasClass(s,"olScrollable"),!i))for(var l=0,h=this.map.layers.length;h>l;l++){var u=this.map.layers[l];if(s==u.div||s==u.pane){i=!0;break}}n=s==this.map.div,s=s.parentNode}if(!e&&n){if(i){var p=0;if(t.wheelDelta?(p=t.wheelDelta,p%160===0&&(p=.75*p),p/=120):t.detail&&(p=-(t.detail/Math.abs(t.detail))),this.delta+=p,window.clearTimeout(this._timeoutId),this.interval&&Math.abs(this.delta)<this.maxDelta){var c=OpenLayers.Util.extend({},t);this._timeoutId=window.setTimeout(OpenLayers.Function.bind(function(){this.wheelZoom(c)},this),this.interval)}else this.wheelZoom(t)}OpenLayers.Event.stop(t)}}},wheelZoom:function(t){var e=this.delta;this.delta=0,e&&(t.xy=this.map.events.getMousePosition(t),0>e?this.callback("down",[t,this.cumulative?Math.max(-this.maxDelta,e):-1]):this.callback("up",[t,this.cumulative?Math.min(this.maxDelta,e):1]))},activate:function(){if(OpenLayers.Handler.prototype.activate.apply(this,arguments)){var t=this.wheelListener;return OpenLayers.Event.observe(window,"DOMMouseScroll",t),OpenLayers.Event.observe(window,"mousewheel",t),OpenLayers.Event.observe(document,"mousewheel",t),!0}return!1},deactivate:function(){if(OpenLayers.Handler.prototype.deactivate.apply(this,arguments)){var t=this.wheelListener;return OpenLayers.Event.stopObserving(window,"DOMMouseScroll",t),OpenLayers.Event.stopObserving(window,"mousewheel",t),OpenLayers.Event.stopObserving(document,"mousewheel",t),!0}return!1},CLASS_NAME:"OpenLayers.Handler.MouseWheel"}),OpenLayers.Format.WFST.v1_0_0=OpenLayers.Class(OpenLayers.Format.Filter.v1_0_0,OpenLayers.Format.WFST.v1,{version:"1.0.0",srsNameInQuery:!1,schemaLocations:{wfs:"http://schemas.opengis.net/wfs/1.0.0/WFS-transaction.xsd"},initialize:function(t){OpenLayers.Format.Filter.v1_0_0.prototype.initialize.apply(this,[t]),OpenLayers.Format.WFST.v1.prototype.initialize.apply(this,[t])},readNode:function(){return OpenLayers.Format.GML.v2.prototype.readNode.apply(this,arguments)},readers:{wfs:OpenLayers.Util.applyDefaults({WFS_TransactionResponse:function(t,e){e.insertIds=[],e.success=!1,this.readChildNodes(t,e)},InsertResult:function(t,e){var i={fids:[]};this.readChildNodes(t,i),e.insertIds=e.insertIds.concat(i.fids)},TransactionResult:function(t,e){this.readChildNodes(t,e)},Status:function(t,e){this.readChildNodes(t,e)},SUCCESS:function(t,e){e.success=!0}},OpenLayers.Format.WFST.v1.prototype.readers.wfs),gml:OpenLayers.Format.GML.v2.prototype.readers.gml,feature:OpenLayers.Format.GML.v2.prototype.readers.feature,ogc:OpenLayers.Format.Filter.v1_0_0.prototype.readers.ogc},writers:{wfs:OpenLayers.Util.applyDefaults({Query:function(t){t=OpenLayers.Util.extend({featureNS:this.featureNS,featurePrefix:this.featurePrefix,featureType:this.featureType,srsName:this.srsName,srsNameInQuery:this.srsNameInQuery},t);var e=t.featurePrefix,i=this.createElementNSPlus("wfs:Query",{attributes:{typeName:(e?e+":":"")+t.featureType}});if(t.srsNameInQuery&&t.srsName&&i.setAttribute("srsName",t.srsName),t.featureNS&&i.setAttribute("xmlns:"+e,t.featureNS),t.propertyNames)for(var n=0,s=t.propertyNames.length;s>n;n++)this.writeNode("ogc:PropertyName",{property:t.propertyNames[n]},i);return t.filter&&(this.setFilterProperty(t.filter),this.writeNode("ogc:Filter",t.filter,i)),i}},OpenLayers.Format.WFST.v1.prototype.writers.wfs),gml:OpenLayers.Format.GML.v2.prototype.writers.gml,feature:OpenLayers.Format.GML.v2.prototype.writers.feature,ogc:OpenLayers.Format.Filter.v1_0_0.prototype.writers.ogc},CLASS_NAME:"OpenLayers.Format.WFST.v1_0_0"}),OpenLayers.ElementsIndexer=OpenLayers.Class({maxZIndex:null,order:null,indices:null,compare:null,initialize:function(t){this.compare=t?OpenLayers.ElementsIndexer.IndexingMethods.Z_ORDER_Y_ORDER:OpenLayers.ElementsIndexer.IndexingMethods.Z_ORDER_DRAWING_ORDER,this.clear()},insert:function(t){this.exists(t)&&this.remove(t);var e=t.id;this.determineZIndex(t);for(var i,n=-1,s=this.order.length;s-n>1;){i=parseInt((n+s)/2);var r=this.compare(this,t,OpenLayers.Util.getElement(this.order[i]));r>0?n=i:s=i}return this.order.splice(s,0,e),this.indices[e]=this.getZIndex(t),this.getNextElement(s)},remove:function(t){var e=t.id,i=OpenLayers.Util.indexOf(this.order,e);if(i>=0)if(this.order.splice(i,1),delete this.indices[e],this.order.length>0){var n=this.order[this.order.length-1];this.maxZIndex=this.indices[n]}else this.maxZIndex=0},clear:function(){this.order=[],this.indices={},this.maxZIndex=0},exists:function(t){return null!=this.indices[t.id]},getZIndex:function(t){return t._style.graphicZIndex},determineZIndex:function(t){var e=t._style.graphicZIndex;null==e?(e=this.maxZIndex,t._style.graphicZIndex=e):e>this.maxZIndex&&(this.maxZIndex=e)},getNextElement:function(t){var e=t+1;if(e<this.order.length){var i=OpenLayers.Util.getElement(this.order[e]);return void 0==i&&(i=this.getNextElement(e)),i}return null},CLASS_NAME:"OpenLayers.ElementsIndexer"}),OpenLayers.ElementsIndexer.IndexingMethods={Z_ORDER:function(t,e,i){var n=t.getZIndex(e),s=0;if(i){var r=t.getZIndex(i);s=n-r}return s},Z_ORDER_DRAWING_ORDER:function(t,e,i){var n=OpenLayers.ElementsIndexer.IndexingMethods.Z_ORDER(t,e,i);return i&&0==n&&(n=1),n},Z_ORDER_Y_ORDER:function(t,e,i){var n=OpenLayers.ElementsIndexer.IndexingMethods.Z_ORDER(t,e,i);if(i&&0===n){var s=i._boundsBottom-e._boundsBottom;n=0===s?1:s}return n}},OpenLayers.Renderer.Elements=OpenLayers.Class(OpenLayers.Renderer,{rendererRoot:null,root:null,vectorRoot:null,textRoot:null,xmlns:null,xOffset:0,indexer:null,BACKGROUND_ID_SUFFIX:"_background",LABEL_ID_SUFFIX:"_label",LABEL_OUTLINE_SUFFIX:"_outline",initialize:function(t,e){OpenLayers.Renderer.prototype.initialize.apply(this,arguments),this.rendererRoot=this.createRenderRoot(),this.root=this.createRoot("_root"),this.vectorRoot=this.createRoot("_vroot"),this.textRoot=this.createRoot("_troot"),this.root.appendChild(this.vectorRoot),this.root.appendChild(this.textRoot),this.rendererRoot.appendChild(this.root),this.container.appendChild(this.rendererRoot),e&&(e.zIndexing||e.yOrdering)&&(this.indexer=new OpenLayers.ElementsIndexer(e.yOrdering))},destroy:function(){this.clear(),this.rendererRoot=null,this.root=null,this.xmlns=null,OpenLayers.Renderer.prototype.destroy.apply(this,arguments)},clear:function(){var t,e=this.vectorRoot;if(e)for(;t=e.firstChild;)e.removeChild(t);if(e=this.textRoot)for(;t=e.firstChild;)e.removeChild(t);this.indexer&&this.indexer.clear()},setExtent:function(t,e){var i=OpenLayers.Renderer.prototype.setExtent.apply(this,arguments),n=this.getResolution();if(this.map.baseLayer&&this.map.baseLayer.wrapDateLine){var s,r=t.getWidth()/this.map.getExtent().getWidth(),t=t.scale(1/r),o=this.map.getMaxExtent();o.right>t.left&&o.right<t.right?s=!0:o.left>t.left&&o.left<t.right&&(s=!1),(s!==this.rightOfDateLine||e)&&(i=!1,this.xOffset=s===!0?o.getWidth()/n:0),this.rightOfDateLine=s}return i},getNodeType:function(){},drawGeometry:function(t,e,i){var n=t.CLASS_NAME,s=!0;if("OpenLayers.Geometry.Collection"==n||"OpenLayers.Geometry.MultiPoint"==n||"OpenLayers.Geometry.MultiLineString"==n||"OpenLayers.Geometry.MultiPolygon"==n){for(var r=0,o=t.components.length;o>r;r++)s=this.drawGeometry(t.components[r],e,i)&&s;return s}s=!1;var a=!1;if("none"!=e.display&&(e.backgroundGraphic?this.redrawBackgroundNode(t.id,t,e,i):a=!0,s=this.redrawNode(t.id,t,e,i)),0==s){var l=document.getElementById(t.id);l&&(l._style.backgroundGraphic&&(a=!0),l.parentNode.removeChild(l))}if(a){var l=document.getElementById(t.id+this.BACKGROUND_ID_SUFFIX);l&&l.parentNode.removeChild(l)}return s},redrawNode:function(t,e,i,n){i=this.applyDefaultSymbolizer(i);var s=this.nodeFactory(t,this.getNodeType(e,i));s._featureId=n,s._boundsBottom=e.getBounds().bottom,s._geometryClass=e.CLASS_NAME,s._style=i;var r=this.drawGeometryNode(s,e,i);if(r===!1)return!1;if(s=r.node,this.indexer){var o=this.indexer.insert(s);o?this.vectorRoot.insertBefore(s,o):this.vectorRoot.appendChild(s)}else s.parentNode!==this.vectorRoot&&this.vectorRoot.appendChild(s);return this.postDraw(s),r.complete},redrawBackgroundNode:function(t,e,i){var n=OpenLayers.Util.extend({},i);return n.externalGraphic=n.backgroundGraphic,n.graphicXOffset=n.backgroundXOffset,n.graphicYOffset=n.backgroundYOffset,n.graphicZIndex=n.backgroundGraphicZIndex,n.graphicWidth=n.backgroundWidth||n.graphicWidth,n.graphicHeight=n.backgroundHeight||n.graphicHeight,n.backgroundGraphic=null,n.backgroundXOffset=null,n.backgroundYOffset=null,n.backgroundGraphicZIndex=null,this.redrawNode(t+this.BACKGROUND_ID_SUFFIX,e,n,null)},drawGeometryNode:function(t,e,i){i=i||t._style;var n,s={isFilled:void 0===i.fill?!0:i.fill,isStroked:void 0===i.stroke?!!i.strokeWidth:i.stroke};switch(e.CLASS_NAME){case"OpenLayers.Geometry.Point":i.graphic===!1&&(s.isFilled=!1,s.isStroked=!1),n=this.drawPoint(t,e);break;case"OpenLayers.Geometry.LineString":s.isFilled=!1,n=this.drawLineString(t,e);break;case"OpenLayers.Geometry.LinearRing":n=this.drawLinearRing(t,e);break;case"OpenLayers.Geometry.Polygon":n=this.drawPolygon(t,e);break;case"OpenLayers.Geometry.Rectangle":n=this.drawRectangle(t,e)}return t._options=s,0!=n?{node:this.setStyle(t,i,s,e),complete:n}:!1},postDraw:function(){},drawPoint:function(){},drawLineString:function(){},drawLinearRing:function(){},drawPolygon:function(){},drawRectangle:function(){},drawCircle:function(){},removeText:function(t){var e=document.getElementById(t+this.LABEL_ID_SUFFIX);e&&this.textRoot.removeChild(e);var i=document.getElementById(t+this.LABEL_OUTLINE_SUFFIX);i&&this.textRoot.removeChild(i)},getFeatureIdFromEvent:function(t){var e=t.target,i=e&&e.correspondingUseElement,n=i?i:e||t.srcElement;return n._featureId},eraseGeometry:function(t,e){if("OpenLayers.Geometry.MultiPoint"==t.CLASS_NAME||"OpenLayers.Geometry.MultiLineString"==t.CLASS_NAME||"OpenLayers.Geometry.MultiPolygon"==t.CLASS_NAME||"OpenLayers.Geometry.Collection"==t.CLASS_NAME)for(var i=0,n=t.components.length;n>i;i++)this.eraseGeometry(t.components[i],e);else{var s=OpenLayers.Util.getElement(t.id);if(s&&s.parentNode&&(s.geometry&&(s.geometry.destroy(),s.geometry=null),s.parentNode.removeChild(s),this.indexer&&this.indexer.remove(s),s._style.backgroundGraphic)){var r=t.id+this.BACKGROUND_ID_SUFFIX,o=OpenLayers.Util.getElement(r);o&&o.parentNode&&o.parentNode.removeChild(o)}}},nodeFactory:function(t,e){var i=OpenLayers.Util.getElement(t);return i?this.nodeTypeCompare(i,e)||(i.parentNode.removeChild(i),i=this.nodeFactory(t,e)):i=this.createNode(e,t),i},nodeTypeCompare:function(){},createNode:function(){},moveRoot:function(t){var e=this.root;t.root.parentNode==this.rendererRoot&&(e=t.root),e.parentNode.removeChild(e),t.rendererRoot.appendChild(e)},getRenderLayerId:function(){return this.root.parentNode.parentNode.id},isComplexSymbol:function(t){return"circle"!=t&&!!t},CLASS_NAME:"OpenLayers.Renderer.Elements"}),OpenLayers.Control.ArgParser=OpenLayers.Class(OpenLayers.Control,{center:null,zoom:null,layers:null,displayProjection:null,getParameters:function(t){t=t||window.location.href;var e=OpenLayers.Util.getParameters(t),i=t.indexOf("#");return i>0&&(t="?"+t.substring(i+1,t.length),OpenLayers.Util.extend(e,OpenLayers.Util.getParameters(t))),e},setMap:function(){OpenLayers.Control.prototype.setMap.apply(this,arguments);for(var t=0,e=this.map.controls.length;e>t;t++){var i=this.map.controls[t];if(i!=this&&"OpenLayers.Control.ArgParser"==i.CLASS_NAME){i.displayProjection!=this.displayProjection&&(this.displayProjection=i.displayProjection);break}}if(t==this.map.controls.length){var n=this.getParameters();n.layers&&(this.layers=n.layers,this.map.events.register("addlayer",this,this.configureLayers),this.configureLayers()),n.lat&&n.lon&&(this.center=new OpenLayers.LonLat(parseFloat(n.lon),parseFloat(n.lat)),n.zoom&&(this.zoom=parseFloat(n.zoom)),this.map.events.register("changebaselayer",this,this.setCenter),this.setCenter())}},setCenter:function(){this.map.baseLayer&&(this.map.events.unregister("changebaselayer",this,this.setCenter),this.displayProjection&&this.center.transform(this.displayProjection,this.map.getProjectionObject()),this.map.setCenter(this.center,this.zoom))},configureLayers:function(){if(this.layers.length==this.map.layers.length){this.map.events.unregister("addlayer",this,this.configureLayers);for(var t=0,e=this.layers.length;e>t;t++){var i=this.map.layers[t],n=this.layers.charAt(t);"B"==n?this.map.setBaseLayer(i):("T"==n||"F"==n)&&i.setVisibility("T"==n)}}},CLASS_NAME:"OpenLayers.Control.ArgParser"}),OpenLayers.Control.Permalink=OpenLayers.Class(OpenLayers.Control,{argParserClass:OpenLayers.Control.ArgParser,element:null,anchor:!1,base:"",displayProjection:null,initialize:function(t,e,i){null===t||"object"!=typeof t||OpenLayers.Util.isElement(t)?(OpenLayers.Control.prototype.initialize.apply(this,[i]),this.element=OpenLayers.Util.getElement(t),this.base=e||document.location.href):(i=t,this.base=document.location.href,OpenLayers.Control.prototype.initialize.apply(this,[i]),null!=this.element&&(this.element=OpenLayers.Util.getElement(this.element)))},destroy:function(){this.element&&this.element.parentNode==this.div&&(this.div.removeChild(this.element),this.element=null),this.map&&this.map.events.unregister("moveend",this,this.updateLink),OpenLayers.Control.prototype.destroy.apply(this,arguments)},setMap:function(){OpenLayers.Control.prototype.setMap.apply(this,arguments);for(var t=0,e=this.map.controls.length;e>t;t++){var i=this.map.controls[t];if(i.CLASS_NAME==this.argParserClass.CLASS_NAME){i.displayProjection!=this.displayProjection&&(this.displayProjection=i.displayProjection);break}}t==this.map.controls.length&&this.map.addControl(new this.argParserClass({displayProjection:this.displayProjection}))},draw:function(){return OpenLayers.Control.prototype.draw.apply(this,arguments),this.element||this.anchor||(this.element=document.createElement("a"),this.element.innerHTML=OpenLayers.i18n("Permalink"),this.element.href="",this.div.appendChild(this.element)),this.map.events.on({moveend:this.updateLink,changelayer:this.updateLink,changebaselayer:this.updateLink,scope:this}),this.updateLink(),this.div},updateLink:function(){var t=this.anchor?"#":"?",e=this.base,i=null;-1!=e.indexOf("#")&&0==this.anchor&&(i=e.substring(e.indexOf("#"),e.length)),-1!=e.indexOf(t)&&(e=e.substring(0,e.indexOf(t)));var n=e.split("#");e=n[0]+t+OpenLayers.Util.getParameterString(this.createParams()),i&&(e+=i),this.anchor&&!this.element?window.location.href=e:this.element.href=e},createParams:function(t,e,i){t=t||this.map.getCenter();var n=OpenLayers.Util.getParameters(this.base);if(t){n.zoom=e||this.map.getZoom();var s=t.lat,r=t.lon;if(this.displayProjection){var o=OpenLayers.Projection.transform({x:r,y:s},this.map.getProjectionObject(),this.displayProjection);r=o.x,s=o.y}n.lat=Math.round(1e5*s)/1e5,n.lon=Math.round(1e5*r)/1e5,i=i||this.map.layers,n.layers="";for(var a=0,l=i.length;l>a;a++){var h=i[a];n.layers+=h.isBaseLayer?h==this.map.baseLayer?"B":"0":h.getVisibility()?"T":"F"}}return n},CLASS_NAME:"OpenLayers.Control.Permalink"}),OpenLayers.Layer.TMS=OpenLayers.Class(OpenLayers.Layer.Grid,{serviceVersion:"1.0.0",layername:null,type:null,isBaseLayer:!0,tileOrigin:null,serverResolutions:null,zoomOffset:0,initialize:function(t,e,i){var n=[];n.push(t,e,{},i),OpenLayers.Layer.Grid.prototype.initialize.apply(this,n)},clone:function(t){return null==t&&(t=new OpenLayers.Layer.TMS(this.name,this.url,this.getOptions())),t=OpenLayers.Layer.Grid.prototype.clone.apply(this,[t])},getURL:function(t){t=this.adjustBounds(t);var e=this.getServerResolution(),i=Math.round((t.left-this.tileOrigin.lon)/(e*this.tileSize.w)),n=Math.round((t.bottom-this.tileOrigin.lat)/(e*this.tileSize.h)),s=this.getServerZoom(),r=this.serviceVersion+"/"+this.layername+"/"+s+"/"+i+"/"+n+"."+this.type,o=this.url;return OpenLayers.Util.isArray(o)&&(o=this.selectUrl(r,o)),o+r},setMap:function(){OpenLayers.Layer.Grid.prototype.setMap.apply(this,arguments),this.tileOrigin||(this.tileOrigin=new OpenLayers.LonLat(this.map.maxExtent.left,this.map.maxExtent.bottom))},CLASS_NAME:"OpenLayers.Layer.TMS"}),OpenLayers.Format.WCSCapabilities=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,{defaultVersion:"1.1.0",CLASS_NAME:"OpenLayers.Format.WCSCapabilities"}),OpenLayers.Format.WCSCapabilities.v1=OpenLayers.Class(OpenLayers.Format.XML,{regExes:{trimSpace:/^\s*|\s*$/g,splitSpace:/\s+/},defaultPrefix:"wcs",read:function(t){"string"==typeof t&&(t=OpenLayers.Format.XML.prototype.read.apply(this,[t]));t&&9==t.nodeType&&(t=t.documentElement);var e={};return this.readNode(t,e),e},CLASS_NAME:"OpenLayers.Format.WCSCapabilities.v1"}),OpenLayers.Format.WCSCapabilities.v1_0_0=OpenLayers.Class(OpenLayers.Format.WCSCapabilities.v1,{namespaces:{wcs:"http://www.opengis.net/wcs",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance",ows:"http://www.opengis.net/ows"},errorProperty:"service",readers:{wcs:{WCS_Capabilities:function(t,e){this.readChildNodes(t,e)},Service:function(t,e){e.service={},this.readChildNodes(t,e.service)},name:function(t,e){e.name=this.getChildValue(t)},label:function(t,e){e.label=this.getChildValue(t)},keywords:function(t,e){e.keywords=[],this.readChildNodes(t,e.keywords)},keyword:function(t,e){e.push(this.getChildValue(t))},responsibleParty:function(t,e){e.responsibleParty={},this.readChildNodes(t,e.responsibleParty)},individualName:function(t,e){e.individualName=this.getChildValue(t)},organisationName:function(t,e){e.organisationName=this.getChildValue(t)},positionName:function(t,e){e.positionName=this.getChildValue(t)},contactInfo:function(t,e){e.contactInfo={},this.readChildNodes(t,e.contactInfo)},phone:function(t,e){e.phone={},this.readChildNodes(t,e.phone)},voice:function(t,e){e.voice=this.getChildValue(t)},facsimile:function(t,e){e.facsimile=this.getChildValue(t)},address:function(t,e){e.address={},this.readChildNodes(t,e.address)},deliveryPoint:function(t,e){e.deliveryPoint=this.getChildValue(t)},city:function(t,e){e.city=this.getChildValue(t)},postalCode:function(t,e){e.postalCode=this.getChildValue(t)},country:function(t,e){e.country=this.getChildValue(t)},electronicMailAddress:function(t,e){e.electronicMailAddress=this.getChildValue(t)},fees:function(t,e){e.fees=this.getChildValue(t)},accessConstraints:function(t,e){e.accessConstraints=this.getChildValue(t)},ContentMetadata:function(t,e){e.contentMetadata=[],this.readChildNodes(t,e.contentMetadata)},CoverageOfferingBrief:function(t,e){var i={};this.readChildNodes(t,i),e.push(i)},name:function(t,e){e.name=this.getChildValue(t)},label:function(t,e){e.label=this.getChildValue(t)},lonLatEnvelope:function(t,e){var i=this.getElementsByTagNameNS(t,"http://www.opengis.net/gml","pos");if(2==i.length){var n={},s={};OpenLayers.Format.GML.v3.prototype.readers.gml.pos.apply(this,[i[0],n]),OpenLayers.Format.GML.v3.prototype.readers.gml.pos.apply(this,[i[1],s]),e.lonLatEnvelope={},e.lonLatEnvelope.srsName=t.getAttribute("srsName"),e.lonLatEnvelope.min=n.points[0],e.lonLatEnvelope.max=s.points[0]}}}},CLASS_NAME:"OpenLayers.Format.WCSCapabilities.v1_0_0"}),OpenLayers.Strategy.Fixed=OpenLayers.Class(OpenLayers.Strategy,{preload:!1,activate:function(){var t=OpenLayers.Strategy.prototype.activate.apply(this,arguments);return t&&(this.layer.events.on({refresh:this.load,scope:this}),1==this.layer.visibility||this.preload?this.load():this.layer.events.on({visibilitychanged:this.load,scope:this})),t},deactivate:function(){var t=OpenLayers.Strategy.prototype.deactivate.call(this);return t&&this.layer.events.un({refresh:this.load,visibilitychanged:this.load,scope:this}),t},load:function(t){var e=this.layer;e.events.triggerEvent("loadstart",{filter:e.filter}),e.protocol.read(OpenLayers.Util.applyDefaults({callback:this.merge,filter:e.filter,scope:this},t)),e.events.un({visibilitychanged:this.load,scope:this})},merge:function(t){var e=this.layer;e.destroyFeatures();var i=t.features;if(i&&i.length>0){var n=e.projection,s=e.map.getProjectionObject();if(!s.equals(n))for(var r,o=0,a=i.length;a>o;++o)r=i[o].geometry,r&&r.transform(n,s);e.addFeatures(i)}e.events.triggerEvent("loadend",{response:t})},CLASS_NAME:"OpenLayers.Strategy.Fixed"}),OpenLayers.Control.Zoom=OpenLayers.Class(OpenLayers.Control,{zoomInText:"+",zoomInId:"olZoomInLink",zoomOutText:"−",zoomOutId:"olZoomOutLink",draw:function(){var t=OpenLayers.Control.prototype.draw.apply(this),e=this.getOrCreateLinks(t),i=e.zoomIn,n=e.zoomOut,s=this.map.events;return n.parentNode!==t&&(s=this.events,s.attachToElement(n.parentNode)),s.register("buttonclick",this,this.onZoomClick),this.zoomInLink=i,this.zoomOutLink=n,t},getOrCreateLinks:function(t){var e=document.getElementById(this.zoomInId),i=document.getElementById(this.zoomOutId);return e||(e=document.createElement("a"),e.href="#zoomIn",e.appendChild(document.createTextNode(this.zoomInText)),e.className="olControlZoomIn",t.appendChild(e)),OpenLayers.Element.addClass(e,"olButton"),i||(i=document.createElement("a"),i.href="#zoomOut",i.appendChild(document.createTextNode(this.zoomOutText)),i.className="olControlZoomOut",t.appendChild(i)),OpenLayers.Element.addClass(i,"olButton"),{zoomIn:e,zoomOut:i}},onZoomClick:function(t){var e=t.buttonElement;e===this.zoomInLink?this.map.zoomIn():e===this.zoomOutLink&&this.map.zoomOut()},destroy:function(){this.map&&this.map.events.unregister("buttonclick",this,this.onZoomClick),delete this.zoomInLink,delete this.zoomOutLink,OpenLayers.Control.prototype.destroy.apply(this)},CLASS_NAME:"OpenLayers.Control.Zoom"}),OpenLayers.StyleMap=OpenLayers.Class({styles:null,extendDefault:!0,initialize:function(t,e){if(this.styles={"default":new OpenLayers.Style(OpenLayers.Feature.Vector.style["default"]),select:new OpenLayers.Style(OpenLayers.Feature.Vector.style.select),temporary:new OpenLayers.Style(OpenLayers.Feature.Vector.style.temporary),"delete":new OpenLayers.Style(OpenLayers.Feature.Vector.style["delete"])},t instanceof OpenLayers.Style)this.styles["default"]=t,this.styles.select=t,this.styles.temporary=t,this.styles["delete"]=t;else if("object"==typeof t)for(var i in t)if(t[i]instanceof OpenLayers.Style)this.styles[i]=t[i];else{if("object"!=typeof t[i]){this.styles["default"]=new OpenLayers.Style(t),this.styles.select=new OpenLayers.Style(t),this.styles.temporary=new OpenLayers.Style(t),this.styles["delete"]=new OpenLayers.Style(t);break}this.styles[i]=new OpenLayers.Style(t[i])}OpenLayers.Util.extend(this,e)},destroy:function(){for(var t in this.styles)this.styles[t].destroy();this.styles=null},createSymbolizer:function(t,e){t||(t=new OpenLayers.Feature.Vector),this.styles[e]||(e="default"),t.renderIntent=e;var i={};return this.extendDefault&&"default"!=e&&(i=this.styles["default"].createSymbolizer(t)),OpenLayers.Util.extend(i,this.styles[e].createSymbolizer(t))},addUniqueValueRules:function(t,e,i,n){var s=[];for(var r in i)s.push(new OpenLayers.Rule({symbolizer:i[r],context:n,filter:new OpenLayers.Filter.Comparison({type:OpenLayers.Filter.Comparison.EQUAL_TO,property:e,value:r})}));this.styles[t].addRules(s)},CLASS_NAME:"OpenLayers.StyleMap"}),OpenLayers.Layer.Vector=OpenLayers.Class(OpenLayers.Layer,{isBaseLayer:!1,isFixed:!1,features:null,filter:null,selectedFeatures:null,unrenderedFeatures:null,reportError:!0,style:null,styleMap:null,strategies:null,protocol:null,renderers:["SVG","VML","Canvas"],renderer:null,rendererOptions:null,geometryType:null,drawn:!1,ratio:1,initialize:function(){if(OpenLayers.Layer.prototype.initialize.apply(this,arguments),this.renderer&&this.renderer.supported()||this.assignRenderer(),this.renderer&&this.renderer.supported()||(this.renderer=null,this.displayError()),this.styleMap||(this.styleMap=new OpenLayers.StyleMap),this.features=[],this.selectedFeatures=[],this.unrenderedFeatures={},this.strategies)for(var t=0,e=this.strategies.length;e>t;t++)this.strategies[t].setLayer(this)},destroy:function(){if(this.strategies){var t,e,i;for(e=0,i=this.strategies.length;i>e;e++)t=this.strategies[e],t.autoDestroy&&t.destroy();this.strategies=null}this.protocol&&(this.protocol.autoDestroy&&this.protocol.destroy(),this.protocol=null),this.destroyFeatures(),this.features=null,this.selectedFeatures=null,this.unrenderedFeatures=null,this.renderer&&this.renderer.destroy(),this.renderer=null,this.geometryType=null,this.drawn=null,OpenLayers.Layer.prototype.destroy.apply(this,arguments)},clone:function(t){null==t&&(t=new OpenLayers.Layer.Vector(this.name,this.getOptions())),t=OpenLayers.Layer.prototype.clone.apply(this,[t]);for(var e=this.features,i=e.length,n=new Array(i),s=0;i>s;++s)n[s]=e[s].clone();return t.features=n,t},refresh:function(t){this.calculateInRange()&&this.visibility&&this.events.triggerEvent("refresh",t)},assignRenderer:function(){for(var t=0,e=this.renderers.length;e>t;t++){var i=this.renderers[t],n="function"==typeof i?i:OpenLayers.Renderer[i];if(n&&n.prototype.supported()){this.renderer=new n(this.div,this.rendererOptions);break}}},displayError:function(){this.reportError&&OpenLayers.Console.userError(OpenLayers.i18n("browserNotSupported",{renderers:this.renderers.join("\n")}))},setMap:function(){if(OpenLayers.Layer.prototype.setMap.apply(this,arguments),this.renderer){this.renderer.map=this.map;var t=this.map.getSize();t.w=t.w*this.ratio,t.h=t.h*this.ratio,this.renderer.setSize(t)}else this.map.removeLayer(this)},afterAdd:function(){if(this.strategies){var t,e,i;for(e=0,i=this.strategies.length;i>e;e++)t=this.strategies[e],t.autoActivate&&t.activate()}},removeMap:function(){if(this.drawn=!1,this.strategies){var t,e,i;for(e=0,i=this.strategies.length;i>e;e++)t=this.strategies[e],t.autoActivate&&t.deactivate()}},onMapResize:function(){OpenLayers.Layer.prototype.onMapResize.apply(this,arguments);var t=this.map.getSize();t.w=t.w*this.ratio,t.h=t.h*this.ratio,this.renderer.setSize(t)},moveTo:function(t,e,i){OpenLayers.Layer.prototype.moveTo.apply(this,arguments);var n=!0;if(!i){this.renderer.root.style.visibility="hidden";var s=this.map.getSize(),r=s.w,o=s.h,a=r/2*this.ratio-r/2,l=o/2*this.ratio-o/2;a+=this.map.layerContainerOriginPx.x,a=-Math.round(a),l+=this.map.layerContainerOriginPx.y,l=-Math.round(l),this.div.style.left=a+"px",this.div.style.top=l+"px";var h=this.map.getExtent().scale(this.ratio);if(n=this.renderer.setExtent(h,e),this.renderer.root.style.visibility="visible",OpenLayers.IS_GECKO===!0&&(this.div.scrollLeft=this.div.scrollLeft),!e&&n)for(var u in this.unrenderedFeatures){var p=this.unrenderedFeatures[u];this.drawFeature(p)}}if(!this.drawn||e||!n){this.drawn=!0;for(var p,u=0,c=this.features.length;c>u;u++)this.renderer.locked=u!==c-1,p=this.features[u],this.drawFeature(p)}},display:function(){OpenLayers.Layer.prototype.display.apply(this,arguments);var t=this.div.style.display;t!=this.renderer.root.style.display&&(this.renderer.root.style.display=t)},addFeatures:function(t,e){OpenLayers.Util.isArray(t)||(t=[t]);var i=!e||!e.silent;if(i){var n={features:t},s=this.events.triggerEvent("beforefeaturesadded",n);if(s===!1)return;t=n.features}for(var r=[],o=0,a=t.length;a>o;o++){this.renderer.locked=o!=t.length-1?!0:!1;var l=t[o];if(this.geometryType&&!(l.geometry instanceof this.geometryType))throw new TypeError("addFeatures: component should be an "+this.geometryType.prototype.CLASS_NAME);if(l.layer=this,!l.style&&this.style&&(l.style=OpenLayers.Util.extend({},this.style)),i){if(this.events.triggerEvent("beforefeatureadded",{feature:l})===!1)continue;this.preFeatureInsert(l)}r.push(l),this.features.push(l),this.drawFeature(l),i&&(this.events.triggerEvent("featureadded",{feature:l}),this.onFeatureInsert(l))
}i&&this.events.triggerEvent("featuresadded",{features:r})},removeFeatures:function(t,e){if(t&&0!==t.length){if(t===this.features)return this.removeAllFeatures(e);OpenLayers.Util.isArray(t)||(t=[t]),t===this.selectedFeatures&&(t=t.slice());var i=!e||!e.silent;i&&this.events.triggerEvent("beforefeaturesremoved",{features:t});for(var n=t.length-1;n>=0;n--){this.renderer.locked=0!=n&&t[n-1].geometry?!0:!1;var s=t[n];delete this.unrenderedFeatures[s.id],i&&this.events.triggerEvent("beforefeatureremoved",{feature:s}),this.features=OpenLayers.Util.removeItem(this.features,s),s.layer=null,s.geometry&&this.renderer.eraseFeatures(s),-1!=OpenLayers.Util.indexOf(this.selectedFeatures,s)&&OpenLayers.Util.removeItem(this.selectedFeatures,s),i&&this.events.triggerEvent("featureremoved",{feature:s})}i&&this.events.triggerEvent("featuresremoved",{features:t})}},removeAllFeatures:function(t){var e=!t||!t.silent,i=this.features;e&&this.events.triggerEvent("beforefeaturesremoved",{features:i});for(var n,s=i.length-1;s>=0;s--)n=i[s],e&&this.events.triggerEvent("beforefeatureremoved",{feature:n}),n.layer=null,e&&this.events.triggerEvent("featureremoved",{feature:n});this.renderer.clear(),this.features=[],this.unrenderedFeatures={},this.selectedFeatures=[],e&&this.events.triggerEvent("featuresremoved",{features:i})},destroyFeatures:function(t,e){var i=void 0==t;if(i&&(t=this.features),t){this.removeFeatures(t,e);for(var n=t.length-1;n>=0;n--)t[n].destroy()}},drawFeature:function(t,e){if(this.drawn){if("object"!=typeof e){e||t.state!==OpenLayers.State.DELETE||(e="delete");var i=e||t.renderIntent;e=t.style||this.style,e||(e=this.styleMap.createSymbolizer(t,i))}var n=this.renderer.drawFeature(t,e);n===!1||null===n?this.unrenderedFeatures[t.id]=t:delete this.unrenderedFeatures[t.id]}},eraseFeatures:function(t){this.renderer.eraseFeatures(t)},getFeatureFromEvent:function(t){if(!this.renderer)throw new Error("getFeatureFromEvent called on layer with no renderer. This usually means you destroyed a layer, but not some handler which is associated with it.");var e=null,i=this.renderer.getFeatureIdFromEvent(t);return i&&(e="string"==typeof i?this.getFeatureById(i):i),e},getFeatureBy:function(t,e){for(var i=null,n=0,s=this.features.length;s>n;++n)if(this.features[n][t]==e){i=this.features[n];break}return i},getFeatureById:function(t){return this.getFeatureBy("id",t)},getFeatureByFid:function(t){return this.getFeatureBy("fid",t)},getFeaturesByAttribute:function(t,e){var i,n,s=this.features.length,r=[];for(i=0;s>i;i++)n=this.features[i],n&&n.attributes&&n.attributes[t]===e&&r.push(n);return r},onFeatureInsert:function(){},preFeatureInsert:function(){},getDataExtent:function(){var t=null,e=this.features;if(e&&e.length>0)for(var i=null,n=0,s=e.length;s>n;n++)i=e[n].geometry,i&&(null===t&&(t=new OpenLayers.Bounds),t.extend(i.getBounds()));return t},CLASS_NAME:"OpenLayers.Layer.Vector"}),OpenLayers.Layer.PointTrack=OpenLayers.Class(OpenLayers.Layer.Vector,{dataFrom:null,styleFrom:null,addNodes:function(t,e){if(t.length<2)throw new Error("At least two point features have to be added to create a line from");for(var i,n,s,r=new Array(t.length-1),o=0,a=t.length;a>o;o++){if(i=t[o],s=i.geometry){if("OpenLayers.Geometry.Point"!=s.CLASS_NAME)throw new TypeError("Only features with point geometries are supported.")}else{var l=i.lonlat;s=new OpenLayers.Geometry.Point(l.lon,l.lat)}if(o>0){var h=null!=this.dataFrom?t[o+this.dataFrom].data||t[o+this.dataFrom].attributes:null,u=null!=this.styleFrom?t[o+this.styleFrom].style:null,p=new OpenLayers.Geometry.LineString([n,s]);r[o-1]=new OpenLayers.Feature.Vector(p,h,u)}n=s}this.addFeatures(r,e)},CLASS_NAME:"OpenLayers.Layer.PointTrack"}),OpenLayers.Layer.PointTrack.SOURCE_NODE=-1,OpenLayers.Layer.PointTrack.TARGET_NODE=0,OpenLayers.Layer.PointTrack.dataFrom={SOURCE_NODE:-1,TARGET_NODE:0},OpenLayers.Protocol=OpenLayers.Class({format:null,options:null,autoDestroy:!0,defaultFilter:null,initialize:function(t){t=t||{},OpenLayers.Util.extend(this,t),this.options=t},mergeWithDefaultFilter:function(t){var e;return e=t&&this.defaultFilter?new OpenLayers.Filter.Logical({type:OpenLayers.Filter.Logical.AND,filters:[this.defaultFilter,t]}):t||this.defaultFilter||void 0},destroy:function(){this.options=null,this.format=null},read:function(t){t=t||{},t.filter=this.mergeWithDefaultFilter(t.filter)},create:function(){},update:function(){},"delete":function(){},commit:function(){},abort:function(){},createCallback:function(t,e,i){return OpenLayers.Function.bind(function(){t.apply(this,[e,i])},this)},CLASS_NAME:"OpenLayers.Protocol"}),OpenLayers.Protocol.Response=OpenLayers.Class({code:null,requestType:null,last:!0,features:null,data:null,reqFeatures:null,priv:null,error:null,initialize:function(t){OpenLayers.Util.extend(this,t)},success:function(){return this.code>0},CLASS_NAME:"OpenLayers.Protocol.Response"}),OpenLayers.Protocol.Response.SUCCESS=1,OpenLayers.Protocol.Response.FAILURE=0,OpenLayers.Protocol.WFS=function(t){t=OpenLayers.Util.applyDefaults(t,OpenLayers.Protocol.WFS.DEFAULTS);var e=OpenLayers.Protocol.WFS["v"+t.version.replace(/\./g,"_")];if(!e)throw"Unsupported WFS version: "+t.version;return new e(t)},OpenLayers.Protocol.WFS.fromWMSLayer=function(t,e){var i,n,s=t.params.LAYERS,r=(OpenLayers.Util.isArray(s)?s[0]:s).split(":");r.length>1&&(n=r[0]),i=r.pop();var o={url:t.url,featureType:i,featurePrefix:n,srsName:t.projection&&t.projection.getCode()||t.map&&t.map.getProjectionObject().getCode(),version:"1.1.0"};return new OpenLayers.Protocol.WFS(OpenLayers.Util.applyDefaults(e,o))},OpenLayers.Protocol.WFS.DEFAULTS={version:"1.0.0"},OpenLayers.Layer.Markers=OpenLayers.Class(OpenLayers.Layer,{isBaseLayer:!1,markers:null,drawn:!1,initialize:function(){OpenLayers.Layer.prototype.initialize.apply(this,arguments),this.markers=[]},destroy:function(){this.clearMarkers(),this.markers=null,OpenLayers.Layer.prototype.destroy.apply(this,arguments)},setOpacity:function(t){if(t!=this.opacity){this.opacity=t;for(var e=0,i=this.markers.length;i>e;e++)this.markers[e].setOpacity(this.opacity)}},moveTo:function(t,e){if(OpenLayers.Layer.prototype.moveTo.apply(this,arguments),e||!this.drawn){for(var i=0,n=this.markers.length;n>i;i++)this.drawMarker(this.markers[i]);this.drawn=!0}},addMarker:function(t){this.markers.push(t),this.opacity<1&&t.setOpacity(this.opacity),this.map&&this.map.getExtent()&&(t.map=this.map,this.drawMarker(t))},removeMarker:function(t){this.markers&&this.markers.length&&(OpenLayers.Util.removeItem(this.markers,t),t.erase())},clearMarkers:function(){if(null!=this.markers)for(;this.markers.length>0;)this.removeMarker(this.markers[0])},drawMarker:function(t){var e=this.map.getLayerPxFromLonLat(t.lonlat);if(null==e)t.display(!1);else if(t.isDrawn())t.icon&&t.icon.moveTo(e);else{var i=t.draw(e);this.div.appendChild(i)}},getDataExtent:function(){var t=null;if(this.markers&&this.markers.length>0)for(var t=new OpenLayers.Bounds,e=0,i=this.markers.length;i>e;e++){var n=this.markers[e];t.extend(n.lonlat)}return t},CLASS_NAME:"OpenLayers.Layer.Markers"}),OpenLayers.Control.Pan=OpenLayers.Class(OpenLayers.Control.Button,{slideFactor:50,slideRatio:null,direction:null,initialize:function(t,e){this.direction=t,this.CLASS_NAME+=this.direction,OpenLayers.Control.prototype.initialize.apply(this,[e])},trigger:function(){if(this.map){var t=OpenLayers.Function.bind(function(t){return this.slideRatio?this.map.getSize()[t]*this.slideRatio:this.slideFactor},this);switch(this.direction){case OpenLayers.Control.Pan.NORTH:this.map.pan(0,-t("h"));break;case OpenLayers.Control.Pan.SOUTH:this.map.pan(0,t("h"));break;case OpenLayers.Control.Pan.WEST:this.map.pan(-t("w"),0);break;case OpenLayers.Control.Pan.EAST:this.map.pan(t("w"),0)}}},CLASS_NAME:"OpenLayers.Control.Pan"}),OpenLayers.Control.Pan.NORTH="North",OpenLayers.Control.Pan.SOUTH="South",OpenLayers.Control.Pan.EAST="East",OpenLayers.Control.Pan.WEST="West",OpenLayers.Format.CSWGetDomain=function(t){t=OpenLayers.Util.applyDefaults(t,OpenLayers.Format.CSWGetDomain.DEFAULTS);var e=OpenLayers.Format.CSWGetDomain["v"+t.version.replace(/\./g,"_")];if(!e)throw"Unsupported CSWGetDomain version: "+t.version;return new e(t)},OpenLayers.Format.CSWGetDomain.DEFAULTS={version:"2.0.2"},OpenLayers.Format.CSWGetDomain.v2_0_2=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance",csw:"http://www.opengis.net/cat/csw/2.0.2"},defaultPrefix:"csw",version:"2.0.2",schemaLocation:"http://www.opengis.net/cat/csw/2.0.2 http://schemas.opengis.net/csw/2.0.2/CSW-discovery.xsd",PropertyName:null,ParameterName:null,read:function(t){"string"==typeof t&&(t=OpenLayers.Format.XML.prototype.read.apply(this,[t])),t&&9==t.nodeType&&(t=t.documentElement);var e={};return this.readNode(t,e),e},readers:{csw:{GetDomainResponse:function(t,e){this.readChildNodes(t,e)},DomainValues:function(t,e){OpenLayers.Util.isArray(e.DomainValues)||(e.DomainValues=[]);for(var i=t.attributes,n={},s=0,r=i.length;r>s;++s)n[i[s].name]=i[s].nodeValue;this.readChildNodes(t,n),e.DomainValues.push(n)},PropertyName:function(t,e){e.PropertyName=this.getChildValue(t)},ParameterName:function(t,e){e.ParameterName=this.getChildValue(t)},ListOfValues:function(t,e){OpenLayers.Util.isArray(e.ListOfValues)||(e.ListOfValues=[]),this.readChildNodes(t,e.ListOfValues)},Value:function(t,e){for(var i=t.attributes,n={},s=0,r=i.length;r>s;++s)n[i[s].name]=i[s].nodeValue;n.value=this.getChildValue(t),e.push({Value:n})},ConceptualScheme:function(t,e){e.ConceptualScheme={},this.readChildNodes(t,e.ConceptualScheme)},Name:function(t,e){e.Name=this.getChildValue(t)},Document:function(t,e){e.Document=this.getChildValue(t)},Authority:function(t,e){e.Authority=this.getChildValue(t)},RangeOfValues:function(t,e){e.RangeOfValues={},this.readChildNodes(t,e.RangeOfValues)},MinValue:function(t,e){for(var i=t.attributes,n={},s=0,r=i.length;r>s;++s)n[i[s].name]=i[s].nodeValue;n.value=this.getChildValue(t),e.MinValue=n},MaxValue:function(t,e){for(var i=t.attributes,n={},s=0,r=i.length;r>s;++s)n[i[s].name]=i[s].nodeValue;n.value=this.getChildValue(t),e.MaxValue=n}}},write:function(t){var e=this.writeNode("csw:GetDomain",t);return OpenLayers.Format.XML.prototype.write.apply(this,[e])},writers:{csw:{GetDomain:function(t){var e=this.createElementNSPlus("csw:GetDomain",{attributes:{service:"CSW",version:this.version}});return t.PropertyName||this.PropertyName?this.writeNode("csw:PropertyName",t.PropertyName||this.PropertyName,e):(t.ParameterName||this.ParameterName)&&this.writeNode("csw:ParameterName",t.ParameterName||this.ParameterName,e),this.readChildNodes(e,t),e},PropertyName:function(t){var e=this.createElementNSPlus("csw:PropertyName",{value:t});return e},ParameterName:function(t){var e=this.createElementNSPlus("csw:ParameterName",{value:t});return e}}},CLASS_NAME:"OpenLayers.Format.CSWGetDomain.v2_0_2"}),OpenLayers.Format.ArcXML.Features=OpenLayers.Class(OpenLayers.Format.XML,{read:function(t){var e=new OpenLayers.Format.ArcXML,i=e.read(t);return i.features.feature}}),OpenLayers.Control.Snapping=OpenLayers.Class(OpenLayers.Control,{DEFAULTS:{tolerance:10,node:!0,edge:!0,vertex:!0},greedy:!0,precedence:["node","vertex","edge"],resolution:null,geoToleranceCache:null,layer:null,feature:null,point:null,initialize:function(t){OpenLayers.Control.prototype.initialize.apply(this,[t]),this.options=t||{},this.options.layer&&this.setLayer(this.options.layer);var e=OpenLayers.Util.extend({},this.options.defaults);this.defaults=OpenLayers.Util.applyDefaults(e,this.DEFAULTS),this.setTargets(this.options.targets),0===this.targets.length&&this.layer&&this.addTargetLayer(this.layer),this.geoToleranceCache={}},setLayer:function(t){this.active?(this.deactivate(),this.layer=t,this.activate()):this.layer=t},setTargets:function(t){if(this.targets=[],t&&t.length)for(var e,i=0,n=t.length;n>i;++i)e=t[i],e instanceof OpenLayers.Layer.Vector?this.addTargetLayer(e):this.addTarget(e)},addTargetLayer:function(t){this.addTarget({layer:t})},addTarget:function(t){t=OpenLayers.Util.applyDefaults(t,this.defaults),t.nodeTolerance=t.nodeTolerance||t.tolerance,t.vertexTolerance=t.vertexTolerance||t.tolerance,t.edgeTolerance=t.edgeTolerance||t.tolerance,this.targets.push(t)},removeTargetLayer:function(t){for(var e,i=this.targets.length-1;i>=0;--i)e=this.targets[i],e.layer===t&&this.removeTarget(e)},removeTarget:function(t){return OpenLayers.Util.removeItem(this.targets,t)},activate:function(){var t=OpenLayers.Control.prototype.activate.call(this);return t&&this.layer&&this.layer.events&&this.layer.events.on({sketchstarted:this.onSketchModified,sketchmodified:this.onSketchModified,vertexmodified:this.onVertexModified,scope:this}),t},deactivate:function(){var t=OpenLayers.Control.prototype.deactivate.call(this);return t&&this.layer&&this.layer.events&&this.layer.events.un({sketchstarted:this.onSketchModified,sketchmodified:this.onSketchModified,vertexmodified:this.onVertexModified,scope:this}),this.feature=null,this.point=null,t},onSketchModified:function(t){this.feature=t.feature,this.considerSnapping(t.vertex,t.vertex)},onVertexModified:function(t){this.feature=t.feature;var e=this.layer.map.getLonLatFromViewPortPx(t.pixel);this.considerSnapping(t.vertex,new OpenLayers.Geometry.Point(e.lon,e.lat))},considerSnapping:function(t,e){for(var i,n,s={rank:Number.POSITIVE_INFINITY,dist:Number.POSITIVE_INFINITY,x:null,y:null},r=!1,o=0,a=this.targets.length;a>o;++o)if(n=this.targets[o],i=this.testTarget(n,e)){if(this.greedy){s=i,s.target=n,r=!0;break}(i.rank<s.rank||i.rank===s.rank&&i.dist<s.dist)&&(s=i,s.target=n,r=!0)}if(r){var l=this.events.triggerEvent("beforesnap",{point:t,x:s.x,y:s.y,distance:s.dist,layer:s.target.layer,snapType:this.precedence[s.rank]});l!==!1?(t.x=s.x,t.y=s.y,this.point=t,this.events.triggerEvent("snap",{point:t,snapType:this.precedence[s.rank],layer:s.target.layer,distance:s.dist})):r=!1}this.point&&!r&&(t.x=e.x,t.y=e.y,this.point=null,this.events.triggerEvent("unsnap",{point:t}))},testTarget:function(t,e){var i=this.layer.map.getResolution();if("minResolution"in t&&i<t.minResolution)return null;if("maxResolution"in t&&i>=t.maxResolution)return null;for(var n,s,r,o,a,l,h,u={node:this.getGeoTolerance(t.nodeTolerance,i),vertex:this.getGeoTolerance(t.vertexTolerance,i),edge:this.getGeoTolerance(t.edgeTolerance,i)},p=Math.max(u.node,u.vertex,u.edge),c={rank:Number.POSITIVE_INFINITY,dist:Number.POSITIVE_INFINITY},d=!1,m=t.layer.features,f=this.precedence.length,y=new OpenLayers.LonLat(e.x,e.y),g=0,v=m.length;v>g;++g)if(n=m[g],n!==this.feature&&!n._sketch&&n.state!==OpenLayers.State.DELETE&&(!t.filter||t.filter.evaluate(n))&&n.atPoint(y,p,p))for(var L=0,_=Math.min(c.rank+1,f);_>L;++L)if(s=this.precedence[L],t[s])if("edge"===s){if(a=n.geometry.distanceTo(e,{details:!0}),l=a.distance,l<=u[s]&&l<c.dist){c={rank:L,dist:l,x:a.x0,y:a.y0},d=!0;break}}else{r=n.geometry.getVertices("node"===s),h=!1;for(var O=0,b=r.length;b>O;++O)o=r[O],l=o.distanceTo(e),l<=u[s]&&(L<c.rank||L===c.rank&&l<c.dist)&&(c={rank:L,dist:l,x:o.x,y:o.y},d=!0,h=!0);if(h)break}return d?c:null},getGeoTolerance:function(t,e){e!==this.resolution&&(this.resolution=e,this.geoToleranceCache={});var i=this.geoToleranceCache[t];return void 0===i&&(i=t*e,this.geoToleranceCache[t]=i),i},destroy:function(){this.active&&this.deactivate(),delete this.layer,delete this.targets,OpenLayers.Control.prototype.destroy.call(this)},CLASS_NAME:"OpenLayers.Control.Snapping"}),OpenLayers.Format.OWSCommon.v1_1_0=OpenLayers.Class(OpenLayers.Format.OWSCommon.v1,{namespaces:{ows:"http://www.opengis.net/ows/1.1",xlink:"http://www.w3.org/1999/xlink"},readers:{ows:OpenLayers.Util.applyDefaults({ExceptionReport:function(t,e){e.exceptionReport={version:t.getAttribute("version"),language:t.getAttribute("xml:lang"),exceptions:[]},this.readChildNodes(t,e.exceptionReport)},AllowedValues:function(t,e){e.allowedValues={},this.readChildNodes(t,e.allowedValues)},AnyValue:function(t,e){e.anyValue=!0},DataType:function(t,e){e.dataType=this.getChildValue(t)},Range:function(t,e){e.range={},this.readChildNodes(t,e.range)},MinimumValue:function(t,e){e.minValue=this.getChildValue(t)},MaximumValue:function(t,e){e.maxValue=this.getChildValue(t)},Identifier:function(t,e){e.identifier=this.getChildValue(t)},SupportedCRS:function(t,e){e.supportedCRS=this.getChildValue(t)}},OpenLayers.Format.OWSCommon.v1.prototype.readers.ows)},writers:{ows:OpenLayers.Util.applyDefaults({Range:function(t){var e=this.createElementNSPlus("ows:Range",{attributes:{"ows:rangeClosure":t.closure}});return this.writeNode("ows:MinimumValue",t.minValue,e),this.writeNode("ows:MaximumValue",t.maxValue,e),e},MinimumValue:function(t){var e=this.createElementNSPlus("ows:MinimumValue",{value:t});return e},MaximumValue:function(t){var e=this.createElementNSPlus("ows:MaximumValue",{value:t});return e},Value:function(t){var e=this.createElementNSPlus("ows:Value",{value:t});return e}},OpenLayers.Format.OWSCommon.v1.prototype.writers.ows)},CLASS_NAME:"OpenLayers.Format.OWSCommon.v1_1_0"}),OpenLayers.Format.WCSGetCoverage=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{ows:"http://www.opengis.net/ows/1.1",wcs:"http://www.opengis.net/wcs/1.1",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance"},regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},VERSION:"1.1.2",schemaLocation:"http://www.opengis.net/wcs/1.1 http://schemas.opengis.net/wcs/1.1/wcsGetCoverage.xsd",write:function(t){var e=this.writeNode("wcs:GetCoverage",t);return this.setAttributeNS(e,this.namespaces.xsi,"xsi:schemaLocation",this.schemaLocation),OpenLayers.Format.XML.prototype.write.apply(this,[e])},writers:{wcs:{GetCoverage:function(t){var e=this.createElementNSPlus("wcs:GetCoverage",{attributes:{version:t.version||this.VERSION,service:"WCS"}});return this.writeNode("ows:Identifier",t.identifier,e),this.writeNode("wcs:DomainSubset",t.domainSubset,e),this.writeNode("wcs:Output",t.output,e),e},DomainSubset:function(t){var e=this.createElementNSPlus("wcs:DomainSubset",{});return this.writeNode("ows:BoundingBox",t.boundingBox,e),t.temporalSubset&&this.writeNode("wcs:TemporalSubset",t.temporalSubset,e),e},TemporalSubset:function(t){for(var e=this.createElementNSPlus("wcs:TemporalSubset",{}),i=0,n=t.timePeriods.length;n>i;++i)this.writeNode("wcs:TimePeriod",t.timePeriods[i],e);return e},TimePeriod:function(t){var e=this.createElementNSPlus("wcs:TimePeriod",{});return this.writeNode("wcs:BeginPosition",t.begin,e),this.writeNode("wcs:EndPosition",t.end,e),t.resolution&&this.writeNode("wcs:TimeResolution",t.resolution,e),e},BeginPosition:function(t){var e=this.createElementNSPlus("wcs:BeginPosition",{value:t});return e},EndPosition:function(t){var e=this.createElementNSPlus("wcs:EndPosition",{value:t});return e},TimeResolution:function(t){var e=this.createElementNSPlus("wcs:TimeResolution",{value:t});return e},Output:function(t){var e=this.createElementNSPlus("wcs:Output",{attributes:{format:t.format,store:t.store}});return t.gridCRS&&this.writeNode("wcs:GridCRS",t.gridCRS,e),e},GridCRS:function(t){var e=this.createElementNSPlus("wcs:GridCRS",{});return this.writeNode("wcs:GridBaseCRS",t.baseCRS,e),t.type&&this.writeNode("wcs:GridType",t.type,e),t.origin&&this.writeNode("wcs:GridOrigin",t.origin,e),this.writeNode("wcs:GridOffsets",t.offsets,e),t.CS&&this.writeNode("wcs:GridCS",t.CS,e),e},GridBaseCRS:function(t){return this.createElementNSPlus("wcs:GridBaseCRS",{value:t})},GridOrigin:function(t){return this.createElementNSPlus("wcs:GridOrigin",{value:t})},GridType:function(t){return this.createElementNSPlus("wcs:GridType",{value:t})},GridOffsets:function(t){return this.createElementNSPlus("wcs:GridOffsets",{value:t})},GridCS:function(t){return this.createElementNSPlus("wcs:GridCS",{value:t})}},ows:OpenLayers.Format.OWSCommon.v1_1_0.prototype.writers.ows},CLASS_NAME:"OpenLayers.Format.WCSGetCoverage"}),OpenLayers.Format.WMSCapabilities=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,{defaultVersion:"1.1.1",profile:null,CLASS_NAME:"OpenLayers.Format.WMSCapabilities"}),OpenLayers.Format.WMSCapabilities.v1=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{wms:"http://www.opengis.net/wms",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance"},defaultPrefix:"wms",read:function(t){"string"==typeof t&&(t=OpenLayers.Format.XML.prototype.read.apply(this,[t]));var e=t;t&&9==t.nodeType&&(t=t.documentElement);var i={};if(this.readNode(t,i),void 0===i.service){var n=new OpenLayers.Format.OGCExceptionReport;i.error=n.read(e)}return i},readers:{wms:{Service:function(t,e){e.service={},this.readChildNodes(t,e.service)},Name:function(t,e){e.name=this.getChildValue(t)},Title:function(t,e){e.title=this.getChildValue(t)},Abstract:function(t,e){e["abstract"]=this.getChildValue(t)},BoundingBox:function(t){var e={};e.bbox=[parseFloat(t.getAttribute("minx")),parseFloat(t.getAttribute("miny")),parseFloat(t.getAttribute("maxx")),parseFloat(t.getAttribute("maxy"))];var i={x:parseFloat(t.getAttribute("resx")),y:parseFloat(t.getAttribute("resy"))};return isNaN(i.x)&&isNaN(i.y)||(e.res=i),e},OnlineResource:function(t,e){e.href=this.getAttributeNS(t,this.namespaces.xlink,"href")},ContactInformation:function(t,e){e.contactInformation={},this.readChildNodes(t,e.contactInformation)},ContactPersonPrimary:function(t,e){e.personPrimary={},this.readChildNodes(t,e.personPrimary)},ContactPerson:function(t,e){e.person=this.getChildValue(t)},ContactOrganization:function(t,e){e.organization=this.getChildValue(t)},ContactPosition:function(t,e){e.position=this.getChildValue(t)},ContactAddress:function(t,e){e.contactAddress={},this.readChildNodes(t,e.contactAddress)},AddressType:function(t,e){e.type=this.getChildValue(t)},Address:function(t,e){e.address=this.getChildValue(t)},City:function(t,e){e.city=this.getChildValue(t)},StateOrProvince:function(t,e){e.stateOrProvince=this.getChildValue(t)},PostCode:function(t,e){e.postcode=this.getChildValue(t)},Country:function(t,e){e.country=this.getChildValue(t)},ContactVoiceTelephone:function(t,e){e.phone=this.getChildValue(t)},ContactFacsimileTelephone:function(t,e){e.fax=this.getChildValue(t)},ContactElectronicMailAddress:function(t,e){e.email=this.getChildValue(t)},Fees:function(t,e){var i=this.getChildValue(t);i&&"none"!=i.toLowerCase()&&(e.fees=i)},AccessConstraints:function(t,e){var i=this.getChildValue(t);i&&"none"!=i.toLowerCase()&&(e.accessConstraints=i)},Capability:function(t,e){e.capability={nestedLayers:[],layers:[]},this.readChildNodes(t,e.capability)},Request:function(t,e){e.request={},this.readChildNodes(t,e.request)},GetCapabilities:function(t,e){e.getcapabilities={formats:[]},this.readChildNodes(t,e.getcapabilities)},Format:function(t,e){OpenLayers.Util.isArray(e.formats)?e.formats.push(this.getChildValue(t)):e.format=this.getChildValue(t)},DCPType:function(t,e){this.readChildNodes(t,e)},HTTP:function(t,e){this.readChildNodes(t,e)},Get:function(t,e){e.get={},this.readChildNodes(t,e.get),e.href||(e.href=e.get.href)},Post:function(t,e){e.post={},this.readChildNodes(t,e.post),e.href||(e.href=e.get.href)},GetMap:function(t,e){e.getmap={formats:[]},this.readChildNodes(t,e.getmap)},GetFeatureInfo:function(t,e){e.getfeatureinfo={formats:[]},this.readChildNodes(t,e.getfeatureinfo)},Exception:function(t,e){e.exception={formats:[]},this.readChildNodes(t,e.exception)},Layer:function(t,e){var i,n;e.capability?(n=e.capability,i=e):n=e;var s=t.getAttributeNode("queryable"),r=s&&s.specified?t.getAttribute("queryable"):null;s=t.getAttributeNode("cascaded");var o=s&&s.specified?t.getAttribute("cascaded"):null;s=t.getAttributeNode("opaque");var a=s&&s.specified?t.getAttribute("opaque"):null,l=t.getAttribute("noSubsets"),h=t.getAttribute("fixedWidth"),u=t.getAttribute("fixedHeight"),p=i||{},c=OpenLayers.Util.extend,d={nestedLayers:[],styles:i?[].concat(i.styles):[],srs:i?c({},p.srs):{},metadataURLs:[],bbox:i?c({},p.bbox):{},llbbox:p.llbbox,dimensions:i?c({},p.dimensions):{},authorityURLs:i?c({},p.authorityURLs):{},identifiers:{},keywords:[],queryable:r&&""!==r?"1"===r||"true"===r:p.queryable||!1,cascaded:null!==o?parseInt(o):p.cascaded||0,opaque:a?"1"===a||"true"===a:p.opaque||!1,noSubsets:null!==l?"1"===l||"true"===l:p.noSubsets||!1,fixedWidth:null!=h?parseInt(h):p.fixedWidth||0,fixedHeight:null!=u?parseInt(u):p.fixedHeight||0,minScale:p.minScale,maxScale:p.maxScale,attribution:p.attribution};if(e.nestedLayers.push(d),d.capability=n,this.readChildNodes(t,d),delete d.capability,d.name){var m=d.name.split(":"),f=n.request,y=f.getfeatureinfo;m.length>0&&(d.prefix=m[0]),n.layers.push(d),void 0===d.formats&&(d.formats=f.getmap.formats),void 0===d.infoFormats&&y&&(d.infoFormats=y.formats)}},Attribution:function(t,e){e.attribution={},this.readChildNodes(t,e.attribution)},LogoURL:function(t,e){e.logo={width:t.getAttribute("width"),height:t.getAttribute("height")},this.readChildNodes(t,e.logo)},Style:function(t,e){var i={};e.styles.push(i),this.readChildNodes(t,i)},LegendURL:function(t,e){var i={width:t.getAttribute("width"),height:t.getAttribute("height")};e.legend=i,this.readChildNodes(t,i)},MetadataURL:function(t,e){var i={type:t.getAttribute("type")};e.metadataURLs.push(i),this.readChildNodes(t,i)},DataURL:function(t,e){e.dataURL={},this.readChildNodes(t,e.dataURL)},FeatureListURL:function(t,e){e.featureListURL={},this.readChildNodes(t,e.featureListURL)},AuthorityURL:function(t,e){var i=t.getAttribute("name"),n={};this.readChildNodes(t,n),e.authorityURLs[i]=n.href},Identifier:function(t,e){var i=t.getAttribute("authority");e.identifiers[i]=this.getChildValue(t)},KeywordList:function(t,e){this.readChildNodes(t,e)},SRS:function(t,e){e.srs[this.getChildValue(t)]=!0}}},CLASS_NAME:"OpenLayers.Format.WMSCapabilities.v1"}),OpenLayers.Format.WMSCapabilities.v1_1=OpenLayers.Class(OpenLayers.Format.WMSCapabilities.v1,{readers:{wms:OpenLayers.Util.applyDefaults({WMT_MS_Capabilities:function(t,e){this.readChildNodes(t,e)},Keyword:function(t,e){e.keywords&&e.keywords.push(this.getChildValue(t))},DescribeLayer:function(t,e){e.describelayer={formats:[]},this.readChildNodes(t,e.describelayer)},GetLegendGraphic:function(t,e){e.getlegendgraphic={formats:[]},this.readChildNodes(t,e.getlegendgraphic)},GetStyles:function(t,e){e.getstyles={formats:[]},this.readChildNodes(t,e.getstyles)},PutStyles:function(t,e){e.putstyles={formats:[]},this.readChildNodes(t,e.putstyles)},UserDefinedSymbolization:function(t,e){var i={supportSLD:1==parseInt(t.getAttribute("SupportSLD")),userLayer:1==parseInt(t.getAttribute("UserLayer")),userStyle:1==parseInt(t.getAttribute("UserStyle")),remoteWFS:1==parseInt(t.getAttribute("RemoteWFS"))};e.userSymbols=i},LatLonBoundingBox:function(t,e){e.llbbox=[parseFloat(t.getAttribute("minx")),parseFloat(t.getAttribute("miny")),parseFloat(t.getAttribute("maxx")),parseFloat(t.getAttribute("maxy"))]},BoundingBox:function(t,e){var i=OpenLayers.Format.WMSCapabilities.v1.prototype.readers.wms.BoundingBox.apply(this,[t,e]);i.srs=t.getAttribute("SRS"),e.bbox[i.srs]=i},ScaleHint:function(t,e){var i=t.getAttribute("min"),n=t.getAttribute("max"),s=Math.pow(2,.5),r=OpenLayers.INCHES_PER_UNIT.m;0!=i&&(e.maxScale=parseFloat((i/s*r*OpenLayers.DOTS_PER_INCH).toPrecision(13))),n!=Number.POSITIVE_INFINITY&&(e.minScale=parseFloat((n/s*r*OpenLayers.DOTS_PER_INCH).toPrecision(13)))},Dimension:function(t,e){var i=t.getAttribute("name").toLowerCase(),n={name:i,units:t.getAttribute("units"),unitsymbol:t.getAttribute("unitSymbol")};e.dimensions[n.name]=n},Extent:function(t,e){var i=t.getAttribute("name").toLowerCase();if(i in e.dimensions){var n=e.dimensions[i];n.nearestVal="1"===t.getAttribute("nearestValue"),n.multipleVal="1"===t.getAttribute("multipleValues"),n.current="1"===t.getAttribute("current"),n["default"]=t.getAttribute("default")||"";var s=this.getChildValue(t);n.values=s.split(",")}}},OpenLayers.Format.WMSCapabilities.v1.prototype.readers.wms)},CLASS_NAME:"OpenLayers.Format.WMSCapabilities.v1_1"}),OpenLayers.Format.WMSCapabilities.v1_1_0=OpenLayers.Class(OpenLayers.Format.WMSCapabilities.v1_1,{version:"1.1.0",readers:{wms:OpenLayers.Util.applyDefaults({SRS:function(t,e){for(var i=this.getChildValue(t),n=i.split(/ +/),s=0,r=n.length;r>s;s++)e.srs[n[s]]=!0}},OpenLayers.Format.WMSCapabilities.v1_1.prototype.readers.wms)},CLASS_NAME:"OpenLayers.Format.WMSCapabilities.v1_1_0"}),OpenLayers.Protocol.WFS.v1=OpenLayers.Class(OpenLayers.Protocol,{version:null,srsName:"EPSG:4326",featureType:null,featureNS:null,geometryName:"the_geom",schema:null,featurePrefix:"feature",formatOptions:null,readFormat:null,readOptions:null,initialize:function(t){OpenLayers.Protocol.prototype.initialize.apply(this,[t]),t.format||(this.format=OpenLayers.Format.WFST(OpenLayers.Util.extend({version:this.version,featureType:this.featureType,featureNS:this.featureNS,featurePrefix:this.featurePrefix,geometryName:this.geometryName,srsName:this.srsName,schema:this.schema},this.formatOptions))),!t.geometryName&&parseFloat(this.format.version)>1&&this.setGeometryName(null)},destroy:function(){this.options&&!this.options.format&&this.format.destroy(),this.format=null,OpenLayers.Protocol.prototype.destroy.apply(this)},read:function(t){OpenLayers.Protocol.prototype.read.apply(this,arguments),t=OpenLayers.Util.extend({},t),OpenLayers.Util.applyDefaults(t,this.options||{});var e=new OpenLayers.Protocol.Response({requestType:"read"}),i=OpenLayers.Format.XML.prototype.write.apply(this.format,[this.format.writeNode("wfs:GetFeature",t)]);return e.priv=OpenLayers.Request.POST({url:t.url,callback:this.createCallback(this.handleRead,e,t),params:t.params,headers:t.headers,data:i}),e},setFeatureType:function(t){this.featureType=t,this.format.featureType=t},setGeometryName:function(t){this.geometryName=t,this.format.geometryName=t},handleRead:function(t,e){if(e=OpenLayers.Util.extend({},e),OpenLayers.Util.applyDefaults(e,this.options),e.callback){var i=t.priv;if(i.status>=200&&i.status<300){var n=this.parseResponse(i,e.readOptions);n&&n.success!==!1?(e.readOptions&&"object"==e.readOptions.output?OpenLayers.Util.extend(t,n):t.features=n,t.code=OpenLayers.Protocol.Response.SUCCESS):(t.code=OpenLayers.Protocol.Response.FAILURE,t.error=n)}else t.code=OpenLayers.Protocol.Response.FAILURE;e.callback.call(e.scope,t)}},parseResponse:function(t,e){var i=t.responseXML;if(i&&i.documentElement||(i=t.responseText),!i||i.length<=0)return null;var n=null!==this.readFormat?this.readFormat.read(i):this.format.read(i,e);if(!this.featureNS){var s=this.readFormat||this.format;this.featureNS=s.featureNS,s.autoConfig=!1,this.geometryName||this.setGeometryName(s.geometryName)}return n},commit:function(t,e){e=OpenLayers.Util.extend({},e),OpenLayers.Util.applyDefaults(e,this.options);var i=new OpenLayers.Protocol.Response({requestType:"commit",reqFeatures:t});return i.priv=OpenLayers.Request.POST({url:e.url,headers:e.headers,data:this.format.write(t,e),callback:this.createCallback(this.handleCommit,i,e)}),i},handleCommit:function(t,e){if(e.callback){var i=t.priv,n=i.responseXML;n&&n.documentElement||(n=i.responseText);var s=this.format.read(n)||{};t.insertIds=s.insertIds||[],s.success?t.code=OpenLayers.Protocol.Response.SUCCESS:(t.code=OpenLayers.Protocol.Response.FAILURE,t.error=s),e.callback.call(e.scope,t)}},filterDelete:function(t,e){e=OpenLayers.Util.extend({},e),OpenLayers.Util.applyDefaults(e,this.options);var i=(new OpenLayers.Protocol.Response({requestType:"commit"}),this.format.createElementNSPlus("wfs:Transaction",{attributes:{service:"WFS",version:this.version}})),n=this.format.createElementNSPlus("wfs:Delete",{attributes:{typeName:(e.featureNS?this.featurePrefix+":":"")+e.featureType}});e.featureNS&&n.setAttribute("xmlns:"+this.featurePrefix,e.featureNS);var s=this.format.writeNode("ogc:Filter",t);n.appendChild(s),i.appendChild(n);var r=OpenLayers.Format.XML.prototype.write.apply(this.format,[i]);return OpenLayers.Request.POST({url:this.url,callback:e.callback||function(){},data:r})
},abort:function(t){t&&t.priv.abort()},CLASS_NAME:"OpenLayers.Protocol.WFS.v1"}),OpenLayers.Handler.Feature=OpenLayers.Class(OpenLayers.Handler,{EVENTMAP:{click:{"in":"click",out:"clickout"},mousemove:{"in":"over",out:"out"},dblclick:{"in":"dblclick",out:null},mousedown:{"in":null,out:null},mouseup:{"in":null,out:null},touchstart:{"in":"click",out:"clickout"}},feature:null,lastFeature:null,down:null,up:null,clickTolerance:4,geometryTypes:null,stopClick:!0,stopDown:!0,stopUp:!1,initialize:function(t,e,i,n){OpenLayers.Handler.prototype.initialize.apply(this,[t,i,n]),this.layer=e},touchstart:function(t){return this.startTouch(),OpenLayers.Event.isMultiTouch(t)?!0:this.mousedown(t)},touchmove:function(t){OpenLayers.Event.preventDefault(t)},mousedown:function(t){return(OpenLayers.Event.isLeftClick(t)||OpenLayers.Event.isSingleTouch(t))&&(this.down=t.xy),this.handle(t)?!this.stopDown:!0},mouseup:function(t){return this.up=t.xy,this.handle(t)?!this.stopUp:!0},click:function(t){return this.handle(t)?!this.stopClick:!0},mousemove:function(t){return this.callbacks.over||this.callbacks.out?(this.handle(t),!0):!0},dblclick:function(t){return!this.handle(t)},geometryTypeMatches:function(t){return null==this.geometryTypes||OpenLayers.Util.indexOf(this.geometryTypes,t.geometry.CLASS_NAME)>-1},handle:function(t){this.feature&&!this.feature.layer&&(this.feature=null);var e=t.type,i=!1,n=!!this.feature,s="click"==e||"dblclick"==e||"touchstart"==e;if(this.feature=this.layer.getFeatureFromEvent(t),this.feature&&!this.feature.layer&&(this.feature=null),this.lastFeature&&!this.lastFeature.layer&&(this.lastFeature=null),this.feature){"touchstart"===e&&OpenLayers.Event.preventDefault(t);var r=this.feature!=this.lastFeature;this.geometryTypeMatches(this.feature)?(n&&r?(this.lastFeature&&this.triggerCallback(e,"out",[this.lastFeature]),this.triggerCallback(e,"in",[this.feature])):(!n||s)&&this.triggerCallback(e,"in",[this.feature]),this.lastFeature=this.feature,i=!0):(this.lastFeature&&(n&&r||s)&&this.triggerCallback(e,"out",[this.lastFeature]),this.feature=null)}else this.lastFeature&&(n||s)&&this.triggerCallback(e,"out",[this.lastFeature]);return i},triggerCallback:function(t,e,i){var n=this.EVENTMAP[t][e];if(n)if("click"==t&&this.up&&this.down){var s=Math.sqrt(Math.pow(this.up.x-this.down.x,2)+Math.pow(this.up.y-this.down.y,2));s<=this.clickTolerance&&this.callback(n,i),this.up=this.down=null}else this.callback(n,i)},activate:function(){var t=!1;return OpenLayers.Handler.prototype.activate.apply(this,arguments)&&(this.moveLayerToTop(),this.map.events.on({removelayer:this.handleMapEvents,changelayer:this.handleMapEvents,scope:this}),t=!0),t},deactivate:function(){var t=!1;return OpenLayers.Handler.prototype.deactivate.apply(this,arguments)&&(this.moveLayerBack(),this.feature=null,this.lastFeature=null,this.down=null,this.up=null,this.map.events.un({removelayer:this.handleMapEvents,changelayer:this.handleMapEvents,scope:this}),t=!0),t},handleMapEvents:function(t){("removelayer"==t.type||"order"==t.property)&&this.moveLayerToTop()},moveLayerToTop:function(){var t=Math.max(this.map.Z_INDEX_BASE.Feature-1,this.layer.getZIndex())+1;this.layer.setZIndex(t)},moveLayerBack:function(){var t=this.layer.getZIndex()-1;t>=this.map.Z_INDEX_BASE.Feature?this.layer.setZIndex(t):this.map.setLayerZIndex(this.layer,this.map.getLayerIndex(this.layer))},CLASS_NAME:"OpenLayers.Handler.Feature"}),OpenLayers.Layer.Vector.RootContainer=OpenLayers.Class(OpenLayers.Layer.Vector,{displayInLayerSwitcher:!1,layers:null,display:function(){},getFeatureFromEvent:function(t){for(var e,i=this.layers,n=0;n<i.length;n++)if(e=i[n].getFeatureFromEvent(t))return e},setMap:function(t){OpenLayers.Layer.Vector.prototype.setMap.apply(this,arguments),this.collectRoots(),t.events.register("changelayer",this,this.handleChangeLayer)},removeMap:function(t){t.events.unregister("changelayer",this,this.handleChangeLayer),this.resetRoots(),OpenLayers.Layer.Vector.prototype.removeMap.apply(this,arguments)},collectRoots:function(){for(var t,e=0;e<this.map.layers.length;++e)t=this.map.layers[e],-1!=OpenLayers.Util.indexOf(this.layers,t)&&t.renderer.moveRoot(this.renderer)},resetRoots:function(){for(var t,e=0;e<this.layers.length;++e)t=this.layers[e],this.renderer&&t.renderer.getRenderLayerId()==this.id&&this.renderer.moveRoot(t.renderer)},handleChangeLayer:function(t){var e=t.layer;"order"==t.property&&-1!=OpenLayers.Util.indexOf(this.layers,e)&&(this.resetRoots(),this.collectRoots())},CLASS_NAME:"OpenLayers.Layer.Vector.RootContainer"}),OpenLayers.Control.SelectFeature=OpenLayers.Class(OpenLayers.Control,{multipleKey:null,toggleKey:null,multiple:!1,clickout:!0,toggle:!1,hover:!1,highlightOnly:!1,box:!1,onBeforeSelect:function(){},onSelect:function(){},onUnselect:function(){},scope:null,geometryTypes:null,layer:null,layers:null,callbacks:null,selectStyle:null,renderIntent:"select",handlers:null,initialize:function(t,e){OpenLayers.Control.prototype.initialize.apply(this,[e]),null===this.scope&&(this.scope=this),this.initLayer(t);var i={click:this.clickFeature,clickout:this.clickoutFeature};this.hover&&(i.over=this.overFeature,i.out=this.outFeature),this.callbacks=OpenLayers.Util.extend(i,this.callbacks),this.handlers={feature:new OpenLayers.Handler.Feature(this,this.layer,this.callbacks,{geometryTypes:this.geometryTypes})},this.box&&(this.handlers.box=new OpenLayers.Handler.Box(this,{done:this.selectBox},{boxDivClassName:"olHandlerBoxSelectFeature"}))},initLayer:function(t){OpenLayers.Util.isArray(t)?(this.layers=t,this.layer=new OpenLayers.Layer.Vector.RootContainer(this.id+"_container",{layers:t})):this.layer=t},destroy:function(){this.active&&this.layers&&this.map.removeLayer(this.layer),OpenLayers.Control.prototype.destroy.apply(this,arguments),this.layers&&this.layer.destroy()},activate:function(){return this.active||(this.layers&&this.map.addLayer(this.layer),this.handlers.feature.activate(),this.box&&this.handlers.box&&this.handlers.box.activate()),OpenLayers.Control.prototype.activate.apply(this,arguments)},deactivate:function(){return this.active&&(this.handlers.feature.deactivate(),this.handlers.box&&this.handlers.box.deactivate(),this.layers&&this.map.removeLayer(this.layer)),OpenLayers.Control.prototype.deactivate.apply(this,arguments)},unselectAll:function(t){var e,i,n,s,r=this.layers||[this.layer];for(n=0;n<r.length;++n)if(e=r[n],s=0,null!=e.selectedFeatures)for(;e.selectedFeatures.length>s;)i=e.selectedFeatures[s],t&&t.except==i?++s:this.unselect(i)},clickFeature:function(t){if(!this.hover){var e=OpenLayers.Util.indexOf(t.layer.selectedFeatures,t)>-1;e?this.toggleSelect()?this.unselect(t):this.multipleSelect()||this.unselectAll({except:t}):(this.multipleSelect()||this.unselectAll({except:t}),this.select(t))}},multipleSelect:function(){return this.multiple||this.handlers.feature.evt&&this.handlers.feature.evt[this.multipleKey]},toggleSelect:function(){return this.toggle||this.handlers.feature.evt&&this.handlers.feature.evt[this.toggleKey]},clickoutFeature:function(){!this.hover&&this.clickout&&this.unselectAll()},overFeature:function(t){var e=t.layer;this.hover&&(this.highlightOnly?this.highlight(t):-1==OpenLayers.Util.indexOf(e.selectedFeatures,t)&&this.select(t))},outFeature:function(t){if(this.hover)if(this.highlightOnly){if(t._lastHighlighter==this.id)if(t._prevHighlighter&&t._prevHighlighter!=this.id){delete t._lastHighlighter;var e=this.map.getControl(t._prevHighlighter);e&&e.highlight(t)}else this.unhighlight(t)}else this.unselect(t)},highlight:function(t){var e=t.layer,i=this.events.triggerEvent("beforefeaturehighlighted",{feature:t});if(i!==!1){t._prevHighlighter=t._lastHighlighter,t._lastHighlighter=this.id;var n=this.selectStyle||this.renderIntent;e.drawFeature(t,n),this.events.triggerEvent("featurehighlighted",{feature:t})}},unhighlight:function(t){var e=t.layer;void 0==t._prevHighlighter?delete t._lastHighlighter:t._prevHighlighter==this.id?delete t._prevHighlighter:(t._lastHighlighter=t._prevHighlighter,delete t._prevHighlighter),e.drawFeature(t,t.style||t.layer.style||"default"),this.events.triggerEvent("featureunhighlighted",{feature:t})},select:function(t){var e=this.onBeforeSelect.call(this.scope,t),i=t.layer;e!==!1&&(e=i.events.triggerEvent("beforefeatureselected",{feature:t}),e!==!1&&(i.selectedFeatures.push(t),this.highlight(t),this.handlers.feature.lastFeature||(this.handlers.feature.lastFeature=i.selectedFeatures[0]),i.events.triggerEvent("featureselected",{feature:t}),this.onSelect.call(this.scope,t)))},unselect:function(t){var e=t.layer;this.unhighlight(t),OpenLayers.Util.removeItem(e.selectedFeatures,t),e.events.triggerEvent("featureunselected",{feature:t}),this.onUnselect.call(this.scope,t)},selectBox:function(t){if(t instanceof OpenLayers.Bounds){var e=this.map.getLonLatFromPixel({x:t.left,y:t.bottom}),i=this.map.getLonLatFromPixel({x:t.right,y:t.top}),n=new OpenLayers.Bounds(e.lon,e.lat,i.lon,i.lat);this.multipleSelect()||this.unselectAll();var s=this.multiple;this.multiple=!0;var r=this.layers||[this.layer];this.events.triggerEvent("boxselectionstart",{layers:r});for(var o,a=0;a<r.length;++a){o=r[a];for(var l=0,h=o.features.length;h>l;++l){var u=o.features[l];u.getVisibility()&&(null==this.geometryTypes||OpenLayers.Util.indexOf(this.geometryTypes,u.geometry.CLASS_NAME)>-1)&&n.toGeometry().intersects(u.geometry)&&-1==OpenLayers.Util.indexOf(o.selectedFeatures,u)&&this.select(u)}}this.multiple=s,this.events.triggerEvent("boxselectionend",{layers:r})}},setMap:function(t){this.handlers.feature.setMap(t),this.box&&this.handlers.box.setMap(t),OpenLayers.Control.prototype.setMap.apply(this,arguments)},setLayer:function(t){var e=this.active;this.unselectAll(),this.deactivate(),this.layers&&(this.layer.destroy(),this.layers=null),this.initLayer(t),this.handlers.feature.layer=this.layer,e&&this.activate()},CLASS_NAME:"OpenLayers.Control.SelectFeature"}),OpenLayers.Handler.Point=OpenLayers.Class(OpenLayers.Handler,{point:null,layer:null,multi:!1,citeCompliant:!1,mouseDown:!1,stoppedDown:null,lastDown:null,lastUp:null,persist:!1,stopDown:!1,stopUp:!1,layerOptions:null,pixelTolerance:5,lastTouchPx:null,initialize:function(t,e,i){i&&i.layerOptions&&i.layerOptions.styleMap||(this.style=OpenLayers.Util.extend(OpenLayers.Feature.Vector.style["default"],{})),OpenLayers.Handler.prototype.initialize.apply(this,arguments)},activate:function(){if(!OpenLayers.Handler.prototype.activate.apply(this,arguments))return!1;var t=OpenLayers.Util.extend({displayInLayerSwitcher:!1,calculateInRange:OpenLayers.Function.True,wrapDateLine:this.citeCompliant},this.layerOptions);return this.layer=new OpenLayers.Layer.Vector(this.CLASS_NAME,t),this.map.addLayer(this.layer),!0},createFeature:function(t){var e=this.layer.getLonLatFromViewPortPx(t),i=new OpenLayers.Geometry.Point(e.lon,e.lat);this.point=new OpenLayers.Feature.Vector(i),this.callback("create",[this.point.geometry,this.point]),this.point.geometry.clearBounds(),this.layer.addFeatures([this.point],{silent:!0})},deactivate:function(){return OpenLayers.Handler.prototype.deactivate.apply(this,arguments)?(this.cancel(),null!=this.layer.map&&(this.destroyFeature(!0),this.layer.destroy(!1)),this.layer=null,!0):!1},destroyFeature:function(t){!this.layer||!t&&this.persist||this.layer.destroyFeatures(),this.point=null},destroyPersistedFeature:function(){var t=this.layer;t&&t.features.length>1&&this.layer.features[0].destroy()},finalize:function(t){var e=t?"cancel":"done";this.mouseDown=!1,this.lastDown=null,this.lastUp=null,this.lastTouchPx=null,this.callback(e,[this.geometryClone()]),this.destroyFeature(t)},cancel:function(){this.finalize(!0)},click:function(t){return OpenLayers.Event.stop(t),!1},dblclick:function(t){return OpenLayers.Event.stop(t),!1},modifyFeature:function(t){this.point||this.createFeature(t);var e=this.layer.getLonLatFromViewPortPx(t);this.point.geometry.x=e.lon,this.point.geometry.y=e.lat,this.callback("modify",[this.point.geometry,this.point,!1]),this.point.geometry.clearBounds(),this.drawFeature()},drawFeature:function(){this.layer.drawFeature(this.point,this.style)},getGeometry:function(){var t=this.point&&this.point.geometry;return t&&this.multi&&(t=new OpenLayers.Geometry.MultiPoint([t])),t},geometryClone:function(){var t=this.getGeometry();return t&&t.clone()},mousedown:function(t){return this.down(t)},touchstart:function(t){return this.startTouch(),this.lastTouchPx=t.xy,this.down(t)},mousemove:function(t){return this.move(t)},touchmove:function(t){return this.lastTouchPx=t.xy,this.move(t)},mouseup:function(t){return this.up(t)},touchend:function(t){return t.xy=this.lastTouchPx,this.up(t)},down:function(t){return this.mouseDown=!0,this.lastDown=t.xy,this.touch||this.modifyFeature(t.xy),this.stoppedDown=this.stopDown,!this.stopDown},move:function(t){return this.touch||this.mouseDown&&!this.stoppedDown||this.modifyFeature(t.xy),!0},up:function(t){return this.mouseDown=!1,this.stoppedDown=this.stopDown,this.checkModifiers(t)?this.lastUp&&this.lastUp.equals(t.xy)?!0:this.lastDown&&this.passesTolerance(this.lastDown,t.xy,this.pixelTolerance)?(this.touch&&this.modifyFeature(t.xy),this.persist&&this.destroyPersistedFeature(),this.lastUp=t.xy,this.finalize(),!this.stopUp):!0:!0},mouseout:function(t){OpenLayers.Util.mouseLeft(t,this.map.viewPortDiv)&&(this.stoppedDown=this.stopDown,this.mouseDown=!1)},passesTolerance:function(t,e,i){var n=!0;if(null!=i&&t&&e){var s=t.distanceTo(e);s>i&&(n=!1)}return n},CLASS_NAME:"OpenLayers.Handler.Point"}),OpenLayers.Handler.Path=OpenLayers.Class(OpenLayers.Handler.Point,{line:null,maxVertices:null,doubleTouchTolerance:20,freehand:!1,freehandToggle:"shiftKey",timerId:null,redoStack:null,createFeature:function(t){var e=this.layer.getLonLatFromViewPortPx(t),i=new OpenLayers.Geometry.Point(e.lon,e.lat);this.point=new OpenLayers.Feature.Vector(i),this.line=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString([this.point.geometry])),this.callback("create",[this.point.geometry,this.getSketch()]),this.point.geometry.clearBounds(),this.layer.addFeatures([this.line,this.point],{silent:!0})},destroyFeature:function(t){OpenLayers.Handler.Point.prototype.destroyFeature.call(this,t),this.line=null},destroyPersistedFeature:function(){var t=this.layer;t&&t.features.length>2&&this.layer.features[0].destroy()},removePoint:function(){this.point&&this.layer.removeFeatures([this.point])},addPoint:function(t){this.layer.removeFeatures([this.point]);var e=this.layer.getLonLatFromViewPortPx(t);this.point=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Point(e.lon,e.lat)),this.line.geometry.addComponent(this.point.geometry,this.line.geometry.components.length),this.layer.addFeatures([this.point]),this.callback("point",[this.point.geometry,this.getGeometry()]),this.callback("modify",[this.point.geometry,this.getSketch()]),this.drawFeature(),delete this.redoStack},insertXY:function(t,e){this.line.geometry.addComponent(new OpenLayers.Geometry.Point(t,e),this.getCurrentPointIndex()),this.drawFeature(),delete this.redoStack},insertDeltaXY:function(t,e){var i=this.getCurrentPointIndex()-1,n=this.line.geometry.components[i];!n||isNaN(n.x)||isNaN(n.y)||this.insertXY(n.x+t,n.y+e)},insertDirectionLength:function(t,e){t*=Math.PI/180;var i=e*Math.cos(t),n=e*Math.sin(t);this.insertDeltaXY(i,n)},insertDeflectionLength:function(t,e){var i=this.getCurrentPointIndex()-1;if(i>0){var n=this.line.geometry.components[i],s=this.line.geometry.components[i-1],r=Math.atan2(n.y-s.y,n.x-s.x);this.insertDirectionLength(180*r/Math.PI+t,e)}},getCurrentPointIndex:function(){return this.line.geometry.components.length-1},undo:function(){var t=this.line.geometry,e=t.components,i=this.getCurrentPointIndex()-1,n=e[i],s=t.removeComponent(n);if(s){if(this.touch&&i>0){e=t.components;var r=e[i-1],o=this.getCurrentPointIndex(),a=e[o];a.x=r.x,a.y=r.y}this.redoStack||(this.redoStack=[]),this.redoStack.push(n),this.drawFeature()}return s},redo:function(){var t=this.redoStack&&this.redoStack.pop();return t&&(this.line.geometry.addComponent(t,this.getCurrentPointIndex()),this.drawFeature()),!!t},freehandMode:function(t){return this.freehandToggle&&t[this.freehandToggle]?!this.freehand:this.freehand},modifyFeature:function(t,e){this.line||this.createFeature(t);var i=this.layer.getLonLatFromViewPortPx(t);this.point.geometry.x=i.lon,this.point.geometry.y=i.lat,this.callback("modify",[this.point.geometry,this.getSketch(),e]),this.point.geometry.clearBounds(),this.drawFeature()},drawFeature:function(){this.layer.drawFeature(this.line,this.style),this.layer.drawFeature(this.point,this.style)},getSketch:function(){return this.line},getGeometry:function(){var t=this.line&&this.line.geometry;return t&&this.multi&&(t=new OpenLayers.Geometry.MultiLineString([t])),t},touchstart:function(t){return this.timerId&&this.passesTolerance(this.lastTouchPx,t.xy,this.doubleTouchTolerance)?(this.finishGeometry(),window.clearTimeout(this.timerId),this.timerId=null,!1):(this.timerId&&(window.clearTimeout(this.timerId),this.timerId=null),this.timerId=window.setTimeout(OpenLayers.Function.bind(function(){this.timerId=null},this),300),OpenLayers.Handler.Point.prototype.touchstart.call(this,t))},down:function(t){var e=this.stopDown;return this.freehandMode(t)&&(e=!0,this.touch&&(this.modifyFeature(t.xy,!!this.lastUp),OpenLayers.Event.stop(t))),this.touch||this.lastDown&&this.passesTolerance(this.lastDown,t.xy,this.pixelTolerance)||this.modifyFeature(t.xy,!!this.lastUp),this.mouseDown=!0,this.lastDown=t.xy,this.stoppedDown=e,!e},move:function(t){return this.stoppedDown&&this.freehandMode(t)?(this.persist&&this.destroyPersistedFeature(),this.maxVertices&&this.line&&this.line.geometry.components.length===this.maxVertices?(this.removePoint(),this.finalize()):this.addPoint(t.xy),!1):(this.touch||this.mouseDown&&!this.stoppedDown||this.modifyFeature(t.xy,!!this.lastUp),!0)},up:function(t){return!this.mouseDown||this.lastUp&&this.lastUp.equals(t.xy)||(this.stoppedDown&&this.freehandMode(t)?(this.persist&&this.destroyPersistedFeature(),this.removePoint(),this.finalize()):this.passesTolerance(this.lastDown,t.xy,this.pixelTolerance)&&(this.touch&&this.modifyFeature(t.xy),null==this.lastUp&&this.persist&&this.destroyPersistedFeature(),this.addPoint(t.xy),this.lastUp=t.xy,this.line.geometry.components.length===this.maxVertices+1&&this.finishGeometry())),this.stoppedDown=this.stopDown,this.mouseDown=!1,!this.stopUp},finishGeometry:function(){var t=this.line.geometry.components.length-1;this.line.geometry.removeComponent(this.line.geometry.components[t]),this.removePoint(),this.finalize()},dblclick:function(t){return this.freehandMode(t)||this.finishGeometry(),!1},CLASS_NAME:"OpenLayers.Handler.Path"}),OpenLayers.Spherical=OpenLayers.Spherical||{},OpenLayers.Spherical.DEFAULT_RADIUS=6378137,OpenLayers.Spherical.computeDistanceBetween=function(t,e,i){var n=i||OpenLayers.Spherical.DEFAULT_RADIUS,s=Math.sin(Math.PI*(e.lon-t.lon)/360),r=Math.sin(Math.PI*(e.lat-t.lat)/360),o=r*r+s*s*Math.cos(Math.PI*t.lat/180)*Math.cos(Math.PI*e.lat/180);return 2*n*Math.atan2(Math.sqrt(o),Math.sqrt(1-o))},OpenLayers.Spherical.computeHeading=function(t,e){var i=Math.sin(Math.PI*(t.lon-e.lon)/180)*Math.cos(Math.PI*e.lat/180),n=Math.cos(Math.PI*t.lat/180)*Math.sin(Math.PI*e.lat/180)-Math.sin(Math.PI*t.lat/180)*Math.cos(Math.PI*e.lat/180)*Math.cos(Math.PI*(t.lon-e.lon)/180);return 180*Math.atan2(i,n)/Math.PI},OpenLayers.Control.CacheWrite=OpenLayers.Class(OpenLayers.Control,{layers:null,imageFormat:"image/png",quotaRegEx:/quota/i,setMap:function(t){OpenLayers.Control.prototype.setMap.apply(this,arguments);var e,i=this.layers||t.layers;for(e=i.length-1;e>=0;--e)this.addLayer({layer:i[e]});this.layers||t.events.on({addlayer:this.addLayer,removeLayer:this.removeLayer,scope:this})},addLayer:function(t){t.layer.events.on({tileloadstart:this.makeSameOrigin,tileloaded:this.onTileLoaded,scope:this})},removeLayer:function(t){t.layer.events.un({tileloadstart:this.makeSameOrigin,tileloaded:this.onTileLoaded,scope:this})},makeSameOrigin:function(t){if(this.active){var e=t.tile;if(e instanceof OpenLayers.Tile.Image&&!e.crossOriginKeyword&&"data:"!==e.url.substr(0,5)){var i=OpenLayers.Request.makeSameOrigin(e.url,OpenLayers.ProxyHost);OpenLayers.Control.CacheWrite.urlMap[i]=e.url,e.url=i}}},onTileLoaded:function(t){this.active&&!t.aborted&&t.tile instanceof OpenLayers.Tile.Image&&"data:"!==t.tile.url.substr(0,5)&&(this.cache({tile:t.tile}),delete OpenLayers.Control.CacheWrite.urlMap[t.tile.url])},cache:function(t){if(window.localStorage){var e=t.tile;try{var i=e.getCanvasContext();if(i){var n=OpenLayers.Control.CacheWrite.urlMap,s=n[e.url]||e.url;window.localStorage.setItem("olCache_"+s,i.canvas.toDataURL(this.imageFormat))}}catch(r){var o=r.name||r.message;o&&this.quotaRegEx.test(o)?this.events.triggerEvent("cachefull",{tile:e}):OpenLayers.Console.error(r.toString())}}},destroy:function(){if(this.layers||this.map){var t,e=this.layers||this.map.layers;for(t=e.length-1;t>=0;--t)this.removeLayer({layer:e[t]})}this.map&&this.map.events.un({addlayer:this.addLayer,removeLayer:this.removeLayer,scope:this}),OpenLayers.Control.prototype.destroy.apply(this,arguments)},CLASS_NAME:"OpenLayers.Control.CacheWrite"}),OpenLayers.Control.CacheWrite.clearCache=function(){if(window.localStorage){var t,e;for(t=window.localStorage.length-1;t>=0;--t)e=window.localStorage.key(t),"olCache_"===e.substr(0,8)&&window.localStorage.removeItem(e)}},OpenLayers.Control.CacheWrite.urlMap={},OpenLayers.Control.PanPanel=OpenLayers.Class(OpenLayers.Control.Panel,{slideFactor:50,slideRatio:null,initialize:function(t){OpenLayers.Control.Panel.prototype.initialize.apply(this,[t]);var t={slideFactor:this.slideFactor,slideRatio:this.slideRatio};this.addControls([new OpenLayers.Control.Pan(OpenLayers.Control.Pan.NORTH,t),new OpenLayers.Control.Pan(OpenLayers.Control.Pan.SOUTH,t),new OpenLayers.Control.Pan(OpenLayers.Control.Pan.EAST,t),new OpenLayers.Control.Pan(OpenLayers.Control.Pan.WEST,t)])},CLASS_NAME:"OpenLayers.Control.PanPanel"}),OpenLayers.Control.Attribution=OpenLayers.Class(OpenLayers.Control,{separator:", ",template:"${layers}",destroy:function(){this.map.events.un({removelayer:this.updateAttribution,addlayer:this.updateAttribution,changelayer:this.updateAttribution,changebaselayer:this.updateAttribution,scope:this}),OpenLayers.Control.prototype.destroy.apply(this,arguments)},draw:function(){return OpenLayers.Control.prototype.draw.apply(this,arguments),this.map.events.on({changebaselayer:this.updateAttribution,changelayer:this.updateAttribution,addlayer:this.updateAttribution,removelayer:this.updateAttribution,scope:this}),this.updateAttribution(),this.div},updateAttribution:function(){var t=[];if(this.map&&this.map.layers){for(var e=0,i=this.map.layers.length;i>e;e++){var n=this.map.layers[e];n.attribution&&n.getVisibility()&&-1===OpenLayers.Util.indexOf(t,n.attribution)&&t.push(n.attribution)}this.div.innerHTML=OpenLayers.String.format(this.template,{layers:t.join(this.separator)})}},CLASS_NAME:"OpenLayers.Control.Attribution"}),OpenLayers.Kinetic=OpenLayers.Class({threshold:0,deceleration:.0035,nbPoints:100,delay:200,points:void 0,timerId:void 0,initialize:function(t){OpenLayers.Util.extend(this,t)},begin:function(){OpenLayers.Animation.stop(this.timerId),this.timerId=void 0,this.points=[]},update:function(t){this.points.unshift({xy:t,tick:(new Date).getTime()}),this.points.length>this.nbPoints&&this.points.pop()},end:function(t){for(var e,i,n=(new Date).getTime(),s=0,r=this.points.length;r>s&&(i=this.points[s],!(n-i.tick>this.delay));s++)e=i;if(e){var o=(new Date).getTime()-e.tick,a=Math.sqrt(Math.pow(t.x-e.xy.x,2)+Math.pow(t.y-e.xy.y,2)),l=a/o;if(!(0==l||l<this.threshold)){var h=Math.asin((t.y-e.xy.y)/a);return e.xy.x<=t.x&&(h=Math.PI-h),{speed:l,theta:h}}}},move:function(t,e){var i=t.speed,n=Math.cos(t.theta),s=-Math.sin(t.theta),r=(new Date).getTime(),o=0,a=0,l=function(){if(null!=this.timerId){var t=(new Date).getTime()-r,l=-this.deceleration*Math.pow(t,2)/2+i*t,h=l*n,u=l*s,p={};p.end=!1;var c=-this.deceleration*t+i;0>=c&&(OpenLayers.Animation.stop(this.timerId),this.timerId=null,p.end=!0),p.x=h-o,p.y=u-a,o=h,a=u,e(p.x,p.y,p.end)}};this.timerId=OpenLayers.Animation.start(OpenLayers.Function.bind(l,this))},CLASS_NAME:"OpenLayers.Kinetic"}),OpenLayers.Format.WPSExecute=OpenLayers.Class(OpenLayers.Format.XML,OpenLayers.Format.Filter.v1_1_0,{namespaces:{ows:"http://www.opengis.net/ows/1.1",gml:"http://www.opengis.net/gml",wps:"http://www.opengis.net/wps/1.0.0",wfs:"http://www.opengis.net/wfs",ogc:"http://www.opengis.net/ogc",wcs:"http://www.opengis.net/wcs",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance"},regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},VERSION:"1.0.0",schemaLocation:"http://www.opengis.net/wps/1.0.0 http://schemas.opengis.net/wps/1.0.0/wpsAll.xsd",schemaLocationAttr:function(){return void 0},write:function(t){var e;window.ActiveXObject?(e=new ActiveXObject("Microsoft.XMLDOM"),this.xmldom=e):e=document.implementation.createDocument("","",null);var i=this.writeNode("wps:Execute",t,e);return this.setAttributeNS(i,this.namespaces.xsi,"xsi:schemaLocation",this.schemaLocation),OpenLayers.Format.XML.prototype.write.apply(this,[i])},read:function(t){"string"==typeof t&&(t=OpenLayers.Format.XML.prototype.read.apply(this,[t])),t&&9==t.nodeType&&(t=t.documentElement);var e={};return this.readNode(t,e),e},writers:{wps:{Execute:function(t){var e=this.createElementNSPlus("wps:Execute",{attributes:{version:this.VERSION,service:"WPS"}});return this.writeNode("ows:Identifier",t.identifier,e),this.writeNode("wps:DataInputs",t.dataInputs,e),this.writeNode("wps:ResponseForm",t.responseForm,e),e},ResponseForm:function(t){var e=this.createElementNSPlus("wps:ResponseForm",{});return t.rawDataOutput&&this.writeNode("wps:RawDataOutput",t.rawDataOutput,e),t.responseDocument&&this.writeNode("wps:ResponseDocument",t.responseDocument,e),e},ResponseDocument:function(t){var e=this.createElementNSPlus("wps:ResponseDocument",{attributes:{storeExecuteResponse:t.storeExecuteResponse,lineage:t.lineage,status:t.status}});if(t.outputs)for(var i=0,n=t.outputs.length;n>i;i++)this.writeNode("wps:Output",t.outputs[i],e);return e},Output:function(t){var e=this.createElementNSPlus("wps:Output",{attributes:{asReference:t.asReference,mimeType:t.mimeType,encoding:t.encoding,schema:t.schema}});return this.writeNode("ows:Identifier",t.identifier,e),this.writeNode("ows:Title",t.title,e),this.writeNode("ows:Abstract",t["abstract"],e),e},RawDataOutput:function(t){var e=this.createElementNSPlus("wps:RawDataOutput",{attributes:{mimeType:t.mimeType,encoding:t.encoding,schema:t.schema}});return this.writeNode("ows:Identifier",t.identifier,e),e},DataInputs:function(t){for(var e=this.createElementNSPlus("wps:DataInputs",{}),i=0,n=t.length;n>i;++i)this.writeNode("wps:Input",t[i],e);return e},Input:function(t){var e=this.createElementNSPlus("wps:Input",{});return this.writeNode("ows:Identifier",t.identifier,e),t.title&&this.writeNode("ows:Title",t.title,e),t.data&&this.writeNode("wps:Data",t.data,e),t.reference&&this.writeNode("wps:Reference",t.reference,e),t.boundingBoxData&&this.writeNode("wps:BoundingBoxData",t.boundingBoxData,e),e},Data:function(t){var e=this.createElementNSPlus("wps:Data",{});return t.literalData?this.writeNode("wps:LiteralData",t.literalData,e):t.complexData?this.writeNode("wps:ComplexData",t.complexData,e):t.boundingBoxData&&this.writeNode("ows:BoundingBox",t.boundingBoxData,e),e},LiteralData:function(t){var e=this.createElementNSPlus("wps:LiteralData",{attributes:{uom:t.uom},value:t.value});return e},ComplexData:function(t){var e=this.createElementNSPlus("wps:ComplexData",{attributes:{mimeType:t.mimeType,encoding:t.encoding,schema:t.schema}}),i=t.value;return e.appendChild("string"==typeof i?this.getXMLDoc().createCDATASection(t.value):i),e},Reference:function(t){var e=this.createElementNSPlus("wps:Reference",{attributes:{mimeType:t.mimeType,"xlink:href":t.href,method:t.method,encoding:t.encoding,schema:t.schema}});return t.body&&this.writeNode("wps:Body",t.body,e),e},BoundingBoxData:function(t,e){this.writers.ows.BoundingBox.apply(this,[t,e,"wps:BoundingBoxData"])},Body:function(t){var e=this.createElementNSPlus("wps:Body",{});return t.wcs?this.writeNode("wcs:GetCoverage",t.wcs,e):t.wfs?(this.featureType=t.wfs.featureType,this.version=t.wfs.version,this.writeNode("wfs:GetFeature",t.wfs,e)):this.writeNode("wps:Execute",t,e),e}},wcs:OpenLayers.Format.WCSGetCoverage.prototype.writers.wcs,wfs:OpenLayers.Format.WFST.v1_1_0.prototype.writers.wfs,ogc:OpenLayers.Format.Filter.v1_1_0.prototype.writers.ogc,ows:OpenLayers.Format.OWSCommon.v1_1_0.prototype.writers.ows},readers:{wps:{ExecuteResponse:function(t,e){e.executeResponse={lang:t.getAttribute("lang"),statusLocation:t.getAttribute("statusLocation"),serviceInstance:t.getAttribute("serviceInstance"),service:t.getAttribute("service")},this.readChildNodes(t,e.executeResponse)},Process:function(t,e){e.process={},this.readChildNodes(t,e.process)},Status:function(t,e){e.status={creationTime:t.getAttribute("creationTime")},this.readChildNodes(t,e.status)},ProcessSucceeded:function(t,e){e.processSucceeded=!0},ProcessOutputs:function(t,e){e.processOutputs=[],this.readChildNodes(t,e.processOutputs)},Output:function(t,e){var i={};this.readChildNodes(t,i),e.push(i)},Reference:function(t,e){e.reference={href:t.getAttribute("href"),mimeType:t.getAttribute("mimeType"),encoding:t.getAttribute("encoding"),schema:t.getAttribute("schema")}},Data:function(t,e){e.data={},this.readChildNodes(t,e)},LiteralData:function(t,e){e.literalData={dataType:t.getAttribute("dataType"),uom:t.getAttribute("uom"),value:this.getChildValue(t)}},ComplexData:function(t,e){if(e.complexData={mimeType:t.getAttribute("mimeType"),schema:t.getAttribute("schema"),encoding:t.getAttribute("encoding"),value:""},this.isSimpleContent(t)){var i;for(i=t.firstChild;i;i=i.nextSibling)switch(i.nodeType){case 3:case 4:e.complexData.value+=i.nodeValue}}else for(i=t.firstChild;i;i=i.nextSibling)1==i.nodeType&&(e.complexData.value=i)},BoundingBox:function(t,e){e.boundingBoxData={dimensions:t.getAttribute("dimensions"),crs:t.getAttribute("crs")},this.readChildNodes(t,e.boundingBoxData)}},ows:OpenLayers.Format.OWSCommon.v1_1_0.prototype.readers.ows},CLASS_NAME:"OpenLayers.Format.WPSExecute"}),OpenLayers.Layer.GeoRSS=OpenLayers.Class(OpenLayers.Layer.Markers,{location:null,features:null,formatOptions:null,selectedFeature:null,icon:null,popupSize:null,useFeedTitle:!0,initialize:function(t,e,i){OpenLayers.Layer.Markers.prototype.initialize.apply(this,[t,i]),this.location=e,this.features=[]},destroy:function(){OpenLayers.Layer.Markers.prototype.destroy.apply(this,arguments),this.clearFeatures(),this.features=null},loadRSS:function(){this.loaded||(this.events.triggerEvent("loadstart"),OpenLayers.Request.GET({url:this.location,success:this.parseData,scope:this}),this.loaded=!0)},moveTo:function(){OpenLayers.Layer.Markers.prototype.moveTo.apply(this,arguments),this.visibility&&!this.loaded&&this.loadRSS()},parseData:function(t){var e=t.responseXML;if(e&&e.documentElement||(e=OpenLayers.Format.XML.prototype.read(t.responseText)),this.useFeedTitle){var i=null;try{i=e.getElementsByTagNameNS("*","title")[0].firstChild.nodeValue}catch(n){i=e.getElementsByTagName("title")[0].firstChild.nodeValue}i&&this.setName(i)}var s={};OpenLayers.Util.extend(s,this.formatOptions),this.map&&!this.projection.equals(this.map.getProjectionObject())&&(s.externalProjection=this.projection,s.internalProjection=this.map.getProjectionObject());for(var r=new OpenLayers.Format.GeoRSS(s),o=r.read(e),a=0,l=o.length;l>a;a++){var h={},u=o[a];if(u.geometry){var p=u.attributes.title?u.attributes.title:"Untitled",c=u.attributes.description?u.attributes.description:"No description.",d=u.attributes.link?u.attributes.link:"",m=u.geometry.getBounds().getCenterLonLat();if(h.icon=null==this.icon?OpenLayers.Marker.defaultIcon():this.icon.clone(),h.popupSize=this.popupSize?this.popupSize.clone():new OpenLayers.Size(250,120),p||c){h.title=p,h.description=c;
var f='<div class="olLayerGeoRSSClose">[x]</div>';f+='<div class="olLayerGeoRSSTitle">',d&&(f+='<a class="link" href="'+d+'" target="_blank">'),f+=p,d&&(f+="</a>"),f+="</div>",f+='<div style="" class="olLayerGeoRSSDescription">',f+=c,f+="</div>",h.popupContentHTML=f}var u=new OpenLayers.Feature(this,m,h);this.features.push(u);var y=u.createMarker();y.events.register("click",u,this.markerClick),this.addMarker(y)}}this.events.triggerEvent("loadend")},markerClick:function(t){var e=this==this.layer.selectedFeature;this.layer.selectedFeature=e?null:this;for(var i=0,n=this.layer.map.popups.length;n>i;i++)this.layer.map.removePopup(this.layer.map.popups[i]);if(!e){var s=this.createPopup();OpenLayers.Event.observe(s.div,"click",OpenLayers.Function.bind(function(){for(var t=0,e=this.layer.map.popups.length;e>t;t++)this.layer.map.removePopup(this.layer.map.popups[t])},this)),this.layer.map.addPopup(s)}OpenLayers.Event.stop(t)},clearFeatures:function(){if(null!=this.features)for(;this.features.length>0;){var t=this.features[0];OpenLayers.Util.removeItem(this.features,t),t.destroy()}},CLASS_NAME:"OpenLayers.Layer.GeoRSS"}),OpenLayers.Format.WMSCapabilities.v1_3=OpenLayers.Class(OpenLayers.Format.WMSCapabilities.v1,{readers:{wms:OpenLayers.Util.applyDefaults({WMS_Capabilities:function(t,e){this.readChildNodes(t,e)},LayerLimit:function(t,e){e.layerLimit=parseInt(this.getChildValue(t))},MaxWidth:function(t,e){e.maxWidth=parseInt(this.getChildValue(t))},MaxHeight:function(t,e){e.maxHeight=parseInt(this.getChildValue(t))},BoundingBox:function(t,e){var i=OpenLayers.Format.WMSCapabilities.v1.prototype.readers.wms.BoundingBox.apply(this,[t,e]);i.srs=t.getAttribute("CRS"),e.bbox[i.srs]=i},CRS:function(t,e){this.readers.wms.SRS.apply(this,[t,e])},EX_GeographicBoundingBox:function(t,e){e.llbbox=[],this.readChildNodes(t,e.llbbox)},westBoundLongitude:function(t,e){e[0]=this.getChildValue(t)},eastBoundLongitude:function(t,e){e[2]=this.getChildValue(t)},southBoundLatitude:function(t,e){e[1]=this.getChildValue(t)},northBoundLatitude:function(t,e){e[3]=this.getChildValue(t)},MinScaleDenominator:function(t,e){e.maxScale=parseFloat(this.getChildValue(t)).toPrecision(16)},MaxScaleDenominator:function(t,e){e.minScale=parseFloat(this.getChildValue(t)).toPrecision(16)},Dimension:function(t,e){var i=t.getAttribute("name").toLowerCase(),n={name:i,units:t.getAttribute("units"),unitsymbol:t.getAttribute("unitSymbol"),nearestVal:"1"===t.getAttribute("nearestValue"),multipleVal:"1"===t.getAttribute("multipleValues"),"default":t.getAttribute("default")||"",current:"1"===t.getAttribute("current"),values:this.getChildValue(t).split(",")};e.dimensions[n.name]=n},Keyword:function(t,e){var i={value:this.getChildValue(t),vocabulary:t.getAttribute("vocabulary")};e.keywords&&e.keywords.push(i)}},OpenLayers.Format.WMSCapabilities.v1.prototype.readers.wms),sld:{UserDefinedSymbolization:function(t,e){this.readers.wms.UserDefinedSymbolization.apply(this,[t,e]),e.userSymbols.inlineFeature=1==parseInt(t.getAttribute("InlineFeature")),e.userSymbols.remoteWCS=1==parseInt(t.getAttribute("RemoteWCS"))},DescribeLayer:function(t,e){this.readers.wms.DescribeLayer.apply(this,[t,e])},GetLegendGraphic:function(t,e){this.readers.wms.GetLegendGraphic.apply(this,[t,e])}}},CLASS_NAME:"OpenLayers.Format.WMSCapabilities.v1_3"}),OpenLayers.Format.SOSCapabilities=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,{defaultVersion:"1.0.0",CLASS_NAME:"OpenLayers.Format.SOSCapabilities"}),OpenLayers.Layer.WMS=OpenLayers.Class(OpenLayers.Layer.Grid,{DEFAULT_PARAMS:{service:"WMS",version:"1.1.1",request:"GetMap",styles:"",format:"image/jpeg"},isBaseLayer:!0,encodeBBOX:!1,noMagic:!1,yx:{},initialize:function(t,e,i,n){var s=[];i=OpenLayers.Util.upperCaseObject(i),parseFloat(i.VERSION)>=1.3&&!i.EXCEPTIONS&&(i.EXCEPTIONS="INIMAGE"),s.push(t,e,i,n),OpenLayers.Layer.Grid.prototype.initialize.apply(this,s),OpenLayers.Util.applyDefaults(this.params,OpenLayers.Util.upperCaseObject(this.DEFAULT_PARAMS)),!this.noMagic&&this.params.TRANSPARENT&&"true"==this.params.TRANSPARENT.toString().toLowerCase()&&(null!=n&&n.isBaseLayer||(this.isBaseLayer=!1),"image/jpeg"==this.params.FORMAT&&(this.params.FORMAT=OpenLayers.Util.alphaHack()?"image/gif":"image/png"))},clone:function(t){return null==t&&(t=new OpenLayers.Layer.WMS(this.name,this.url,this.params,this.getOptions())),t=OpenLayers.Layer.Grid.prototype.clone.apply(this,[t])},reverseAxisOrder:function(){var t=this.projection.getCode();return parseFloat(this.params.VERSION)>=1.3&&!!(this.yx[t]||OpenLayers.Projection.defaults[t]&&OpenLayers.Projection.defaults[t].yx)},getURL:function(t){t=this.adjustBounds(t);var e=this.getImageSize(),i={},n=this.reverseAxisOrder();i.BBOX=this.encodeBBOX?t.toBBOX(null,n):t.toArray(n),i.WIDTH=e.w,i.HEIGHT=e.h;var s=this.getFullRequestString(i);return s},mergeNewParams:function(t){var e=OpenLayers.Util.upperCaseObject(t),i=[e];return OpenLayers.Layer.Grid.prototype.mergeNewParams.apply(this,i)},getFullRequestString:function(t){var e=this.map.getProjectionObject(),i=this.projection&&this.projection.equals(e)?this.projection.getCode():e.getCode(),n="none"==i?null:i;return parseFloat(this.params.VERSION)>=1.3?this.params.CRS=n:this.params.SRS=n,"boolean"==typeof this.params.TRANSPARENT&&(t.TRANSPARENT=this.params.TRANSPARENT?"TRUE":"FALSE"),OpenLayers.Layer.Grid.prototype.getFullRequestString.apply(this,arguments)},CLASS_NAME:"OpenLayers.Layer.WMS"}),OpenLayers.Layer.KaMap=OpenLayers.Class(OpenLayers.Layer.Grid,{isBaseLayer:!0,DEFAULT_PARAMS:{i:"jpeg",map:""},initialize:function(){OpenLayers.Layer.Grid.prototype.initialize.apply(this,arguments),this.params=OpenLayers.Util.applyDefaults(this.params,this.DEFAULT_PARAMS)},getURL:function(t){t=this.adjustBounds(t);var e=this.map.getResolution(),i=Math.round(1e4*this.map.getScale())/1e4,n=Math.round(t.left/e),s=-Math.round(t.top/e);return this.getFullRequestString({t:s,l:n,s:i})},calculateGridLayout:function(t,e,i){var n=i*this.tileSize.w,s=i*this.tileSize.h,r=t.left,o=Math.floor(r/n)-this.buffer,a=t.top,l=Math.floor(a/s)+this.buffer;return{tilelon:n,tilelat:s,startcol:o,startrow:l}},getTileBoundsForGridIndex:function(t,e){var i=(this.getTileOrigin(),this.gridLayout),n=i.tilelon,s=i.tilelat,r=(i.startcol+e)*n,o=(i.startrow-t)*s;return new OpenLayers.Bounds(r,o,r+n,o+s)},clone:function(t){return null==t&&(t=new OpenLayers.Layer.KaMap(this.name,this.url,this.params,this.getOptions())),t=OpenLayers.Layer.Grid.prototype.clone.apply(this,[t]),null!=this.tileSize&&(t.tileSize=this.tileSize.clone()),t.grid=[],t},getTileBounds:function(t){var e=this.getResolution(),i=e*this.tileSize.w,n=e*this.tileSize.h,s=this.getLonLatFromViewPortPx(t),r=i*Math.floor(s.lon/i),o=n*Math.floor(s.lat/n);return new OpenLayers.Bounds(r,o,r+i,o+n)},CLASS_NAME:"OpenLayers.Layer.KaMap"}),OpenLayers.Format.WMC=OpenLayers.Class(OpenLayers.Format.Context,{defaultVersion:"1.1.0",layerToContext:function(t){var e=this.getParser(),i={queryable:t.queryable,visibility:t.visibility,name:t.params.LAYERS,title:t.name,"abstract":t.metadata["abstract"],dataURL:t.metadata.dataURL,metadataURL:t.metadataURL,server:{version:t.params.VERSION,url:t.url},maxExtent:t.maxExtent,transparent:t.params.TRANSPARENT,numZoomLevels:t.numZoomLevels,units:t.units,isBaseLayer:t.isBaseLayer,opacity:1==t.opacity?void 0:t.opacity,displayInLayerSwitcher:t.displayInLayerSwitcher,singleTile:t.singleTile,tileSize:t.singleTile||!t.tileSize?void 0:{width:t.tileSize.w,height:t.tileSize.h},minScale:t.options.resolutions||t.options.scales||t.options.maxResolution||t.options.minScale?t.minScale:void 0,maxScale:t.options.resolutions||t.options.scales||t.options.minResolution||t.options.maxScale?t.maxScale:void 0,formats:[],styles:[],srs:t.srs,dimensions:t.dimensions};if(t.metadata.servertitle&&(i.server.title=t.metadata.servertitle),t.metadata.formats&&t.metadata.formats.length>0)for(var n=0,s=t.metadata.formats.length;s>n;n++){var r=t.metadata.formats[n];i.formats.push({value:r.value,current:r.value==t.params.FORMAT})}else i.formats.push({value:t.params.FORMAT,current:!0});if(t.metadata.styles&&t.metadata.styles.length>0)for(var n=0,s=t.metadata.styles.length;s>n;n++){var o=t.metadata.styles[n];o.current=o.href==t.params.SLD||o.body==t.params.SLD_BODY||o.name==t.params.STYLES?!0:!1,i.styles.push(o)}else i.styles.push({href:t.params.SLD,body:t.params.SLD_BODY,name:t.params.STYLES||e.defaultStyleName,title:e.defaultStyleTitle,current:!0});return i},toContext:function(t){var e={},i=t.layers;if("OpenLayers.Map"==t.CLASS_NAME){var n=t.metadata||{};e.size=t.getSize(),e.bounds=t.getExtent(),e.projection=t.projection,e.title=t.title,e.keywords=n.keywords,e["abstract"]=n["abstract"],e.logo=n.logo,e.descriptionURL=n.descriptionURL,e.contactInformation=n.contactInformation,e.maxExtent=t.maxExtent}else OpenLayers.Util.applyDefaults(e,t),void 0!=e.layers&&delete e.layers;if(void 0==e.layersContext&&(e.layersContext=[]),void 0!=i&&OpenLayers.Util.isArray(i))for(var s=0,r=i.length;r>s;s++){var o=i[s];o instanceof OpenLayers.Layer.WMS&&e.layersContext.push(this.layerToContext(o))}return e},CLASS_NAME:"OpenLayers.Format.WMC"}),OpenLayers.Format.WMC.v1=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{ol:"http://openlayers.org/context",wmc:"http://www.opengis.net/context",sld:"http://www.opengis.net/sld",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance"},schemaLocation:"",getNamespacePrefix:function(t){var e=null;if(null==t)e=this.namespaces[this.defaultPrefix];else for(e in this.namespaces)if(this.namespaces[e]==t)break;return e},defaultPrefix:"wmc",rootPrefix:null,defaultStyleName:"",defaultStyleTitle:"Default",initialize:function(t){OpenLayers.Format.XML.prototype.initialize.apply(this,[t])},read:function(t){"string"==typeof t&&(t=OpenLayers.Format.XML.prototype.read.apply(this,[t]));var e=t.documentElement;this.rootPrefix=e.prefix;var i={version:e.getAttribute("version")};return this.runChildNodes(i,e),i},runChildNodes:function(t,e){for(var i,n,s,r,o=e.childNodes,a=0,l=o.length;l>a;++a)i=o[a],1==i.nodeType&&(s=this.getNamespacePrefix(i.namespaceURI),r=i.nodeName.split(":").pop(),n=this["read_"+s+"_"+r],n&&n.apply(this,[t,i]))},read_wmc_General:function(t,e){this.runChildNodes(t,e)},read_wmc_BoundingBox:function(t,e){t.projection=e.getAttribute("SRS"),t.bounds=new OpenLayers.Bounds(e.getAttribute("minx"),e.getAttribute("miny"),e.getAttribute("maxx"),e.getAttribute("maxy"))},read_wmc_LayerList:function(t,e){t.layersContext=[],this.runChildNodes(t,e)},read_wmc_Layer:function(t,e){var i={visibility:"1"!=e.getAttribute("hidden"),queryable:"1"==e.getAttribute("queryable"),formats:[],styles:[],metadata:{}};this.runChildNodes(i,e),t.layersContext.push(i)},read_wmc_Extension:function(t,e){this.runChildNodes(t,e)},read_ol_units:function(t,e){t.units=this.getChildValue(e)},read_ol_maxExtent:function(t,e){var i=new OpenLayers.Bounds(e.getAttribute("minx"),e.getAttribute("miny"),e.getAttribute("maxx"),e.getAttribute("maxy"));t.maxExtent=i},read_ol_transparent:function(t,e){t.transparent=this.getChildValue(e)},read_ol_numZoomLevels:function(t,e){t.numZoomLevels=parseInt(this.getChildValue(e))},read_ol_opacity:function(t,e){t.opacity=parseFloat(this.getChildValue(e))},read_ol_singleTile:function(t,e){t.singleTile="true"==this.getChildValue(e)},read_ol_tileSize:function(t,e){var i={width:e.getAttribute("width"),height:e.getAttribute("height")};t.tileSize=i},read_ol_isBaseLayer:function(t,e){t.isBaseLayer="true"==this.getChildValue(e)},read_ol_displayInLayerSwitcher:function(t,e){t.displayInLayerSwitcher="true"==this.getChildValue(e)},read_wmc_Server:function(t,e){t.version=e.getAttribute("version"),t.url=this.getOnlineResource_href(e),t.metadata.servertitle=e.getAttribute("title")},read_wmc_FormatList:function(t,e){this.runChildNodes(t,e)},read_wmc_Format:function(t,e){var i={value:this.getChildValue(e)};"1"==e.getAttribute("current")&&(i.current=!0),t.formats.push(i)},read_wmc_StyleList:function(t,e){this.runChildNodes(t,e)},read_wmc_Style:function(t,e){var i={};this.runChildNodes(i,e),"1"==e.getAttribute("current")&&(i.current=!0),t.styles.push(i)},read_wmc_SLD:function(t,e){this.runChildNodes(t,e)},read_sld_StyledLayerDescriptor:function(t,e){var i=OpenLayers.Format.XML.prototype.write.apply(this,[e]);t.body=i},read_sld_FeatureTypeStyle:function(t,e){var i=OpenLayers.Format.XML.prototype.write.apply(this,[e]);t.body=i},read_wmc_OnlineResource:function(t,e){t.href=this.getAttributeNS(e,this.namespaces.xlink,"href")},read_wmc_Name:function(t,e){var i=this.getChildValue(e);i&&(t.name=i)},read_wmc_Title:function(t,e){var i=this.getChildValue(e);i&&(t.title=i)},read_wmc_MetadataURL:function(t,e){t.metadataURL=this.getOnlineResource_href(e)},read_wmc_KeywordList:function(t,e){t.keywords=[],this.runChildNodes(t.keywords,e)},read_wmc_Keyword:function(t,e){t.push(this.getChildValue(e))},read_wmc_Abstract:function(t,e){var i=this.getChildValue(e);i&&(t["abstract"]=i)},read_wmc_LogoURL:function(t,e){t.logo={width:e.getAttribute("width"),height:e.getAttribute("height"),format:e.getAttribute("format"),href:this.getOnlineResource_href(e)}},read_wmc_DescriptionURL:function(t,e){t.descriptionURL=this.getOnlineResource_href(e)},read_wmc_ContactInformation:function(t,e){var i={};this.runChildNodes(i,e),t.contactInformation=i},read_wmc_ContactPersonPrimary:function(t,e){var i={};this.runChildNodes(i,e),t.personPrimary=i},read_wmc_ContactPerson:function(t,e){var i=this.getChildValue(e);i&&(t.person=i)},read_wmc_ContactOrganization:function(t,e){var i=this.getChildValue(e);i&&(t.organization=i)},read_wmc_ContactPosition:function(t,e){var i=this.getChildValue(e);i&&(t.position=i)},read_wmc_ContactAddress:function(t,e){var i={};this.runChildNodes(i,e),t.contactAddress=i},read_wmc_AddressType:function(t,e){var i=this.getChildValue(e);i&&(t.type=i)},read_wmc_Address:function(t,e){var i=this.getChildValue(e);i&&(t.address=i)},read_wmc_City:function(t,e){var i=this.getChildValue(e);i&&(t.city=i)},read_wmc_StateOrProvince:function(t,e){var i=this.getChildValue(e);i&&(t.stateOrProvince=i)},read_wmc_PostCode:function(t,e){var i=this.getChildValue(e);i&&(t.postcode=i)},read_wmc_Country:function(t,e){var i=this.getChildValue(e);i&&(t.country=i)},read_wmc_ContactVoiceTelephone:function(t,e){var i=this.getChildValue(e);i&&(t.phone=i)},read_wmc_ContactFacsimileTelephone:function(t,e){var i=this.getChildValue(e);i&&(t.fax=i)},read_wmc_ContactElectronicMailAddress:function(t,e){var i=this.getChildValue(e);i&&(t.email=i)},read_wmc_DataURL:function(t,e){t.dataURL=this.getOnlineResource_href(e)},read_wmc_LegendURL:function(t,e){var i={width:e.getAttribute("width"),height:e.getAttribute("height"),format:e.getAttribute("format"),href:this.getOnlineResource_href(e)};t.legend=i},read_wmc_DimensionList:function(t,e){t.dimensions={},this.runChildNodes(t.dimensions,e)},read_wmc_Dimension:function(t,e){var i=e.getAttribute("name").toLowerCase(),n={name:i,units:e.getAttribute("units")||"",unitSymbol:e.getAttribute("unitSymbol")||"",userValue:e.getAttribute("userValue")||"",nearestValue:"1"===e.getAttribute("nearestValue"),multipleValues:"1"===e.getAttribute("multipleValues"),current:"1"===e.getAttribute("current"),"default":e.getAttribute("default")||""},s=this.getChildValue(e);n.values=s.split(","),t[n.name]=n},write:function(t,e){var i=this.createElementDefaultNS("ViewContext");return this.setAttributes(i,{version:this.VERSION,id:e&&"string"==typeof e.id?e.id:OpenLayers.Util.createUniqueID("OpenLayers_Context_")}),this.setAttributeNS(i,this.namespaces.xsi,"xsi:schemaLocation",this.schemaLocation),i.appendChild(this.write_wmc_General(t)),i.appendChild(this.write_wmc_LayerList(t)),OpenLayers.Format.XML.prototype.write.apply(this,[i])},createElementDefaultNS:function(t,e,i){var n=this.createElementNS(this.namespaces[this.defaultPrefix],t);return e&&n.appendChild(this.createTextNode(e)),i&&this.setAttributes(n,i),n},setAttributes:function(t,e){var i;for(var n in e)i=e[n].toString(),i.match(/[A-Z]/)?this.setAttributeNS(t,null,n,i):t.setAttribute(n,i)},write_wmc_General:function(t){var e=this.createElementDefaultNS("General");t.size&&e.appendChild(this.createElementDefaultNS("Window",null,{width:t.size.w,height:t.size.h}));var i=t.bounds;return e.appendChild(this.createElementDefaultNS("BoundingBox",null,{minx:i.left.toPrecision(18),miny:i.bottom.toPrecision(18),maxx:i.right.toPrecision(18),maxy:i.top.toPrecision(18),SRS:t.projection})),e.appendChild(this.createElementDefaultNS("Title",t.title)),t.keywords&&e.appendChild(this.write_wmc_KeywordList(t.keywords)),t["abstract"]&&e.appendChild(this.createElementDefaultNS("Abstract",t["abstract"])),t.logo&&e.appendChild(this.write_wmc_URLType("LogoURL",t.logo.href,t.logo)),t.descriptionURL&&e.appendChild(this.write_wmc_URLType("DescriptionURL",t.descriptionURL)),t.contactInformation&&e.appendChild(this.write_wmc_ContactInformation(t.contactInformation)),e.appendChild(this.write_ol_MapExtension(t)),e},write_wmc_KeywordList:function(t){for(var e=this.createElementDefaultNS("KeywordList"),i=0,n=t.length;n>i;i++)e.appendChild(this.createElementDefaultNS("Keyword",t[i]));return e},write_wmc_ContactInformation:function(t){var e=this.createElementDefaultNS("ContactInformation");return t.personPrimary&&e.appendChild(this.write_wmc_ContactPersonPrimary(t.personPrimary)),t.position&&e.appendChild(this.createElementDefaultNS("ContactPosition",t.position)),t.contactAddress&&e.appendChild(this.write_wmc_ContactAddress(t.contactAddress)),t.phone&&e.appendChild(this.createElementDefaultNS("ContactVoiceTelephone",t.phone)),t.fax&&e.appendChild(this.createElementDefaultNS("ContactFacsimileTelephone",t.fax)),t.email&&e.appendChild(this.createElementDefaultNS("ContactElectronicMailAddress",t.email)),e},write_wmc_ContactPersonPrimary:function(t){var e=this.createElementDefaultNS("ContactPersonPrimary");return t.person&&e.appendChild(this.createElementDefaultNS("ContactPerson",t.person)),t.organization&&e.appendChild(this.createElementDefaultNS("ContactOrganization",t.organization)),e},write_wmc_ContactAddress:function(t){var e=this.createElementDefaultNS("ContactAddress");return t.type&&e.appendChild(this.createElementDefaultNS("AddressType",t.type)),t.address&&e.appendChild(this.createElementDefaultNS("Address",t.address)),t.city&&e.appendChild(this.createElementDefaultNS("City",t.city)),t.stateOrProvince&&e.appendChild(this.createElementDefaultNS("StateOrProvince",t.stateOrProvince)),t.postcode&&e.appendChild(this.createElementDefaultNS("PostCode",t.postcode)),t.country&&e.appendChild(this.createElementDefaultNS("Country",t.country)),e},write_ol_MapExtension:function(t){var e=this.createElementDefaultNS("Extension"),i=t.maxExtent;if(i){var n=this.createElementNS(this.namespaces.ol,"ol:maxExtent");this.setAttributes(n,{minx:i.left.toPrecision(18),miny:i.bottom.toPrecision(18),maxx:i.right.toPrecision(18),maxy:i.top.toPrecision(18)}),e.appendChild(n)}return e},write_wmc_LayerList:function(t){for(var e=this.createElementDefaultNS("LayerList"),i=0,n=t.layersContext.length;n>i;++i)e.appendChild(this.write_wmc_Layer(t.layersContext[i]));return e},write_wmc_Layer:function(t){var e=this.createElementDefaultNS("Layer",null,{queryable:t.queryable?"1":"0",hidden:t.visibility?"0":"1"});return e.appendChild(this.write_wmc_Server(t)),e.appendChild(this.createElementDefaultNS("Name",t.name)),e.appendChild(this.createElementDefaultNS("Title",t.title)),t["abstract"]&&e.appendChild(this.createElementDefaultNS("Abstract",t["abstract"])),t.dataURL&&e.appendChild(this.write_wmc_URLType("DataURL",t.dataURL)),t.metadataURL&&e.appendChild(this.write_wmc_URLType("MetadataURL",t.metadataURL)),e},write_wmc_LayerExtension:function(t){var e=this.createElementDefaultNS("Extension"),i=t.maxExtent,n=this.createElementNS(this.namespaces.ol,"ol:maxExtent");if(this.setAttributes(n,{minx:i.left.toPrecision(18),miny:i.bottom.toPrecision(18),maxx:i.right.toPrecision(18),maxy:i.top.toPrecision(18)}),e.appendChild(n),t.tileSize&&!t.singleTile){var s=this.createElementNS(this.namespaces.ol,"ol:tileSize");this.setAttributes(s,t.tileSize),e.appendChild(s)}for(var r,o=["transparent","numZoomLevels","units","isBaseLayer","opacity","displayInLayerSwitcher","singleTile"],a=0,l=o.length;l>a;++a)r=this.createOLPropertyNode(t,o[a]),r&&e.appendChild(r);return e},createOLPropertyNode:function(t,e){var i=null;return null!=t[e]&&(i=this.createElementNS(this.namespaces.ol,"ol:"+e),i.appendChild(this.createTextNode(t[e].toString()))),i},write_wmc_Server:function(t){var e=t.server,i=this.createElementDefaultNS("Server"),n={service:"OGC:WMS",version:e.version};return e.title&&(n.title=e.title),this.setAttributes(i,n),i.appendChild(this.write_wmc_OnlineResource(e.url)),i},write_wmc_URLType:function(t,e,i){var n=this.createElementDefaultNS(t);if(n.appendChild(this.write_wmc_OnlineResource(e)),i)for(var s=["width","height","format"],r=0;r<s.length;r++)s[r]in i&&n.setAttribute(s[r],i[s[r]]);return n},write_wmc_DimensionList:function(t){var e=this.createElementDefaultNS("DimensionList");for(var i in t.dimensions){var n={},s=t.dimensions[i];for(var r in s)n[r]="boolean"==typeof s[r]?Number(s[r]):s[r];var o="";n.values&&(o=n.values.join(","),delete n.values),e.appendChild(this.createElementDefaultNS("Dimension",o,n))}return e},write_wmc_FormatList:function(t){for(var e=this.createElementDefaultNS("FormatList"),i=0,n=t.formats.length;n>i;i++){var s=t.formats[i];e.appendChild(this.createElementDefaultNS("Format",s.value,s.current&&1==s.current?{current:"1"}:null))}return e},write_wmc_StyleList:function(t){var e=this.createElementDefaultNS("StyleList"),i=t.styles;if(i&&OpenLayers.Util.isArray(i))for(var n,s=0,r=i.length;r>s;s++){var o=i[s],a=this.createElementDefaultNS("Style",null,o.current&&1==o.current?{current:"1"}:null);if(o.href){n=this.createElementDefaultNS("SLD"),o.name&&n.appendChild(this.createElementDefaultNS("Name",o.name)),o.title&&n.appendChild(this.createElementDefaultNS("Title",o.title)),o.legend&&n.appendChild(this.write_wmc_URLType("LegendURL",o.legend.href,o.legend));var l=this.write_wmc_OnlineResource(o.href);n.appendChild(l),a.appendChild(n)}else if(o.body){n=this.createElementDefaultNS("SLD"),o.name&&n.appendChild(this.createElementDefaultNS("Name",o.name)),o.title&&n.appendChild(this.createElementDefaultNS("Title",o.title)),o.legend&&n.appendChild(this.write_wmc_URLType("LegendURL",o.legend.href,o.legend));var h=OpenLayers.Format.XML.prototype.read.apply(this,[o.body]),u=h.documentElement;n.ownerDocument&&n.ownerDocument.importNode&&(u=n.ownerDocument.importNode(u,!0)),n.appendChild(u),a.appendChild(n)}else a.appendChild(this.createElementDefaultNS("Name",o.name)),a.appendChild(this.createElementDefaultNS("Title",o.title)),o["abstract"]&&a.appendChild(this.createElementDefaultNS("Abstract",o["abstract"])),o.legend&&a.appendChild(this.write_wmc_URLType("LegendURL",o.legend.href,o.legend));e.appendChild(a)}return e},write_wmc_OnlineResource:function(t){var e=this.createElementDefaultNS("OnlineResource");return this.setAttributeNS(e,this.namespaces.xlink,"xlink:type","simple"),this.setAttributeNS(e,this.namespaces.xlink,"xlink:href",t),e},getOnlineResource_href:function(t){var e={},i=t.getElementsByTagName("OnlineResource");return i.length>0&&this.read_wmc_OnlineResource(e,i[0]),e.href},CLASS_NAME:"OpenLayers.Format.WMC.v1"}),OpenLayers.Format.WMC.v1_1_0=OpenLayers.Class(OpenLayers.Format.WMC.v1,{VERSION:"1.1.0",schemaLocation:"http://www.opengis.net/context http://schemas.opengis.net/context/1.1.0/context.xsd",initialize:function(t){OpenLayers.Format.WMC.v1.prototype.initialize.apply(this,[t])},read_sld_MinScaleDenominator:function(t,e){var i=parseFloat(this.getChildValue(e));i>0&&(t.maxScale=i)},read_sld_MaxScaleDenominator:function(t,e){t.minScale=parseFloat(this.getChildValue(e))},read_wmc_SRS:function(t,e){"srs"in t||(t.srs={}),t.srs[this.getChildValue(e)]=!0},write_wmc_Layer:function(t){var e=OpenLayers.Format.WMC.v1.prototype.write_wmc_Layer.apply(this,[t]);if(t.maxScale){var i=this.createElementNS(this.namespaces.sld,"sld:MinScaleDenominator");i.appendChild(this.createTextNode(t.maxScale.toPrecision(16))),e.appendChild(i)}if(t.minScale){var n=this.createElementNS(this.namespaces.sld,"sld:MaxScaleDenominator");n.appendChild(this.createTextNode(t.minScale.toPrecision(16))),e.appendChild(n)}if(t.srs)for(var s in t.srs)e.appendChild(this.createElementDefaultNS("SRS",s));return e.appendChild(this.write_wmc_FormatList(t)),e.appendChild(this.write_wmc_StyleList(t)),t.dimensions&&e.appendChild(this.write_wmc_DimensionList(t)),e.appendChild(this.write_wmc_LayerExtension(t)),e},CLASS_NAME:"OpenLayers.Format.WMC.v1_1_0"}),OpenLayers.Format.XLS=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,{defaultVersion:"1.1.0",stringifyOutput:!0,CLASS_NAME:"OpenLayers.Format.XLS"}),OpenLayers.Format.XLS.v1=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{xls:"http://www.opengis.net/xls",gml:"http://www.opengis.net/gml",xsi:"http://www.w3.org/2001/XMLSchema-instance"},regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},xy:!0,defaultPrefix:"xls",schemaLocation:null,read:function(t,e){e=OpenLayers.Util.applyDefaults(e,this.options);var i={};return this.readChildNodes(t,i),i},readers:{xls:{XLS:function(t,e){e.version=t.getAttribute("version"),this.readChildNodes(t,e)},Response:function(t,e){this.readChildNodes(t,e)},GeocodeResponse:function(t,e){e.responseLists=[],this.readChildNodes(t,e)},GeocodeResponseList:function(t,e){var i={features:[],numberOfGeocodedAddresses:parseInt(t.getAttribute("numberOfGeocodedAddresses"))};e.responseLists.push(i),this.readChildNodes(t,i)},GeocodedAddress:function(t,e){var i=new OpenLayers.Feature.Vector;e.features.push(i),this.readChildNodes(t,i),i.geometry=i.components[0]},GeocodeMatchCode:function(t,e){e.attributes.matchCode={accuracy:parseFloat(t.getAttribute("accuracy")),matchType:t.getAttribute("matchType")}},Address:function(t,e){var i={countryCode:t.getAttribute("countryCode"),addressee:t.getAttribute("addressee"),street:[],place:[]};e.attributes.address=i,this.readChildNodes(t,i)},freeFormAddress:function(t,e){e.freeFormAddress=this.getChildValue(t)},StreetAddress:function(t,e){this.readChildNodes(t,e)},Building:function(t,e){e.building={number:t.getAttribute("number"),subdivision:t.getAttribute("subdivision"),buildingName:t.getAttribute("buildingName")}},Street:function(t,e){e.street.push(this.getChildValue(t))},Place:function(t,e){e.place[t.getAttribute("type")]=this.getChildValue(t)},PostalCode:function(t,e){e.postalCode=this.getChildValue(t)}},gml:OpenLayers.Format.GML.v3.prototype.readers.gml},write:function(t){return this.writers.xls.XLS.apply(this,[t])},writers:{xls:{XLS:function(t){var e=this.createElementNSPlus("xls:XLS",{attributes:{version:this.VERSION,"xsi:schemaLocation":this.schemaLocation}});return this.writeNode("RequestHeader",t.header,e),this.writeNode("Request",t,e),e},RequestHeader:function(){return this.createElementNSPlus("xls:RequestHeader")},Request:function(t){var e=this.createElementNSPlus("xls:Request",{attributes:{methodName:"GeocodeRequest",requestID:t.requestID||"",version:this.VERSION}});return this.writeNode("GeocodeRequest",t.addresses,e),e},GeocodeRequest:function(t){for(var e=this.createElementNSPlus("xls:GeocodeRequest"),i=0,n=t.length;n>i;i++)this.writeNode("Address",t[i],e);return e},Address:function(t){var e=this.createElementNSPlus("xls:Address",{attributes:{countryCode:t.countryCode}});return t.freeFormAddress?this.writeNode("freeFormAddress",t.freeFormAddress,e):(t.street&&this.writeNode("StreetAddress",t,e),t.municipality&&this.writeNode("Municipality",t.municipality,e),t.countrySubdivision&&this.writeNode("CountrySubdivision",t.countrySubdivision,e),t.postalCode&&this.writeNode("PostalCode",t.postalCode,e)),e},freeFormAddress:function(t){return this.createElementNSPlus("freeFormAddress",{value:t})},StreetAddress:function(t){var e=this.createElementNSPlus("xls:StreetAddress");t.building&&this.writeNode(e,"Building",t.building);var i=t.street;OpenLayers.Util.isArray(i)||(i=[i]);for(var n=0,s=i.length;s>n;n++)this.writeNode("Street",i[n],e);return e},Building:function(t){return this.createElementNSPlus("xls:Building",{attributes:{number:t.number,subdivision:t.subdivision,buildingName:t.buildingName}})},Street:function(t){return this.createElementNSPlus("xls:Street",{value:t})},Municipality:function(t){return this.createElementNSPlus("xls:Place",{attributes:{type:"Municipality"},value:t})},CountrySubdivision:function(t){return this.createElementNSPlus("xls:Place",{attributes:{type:"CountrySubdivision"},value:t})},PostalCode:function(t){return this.createElementNSPlus("xls:PostalCode",{value:t})}}},CLASS_NAME:"OpenLayers.Format.XLS.v1"}),OpenLayers.Format.XLS.v1_1_0=OpenLayers.Class(OpenLayers.Format.XLS.v1,{VERSION:"1.1",schemaLocation:"http://www.opengis.net/xls http://schemas.opengis.net/ols/1.1.0/LocationUtilityService.xsd",CLASS_NAME:"OpenLayers.Format.XLS.v1_1_0"}),OpenLayers.Format.XLS.v1_1=OpenLayers.Format.XLS.v1_1_0,OpenLayers.Renderer.SVG=OpenLayers.Class(OpenLayers.Renderer.Elements,{xmlns:"http://www.w3.org/2000/svg",xlinkns:"http://www.w3.org/1999/xlink",MAX_PIXEL:15e3,translationParameters:null,symbolMetrics:null,initialize:function(){this.supported()&&(OpenLayers.Renderer.Elements.prototype.initialize.apply(this,arguments),this.translationParameters={x:0,y:0},this.symbolMetrics={})},supported:function(){var t="http://www.w3.org/TR/SVG11/feature#";return document.implementation&&(document.implementation.hasFeature("org.w3c.svg","1.0")||document.implementation.hasFeature(t+"SVG","1.1")||document.implementation.hasFeature(t+"BasicStructure","1.1"))},inValidRange:function(t,e,i){var n=t+(i?0:this.translationParameters.x),s=e+(i?0:this.translationParameters.y);return n>=-this.MAX_PIXEL&&n<=this.MAX_PIXEL&&s>=-this.MAX_PIXEL&&s<=this.MAX_PIXEL},setExtent:function(t,e){var i=OpenLayers.Renderer.Elements.prototype.setExtent.apply(this,arguments),n=this.getResolution(),s=-t.left/n,r=t.top/n;if(e){this.left=s,this.top=r;var o="0 0 "+this.size.w+" "+this.size.h;return this.rendererRoot.setAttributeNS(null,"viewBox",o),this.translate(this.xOffset,0),!0}var a=this.translate(s-this.left+this.xOffset,r-this.top);return a||this.setExtent(t,!0),i&&a},translate:function(t,e){if(this.inValidRange(t,e,!0)){var i="";return(t||e)&&(i="translate("+t+","+e+")"),this.root.setAttributeNS(null,"transform",i),this.translationParameters={x:t,y:e},!0}return!1},setSize:function(){OpenLayers.Renderer.prototype.setSize.apply(this,arguments),this.rendererRoot.setAttributeNS(null,"width",this.size.w),this.rendererRoot.setAttributeNS(null,"height",this.size.h)},getNodeType:function(t,e){var i=null;switch(t.CLASS_NAME){case"OpenLayers.Geometry.Point":i=e.externalGraphic?"image":this.isComplexSymbol(e.graphicName)?"svg":"circle";break;case"OpenLayers.Geometry.Rectangle":i="rect";break;case"OpenLayers.Geometry.LineString":i="polyline";break;case"OpenLayers.Geometry.LinearRing":i="polygon";break;case"OpenLayers.Geometry.Polygon":case"OpenLayers.Geometry.Curve":i="path"}return i},setStyle:function(t,e,i){e=e||t._style,i=i||t._options;var n=e.title||e.graphicTitle;if(n){t.setAttributeNS(null,"title",n);var s=t.getElementsByTagName("title");if(s.length>0)s[0].firstChild.textContent=n;else{var r=this.nodeFactory(null,"title");r.textContent=n,t.appendChild(r)}}var o,a=parseFloat(t.getAttributeNS(null,"r")),l=1;if("OpenLayers.Geometry.Point"==t._geometryClass&&a){if(t.style.visibility="",e.graphic===!1)t.style.visibility="hidden";else if(e.externalGraphic){o=this.getPosition(t),e.graphicWidth&&e.graphicHeight&&t.setAttributeNS(null,"preserveAspectRatio","none");var h=e.graphicWidth||e.graphicHeight,u=e.graphicHeight||e.graphicWidth;h=h?h:2*e.pointRadius,u=u?u:2*e.pointRadius;var p=void 0!=e.graphicXOffset?e.graphicXOffset:-(.5*h),c=void 0!=e.graphicYOffset?e.graphicYOffset:-(.5*u),d=e.graphicOpacity||e.fillOpacity;t.setAttributeNS(null,"x",(o.x+p).toFixed()),t.setAttributeNS(null,"y",(o.y+c).toFixed()),t.setAttributeNS(null,"width",h),t.setAttributeNS(null,"height",u),t.setAttributeNS(this.xlinkns,"xlink:href",e.externalGraphic),t.setAttributeNS(null,"style","opacity: "+d),t.onclick=OpenLayers.Event.preventDefault
}else if(this.isComplexSymbol(e.graphicName)){var m=3*e.pointRadius,f=2*m,y=this.importSymbol(e.graphicName);o=this.getPosition(t),l=3*this.symbolMetrics[y.id][0]/f;var g=t.parentNode,v=t.nextSibling;g&&g.removeChild(t),t.firstChild&&t.removeChild(t.firstChild),t.appendChild(y.firstChild.cloneNode(!0)),t.setAttributeNS(null,"viewBox",y.getAttributeNS(null,"viewBox")),t.setAttributeNS(null,"width",f),t.setAttributeNS(null,"height",f),t.setAttributeNS(null,"x",o.x-m),t.setAttributeNS(null,"y",o.y-m),v?g.insertBefore(t,v):g&&g.appendChild(t)}else t.setAttributeNS(null,"r",e.pointRadius);var L=e.rotation;if((void 0!==L||void 0!==t._rotation)&&o)if(t._rotation=L,L|=0,"svg"!==t.nodeName)t.setAttributeNS(null,"transform","rotate("+L+" "+o.x+" "+o.y+")");else{var _=this.symbolMetrics[y.id];t.firstChild.setAttributeNS(null,"transform","rotate("+L+" "+_[1]+" "+_[2]+")")}}return i.isFilled?(t.setAttributeNS(null,"fill",e.fillColor),t.setAttributeNS(null,"fill-opacity",e.fillOpacity)):t.setAttributeNS(null,"fill","none"),i.isStroked?(t.setAttributeNS(null,"stroke",e.strokeColor),t.setAttributeNS(null,"stroke-opacity",e.strokeOpacity),t.setAttributeNS(null,"stroke-width",e.strokeWidth*l),t.setAttributeNS(null,"stroke-linecap",e.strokeLinecap||"round"),t.setAttributeNS(null,"stroke-linejoin","round"),e.strokeDashstyle&&t.setAttributeNS(null,"stroke-dasharray",this.dashStyle(e,l))):t.setAttributeNS(null,"stroke","none"),e.pointerEvents&&t.setAttributeNS(null,"pointer-events",e.pointerEvents),null!=e.cursor&&t.setAttributeNS(null,"cursor",e.cursor),t},dashStyle:function(t,e){var i=t.strokeWidth*e,n=t.strokeDashstyle;switch(n){case"solid":return"none";case"dot":return[1,4*i].join();case"dash":return[4*i,4*i].join();case"dashdot":return[4*i,4*i,1,4*i].join();case"longdash":return[8*i,4*i].join();case"longdashdot":return[8*i,4*i,1,4*i].join();default:return OpenLayers.String.trim(n).replace(/\s+/g,",")}},createNode:function(t,e){var i=document.createElementNS(this.xmlns,t);return e&&i.setAttributeNS(null,"id",e),i},nodeTypeCompare:function(t,e){return e==t.nodeName},createRenderRoot:function(){var t=this.nodeFactory(this.container.id+"_svgRoot","svg");return t.style.display="block",t},createRoot:function(t){return this.nodeFactory(this.container.id+t,"g")},createDefs:function(){var t=this.nodeFactory(this.container.id+"_defs","defs");return this.rendererRoot.appendChild(t),t},drawPoint:function(t,e){return this.drawCircle(t,e,1)},drawCircle:function(t,e,i){var n=this.getResolution(),s=(e.x-this.featureDx)/n+this.left,r=this.top-e.y/n;return this.inValidRange(s,r)?(t.setAttributeNS(null,"cx",s),t.setAttributeNS(null,"cy",r),t.setAttributeNS(null,"r",i),t):!1},drawLineString:function(t,e){var i=this.getComponentsString(e.components);return i.path?(t.setAttributeNS(null,"points",i.path),i.complete?t:null):!1},drawLinearRing:function(t,e){var i=this.getComponentsString(e.components);return i.path?(t.setAttributeNS(null,"points",i.path),i.complete?t:null):!1},drawPolygon:function(t,e){for(var i,n,s="",r=!0,o=!0,a=0,l=e.components.length;l>a;a++)s+=" M",i=this.getComponentsString(e.components[a].components," "),n=i.path,n?(s+=" "+n,o=i.complete&&o):r=!1;return s+=" z",r?(t.setAttributeNS(null,"d",s),t.setAttributeNS(null,"fill-rule","evenodd"),o?t:null):!1},drawRectangle:function(t,e){var i=this.getResolution(),n=(e.x-this.featureDx)/i+this.left,s=this.top-e.y/i;return this.inValidRange(n,s)?(t.setAttributeNS(null,"x",n),t.setAttributeNS(null,"y",s),t.setAttributeNS(null,"width",e.width/i),t.setAttributeNS(null,"height",e.height/i),t):!1},drawText:function(t,e,i){var n=!!e.labelOutlineWidth;if(n){var s=OpenLayers.Util.extend({},e);s.fontColor=s.labelOutlineColor,s.fontStrokeColor=s.labelOutlineColor,s.fontStrokeWidth=e.labelOutlineWidth,e.labelOutlineOpacity&&(s.fontOpacity=e.labelOutlineOpacity),delete s.labelOutlineWidth,this.drawText(t,s,i)}var r=this.getResolution(),o=(i.x-this.featureDx)/r+this.left,a=i.y/r-this.top,l=n?this.LABEL_OUTLINE_SUFFIX:this.LABEL_ID_SUFFIX,h=this.nodeFactory(t+l,"text");h.setAttributeNS(null,"x",o),h.setAttributeNS(null,"y",-a),e.fontColor&&h.setAttributeNS(null,"fill",e.fontColor),e.fontStrokeColor&&h.setAttributeNS(null,"stroke",e.fontStrokeColor),e.fontStrokeWidth&&h.setAttributeNS(null,"stroke-width",e.fontStrokeWidth),e.fontOpacity&&h.setAttributeNS(null,"opacity",e.fontOpacity),e.fontFamily&&h.setAttributeNS(null,"font-family",e.fontFamily),e.fontSize&&h.setAttributeNS(null,"font-size",e.fontSize),e.fontWeight&&h.setAttributeNS(null,"font-weight",e.fontWeight),e.fontStyle&&h.setAttributeNS(null,"font-style",e.fontStyle),e.labelSelect===!0?(h.setAttributeNS(null,"pointer-events","visible"),h._featureId=t):h.setAttributeNS(null,"pointer-events","none");var u=e.labelAlign||OpenLayers.Renderer.defaultSymbolizer.labelAlign;h.setAttributeNS(null,"text-anchor",OpenLayers.Renderer.SVG.LABEL_ALIGN[u[0]]||"middle"),OpenLayers.IS_GECKO===!0&&h.setAttributeNS(null,"dominant-baseline",OpenLayers.Renderer.SVG.LABEL_ALIGN[u[1]]||"central");for(var p=e.label.split("\n"),c=p.length;h.childNodes.length>c;)h.removeChild(h.lastChild);for(var d=0;c>d;d++){var m=this.nodeFactory(t+l+"_tspan_"+d,"tspan");if(e.labelSelect===!0&&(m._featureId=t,m._geometry=i,m._geometryClass=i.CLASS_NAME),OpenLayers.IS_GECKO===!1&&m.setAttributeNS(null,"baseline-shift",OpenLayers.Renderer.SVG.LABEL_VSHIFT[u[1]]||"-35%"),m.setAttribute("x",o),0==d){var f=OpenLayers.Renderer.SVG.LABEL_VFACTOR[u[1]];null==f&&(f=-.5),m.setAttribute("dy",f*(c-1)+"em")}else m.setAttribute("dy","1em");m.textContent=""===p[d]?" ":p[d],m.parentNode||h.appendChild(m)}h.parentNode||this.textRoot.appendChild(h)},getComponentsString:function(t,e){for(var i,n,s=[],r=!0,o=t.length,a=[],l=0;o>l;l++)n=t[l],s.push(n),i=this.getShortString(n),i?a.push(i):(l>0&&this.getShortString(t[l-1])&&a.push(this.clipLine(t[l],t[l-1])),o-1>l&&this.getShortString(t[l+1])&&a.push(this.clipLine(t[l],t[l+1])),r=!1);return{path:a.join(e||","),complete:r}},clipLine:function(t,e){if(e.equals(t))return"";var i,n=this.getResolution(),s=this.MAX_PIXEL-this.translationParameters.x,r=this.MAX_PIXEL-this.translationParameters.y,o=(e.x-this.featureDx)/n+this.left,a=this.top-e.y/n,l=(t.x-this.featureDx)/n+this.left,h=this.top-t.y/n;return(-s>l||l>s)&&(i=(h-a)/(l-o),l=0>l?-s:s,h=a+(l-o)*i),(-r>h||h>r)&&(i=(l-o)/(h-a),h=0>h?-r:r,l=o+(h-a)*i),l+","+h},getShortString:function(t){var e=this.getResolution(),i=(t.x-this.featureDx)/e+this.left,n=this.top-t.y/e;return this.inValidRange(i,n)?i+","+n:!1},getPosition:function(t){return{x:parseFloat(t.getAttributeNS(null,"cx")),y:parseFloat(t.getAttributeNS(null,"cy"))}},importSymbol:function(t){this.defs||(this.defs=this.createDefs());var e=this.container.id+"-"+t,i=document.getElementById(e);if(null!=i)return i;var n=OpenLayers.Renderer.symbol[t];if(!n)throw new Error(t+" is not a valid symbol name");var s=this.nodeFactory(e,"symbol"),r=this.nodeFactory(null,"polygon");s.appendChild(r);for(var o,a,l=new OpenLayers.Bounds(Number.MAX_VALUE,Number.MAX_VALUE,0,0),h=[],u=0;u<n.length;u+=2)o=n[u],a=n[u+1],l.left=Math.min(l.left,o),l.bottom=Math.min(l.bottom,a),l.right=Math.max(l.right,o),l.top=Math.max(l.top,a),h.push(o,",",a);r.setAttributeNS(null,"points",h.join(" "));var p=l.getWidth(),c=l.getHeight(),d=[l.left-p,l.bottom-c,3*p,3*c];return s.setAttributeNS(null,"viewBox",d.join(" ")),this.symbolMetrics[e]=[Math.max(p,c),l.getCenterLonLat().lon,l.getCenterLonLat().lat],this.defs.appendChild(s),s},getFeatureIdFromEvent:function(t){var e=OpenLayers.Renderer.Elements.prototype.getFeatureIdFromEvent.apply(this,arguments);if(!e){var i=t.target;e=i.parentNode&&i!=this.rendererRoot?i.parentNode._featureId:void 0}return e},CLASS_NAME:"OpenLayers.Renderer.SVG"}),OpenLayers.Renderer.SVG.LABEL_ALIGN={l:"start",r:"end",b:"bottom",t:"hanging"},OpenLayers.Renderer.SVG.LABEL_VSHIFT={t:"-70%",b:"0"},OpenLayers.Renderer.SVG.LABEL_VFACTOR={t:0,b:-1},OpenLayers.Renderer.SVG.preventDefault=function(t){OpenLayers.Event.preventDefault(t)},OpenLayers.Format.WMSDescribeLayer=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,{defaultVersion:"1.1.1",CLASS_NAME:"OpenLayers.Format.WMSDescribeLayer"}),OpenLayers.Format.WMSDescribeLayer.v1_1_1=OpenLayers.Class(OpenLayers.Format.WMSDescribeLayer,{initialize:function(t){OpenLayers.Format.WMSDescribeLayer.prototype.initialize.apply(this,[t])},read:function(t){"string"==typeof t&&(t=OpenLayers.Format.XML.prototype.read.apply(this,[t]));for(var e,i,n=t.documentElement,s=n.childNodes,r={layerDescriptions:[]},o=0;o<s.length;++o)if(e=s[o],i=e.nodeName,"LayerDescription"==i){var a=e.getAttribute("name"),l="",h="",u="";e.getAttribute("owsType")?(l=e.getAttribute("owsType"),h=e.getAttribute("owsURL")):""!=e.getAttribute("wfs")?(l="WFS",h=e.getAttribute("wfs")):""!=e.getAttribute("wcs")&&(l="WCS",h=e.getAttribute("wcs"));var p=e.getElementsByTagName("Query");p.length>0&&(u=p[0].getAttribute("typeName"),u||(u=p[0].getAttribute("typename")));var c={layerName:a,owsType:l,owsURL:h,typeName:u};r.layerDescriptions.push(c),r.length=r.layerDescriptions.length,r[r.length-1]=c}else if("ServiceException"==i){var d=new OpenLayers.Format.OGCExceptionReport;return{error:d.read(t)}}return r},CLASS_NAME:"OpenLayers.Format.WMSDescribeLayer.v1_1_1"}),OpenLayers.Format.WMSDescribeLayer.v1_1_0=OpenLayers.Format.WMSDescribeLayer.v1_1_1,OpenLayers.Control.ScaleLine=OpenLayers.Class(OpenLayers.Control,{maxWidth:100,topOutUnits:"km",topInUnits:"m",bottomOutUnits:"mi",bottomInUnits:"ft",eTop:null,eBottom:null,geodesic:!1,draw:function(){if(OpenLayers.Control.prototype.draw.apply(this,arguments),!this.eTop){this.eTop=document.createElement("div"),this.eTop.className=this.displayClass+"Top";{this.topInUnits.length}this.div.appendChild(this.eTop),this.eTop.style.visibility=""==this.topOutUnits||""==this.topInUnits?"hidden":"visible",this.eBottom=document.createElement("div"),this.eBottom.className=this.displayClass+"Bottom",this.div.appendChild(this.eBottom),this.eBottom.style.visibility=""==this.bottomOutUnits||""==this.bottomInUnits?"hidden":"visible"}return this.map.events.register("moveend",this,this.update),this.update(),this.div},getBarLen:function(t){var e,i=parseInt(Math.log(t)/Math.log(10)),n=Math.pow(10,i),s=parseInt(t/n);return e=s>5?5:s>2?2:1,e*n},update:function(){var t=this.map.getResolution();if(t){var e=this.map.getUnits(),i=OpenLayers.INCHES_PER_UNIT,n=this.maxWidth*t*i[e],s=1;if(this.geodesic===!0){var r=(this.map.getGeodesicPixelSize().w||1e-6)*this.maxWidth,o=n/i.km;s=r/o,n*=s}var a,l;n>1e5?(a=this.topOutUnits,l=this.bottomOutUnits):(a=this.topInUnits,l=this.bottomInUnits);var h=n/i[a],u=n/i[l],p=this.getBarLen(h),c=this.getBarLen(u);h=p/i[e]*i[a],u=c/i[e]*i[l];var d=h/t/s,m=u/t/s;"visible"==this.eBottom.style.visibility&&(this.eBottom.style.width=Math.round(m)+"px",this.eBottom.innerHTML=c+" "+l),"visible"==this.eTop.style.visibility&&(this.eTop.style.width=Math.round(d)+"px",this.eTop.innerHTML=p+" "+a)}},CLASS_NAME:"OpenLayers.Control.ScaleLine"}),OpenLayers.Icon=OpenLayers.Class({url:null,size:null,offset:null,calculateOffset:null,imageDiv:null,px:null,initialize:function(t,e,i,n){this.url=t,this.size=e||{w:20,h:20},this.offset=i||{x:-(this.size.w/2),y:-(this.size.h/2)},this.calculateOffset=n;var s=OpenLayers.Util.createUniqueID("OL_Icon_");this.imageDiv=OpenLayers.Util.createAlphaImageDiv(s)},destroy:function(){this.erase(),OpenLayers.Event.stopObservingElement(this.imageDiv.firstChild),this.imageDiv.innerHTML="",this.imageDiv=null},clone:function(){return new OpenLayers.Icon(this.url,this.size,this.offset,this.calculateOffset)},setSize:function(t){null!=t&&(this.size=t),this.draw()},setUrl:function(t){null!=t&&(this.url=t),this.draw()},draw:function(t){return OpenLayers.Util.modifyAlphaImageDiv(this.imageDiv,null,null,this.size,this.url,"absolute"),this.moveTo(t),this.imageDiv},erase:function(){null!=this.imageDiv&&null!=this.imageDiv.parentNode&&OpenLayers.Element.remove(this.imageDiv)},setOpacity:function(t){OpenLayers.Util.modifyAlphaImageDiv(this.imageDiv,null,null,null,null,null,null,null,t)},moveTo:function(t){null!=t&&(this.px=t),null!=this.imageDiv&&(null==this.px?this.display(!1):(this.calculateOffset&&(this.offset=this.calculateOffset(this.size)),OpenLayers.Util.modifyAlphaImageDiv(this.imageDiv,null,{x:this.px.x+this.offset.x,y:this.px.y+this.offset.y})))},display:function(t){this.imageDiv.style.display=t?"":"none"},isDrawn:function(){var t=this.imageDiv&&this.imageDiv.parentNode&&11!=this.imageDiv.parentNode.nodeType;return t},CLASS_NAME:"OpenLayers.Icon"}),OpenLayers.Marker=OpenLayers.Class({icon:null,lonlat:null,events:null,map:null,initialize:function(t,e){this.lonlat=t;var i=e?e:OpenLayers.Marker.defaultIcon();null==this.icon?this.icon=i:(this.icon.url=i.url,this.icon.size=i.size,this.icon.offset=i.offset,this.icon.calculateOffset=i.calculateOffset),this.events=new OpenLayers.Events(this,this.icon.imageDiv)},destroy:function(){this.erase(),this.map=null,this.events.destroy(),this.events=null,null!=this.icon&&(this.icon.destroy(),this.icon=null)},draw:function(t){return this.icon.draw(t)},erase:function(){null!=this.icon&&this.icon.erase()},moveTo:function(t){null!=t&&null!=this.icon&&this.icon.moveTo(t),this.lonlat=this.map.getLonLatFromLayerPx(t)},isDrawn:function(){var t=this.icon&&this.icon.isDrawn();return t},onScreen:function(){var t=!1;if(this.map){var e=this.map.getExtent();t=e.containsLonLat(this.lonlat)}return t},inflate:function(t){this.icon&&this.icon.setSize({w:this.icon.size.w*t,h:this.icon.size.h*t})},setOpacity:function(t){this.icon.setOpacity(t)},setUrl:function(t){this.icon.setUrl(t)},display:function(t){this.icon.display(t)},CLASS_NAME:"OpenLayers.Marker"}),OpenLayers.Marker.defaultIcon=function(){return new OpenLayers.Icon(OpenLayers.Util.getImageLocation("marker.png"),{w:21,h:25},{x:-10.5,y:-25})},OpenLayers.Popup=OpenLayers.Class({events:null,id:"",lonlat:null,div:null,contentSize:null,size:null,contentHTML:null,backgroundColor:"",opacity:"",border:"",contentDiv:null,groupDiv:null,closeDiv:null,autoSize:!1,minSize:null,maxSize:null,displayClass:"olPopup",contentDisplayClass:"olPopupContent",padding:0,disableFirefoxOverflowHack:!1,fixPadding:function(){"number"==typeof this.padding&&(this.padding=new OpenLayers.Bounds(this.padding,this.padding,this.padding,this.padding))},panMapIfOutOfView:!1,keepInMap:!1,closeOnMove:!1,map:null,initialize:function(t,e,i,n,s,r){null==t&&(t=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")),this.id=t,this.lonlat=e,this.contentSize=null!=i?i:new OpenLayers.Size(OpenLayers.Popup.WIDTH,OpenLayers.Popup.HEIGHT),null!=n&&(this.contentHTML=n),this.backgroundColor=OpenLayers.Popup.COLOR,this.opacity=OpenLayers.Popup.OPACITY,this.border=OpenLayers.Popup.BORDER,this.div=OpenLayers.Util.createDiv(this.id,null,null,null,null,null,"hidden"),this.div.className=this.displayClass;var o=this.id+"_GroupDiv";this.groupDiv=OpenLayers.Util.createDiv(o,null,null,null,"relative",null,"hidden");var t=this.div.id+"_contentDiv";this.contentDiv=OpenLayers.Util.createDiv(t,null,this.contentSize.clone(),null,"relative"),this.contentDiv.className=this.contentDisplayClass,this.groupDiv.appendChild(this.contentDiv),this.div.appendChild(this.groupDiv),s&&this.addCloseBox(r),this.registerEvents()},destroy:function(){this.id=null,this.lonlat=null,this.size=null,this.contentHTML=null,this.backgroundColor=null,this.opacity=null,this.border=null,this.closeOnMove&&this.map&&this.map.events.unregister("movestart",this,this.hide),this.events.destroy(),this.events=null,this.closeDiv&&(OpenLayers.Event.stopObservingElement(this.closeDiv),this.groupDiv.removeChild(this.closeDiv)),this.closeDiv=null,this.div.removeChild(this.groupDiv),this.groupDiv=null,null!=this.map&&this.map.removePopup(this),this.map=null,this.div=null,this.autoSize=null,this.minSize=null,this.maxSize=null,this.padding=null,this.panMapIfOutOfView=null},draw:function(t){return null==t&&null!=this.lonlat&&null!=this.map&&(t=this.map.getLayerPxFromLonLat(this.lonlat)),this.closeOnMove&&this.map.events.register("movestart",this,this.hide),this.disableFirefoxOverflowHack||"firefox"!=OpenLayers.BROWSER_NAME||(this.map.events.register("movestart",this,function(){var t=document.defaultView.getComputedStyle(this.contentDiv,null),e=t.getPropertyValue("overflow");"hidden"!=e&&(this.contentDiv._oldOverflow=e,this.contentDiv.style.overflow="hidden")}),this.map.events.register("moveend",this,function(){var t=this.contentDiv._oldOverflow;t&&(this.contentDiv.style.overflow=t,this.contentDiv._oldOverflow=null)})),this.moveTo(t),this.autoSize||this.size||this.setSize(this.contentSize),this.setBackgroundColor(),this.setOpacity(),this.setBorder(),this.setContentHTML(),this.panMapIfOutOfView&&this.panIntoView(),this.div},updatePosition:function(){if(this.lonlat&&this.map){var t=this.map.getLayerPxFromLonLat(this.lonlat);t&&this.moveTo(t)}},moveTo:function(t){null!=t&&null!=this.div&&(this.div.style.left=t.x+"px",this.div.style.top=t.y+"px")},visible:function(){return OpenLayers.Element.visible(this.div)},toggle:function(){this.visible()?this.hide():this.show()},show:function(){this.div.style.display="",this.panMapIfOutOfView&&this.panIntoView()},hide:function(){this.div.style.display="none"},setSize:function(t){this.size=t.clone();var e=this.getContentDivPadding(),i=e.left+e.right,n=e.top+e.bottom;if(this.fixPadding(),i+=this.padding.left+this.padding.right,n+=this.padding.top+this.padding.bottom,this.closeDiv){var s=parseInt(this.closeDiv.style.width);i+=s+e.right}this.size.w+=i,this.size.h+=n,"msie"==OpenLayers.BROWSER_NAME&&(this.contentSize.w+=e.left+e.right,this.contentSize.h+=e.bottom+e.top),null!=this.div&&(this.div.style.width=this.size.w+"px",this.div.style.height=this.size.h+"px"),null!=this.contentDiv&&(this.contentDiv.style.width=t.w+"px",this.contentDiv.style.height=t.h+"px")},updateSize:function(){var t="<div class='"+this.contentDisplayClass+"'>"+this.contentDiv.innerHTML+"</div>",e=this.map?this.map.div:document.body,i=OpenLayers.Util.getRenderedDimensions(t,null,{displayClass:this.displayClass,containerElement:e}),n=this.getSafeContentSize(i),s=null;if(n.equals(i))s=i;else{var r={w:n.w<i.w?n.w:null,h:n.h<i.h?n.h:null};if(r.w&&r.h)s=n;else{var o=OpenLayers.Util.getRenderedDimensions(t,r,{displayClass:this.contentDisplayClass,containerElement:e}),a=OpenLayers.Element.getStyle(this.contentDiv,"overflow");if("hidden"!=a&&o.equals(n)){var l=OpenLayers.Util.getScrollbarWidth();r.w?o.h+=l:o.w+=l}s=this.getSafeContentSize(o)}}this.setSize(s)},setBackgroundColor:function(t){void 0!=t&&(this.backgroundColor=t),null!=this.div&&(this.div.style.backgroundColor=this.backgroundColor)},setOpacity:function(t){void 0!=t&&(this.opacity=t),null!=this.div&&(this.div.style.opacity=this.opacity,this.div.style.filter="alpha(opacity="+100*this.opacity+")")},setBorder:function(t){void 0!=t&&(this.border=t),null!=this.div&&(this.div.style.border=this.border)},setContentHTML:function(t){null!=t&&(this.contentHTML=t),null!=this.contentDiv&&null!=this.contentHTML&&this.contentHTML!=this.contentDiv.innerHTML&&(this.contentDiv.innerHTML=this.contentHTML,this.autoSize&&(this.registerImageListeners(),this.updateSize()))},registerImageListeners:function(){for(var t=function(){null!==this.popup.id&&(this.popup.updateSize(),this.popup.visible()&&this.popup.panMapIfOutOfView&&this.popup.panIntoView(),OpenLayers.Event.stopObserving(this.img,"load",this.img._onImgLoad))},e=this.contentDiv.getElementsByTagName("img"),i=0,n=e.length;n>i;i++){var s=e[i];if(0==s.width||0==s.height){var r={popup:this,img:s};s._onImgLoad=OpenLayers.Function.bind(t,r),OpenLayers.Event.observe(s,"load",s._onImgLoad)}}},getSafeContentSize:function(t){var e=t.clone(),i=this.getContentDivPadding(),n=i.left+i.right,s=i.top+i.bottom;if(this.fixPadding(),n+=this.padding.left+this.padding.right,s+=this.padding.top+this.padding.bottom,this.closeDiv){var r=parseInt(this.closeDiv.style.width);n+=r+i.right}if(this.minSize&&(e.w=Math.max(e.w,this.minSize.w-n),e.h=Math.max(e.h,this.minSize.h-s)),this.maxSize&&(e.w=Math.min(e.w,this.maxSize.w-n),e.h=Math.min(e.h,this.maxSize.h-s)),this.map&&this.map.size){var o=0,a=0;if(this.keepInMap&&!this.panMapIfOutOfView){var l=this.map.getPixelFromLonLat(this.lonlat);switch(this.relativePosition){case"tr":o=l.x,a=this.map.size.h-l.y;break;case"tl":o=this.map.size.w-l.x,a=this.map.size.h-l.y;break;case"bl":o=this.map.size.w-l.x,a=l.y;break;case"br":o=l.x,a=l.y;break;default:o=l.x,a=this.map.size.h-l.y}}var h=this.map.size.h-this.map.paddingForPopups.top-this.map.paddingForPopups.bottom-s-a,u=this.map.size.w-this.map.paddingForPopups.left-this.map.paddingForPopups.right-n-o;e.w=Math.min(e.w,u),e.h=Math.min(e.h,h)}return e},getContentDivPadding:function(){var t=this._contentDivPadding;return t||(null==this.div.parentNode&&(this.div.style.display="none",document.body.appendChild(this.div)),t=new OpenLayers.Bounds(OpenLayers.Element.getStyle(this.contentDiv,"padding-left"),OpenLayers.Element.getStyle(this.contentDiv,"padding-bottom"),OpenLayers.Element.getStyle(this.contentDiv,"padding-right"),OpenLayers.Element.getStyle(this.contentDiv,"padding-top")),this._contentDivPadding=t,this.div.parentNode==document.body&&(document.body.removeChild(this.div),this.div.style.display="")),t},addCloseBox:function(t){this.closeDiv=OpenLayers.Util.createDiv(this.id+"_close",null,{w:17,h:17}),this.closeDiv.className="olPopupCloseBox";var e=this.getContentDivPadding();this.closeDiv.style.right=e.right+"px",this.closeDiv.style.top=e.top+"px",this.groupDiv.appendChild(this.closeDiv);var i=t||function(t){this.hide(),OpenLayers.Event.stop(t)};OpenLayers.Event.observe(this.closeDiv,"touchend",OpenLayers.Function.bindAsEventListener(i,this)),OpenLayers.Event.observe(this.closeDiv,"click",OpenLayers.Function.bindAsEventListener(i,this))},panIntoView:function(){var t=this.map.getSize(),e=this.map.getViewPortPxFromLayerPx(new OpenLayers.Pixel(parseInt(this.div.style.left),parseInt(this.div.style.top))),i=e.clone();e.x<this.map.paddingForPopups.left?i.x=this.map.paddingForPopups.left:e.x+this.size.w>t.w-this.map.paddingForPopups.right&&(i.x=t.w-this.map.paddingForPopups.right-this.size.w),e.y<this.map.paddingForPopups.top?i.y=this.map.paddingForPopups.top:e.y+this.size.h>t.h-this.map.paddingForPopups.bottom&&(i.y=t.h-this.map.paddingForPopups.bottom-this.size.h);var n=e.x-i.x,s=e.y-i.y;this.map.pan(n,s)},registerEvents:function(){function t(t){OpenLayers.Event.stop(t,!0)}this.events=new OpenLayers.Events(this,this.div,null,!0),this.events.on({mousedown:this.onmousedown,mousemove:this.onmousemove,mouseup:this.onmouseup,click:this.onclick,mouseout:this.onmouseout,dblclick:this.ondblclick,touchstart:t,scope:this})},onmousedown:function(t){this.mousedown=!0,OpenLayers.Event.stop(t,!0)},onmousemove:function(t){this.mousedown&&OpenLayers.Event.stop(t,!0)},onmouseup:function(t){this.mousedown&&(this.mousedown=!1,OpenLayers.Event.stop(t,!0))},onclick:function(t){OpenLayers.Event.stop(t,!0)},onmouseout:function(){this.mousedown=!1},ondblclick:function(t){OpenLayers.Event.stop(t,!0)},CLASS_NAME:"OpenLayers.Popup"}),OpenLayers.Popup.WIDTH=200,OpenLayers.Popup.HEIGHT=200,OpenLayers.Popup.COLOR="white",OpenLayers.Popup.OPACITY=1,OpenLayers.Popup.BORDER="0px",OpenLayers.Strategy.Paging=OpenLayers.Class(OpenLayers.Strategy,{features:null,length:10,num:null,paging:!1,activate:function(){var t=OpenLayers.Strategy.prototype.activate.call(this);return t&&this.layer.events.on({beforefeaturesadded:this.cacheFeatures,scope:this}),t},deactivate:function(){var t=OpenLayers.Strategy.prototype.deactivate.call(this);return t&&(this.clearCache(),this.layer.events.un({beforefeaturesadded:this.cacheFeatures,scope:this})),t},cacheFeatures:function(t){this.paging||(this.clearCache(),this.features=t.features,this.pageNext(t))},clearCache:function(){if(this.features)for(var t=0;t<this.features.length;++t)this.features[t].destroy();this.features=null,this.num=null},pageCount:function(){var t=this.features?this.features.length:0;return Math.ceil(t/this.length)},pageNum:function(){return this.num},pageLength:function(t){return t&&t>0&&(this.length=t),this.length},pageNext:function(t){var e=!1;if(this.features){null===this.num&&(this.num=-1);var i=(this.num+1)*this.length;e=this.page(i,t)}return e},pagePrevious:function(){var t=!1;if(this.features){null===this.num&&(this.num=this.pageCount());var e=(this.num-1)*this.length;t=this.page(e)}return t},page:function(t,e){var i=!1;if(this.features&&t>=0&&t<this.features.length){var n=Math.floor(t/this.length);if(n!=this.num){this.paging=!0;var s=this.features.slice(t,t+this.length);this.layer.removeFeatures(this.layer.features),this.num=n,e&&e.features?e.features=s:this.layer.addFeatures(s),this.paging=!1,i=!0}}return i},CLASS_NAME:"OpenLayers.Strategy.Paging"}),OpenLayers.Popup.Anchored=OpenLayers.Class(OpenLayers.Popup,{relativePosition:null,keepInMap:!0,anchor:null,initialize:function(t,e,i,n,s,r,o){var a=[t,e,i,n,r,o];OpenLayers.Popup.prototype.initialize.apply(this,a),this.anchor=null!=s?s:{size:new OpenLayers.Size(0,0),offset:new OpenLayers.Pixel(0,0)}},destroy:function(){this.anchor=null,this.relativePosition=null,OpenLayers.Popup.prototype.destroy.apply(this,arguments)},show:function(){this.updatePosition(),OpenLayers.Popup.prototype.show.apply(this,arguments)},moveTo:function(t){var e=this.relativePosition;this.relativePosition=this.calculateRelativePosition(t),OpenLayers.Popup.prototype.moveTo.call(this,this.calculateNewPx(t)),this.relativePosition!=e&&this.updateRelativePosition()},setSize:function(){if(OpenLayers.Popup.prototype.setSize.apply(this,arguments),this.lonlat&&this.map){var t=this.map.getLayerPxFromLonLat(this.lonlat);this.moveTo(t)}},calculateRelativePosition:function(t){var e=this.map.getLonLatFromLayerPx(t),i=this.map.getExtent(),n=i.determineQuadrant(e);return OpenLayers.Bounds.oppositeQuadrant(n)},updateRelativePosition:function(){},calculateNewPx:function(t){var e=t.offset(this.anchor.offset),i=this.size||this.contentSize,n="t"==this.relativePosition.charAt(0);e.y+=n?-i.h:this.anchor.size.h;var s="l"==this.relativePosition.charAt(1);return e.x+=s?-i.w:this.anchor.size.w,e},CLASS_NAME:"OpenLayers.Popup.Anchored"}),OpenLayers.Popup.Framed=OpenLayers.Class(OpenLayers.Popup.Anchored,{imageSrc:null,imageSize:null,isAlphaImage:!1,positionBlocks:null,blocks:null,fixedRelativePosition:!1,initialize:function(t,e,i,n,s,r){OpenLayers.Popup.Anchored.prototype.initialize.apply(this,arguments),this.fixedRelativePosition&&(this.updateRelativePosition(),this.calculateRelativePosition=function(){return this.relativePosition}),this.contentDiv.style.position="absolute",this.contentDiv.style.zIndex=1,r&&(this.closeDiv.style.zIndex=1),this.groupDiv.style.position="absolute",this.groupDiv.style.top="0px",this.groupDiv.style.left="0px",this.groupDiv.style.height="100%",this.groupDiv.style.width="100%"},destroy:function(){this.imageSrc=null,this.imageSize=null,this.isAlphaImage=null,this.fixedRelativePosition=!1,this.positionBlocks=null;for(var t=0;t<this.blocks.length;t++){var e=this.blocks[t];e.image&&e.div.removeChild(e.image),e.image=null,e.div&&this.groupDiv.removeChild(e.div),e.div=null}this.blocks=null,OpenLayers.Popup.Anchored.prototype.destroy.apply(this,arguments)},setBackgroundColor:function(){},setBorder:function(){},setOpacity:function(){},setSize:function(){OpenLayers.Popup.Anchored.prototype.setSize.apply(this,arguments),this.updateBlocks()},updateRelativePosition:function(){if(this.padding=this.positionBlocks[this.relativePosition].padding,this.closeDiv){var t=this.getContentDivPadding();this.closeDiv.style.right=t.right+this.padding.right+"px",this.closeDiv.style.top=t.top+this.padding.top+"px"}this.updateBlocks()},calculateNewPx:function(){var t=OpenLayers.Popup.Anchored.prototype.calculateNewPx.apply(this,arguments);return t=t.offset(this.positionBlocks[this.relativePosition].offset)},createBlocks:function(){this.blocks=[];var t=null;for(var e in this.positionBlocks){t=e;break}for(var i=this.positionBlocks[t],n=0;n<i.blocks.length;n++){var s={};this.blocks.push(s);var r=this.id+"_FrameDecorationDiv_"+n;s.div=OpenLayers.Util.createDiv(r,null,null,null,"absolute",null,"hidden",null);var o=this.id+"_FrameDecorationImg_"+n,a=this.isAlphaImage?OpenLayers.Util.createAlphaImageDiv:OpenLayers.Util.createImage;s.image=a(o,null,this.imageSize,this.imageSrc,"absolute",null,null,null),s.div.appendChild(s.image),this.groupDiv.appendChild(s.div)}},updateBlocks:function(){if(this.blocks||this.createBlocks(),this.size&&this.relativePosition){for(var t=this.positionBlocks[this.relativePosition],e=0;e<t.blocks.length;e++){var i=t.blocks[e],n=this.blocks[e],s=i.anchor.left,r=i.anchor.bottom,o=i.anchor.right,a=i.anchor.top,l=isNaN(i.size.w)?this.size.w-(o+s):i.size.w,h=isNaN(i.size.h)?this.size.h-(r+a):i.size.h;n.div.style.width=(0>l?0:l)+"px",n.div.style.height=(0>h?0:h)+"px",n.div.style.left=null!=s?s+"px":"",n.div.style.bottom=null!=r?r+"px":"",n.div.style.right=null!=o?o+"px":"",n.div.style.top=null!=a?a+"px":"",n.image.style.left=i.position.x+"px",n.image.style.top=i.position.y+"px"}this.contentDiv.style.left=this.padding.left+"px",this.contentDiv.style.top=this.padding.top+"px"}},CLASS_NAME:"OpenLayers.Popup.Framed"}),OpenLayers.Handler.Box=OpenLayers.Class(OpenLayers.Handler,{dragHandler:null,boxDivClassName:"olHandlerBoxZoomBox",boxOffsets:null,initialize:function(){OpenLayers.Handler.prototype.initialize.apply(this,arguments),this.dragHandler=new OpenLayers.Handler.Drag(this,{down:this.startBox,move:this.moveBox,out:this.removeBox,up:this.endBox},{keyMask:this.keyMask})},destroy:function(){OpenLayers.Handler.prototype.destroy.apply(this,arguments),this.dragHandler&&(this.dragHandler.destroy(),this.dragHandler=null)},setMap:function(t){OpenLayers.Handler.prototype.setMap.apply(this,arguments),this.dragHandler&&this.dragHandler.setMap(t)},startBox:function(){this.callback("start",[]),this.zoomBox=OpenLayers.Util.createDiv("zoomBox",{x:-9999,y:-9999}),this.zoomBox.className=this.boxDivClassName,this.zoomBox.style.zIndex=this.map.Z_INDEX_BASE.Popup-1,this.map.viewPortDiv.appendChild(this.zoomBox),OpenLayers.Element.addClass(this.map.viewPortDiv,"olDrawBox")},moveBox:function(t){var e=this.dragHandler.start.x,i=this.dragHandler.start.y,n=Math.abs(e-t.x),s=Math.abs(i-t.y),r=this.getBoxOffsets();this.zoomBox.style.width=n+r.width+1+"px",this.zoomBox.style.height=s+r.height+1+"px",this.zoomBox.style.left=(t.x<e?e-n-r.left:e-r.left)+"px",this.zoomBox.style.top=(t.y<i?i-s-r.top:i-r.top)+"px"},endBox:function(t){var e;if(Math.abs(this.dragHandler.start.x-t.x)>5||Math.abs(this.dragHandler.start.y-t.y)>5){var i=this.dragHandler.start,n=Math.min(i.y,t.y),s=Math.max(i.y,t.y),r=Math.min(i.x,t.x),o=Math.max(i.x,t.x);e=new OpenLayers.Bounds(r,s,o,n)}else e=this.dragHandler.start.clone();this.removeBox(),this.callback("done",[e])},removeBox:function(){this.map.viewPortDiv.removeChild(this.zoomBox),this.zoomBox=null,this.boxOffsets=null,OpenLayers.Element.removeClass(this.map.viewPortDiv,"olDrawBox")},activate:function(){return OpenLayers.Handler.prototype.activate.apply(this,arguments)?(this.dragHandler.activate(),!0):!1},deactivate:function(){return OpenLayers.Handler.prototype.deactivate.apply(this,arguments)?(this.dragHandler.deactivate()&&this.zoomBox&&this.removeBox(),!0):!1},getBoxOffsets:function(){if(!this.boxOffsets){var t=document.createElement("div");t.style.position="absolute",t.style.border="1px solid black",t.style.width="3px",document.body.appendChild(t);var e=3==t.clientWidth;document.body.removeChild(t);var i=parseInt(OpenLayers.Element.getStyle(this.zoomBox,"border-left-width")),n=parseInt(OpenLayers.Element.getStyle(this.zoomBox,"border-right-width")),s=parseInt(OpenLayers.Element.getStyle(this.zoomBox,"border-top-width")),r=parseInt(OpenLayers.Element.getStyle(this.zoomBox,"border-bottom-width"));this.boxOffsets={left:i,right:n,top:s,bottom:r,width:e===!1?i+n:0,height:e===!1?s+r:0}
}return this.boxOffsets},CLASS_NAME:"OpenLayers.Handler.Box"}),OpenLayers.Control.ZoomBox=OpenLayers.Class(OpenLayers.Control,{type:OpenLayers.Control.TYPE_TOOL,out:!1,keyMask:null,alwaysZoom:!1,zoomOnClick:!0,draw:function(){this.handler=new OpenLayers.Handler.Box(this,{done:this.zoomBox},{keyMask:this.keyMask})},zoomBox:function(t){if(t instanceof OpenLayers.Bounds){var e,i=t.getCenterPixel();if(this.out){var n=t.right-t.left,s=t.bottom-t.top,r=Math.min(this.map.size.h/s,this.map.size.w/n),o=this.map.getExtent(),a=this.map.getLonLatFromPixel(i),l=a.lon-o.getWidth()/2*r,h=a.lon+o.getWidth()/2*r,u=a.lat-o.getHeight()/2*r,p=a.lat+o.getHeight()/2*r;e=new OpenLayers.Bounds(l,u,h,p)}else{var c=this.map.getLonLatFromPixel({x:t.left,y:t.bottom}),d=this.map.getLonLatFromPixel({x:t.right,y:t.top});e=new OpenLayers.Bounds(c.lon,c.lat,d.lon,d.lat)}var m=this.map.getZoom(),f=this.map.getSize(),y={x:f.w/2,y:f.h/2},g=this.map.getZoomForExtent(e),v=this.map.getResolution(),L=this.map.getResolutionForZoom(g);if(v==L)this.map.setCenter(this.map.getLonLatFromPixel(i));else{var _={x:(v*i.x-L*y.x)/(v-L),y:(v*i.y-L*y.y)/(v-L)};this.map.zoomTo(g,_)}m==this.map.getZoom()&&1==this.alwaysZoom&&this.map.zoomTo(m+(this.out?-1:1))}else this.zoomOnClick&&(this.out?this.map.zoomTo(this.map.getZoom()-1,t):this.map.zoomTo(this.map.getZoom()+1,t))},CLASS_NAME:"OpenLayers.Control.ZoomBox"}),OpenLayers.Control.DragPan=OpenLayers.Class(OpenLayers.Control,{type:OpenLayers.Control.TYPE_TOOL,panned:!1,interval:0,documentDrag:!1,kinetic:null,enableKinetic:!0,kineticInterval:10,draw:function(){if(this.enableKinetic&&OpenLayers.Kinetic){var t={interval:this.kineticInterval};"object"==typeof this.enableKinetic&&(t=OpenLayers.Util.extend(t,this.enableKinetic)),this.kinetic=new OpenLayers.Kinetic(t)}this.handler=new OpenLayers.Handler.Drag(this,{move:this.panMap,done:this.panMapDone,down:this.panMapStart},{interval:this.interval,documentDrag:this.documentDrag})},panMapStart:function(){this.kinetic&&this.kinetic.begin()},panMap:function(t){this.kinetic&&this.kinetic.update(t),this.panned=!0,this.map.pan(this.handler.last.x-t.x,this.handler.last.y-t.y,{dragging:!0,animate:!1})},panMapDone:function(t){if(this.panned){var e=null;if(this.kinetic&&(e=this.kinetic.end(t)),this.map.pan(this.handler.last.x-t.x,this.handler.last.y-t.y,{dragging:!!e,animate:!1}),e){var i=this;this.kinetic.move(e,function(t,e,n){i.map.pan(t,e,{dragging:!n,animate:!1})})}this.panned=!1}},CLASS_NAME:"OpenLayers.Control.DragPan"}),OpenLayers.Control.Navigation=OpenLayers.Class(OpenLayers.Control,{dragPan:null,dragPanOptions:null,pinchZoom:null,pinchZoomOptions:null,documentDrag:!1,zoomBox:null,zoomBoxEnabled:!0,zoomWheelEnabled:!0,mouseWheelOptions:null,handleRightClicks:!1,zoomBoxKeyMask:OpenLayers.Handler.MOD_SHIFT,autoActivate:!0,initialize:function(){this.handlers={},OpenLayers.Control.prototype.initialize.apply(this,arguments)},destroy:function(){this.deactivate(),this.dragPan&&this.dragPan.destroy(),this.dragPan=null,this.zoomBox&&this.zoomBox.destroy(),this.zoomBox=null,this.pinchZoom&&this.pinchZoom.destroy(),this.pinchZoom=null,OpenLayers.Control.prototype.destroy.apply(this,arguments)},activate:function(){return this.dragPan.activate(),this.zoomWheelEnabled&&this.handlers.wheel.activate(),this.handlers.click.activate(),this.zoomBoxEnabled&&this.zoomBox.activate(),this.pinchZoom&&this.pinchZoom.activate(),OpenLayers.Control.prototype.activate.apply(this,arguments)},deactivate:function(){return this.pinchZoom&&this.pinchZoom.deactivate(),this.zoomBox.deactivate(),this.dragPan.deactivate(),this.handlers.click.deactivate(),this.handlers.wheel.deactivate(),OpenLayers.Control.prototype.deactivate.apply(this,arguments)},draw:function(){this.handleRightClicks&&(this.map.viewPortDiv.oncontextmenu=OpenLayers.Function.False);var t={click:this.defaultClick,dblclick:this.defaultDblClick,dblrightclick:this.defaultDblRightClick},e={"double":!0,stopDouble:!0};this.handlers.click=new OpenLayers.Handler.Click(this,t,e),this.dragPan=new OpenLayers.Control.DragPan(OpenLayers.Util.extend({map:this.map,documentDrag:this.documentDrag},this.dragPanOptions)),this.zoomBox=new OpenLayers.Control.ZoomBox({map:this.map,keyMask:this.zoomBoxKeyMask}),this.dragPan.draw(),this.zoomBox.draw();var i=this.map.fractionalZoom?{}:{cumulative:!1,interval:50,maxDelta:6};this.handlers.wheel=new OpenLayers.Handler.MouseWheel(this,{up:this.wheelUp,down:this.wheelDown},OpenLayers.Util.extend(i,this.mouseWheelOptions)),OpenLayers.Control.PinchZoom&&(this.pinchZoom=new OpenLayers.Control.PinchZoom(OpenLayers.Util.extend({map:this.map},this.pinchZoomOptions)))},defaultClick:function(t){t.lastTouches&&2==t.lastTouches.length&&this.map.zoomOut()},defaultDblClick:function(t){this.map.zoomTo(this.map.zoom+1,t.xy)},defaultDblRightClick:function(t){this.map.zoomTo(this.map.zoom-1,t.xy)},wheelChange:function(t,e){this.map.fractionalZoom||(e=Math.round(e));var i=this.map.getZoom(),n=i+e;n=Math.max(n,0),n=Math.min(n,this.map.getNumZoomLevels()),n!==i&&this.map.zoomTo(n,t.xy)},wheelUp:function(t,e){this.wheelChange(t,e||1)},wheelDown:function(t,e){this.wheelChange(t,e||-1)},disableZoomBox:function(){this.zoomBoxEnabled=!1,this.zoomBox.deactivate()},enableZoomBox:function(){this.zoomBoxEnabled=!0,this.active&&this.zoomBox.activate()},disableZoomWheel:function(){this.zoomWheelEnabled=!1,this.handlers.wheel.deactivate()},enableZoomWheel:function(){this.zoomWheelEnabled=!0,this.active&&this.handlers.wheel.activate()},CLASS_NAME:"OpenLayers.Control.Navigation"}),OpenLayers.Control.DrawFeature=OpenLayers.Class(OpenLayers.Control,{layer:null,callbacks:null,multi:!1,featureAdded:function(){},initialize:function(t,e,i){OpenLayers.Control.prototype.initialize.apply(this,[i]),this.callbacks=OpenLayers.Util.extend({done:this.drawFeature,modify:function(t,e){this.layer.events.triggerEvent("sketchmodified",{vertex:t,feature:e})},create:function(t,e){this.layer.events.triggerEvent("sketchstarted",{vertex:t,feature:e})}},this.callbacks),this.layer=t,this.handlerOptions=this.handlerOptions||{},this.handlerOptions.layerOptions=OpenLayers.Util.applyDefaults(this.handlerOptions.layerOptions,{renderers:t.renderers,rendererOptions:t.rendererOptions}),"multi"in this.handlerOptions||(this.handlerOptions.multi=this.multi);var n=this.layer.styleMap&&this.layer.styleMap.styles.temporary;n&&(this.handlerOptions.layerOptions=OpenLayers.Util.applyDefaults(this.handlerOptions.layerOptions,{styleMap:new OpenLayers.StyleMap({"default":n})})),this.handler=new e(this,this.callbacks,this.handlerOptions)},drawFeature:function(t){var e=new OpenLayers.Feature.Vector(t),i=this.layer.events.triggerEvent("sketchcomplete",{feature:e});i!==!1&&(e.state=OpenLayers.State.INSERT,this.layer.addFeatures([e]),this.featureAdded(e),this.events.triggerEvent("featureadded",{feature:e}))},insertXY:function(t,e){this.handler&&this.handler.line&&this.handler.insertXY(t,e)},insertDeltaXY:function(t,e){this.handler&&this.handler.line&&this.handler.insertDeltaXY(t,e)},insertDirectionLength:function(t,e){this.handler&&this.handler.line&&this.handler.insertDirectionLength(t,e)},insertDeflectionLength:function(t,e){this.handler&&this.handler.line&&this.handler.insertDeflectionLength(t,e)},undo:function(){return this.handler.undo&&this.handler.undo()},redo:function(){return this.handler.redo&&this.handler.redo()},finishSketch:function(){this.handler.finishGeometry()},cancel:function(){this.handler.cancel()},CLASS_NAME:"OpenLayers.Control.DrawFeature"}),OpenLayers.Handler.Polygon=OpenLayers.Class(OpenLayers.Handler.Path,{holeModifier:null,drawingHole:!1,polygon:null,createFeature:function(t){var e=this.layer.getLonLatFromViewPortPx(t),i=new OpenLayers.Geometry.Point(e.lon,e.lat);this.point=new OpenLayers.Feature.Vector(i),this.line=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LinearRing([this.point.geometry])),this.polygon=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Polygon([this.line.geometry])),this.callback("create",[this.point.geometry,this.getSketch()]),this.point.geometry.clearBounds(),this.layer.addFeatures([this.polygon,this.point],{silent:!0})},addPoint:function(){if(!this.drawingHole&&this.holeModifier&&this.evt&&this.evt[this.holeModifier])for(var t,e,i=this.point.geometry,n=this.control.layer.features,s=n.length-1;s>=0;--s)if(t=n[s].geometry,(t instanceof OpenLayers.Geometry.Polygon||t instanceof OpenLayers.Geometry.MultiPolygon)&&t.intersects(i)){e=n[s],this.control.layer.removeFeatures([e],{silent:!0}),this.control.layer.events.registerPriority("sketchcomplete",this,this.finalizeInteriorRing),this.control.layer.events.registerPriority("sketchmodified",this,this.enforceTopology),e.geometry.addComponent(this.line.geometry),this.polygon=e,this.drawingHole=!0;break}OpenLayers.Handler.Path.prototype.addPoint.apply(this,arguments)},getCurrentPointIndex:function(){return this.line.geometry.components.length-2},enforceTopology:function(t){var e=t.vertex,i=this.line.geometry.components;if(!this.polygon.geometry.intersects(e)){var n=i[i.length-3];e.x=n.x,e.y=n.y}},finishGeometry:function(){var t=this.line.geometry.components.length-2;this.line.geometry.removeComponent(this.line.geometry.components[t]),this.removePoint(),this.finalize()},finalizeInteriorRing:function(){var t=this.line.geometry,e=0!==t.getArea();if(e){for(var i=this.polygon.geometry.components,n=i.length-2;n>=0;--n)if(t.intersects(i[n])){e=!1;break}if(e){t:for(var n=i.length-2;n>0;--n)for(var s=i[n].components,r=0,o=s.length;o>r;++r)if(t.containsPoint(s[r])){e=!1;break t}}}return e?this.polygon.state!==OpenLayers.State.INSERT&&(this.polygon.state=OpenLayers.State.UPDATE):this.polygon.geometry.removeComponent(t),this.restoreFeature(),!1},cancel:function(){return this.drawingHole&&(this.polygon.geometry.removeComponent(this.line.geometry),this.restoreFeature(!0)),OpenLayers.Handler.Path.prototype.cancel.apply(this,arguments)},restoreFeature:function(t){this.control.layer.events.unregister("sketchcomplete",this,this.finalizeInteriorRing),this.control.layer.events.unregister("sketchmodified",this,this.enforceTopology),this.layer.removeFeatures([this.polygon],{silent:!0}),this.control.layer.addFeatures([this.polygon],{silent:!0}),this.drawingHole=!1,t||this.control.layer.events.triggerEvent("sketchcomplete",{feature:this.polygon})},destroyFeature:function(t){OpenLayers.Handler.Path.prototype.destroyFeature.call(this,t),this.polygon=null},drawFeature:function(){this.layer.drawFeature(this.polygon,this.style),this.layer.drawFeature(this.point,this.style)},getSketch:function(){return this.polygon},getGeometry:function(){var t=this.polygon&&this.polygon.geometry;return t&&this.multi&&(t=new OpenLayers.Geometry.MultiPolygon([t])),t},CLASS_NAME:"OpenLayers.Handler.Polygon"}),OpenLayers.Control.EditingToolbar=OpenLayers.Class(OpenLayers.Control.Panel,{citeCompliant:!1,initialize:function(t,e){OpenLayers.Control.Panel.prototype.initialize.apply(this,[e]),this.addControls([new OpenLayers.Control.Navigation]);var i=[new OpenLayers.Control.DrawFeature(t,OpenLayers.Handler.Point,{displayClass:"olControlDrawFeaturePoint",handlerOptions:{citeCompliant:this.citeCompliant}}),new OpenLayers.Control.DrawFeature(t,OpenLayers.Handler.Path,{displayClass:"olControlDrawFeaturePath",handlerOptions:{citeCompliant:this.citeCompliant}}),new OpenLayers.Control.DrawFeature(t,OpenLayers.Handler.Polygon,{displayClass:"olControlDrawFeaturePolygon",handlerOptions:{citeCompliant:this.citeCompliant}})];this.addControls(i)},draw:function(){var t=OpenLayers.Control.Panel.prototype.draw.apply(this,arguments);return null===this.defaultControl&&(this.defaultControl=this.controls[0]),t},CLASS_NAME:"OpenLayers.Control.EditingToolbar"}),OpenLayers.Format.WMSGetFeatureInfo=OpenLayers.Class(OpenLayers.Format.XML,{layerIdentifier:"_layer",featureIdentifier:"_feature",regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},gmlFormat:null,read:function(t){var e;"string"==typeof t&&(t=OpenLayers.Format.XML.prototype.read.apply(this,[t]));var i=t.documentElement;if(i){var n=this["read_"+i.nodeName];e=n?n.call(this,i):new OpenLayers.Format.GML(this.options?this.options:{}).read(t)}else e=t;return e},read_msGMLOutput:function(t){var e=[],i=this.getSiblingNodesByTagCriteria(t,this.layerIdentifier);if(i)for(var n=0,s=i.length;s>n;++n){var r=i[n],o=r.nodeName;r.prefix&&(o=o.split(":")[1]);var o=o.replace(this.layerIdentifier,""),a=this.getSiblingNodesByTagCriteria(r,this.featureIdentifier);if(a)for(var l=0;l<a.length;l++){var h=a[l],u=this.parseGeometry(h),p=this.parseAttributes(h),c=new OpenLayers.Feature.Vector(u.geometry,p,null);c.bounds=u.bounds,c.type=o,e.push(c)}}return e},read_FeatureInfoResponse:function(t){for(var e=[],i=this.getElementsByTagNameNS(t,"*","FIELDS"),n=0,s=i.length;s>n;n++){var r,o=i[n],a=null,l={},h=o.attributes.length;if(h>0)for(r=0;h>r;r++){var u=o.attributes[r];l[u.nodeName]=u.nodeValue}else{var p=o.childNodes;for(r=0,h=p.length;h>r;++r){var c=p[r];3!=c.nodeType&&(l[c.getAttribute("name")]=c.getAttribute("value"))}}e.push(new OpenLayers.Feature.Vector(a,l,null))}return e},getSiblingNodesByTagCriteria:function(t,e){var i,n,s,r,o,a=[];if(t&&t.hasChildNodes()){i=t.childNodes,s=i.length;for(var l=0;s>l;l++){for(o=i[l];o&&1!=o.nodeType;)o=o.nextSibling,l++;n=o?o.nodeName:"",n.length>0&&n.indexOf(e)>-1?a.push(o):(r=this.getSiblingNodesByTagCriteria(o,e),r.length>0&&(0==a.length?a=r:a.push(r)))}}return a},parseAttributes:function(t){var e={};if(1==t.nodeType)for(var i=t.childNodes,n=i.length,s=0;n>s;++s){var r=i[s];if(1==r.nodeType){var o=r.childNodes,a=r.prefix?r.nodeName.split(":")[1]:r.nodeName;if(0==o.length)e[a]=null;else if(1==o.length){var l=o[0];if(3==l.nodeType||4==l.nodeType){var h=l.nodeValue.replace(this.regExes.trimSpace,"");e[a]=h}}}}return e},parseGeometry:function(t){this.gmlFormat||(this.gmlFormat=new OpenLayers.Format.GML);var e,i=this.gmlFormat.parseFeature(t),n=null;return i&&(e=i.geometry&&i.geometry.clone(),n=i.bounds&&i.bounds.clone(),i.destroy()),{geometry:e,bounds:n}},CLASS_NAME:"OpenLayers.Format.WMSGetFeatureInfo"}),OpenLayers.Format.GeoJSON=OpenLayers.Class(OpenLayers.Format.JSON,{ignoreExtraDims:!1,read:function(t,e,i){e=e?e:"FeatureCollection";var n=null,s=null;if(s="string"==typeof t?OpenLayers.Format.JSON.prototype.read.apply(this,[t,i]):t){if("string"!=typeof s.type)OpenLayers.Console.error("Bad GeoJSON - no type: "+t);else if(this.isValidType(s,e))switch(e){case"Geometry":try{n=this.parseGeometry(s)}catch(r){OpenLayers.Console.error(r)}break;case"Feature":try{n=this.parseFeature(s),n.type="Feature"}catch(r){OpenLayers.Console.error(r)}break;case"FeatureCollection":switch(n=[],s.type){case"Feature":try{n.push(this.parseFeature(s))}catch(r){n=null,OpenLayers.Console.error(r)}break;case"FeatureCollection":for(var o=0,a=s.features.length;a>o;++o)try{n.push(this.parseFeature(s.features[o]))}catch(r){n=null,OpenLayers.Console.error(r)}break;default:try{var l=this.parseGeometry(s);n.push(new OpenLayers.Feature.Vector(l))}catch(r){n=null,OpenLayers.Console.error(r)}}}}else OpenLayers.Console.error("Bad JSON: "+t);return n},isValidType:function(t,e){var i=!1;switch(e){case"Geometry":-1==OpenLayers.Util.indexOf(["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon","Box","GeometryCollection"],t.type)?OpenLayers.Console.error("Unsupported geometry type: "+t.type):i=!0;break;case"FeatureCollection":i=!0;break;default:t.type==e?i=!0:OpenLayers.Console.error("Cannot convert types from "+t.type+" to "+e)}return i},parseFeature:function(t){var e,i,n,s;n=t.properties?t.properties:{},s=t.geometry&&t.geometry.bbox||t.bbox;try{i=this.parseGeometry(t.geometry)}catch(r){throw r}return e=new OpenLayers.Feature.Vector(i,n),s&&(e.bounds=OpenLayers.Bounds.fromArray(s)),t.id&&(e.fid=t.id),e},parseGeometry:function(t){if(null==t)return null;var e,i=!1;if("GeometryCollection"==t.type){if(!OpenLayers.Util.isArray(t.geometries))throw"GeometryCollection must have geometries array: "+t;for(var n=t.geometries.length,s=new Array(n),r=0;n>r;++r)s[r]=this.parseGeometry.apply(this,[t.geometries[r]]);e=new OpenLayers.Geometry.Collection(s),i=!0}else{if(!OpenLayers.Util.isArray(t.coordinates))throw"Geometry must have coordinates array: "+t;if(!this.parseCoords[t.type.toLowerCase()])throw"Unsupported geometry type: "+t.type;try{e=this.parseCoords[t.type.toLowerCase()].apply(this,[t.coordinates])}catch(o){throw o}}return this.internalProjection&&this.externalProjection&&!i&&e.transform(this.externalProjection,this.internalProjection),e},parseCoords:{point:function(t){if(0==this.ignoreExtraDims&&2!=t.length)throw"Only 2D points are supported: "+t;return new OpenLayers.Geometry.Point(t[0],t[1])},multipoint:function(t){for(var e=[],i=null,n=0,s=t.length;s>n;++n){try{i=this.parseCoords.point.apply(this,[t[n]])}catch(r){throw r}e.push(i)}return new OpenLayers.Geometry.MultiPoint(e)},linestring:function(t){for(var e=[],i=null,n=0,s=t.length;s>n;++n){try{i=this.parseCoords.point.apply(this,[t[n]])}catch(r){throw r}e.push(i)}return new OpenLayers.Geometry.LineString(e)},multilinestring:function(t){for(var e=[],i=null,n=0,s=t.length;s>n;++n){try{i=this.parseCoords.linestring.apply(this,[t[n]])}catch(r){throw r}e.push(i)}return new OpenLayers.Geometry.MultiLineString(e)},polygon:function(t){for(var e,i,n=[],s=0,r=t.length;r>s;++s){try{i=this.parseCoords.linestring.apply(this,[t[s]])}catch(o){throw o}e=new OpenLayers.Geometry.LinearRing(i.components),n.push(e)}return new OpenLayers.Geometry.Polygon(n)},multipolygon:function(t){for(var e=[],i=null,n=0,s=t.length;s>n;++n){try{i=this.parseCoords.polygon.apply(this,[t[n]])}catch(r){throw r}e.push(i)}return new OpenLayers.Geometry.MultiPolygon(e)},box:function(t){if(2!=t.length)throw"GeoJSON box coordinates must have 2 elements";return new OpenLayers.Geometry.Polygon([new OpenLayers.Geometry.LinearRing([new OpenLayers.Geometry.Point(t[0][0],t[0][1]),new OpenLayers.Geometry.Point(t[1][0],t[0][1]),new OpenLayers.Geometry.Point(t[1][0],t[1][1]),new OpenLayers.Geometry.Point(t[0][0],t[1][1]),new OpenLayers.Geometry.Point(t[0][0],t[0][1])])])}},write:function(t,e){var i={type:null};if(OpenLayers.Util.isArray(t)){i.type="FeatureCollection";var n=t.length;i.features=new Array(n);for(var s=0;n>s;++s){var r=t[s];if(!r instanceof OpenLayers.Feature.Vector){var o="FeatureCollection only supports collections of features: "+r;throw o}i.features[s]=this.extract.feature.apply(this,[r])}}else 0==t.CLASS_NAME.indexOf("OpenLayers.Geometry")?i=this.extract.geometry.apply(this,[t]):t instanceof OpenLayers.Feature.Vector&&(i=this.extract.feature.apply(this,[t]),t.layer&&t.layer.projection&&(i.crs=this.createCRSObject(t)));return OpenLayers.Format.JSON.prototype.write.apply(this,[i,e])},createCRSObject:function(t){var e=t.layer.projection.toString(),i={};if(e.match(/epsg:/i)){var n=parseInt(e.substring(e.indexOf(":")+1));i=4326==n?{type:"name",properties:{name:"urn:ogc:def:crs:OGC:1.3:CRS84"}}:{type:"name",properties:{name:"EPSG:"+n}}}return i},extract:{feature:function(t){var e=this.extract.geometry.apply(this,[t.geometry]),i={type:"Feature",properties:t.attributes,geometry:e};return null!=t.fid&&(i.id=t.fid),i},geometry:function(t){if(null==t)return null;this.internalProjection&&this.externalProjection&&(t=t.clone(),t.transform(this.internalProjection,this.externalProjection));var e,i=t.CLASS_NAME.split(".")[2],n=this.extract[i.toLowerCase()].apply(this,[t]);return e="Collection"==i?{type:"GeometryCollection",geometries:n}:{type:i,coordinates:n}},point:function(t){return[t.x,t.y]},multipoint:function(t){for(var e=[],i=0,n=t.components.length;n>i;++i)e.push(this.extract.point.apply(this,[t.components[i]]));return e},linestring:function(t){for(var e=[],i=0,n=t.components.length;n>i;++i)e.push(this.extract.point.apply(this,[t.components[i]]));return e},multilinestring:function(t){for(var e=[],i=0,n=t.components.length;n>i;++i)e.push(this.extract.linestring.apply(this,[t.components[i]]));return e},polygon:function(t){for(var e=[],i=0,n=t.components.length;n>i;++i)e.push(this.extract.linestring.apply(this,[t.components[i]]));return e},multipolygon:function(t){for(var e=[],i=0,n=t.components.length;n>i;++i)e.push(this.extract.polygon.apply(this,[t.components[i]]));return e},collection:function(t){for(var e=t.components.length,i=new Array(e),n=0;e>n;++n)i[n]=this.extract.geometry.apply(this,[t.components[n]]);return i}},CLASS_NAME:"OpenLayers.Format.GeoJSON"}),OpenLayers.Strategy.BBOX=OpenLayers.Class(OpenLayers.Strategy,{bounds:null,resolution:null,ratio:2,resFactor:null,response:null,activate:function(){var t=OpenLayers.Strategy.prototype.activate.call(this);return t&&(this.layer.events.on({moveend:this.update,refresh:this.update,visibilitychanged:this.update,scope:this}),this.update()),t},deactivate:function(){var t=OpenLayers.Strategy.prototype.deactivate.call(this);return t&&this.layer.events.un({moveend:this.update,refresh:this.update,visibilitychanged:this.update,scope:this}),t},update:function(t){var e=this.getMapBounds();null!==e&&(t&&t.force||this.layer.visibility&&this.layer.calculateInRange()&&this.invalidBounds(e))&&(this.calculateBounds(e),this.resolution=this.layer.map.getResolution(),this.triggerRead(t))},getMapBounds:function(){if(null===this.layer.map)return null;var t=this.layer.map.getExtent();return t&&!this.layer.projection.equals(this.layer.map.getProjectionObject())&&(t=t.clone().transform(this.layer.map.getProjectionObject(),this.layer.projection)),t},invalidBounds:function(t){t||(t=this.getMapBounds());var e=!this.bounds||!this.bounds.containsBounds(t);if(!e&&this.resFactor){var i=this.resolution/this.layer.map.getResolution();e=i>=this.resFactor||i<=1/this.resFactor}return e},calculateBounds:function(t){t||(t=this.getMapBounds());var e=t.getCenterLonLat(),i=t.getWidth()*this.ratio,n=t.getHeight()*this.ratio;this.bounds=new OpenLayers.Bounds(e.lon-i/2,e.lat-n/2,e.lon+i/2,e.lat+n/2)},triggerRead:function(t){!this.response||t&&t.noAbort===!0||(this.layer.protocol.abort(this.response),this.layer.events.triggerEvent("loadend"));var e={filter:this.createFilter()};this.layer.events.triggerEvent("loadstart",e),this.response=this.layer.protocol.read(OpenLayers.Util.applyDefaults({filter:e.filter,callback:this.merge,scope:this},t))},createFilter:function(){var t=new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.BBOX,value:this.bounds,projection:this.layer.projection});return this.layer.filter&&(t=new OpenLayers.Filter.Logical({type:OpenLayers.Filter.Logical.AND,filters:[this.layer.filter,t]})),t},merge:function(t){if(this.layer.destroyFeatures(),t.success()){var e=t.features;if(e&&e.length>0){var i=this.layer.projection,n=this.layer.map.getProjectionObject();if(!n.equals(i))for(var s,r=0,o=e.length;o>r;++r)s=e[r].geometry,s&&s.transform(i,n);this.layer.addFeatures(e)}}else this.bounds=null;this.response=null,this.layer.events.triggerEvent("loadend",{response:t})},CLASS_NAME:"OpenLayers.Strategy.BBOX"}),OpenLayers.Format.SLD.v1_0_0_GeoServer=OpenLayers.Class(OpenLayers.Format.SLD.v1_0_0,{version:"1.0.0",profile:"GeoServer",readers:OpenLayers.Util.applyDefaults({sld:OpenLayers.Util.applyDefaults({Priority:function(t,e){var i=this.readers.ogc._expression.call(this,t);i&&(e.priority=i)},VendorOption:function(t,e){e.vendorOptions||(e.vendorOptions={}),e.vendorOptions[t.getAttribute("name")]=this.getChildValue(t)},TextSymbolizer:function(t,e){OpenLayers.Format.SLD.v1_0_0.prototype.readers.sld.TextSymbolizer.apply(this,arguments);var i=this.multipleSymbolizers?e.symbolizers[e.symbolizers.length-1]:e.symbolizer.Text;void 0===i.graphic&&(i.graphic=!1)}},OpenLayers.Format.SLD.v1_0_0.prototype.readers.sld)},OpenLayers.Format.SLD.v1_0_0.prototype.readers),writers:OpenLayers.Util.applyDefaults({sld:OpenLayers.Util.applyDefaults({Priority:function(t){return this.writers.sld._OGCExpression.call(this,"sld:Priority",t)},VendorOption:function(t){return this.createElementNSPlus("sld:VendorOption",{attributes:{name:t.name},value:t.value})},TextSymbolizer:function(t){var e=OpenLayers.Format.SLD.v1_0_0.prototype.writers,i=e.sld.TextSymbolizer.apply(this,arguments);return t.graphic!==!1&&(t.externalGraphic||t.graphicName)&&this.writeNode("Graphic",t,i),"priority"in t&&this.writeNode("Priority",t.priority,i),this.addVendorOptions(i,t)},PointSymbolizer:function(t){var e=OpenLayers.Format.SLD.v1_0_0.prototype.writers,i=e.sld.PointSymbolizer.apply(this,arguments);return this.addVendorOptions(i,t)},LineSymbolizer:function(t){var e=OpenLayers.Format.SLD.v1_0_0.prototype.writers,i=e.sld.LineSymbolizer.apply(this,arguments);return this.addVendorOptions(i,t)},PolygonSymbolizer:function(t){var e=OpenLayers.Format.SLD.v1_0_0.prototype.writers,i=e.sld.PolygonSymbolizer.apply(this,arguments);return this.addVendorOptions(i,t)}},OpenLayers.Format.SLD.v1_0_0.prototype.writers.sld)},OpenLayers.Format.SLD.v1_0_0.prototype.writers),addVendorOptions:function(t,e){var i=e.vendorOptions;if(i)for(var n in e.vendorOptions)this.writeNode("VendorOption",{name:n,value:e.vendorOptions[n]},t);return t},CLASS_NAME:"OpenLayers.Format.SLD.v1_0_0_GeoServer"}),OpenLayers.Protocol.CSW=function(t){t=OpenLayers.Util.applyDefaults(t,OpenLayers.Protocol.CSW.DEFAULTS);var e=OpenLayers.Protocol.CSW["v"+t.version.replace(/\./g,"_")];if(!e)throw"Unsupported CSW version: "+t.version;return new e(t)},OpenLayers.Protocol.CSW.DEFAULTS={version:"2.0.2"},OpenLayers.Protocol.WFS.v1_1_0=OpenLayers.Class(OpenLayers.Protocol.WFS.v1,{version:"1.1.0",initialize:function(){OpenLayers.Protocol.WFS.v1.prototype.initialize.apply(this,arguments),this.outputFormat&&!this.readFormat&&("gml2"==this.outputFormat.toLowerCase()?this.readFormat=new OpenLayers.Format.GML.v2({featureType:this.featureType,featureNS:this.featureNS,geometryName:this.geometryName}):"json"==this.outputFormat.toLowerCase()&&(this.readFormat=new OpenLayers.Format.GeoJSON))},CLASS_NAME:"OpenLayers.Protocol.WFS.v1_1_0"}),OpenLayers.Format.WMTSCapabilities=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,{defaultVersion:"1.0.0",yx:{"urn:ogc:def:crs:EPSG::4326":!0},createLayer:function(t,e){if(!("layer"in e))throw new Error("Missing property 'layer' in configuration.");for(var i,n=t.contents,s=(n.layers,0),r=n.layers.length;r>s;++s)if(n.layers[s].identifier===e.layer){i=n.layers[s];break}if(!i)throw new Error("Layer not found");var o=e.format;!o&&i.formats&&i.formats.length&&(o=i.formats[0]);var a;if(e.matrixSet?a=n.tileMatrixSets[e.matrixSet]:i.tileMatrixSetLinks.length>=1&&(a=n.tileMatrixSets[i.tileMatrixSetLinks[0].tileMatrixSet]),!a)throw new Error("matrixSet not found");for(var l,s=0,r=i.styles.length;r>s&&(l=i.styles[s],!l.isDefault);++s);var h=e.requestEncoding;if(!h&&(h="KVP",t.operationsMetadata.GetTile.dcp.http)){var u=t.operationsMetadata.GetTile.dcp.http;if(u.get[0].constraints){var p=u.get[0].constraints,c=p.GetEncoding.allowedValues;c.KVP||!c.REST&&!c.RESTful||(h="REST")}}var d=[],m=e.params||{};delete e.params;for(var f=0,y=i.dimensions.length;y>f;f++){var g=i.dimensions[f];d.push(g.identifier),m.hasOwnProperty(g.identifier)||(m[g.identifier]=g["default"])}var v=e.projection||a.supportedCRS.replace(/urn:ogc:def:crs:(\w+):(.*:)?(\w+)$/,"$1:$3"),L=e.units||("EPSG:4326"===v?"degrees":"m"),_=[];for(var O in a.matrixIds)a.matrixIds.hasOwnProperty(O)&&_.push(28e-5*a.matrixIds[O].scaleDenominator/OpenLayers.METERS_PER_INCH/OpenLayers.INCHES_PER_UNIT[L]);var b;if("REST"===h&&i.resourceUrls){b=[];for(var w,x=(i.resourceUrls,0),S=i.resourceUrls.length;S>x;++x)w=i.resourceUrls[x],w.format===o&&"tile"===w.resourceType&&b.push(w.template)}else{var C=t.operationsMetadata.GetTile.dcp.http.get;b=[];for(var E,s=0,r=C.length;r>s;s++)E=C[s].constraints,(!E||E&&E.GetEncoding.allowedValues[h])&&b.push(C[s].url)}return new OpenLayers.Layer.WMTS(OpenLayers.Util.applyDefaults(e,{url:b,requestEncoding:h,name:i.title,style:l.identifier,format:o,matrixIds:a.matrixIds,matrixSet:a.identifier,projection:v,units:L,resolutions:e.isBaseLayer===!1?void 0:_,serverResolutions:_,tileFullExtent:a.bounds,dimensions:d,params:m}))},CLASS_NAME:"OpenLayers.Format.WMTSCapabilities"}),OpenLayers.Layer.Google.v3={DEFAULTS:{sphericalMercator:!0,projection:"EPSG:900913"},animationEnabled:!0,loadMapObject:function(){this.type||(this.type=google.maps.MapTypeId.ROADMAP);var t,e=OpenLayers.Layer.Google.cache[this.map.id];if(e)t=e.mapObject,++e.count;else{var i=this.map.getCenter(),n=document.createElement("div");n.className="olForeignContainer",n.style.width="100%",n.style.height="100%",t=new google.maps.Map(n,{center:i?new google.maps.LatLng(i.lat,i.lon):new google.maps.LatLng(0,0),zoom:this.map.getZoom()||0,mapTypeId:this.type,disableDefaultUI:!0,keyboardShortcuts:!1,draggable:!1,disableDoubleClickZoom:!0,scrollwheel:!1,streetViewControl:!1});var s=document.createElement("div");s.style.width="100%",s.style.height="100%",t.controls[google.maps.ControlPosition.TOP_LEFT].push(s),e={googleControl:s,mapObject:t,count:1},OpenLayers.Layer.Google.cache[this.map.id]=e}this.mapObject=t,this.setGMapVisibility(this.visibility)},onMapResize:function(){this.visibility&&google.maps.event.trigger(this.mapObject,"resize")},setGMapVisibility:function(t){var e=OpenLayers.Layer.Google.cache[this.map.id],i=this.map;if(e){for(var n,s=this.type,r=i.layers,o=r.length-1;o>=0;--o)if(n=r[o],n instanceof OpenLayers.Layer.Google&&n.visibility===!0&&n.inRange===!0){s=n.type,t=!0;break}var a=this.mapObject.getDiv();if(t===!0){if(a.parentNode!==i.div)if(e.rendered)i.div.appendChild(a),e.googleControl.appendChild(i.viewPortDiv),google.maps.event.trigger(this.mapObject,"resize");else{var l=this;google.maps.event.addListenerOnce(this.mapObject,"tilesloaded",function(){e.rendered=!0,l.setGMapVisibility(l.getVisibility()),l.moveTo(l.map.getCenter())})}this.mapObject.setMapTypeId(s)}else e.googleControl.hasChildNodes()&&(i.div.appendChild(i.viewPortDiv),i.div.removeChild(a))}},getMapContainer:function(){return this.mapObject.getDiv()},getMapObjectBoundsFromOLBounds:function(t){var e=null;if(null!=t){var i=this.sphericalMercator?this.inverseMercator(t.bottom,t.left):new OpenLayers.LonLat(t.bottom,t.left),n=this.sphericalMercator?this.inverseMercator(t.top,t.right):new OpenLayers.LonLat(t.top,t.right);e=new google.maps.LatLngBounds(new google.maps.LatLng(i.lat,i.lon),new google.maps.LatLng(n.lat,n.lon))}return e},getMapObjectLonLatFromMapObjectPixel:function(t){var e=this.map.getSize(),i=this.getLongitudeFromMapObjectLonLat(this.mapObject.center),n=this.getLatitudeFromMapObjectLonLat(this.mapObject.center),s=this.map.getResolution(),r=t.x-e.w/2,o=t.y-e.h/2,a=new OpenLayers.LonLat(i+r*s,n-o*s);return this.wrapDateLine&&(a=a.wrapDateLine(this.maxExtent)),this.getMapObjectLonLatFromLonLat(a.lon,a.lat)},getMapObjectPixelFromMapObjectLonLat:function(t){var e=this.getLongitudeFromMapObjectLonLat(t),i=this.getLatitudeFromMapObjectLonLat(t),n=this.map.getResolution(),s=this.map.getExtent();return this.getMapObjectPixelFromXY(1/n*(e-s.left),1/n*(s.top-i))},setMapObjectCenter:function(t,e){if(this.animationEnabled===!1&&e!=this.mapObject.zoom){var i=this.getMapContainer();google.maps.event.addListenerOnce(this.mapObject,"idle",function(){i.style.visibility=""}),i.style.visibility="hidden"}this.mapObject.setOptions({center:t,zoom:e})},getMapObjectZoomFromMapObjectBounds:function(t){return this.mapObject.getBoundsZoomLevel(t)},getMapObjectLonLatFromLonLat:function(t,e){var i;if(this.sphericalMercator){var n=this.inverseMercator(t,e);i=new google.maps.LatLng(n.lat,n.lon)}else i=new google.maps.LatLng(e,t);return i},getMapObjectPixelFromXY:function(t,e){return new google.maps.Point(t,e)}},OpenLayers.Format.WPSDescribeProcess=OpenLayers.Class(OpenLayers.Format.XML,{VERSION:"1.0.0",namespaces:{wps:"http://www.opengis.net/wps/1.0.0",ows:"http://www.opengis.net/ows/1.1",xsi:"http://www.w3.org/2001/XMLSchema-instance"},schemaLocation:"http://www.opengis.net/wps/1.0.0 http://schemas.opengis.net/wps/1.0.0/wpsAll.xsd",defaultPrefix:"wps",regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},read:function(t){"string"==typeof t&&(t=OpenLayers.Format.XML.prototype.read.apply(this,[t])),t&&9==t.nodeType&&(t=t.documentElement);
var e={};return this.readNode(t,e),e},readers:{wps:{ProcessDescriptions:function(t,e){e.processDescriptions={},this.readChildNodes(t,e.processDescriptions)},ProcessDescription:function(t,e){var i=this.getAttributeNS(t,this.namespaces.wps,"processVersion"),n={processVersion:i,statusSupported:"true"===t.getAttribute("statusSupported"),storeSupported:"true"===t.getAttribute("storeSupported")};this.readChildNodes(t,n),e[n.identifier]=n},DataInputs:function(t,e){e.dataInputs=[],this.readChildNodes(t,e.dataInputs)},ProcessOutputs:function(t,e){e.processOutputs=[],this.readChildNodes(t,e.processOutputs)},Output:function(t,e){var i={};this.readChildNodes(t,i),e.push(i)},ComplexOutput:function(t,e){e.complexOutput={},this.readChildNodes(t,e.complexOutput)},LiteralOutput:function(t,e){e.literalOutput={},this.readChildNodes(t,e.literalOutput)},Input:function(t,e){var i={maxOccurs:parseInt(t.getAttribute("maxOccurs")),minOccurs:parseInt(t.getAttribute("minOccurs"))};this.readChildNodes(t,i),e.push(i)},BoundingBoxData:function(t,e){e.boundingBoxData={},this.readChildNodes(t,e.boundingBoxData)},CRS:function(t,e){e.CRSs||(e.CRSs={}),e.CRSs[this.getChildValue(t)]=!0},LiteralData:function(t,e){e.literalData={},this.readChildNodes(t,e.literalData)},ComplexData:function(t,e){e.complexData={},this.readChildNodes(t,e.complexData)},Default:function(t,e){e["default"]={},this.readChildNodes(t,e["default"])},Supported:function(t,e){e.supported={},this.readChildNodes(t,e.supported)},Format:function(t,e){var i={};this.readChildNodes(t,i),e.formats||(e.formats={}),e.formats[i.mimeType]=!0},MimeType:function(t,e){e.mimeType=this.getChildValue(t)}},ows:OpenLayers.Format.OWSCommon.v1_1_0.prototype.readers.ows},CLASS_NAME:"OpenLayers.Format.WPSDescribeProcess"}),OpenLayers.Format.WKT=OpenLayers.Class(OpenLayers.Format,{initialize:function(t){this.regExes={typeStr:/^\s*(\w+)\s*\(\s*(.*)\s*\)\s*$/,spaces:/\s+/,parenComma:/\)\s*,\s*\(/,doubleParenComma:/\)\s*\)\s*,\s*\(\s*\(/,trimParens:/^\s*\(?(.*?)\)?\s*$/},OpenLayers.Format.prototype.initialize.apply(this,[t])},read:function(t){var e,i,n;t=t.replace(/[\n\r]/g," ");var s=this.regExes.typeStr.exec(t);if(s&&(i=s[1].toLowerCase(),n=s[2],this.parse[i]&&(e=this.parse[i].apply(this,[n])),this.internalProjection&&this.externalProjection))if(e&&"OpenLayers.Feature.Vector"==e.CLASS_NAME)e.geometry.transform(this.externalProjection,this.internalProjection);else if(e&&"geometrycollection"!=i&&"object"==typeof e)for(var r=0,o=e.length;o>r;r++){var a=e[r];a.geometry.transform(this.externalProjection,this.internalProjection)}return e},write:function(t){var e,i,n;t.constructor==Array?(e=t,n=!0):(e=[t],n=!1);var s=[];n&&s.push("GEOMETRYCOLLECTION(");for(var r=0,o=e.length;o>r;++r)n&&r>0&&s.push(","),i=e[r].geometry,s.push(this.extractGeometry(i));return n&&s.push(")"),s.join("")},extractGeometry:function(t){var e=t.CLASS_NAME.split(".")[2].toLowerCase();if(!this.extract[e])return null;this.internalProjection&&this.externalProjection&&(t=t.clone(),t.transform(this.internalProjection,this.externalProjection));var i="collection"==e?"GEOMETRYCOLLECTION":e.toUpperCase(),n=i+"("+this.extract[e].apply(this,[t])+")";return n},extract:{point:function(t){return t.x+" "+t.y},multipoint:function(t){for(var e=[],i=0,n=t.components.length;n>i;++i)e.push("("+this.extract.point.apply(this,[t.components[i]])+")");return e.join(",")},linestring:function(t){for(var e=[],i=0,n=t.components.length;n>i;++i)e.push(this.extract.point.apply(this,[t.components[i]]));return e.join(",")},multilinestring:function(t){for(var e=[],i=0,n=t.components.length;n>i;++i)e.push("("+this.extract.linestring.apply(this,[t.components[i]])+")");return e.join(",")},polygon:function(t){for(var e=[],i=0,n=t.components.length;n>i;++i)e.push("("+this.extract.linestring.apply(this,[t.components[i]])+")");return e.join(",")},multipolygon:function(t){for(var e=[],i=0,n=t.components.length;n>i;++i)e.push("("+this.extract.polygon.apply(this,[t.components[i]])+")");return e.join(",")},collection:function(t){for(var e=[],i=0,n=t.components.length;n>i;++i)e.push(this.extractGeometry.apply(this,[t.components[i]]));return e.join(",")}},parse:{point:function(t){var e=OpenLayers.String.trim(t).split(this.regExes.spaces);return new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Point(e[0],e[1]))},multipoint:function(t){for(var e,i=OpenLayers.String.trim(t).split(","),n=[],s=0,r=i.length;r>s;++s)e=i[s].replace(this.regExes.trimParens,"$1"),n.push(this.parse.point.apply(this,[e]).geometry);return new OpenLayers.Feature.Vector(new OpenLayers.Geometry.MultiPoint(n))},linestring:function(t){for(var e=OpenLayers.String.trim(t).split(","),i=[],n=0,s=e.length;s>n;++n)i.push(this.parse.point.apply(this,[e[n]]).geometry);return new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString(i))},multilinestring:function(t){for(var e,i=OpenLayers.String.trim(t).split(this.regExes.parenComma),n=[],s=0,r=i.length;r>s;++s)e=i[s].replace(this.regExes.trimParens,"$1"),n.push(this.parse.linestring.apply(this,[e]).geometry);return new OpenLayers.Feature.Vector(new OpenLayers.Geometry.MultiLineString(n))},polygon:function(t){for(var e,i,n,s=OpenLayers.String.trim(t).split(this.regExes.parenComma),r=[],o=0,a=s.length;a>o;++o)e=s[o].replace(this.regExes.trimParens,"$1"),i=this.parse.linestring.apply(this,[e]).geometry,n=new OpenLayers.Geometry.LinearRing(i.components),r.push(n);return new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Polygon(r))},multipolygon:function(t){for(var e,i=OpenLayers.String.trim(t).split(this.regExes.doubleParenComma),n=[],s=0,r=i.length;r>s;++s)e=i[s].replace(this.regExes.trimParens,"$1"),n.push(this.parse.polygon.apply(this,[e]).geometry);return new OpenLayers.Feature.Vector(new OpenLayers.Geometry.MultiPolygon(n))},geometrycollection:function(t){t=t.replace(/,\s*([A-Za-z])/g,"|$1");for(var e=OpenLayers.String.trim(t).split("|"),i=[],n=0,s=e.length;s>n;++n)i.push(OpenLayers.Format.WKT.prototype.read.apply(this,[e[n]]));return i}},CLASS_NAME:"OpenLayers.Format.WKT"}),OpenLayers.WPSProcess=OpenLayers.Class({client:null,server:null,identifier:null,description:null,localWPS:"http://geoserver/wps",formats:null,chained:0,executeCallbacks:null,initialize:function(t){OpenLayers.Util.extend(this,t),this.executeCallbacks=[],this.formats={"application/wkt":new OpenLayers.Format.WKT,"application/json":new OpenLayers.Format.GeoJSON}},describe:function(t){if(t=t||{},this.description){if(t.callback){var e=this.description;window.setTimeout(function(){t.callback.call(t.scope,e)},0)}}else this.client.describeProcess(this.server,this.identifier,function(e){this.description||this.parseDescription(e),t.callback&&t.callback.call(t.scope,this.description)},this)},configure:function(t){return this.describe({callback:function(){var e,i,n,s=this.description,r=t.inputs;for(i=0,n=s.dataInputs.length;n>i;++i)e=s.dataInputs[i],this.setInputData(e,r[e.identifier]);t.callback&&t.callback.call(t.scope)},scope:this}),this},execute:function(t){this.configure({inputs:t.inputs,callback:function(){var e=this,i=this.getOutputIndex(e.description.processOutputs,t.output);e.setResponseForm({outputIndex:i}),function n(){return OpenLayers.Util.removeItem(e.executeCallbacks,n),0!==e.chained?void e.executeCallbacks.push(n):void OpenLayers.Request.POST({url:e.client.servers[e.server].url,data:(new OpenLayers.Format.WPSExecute).write(e.description),success:function(n){var s=e.description.processOutputs[i],r=e.findMimeType(s.complexOutput.supported.formats),o=e.formats[r].read(n.responseText);if(o instanceof OpenLayers.Feature.Vector&&(o=[o]),t.success){var a={};a[t.output||"result"]=o,t.success.call(t.scope,a)}},scope:e})}()},scope:this})},output:function(t){return new OpenLayers.WPSProcess.ChainLink({process:this,output:t})},parseDescription:function(){var t=this.client.servers[this.server];this.description=(new OpenLayers.Format.WPSDescribeProcess).read(t.processDescription[this.identifier]).processDescriptions[this.identifier]},setInputData:function(t,e){if(delete t.data,delete t.reference,e instanceof OpenLayers.WPSProcess.ChainLink)++this.chained,t.reference={method:"POST",href:e.process.server===this.server?this.localWPS:this.client.servers[e.process.server].url},e.process.describe({callback:function(){--this.chained,this.chainProcess(t,e)},scope:this});else{t.data={};var i=t.complexData;if(i){var n=this.findMimeType(i.supported.formats);t.data.complexData={mimeType:n,value:this.formats[n].write(this.toFeatures(e))}}else t.data.literalData={value:e}}},setResponseForm:function(t){t=t||{};var e=this.description.processOutputs[t.outputIndex||0];this.description.responseForm={rawDataOutput:{identifier:e.identifier,mimeType:this.findMimeType(e.complexOutput.supported.formats,t.supportedFormats)}}},getOutputIndex:function(t,e){var i;if(e){for(var n=t.length-1;n>=0;--n)if(t[n].identifier===e){i=n;break}}else i=0;return i},chainProcess:function(t,e){var i=this.getOutputIndex(e.process.description.processOutputs,e.output);t.reference.mimeType=this.findMimeType(t.complexData.supported.formats,e.process.description.processOutputs[i].complexOutput.supported.formats);var n={};for(n[t.reference.mimeType]=!0,e.process.setResponseForm({outputIndex:i,supportedFormats:n}),t.reference.body=e.process.description;this.executeCallbacks.length>0;)this.executeCallbacks[0]()},toFeatures:function(t){var e=OpenLayers.Util.isArray(t);e||(t=[t]);for(var i,n=new Array(t.length),s=0,r=t.length;r>s;++s)i=t[s],n[s]=i instanceof OpenLayers.Feature.Vector?i:new OpenLayers.Feature.Vector(i);return e?n:n[0]},findMimeType:function(t,e){e=e||this.formats;for(var i in t)if(i in e)return i},CLASS_NAME:"OpenLayers.WPSProcess"}),OpenLayers.WPSProcess.ChainLink=OpenLayers.Class({process:null,output:null,initialize:function(t){OpenLayers.Util.extend(this,t)},CLASS_NAME:"OpenLayers.WPSProcess.ChainLink"}),OpenLayers.WPSClient=OpenLayers.Class({servers:null,version:"1.0.0",lazy:!1,events:null,initialize:function(t){OpenLayers.Util.extend(this,t),this.events=new OpenLayers.Events(this),this.servers={};for(var e in t.servers)this.servers[e]="string"==typeof t.servers[e]?{url:t.servers[e],version:this.version,processDescription:{}}:t.servers[e]},execute:function(t){var e=this.getProcess(t.server,t.process);e.execute({inputs:t.inputs,success:t.success,scope:t.scope})},getProcess:function(t,e){var i=new OpenLayers.WPSProcess({client:this,server:t,identifier:e});return this.lazy||i.describe(),i},describeProcess:function(t,e,i,n){var s=this.servers[t];s.processDescription[e]?window.setTimeout(function(){i.call(n,s.processDescription[e])},0):e in s.processDescription?this.events.register("describeprocess",this,function r(t){t.identifier===e&&(this.events.unregister("describeprocess",this,r),i.call(n,t.raw))}):(s.processDescription[e]=null,OpenLayers.Request.GET({url:s.url,params:{SERVICE:"WPS",VERSION:s.version,REQUEST:"DescribeProcess",IDENTIFIER:e},success:function(t){s.processDescription[e]=t.responseText,this.events.triggerEvent("describeprocess",{identifier:e,raw:t.responseText})},scope:this}))},destroy:function(){this.events.destroy(),this.events=null,this.servers=null},CLASS_NAME:"OpenLayers.WPSClient"}),OpenLayers.Format.CSWGetRecords.v2_0_2=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{csw:"http://www.opengis.net/cat/csw/2.0.2",dc:"http://purl.org/dc/elements/1.1/",dct:"http://purl.org/dc/terms/",gmd:"http://www.isotc211.org/2005/gmd",geonet:"http://www.fao.org/geonetwork",ogc:"http://www.opengis.net/ogc",ows:"http://www.opengis.net/ows",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance"},defaultPrefix:"csw",version:"2.0.2",schemaLocation:"http://www.opengis.net/cat/csw/2.0.2 http://schemas.opengis.net/csw/2.0.2/CSW-discovery.xsd",requestId:null,resultType:null,outputFormat:null,outputSchema:null,startPosition:null,maxRecords:null,DistributedSearch:null,ResponseHandler:null,Query:null,regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},initialize:function(t){OpenLayers.Format.XML.prototype.initialize.apply(this,[t])},read:function(t){"string"==typeof t&&(t=OpenLayers.Format.XML.prototype.read.apply(this,[t])),t&&9==t.nodeType&&(t=t.documentElement);var e={};return this.readNode(t,e),e},readers:{csw:{GetRecordsResponse:function(t,e){e.records=[],this.readChildNodes(t,e);var i=this.getAttributeNS(t,"","version");""!=i&&(e.version=i)},RequestId:function(t,e){e.RequestId=this.getChildValue(t)},SearchStatus:function(t,e){e.SearchStatus={};var i=this.getAttributeNS(t,"","timestamp");""!=i&&(e.SearchStatus.timestamp=i)},SearchResults:function(t,e){this.readChildNodes(t,e);for(var i=t.attributes,n={},s=0,r=i.length;r>s;++s)n[i[s].name]="numberOfRecordsMatched"==i[s].name||"numberOfRecordsReturned"==i[s].name||"nextRecord"==i[s].name?parseInt(i[s].nodeValue):i[s].nodeValue;e.SearchResults=n},SummaryRecord:function(t,e){var i={type:"SummaryRecord"};this.readChildNodes(t,i),e.records.push(i)},BriefRecord:function(t,e){var i={type:"BriefRecord"};this.readChildNodes(t,i),e.records.push(i)},DCMIRecord:function(t,e){var i={type:"DCMIRecord"};this.readChildNodes(t,i),e.records.push(i)},Record:function(t,e){var i={type:"Record"};this.readChildNodes(t,i),e.records.push(i)},"*":function(t,e){var i=t.localName||t.nodeName.split(":").pop();e[i]=this.getChildValue(t)}},geonet:{info:function(t,e){var i={};this.readChildNodes(t,i),e.gninfo=i}},dc:{"*":function(t,e){var i=t.localName||t.nodeName.split(":").pop();OpenLayers.Util.isArray(e[i])||(e[i]=[]);for(var n={},s=t.attributes,r=0,o=s.length;o>r;++r)n[s[r].name]=s[r].nodeValue;n.value=this.getChildValue(t),""!=n.value&&e[i].push(n)}},dct:{"*":function(t,e){var i=t.localName||t.nodeName.split(":").pop();OpenLayers.Util.isArray(e[i])||(e[i]=[]),e[i].push(this.getChildValue(t))}},ows:OpenLayers.Util.applyDefaults({BoundingBox:function(t,e){e.bounds&&(e.BoundingBox=[{crs:e.projection,value:[e.bounds.left,e.bounds.bottom,e.bounds.right,e.bounds.top]}],delete e.projection,delete e.bounds),OpenLayers.Format.OWSCommon.v1_0_0.prototype.readers.ows.BoundingBox.apply(this,arguments)}},OpenLayers.Format.OWSCommon.v1_0_0.prototype.readers.ows)},write:function(t){var e=this.writeNode("csw:GetRecords",t);return e.setAttribute("xmlns:gmd",this.namespaces.gmd),OpenLayers.Format.XML.prototype.write.apply(this,[e])},writers:{csw:{GetRecords:function(t){t||(t={});var e=this.createElementNSPlus("csw:GetRecords",{attributes:{service:"CSW",version:this.version,requestId:t.requestId||this.requestId,resultType:t.resultType||this.resultType,outputFormat:t.outputFormat||this.outputFormat,outputSchema:t.outputSchema||this.outputSchema,startPosition:t.startPosition||this.startPosition,maxRecords:t.maxRecords||this.maxRecords}});(t.DistributedSearch||this.DistributedSearch)&&this.writeNode("csw:DistributedSearch",t.DistributedSearch||this.DistributedSearch,e);var i=t.ResponseHandler||this.ResponseHandler;if(OpenLayers.Util.isArray(i)&&i.length>0)for(var n=0,s=i.length;s>n;n++)this.writeNode("csw:ResponseHandler",i[n],e);return this.writeNode("Query",t.Query||this.Query,e),e},DistributedSearch:function(t){var e=this.createElementNSPlus("csw:DistributedSearch",{attributes:{hopCount:t.hopCount}});return e},ResponseHandler:function(t){var e=this.createElementNSPlus("csw:ResponseHandler",{value:t.value});return e},Query:function(t){t||(t={});var e=this.createElementNSPlus("csw:Query",{attributes:{typeNames:t.typeNames||"csw:Record"}}),i=t.ElementName;if(OpenLayers.Util.isArray(i)&&i.length>0)for(var n=0,s=i.length;s>n;n++)this.writeNode("csw:ElementName",i[n],e);else this.writeNode("csw:ElementSetName",t.ElementSetName||{value:"summary"},e);return t.Constraint&&this.writeNode("csw:Constraint",t.Constraint,e),t.SortBy&&this.writeNode("ogc:SortBy",t.SortBy,e),e},ElementName:function(t){var e=this.createElementNSPlus("csw:ElementName",{value:t.value});return e},ElementSetName:function(t){var e=this.createElementNSPlus("csw:ElementSetName",{attributes:{typeNames:t.typeNames},value:t.value});return e},Constraint:function(t){var e=this.createElementNSPlus("csw:Constraint",{attributes:{version:t.version}});if(t.Filter){var i=new OpenLayers.Format.Filter({version:t.version});e.appendChild(i.write(t.Filter))}else if(t.CqlText){var n=this.createElementNSPlus("CqlText",{value:t.CqlText.value});e.appendChild(n)}return e}},ogc:OpenLayers.Format.Filter.v1_1_0.prototype.writers.ogc},CLASS_NAME:"OpenLayers.Format.CSWGetRecords.v2_0_2"}),OpenLayers.Marker.Box=OpenLayers.Class(OpenLayers.Marker,{bounds:null,div:null,initialize:function(t,e,i){this.bounds=t,this.div=OpenLayers.Util.createDiv(),this.div.style.overflow="hidden",this.events=new OpenLayers.Events(this,this.div),this.setBorder(e,i)},destroy:function(){this.bounds=null,this.div=null,OpenLayers.Marker.prototype.destroy.apply(this,arguments)},setBorder:function(t,e){t||(t="red"),e||(e=2),this.div.style.border=e+"px solid "+t},draw:function(t,e){return OpenLayers.Util.modifyDOMElement(this.div,null,t,e),this.div},onScreen:function(){var t=!1;if(this.map){var e=this.map.getExtent();t=e.containsBounds(this.bounds,!0,!0)}return t},display:function(t){this.div.style.display=t?"":"none"},CLASS_NAME:"OpenLayers.Marker.Box"}),OpenLayers.Format.Text=OpenLayers.Class(OpenLayers.Format,{defaultStyle:null,extractStyles:!0,initialize:function(t){t=t||{},t.extractStyles!==!1&&(t.defaultStyle={externalGraphic:OpenLayers.Util.getImageLocation("marker.png"),graphicWidth:21,graphicHeight:25,graphicXOffset:-10.5,graphicYOffset:-12.5}),OpenLayers.Format.prototype.initialize.apply(this,[t])},read:function(t){for(var e,i=t.split("\n"),n=[],s=0;s<i.length-1;s++){var r=i[s].replace(/^\s*/,"").replace(/\s*$/,"");if("#"!=r.charAt(0))if(e){for(var o=r.split("	"),a=new OpenLayers.Geometry.Point(0,0),l={},h=this.defaultStyle?OpenLayers.Util.applyDefaults({},this.defaultStyle):null,u=!1,p=0;p<o.length;p++)if(o[p])if("point"==e[p]){var c=o[p].split(",");a.y=parseFloat(c[0]),a.x=parseFloat(c[1]),u=!0}else if("lat"==e[p])a.y=parseFloat(o[p]),u=!0;else if("lon"==e[p])a.x=parseFloat(o[p]),u=!0;else if("title"==e[p])l.title=o[p];else if("image"==e[p]||"icon"==e[p]&&h)h.externalGraphic=o[p];else if("iconSize"==e[p]&&h){var d=o[p].split(",");h.graphicWidth=parseFloat(d[0]),h.graphicHeight=parseFloat(d[1])}else if("iconOffset"==e[p]&&h){var m=o[p].split(",");h.graphicXOffset=parseFloat(m[0]),h.graphicYOffset=parseFloat(m[1])}else"description"==e[p]?l.description=o[p]:"overflow"==e[p]?l.overflow=o[p]:l[e[p]]=o[p];if(u){this.internalProjection&&this.externalProjection&&a.transform(this.externalProjection,this.internalProjection);var f=new OpenLayers.Feature.Vector(a,l,h);n.push(f)}}else e=r.split("	")}return n},CLASS_NAME:"OpenLayers.Format.Text"}),OpenLayers.Layer.Text=OpenLayers.Class(OpenLayers.Layer.Markers,{location:null,features:null,formatOptions:null,selectedFeature:null,initialize:function(){OpenLayers.Layer.Markers.prototype.initialize.apply(this,arguments),this.features=[]},destroy:function(){OpenLayers.Layer.Markers.prototype.destroy.apply(this,arguments),this.clearFeatures(),this.features=null},loadText:function(){if(!this.loaded&&null!=this.location){var t=function(){this.events.triggerEvent("loadend")};this.events.triggerEvent("loadstart"),OpenLayers.Request.GET({url:this.location,success:this.parseData,failure:t,scope:this}),this.loaded=!0}},moveTo:function(){OpenLayers.Layer.Markers.prototype.moveTo.apply(this,arguments),this.visibility&&!this.loaded&&this.loadText()},parseData:function(t){var e=t.responseText,i={};OpenLayers.Util.extend(i,this.formatOptions),this.map&&!this.projection.equals(this.map.getProjectionObject())&&(i.externalProjection=this.projection,i.internalProjection=this.map.getProjectionObject());for(var n=new OpenLayers.Format.Text(i),s=n.read(e),r=0,o=s.length;o>r;r++){var a,l,h,u={},p=s[r];a=new OpenLayers.LonLat(p.geometry.x,p.geometry.y),p.style.graphicWidth&&p.style.graphicHeight&&(l=new OpenLayers.Size(p.style.graphicWidth,p.style.graphicHeight)),void 0!==p.style.graphicXOffset&&void 0!==p.style.graphicYOffset&&(h=new OpenLayers.Pixel(p.style.graphicXOffset,p.style.graphicYOffset)),null!=p.style.externalGraphic?u.icon=new OpenLayers.Icon(p.style.externalGraphic,l,h):(u.icon=OpenLayers.Marker.defaultIcon(),null!=l&&u.icon.setSize(l)),null!=p.attributes.title&&null!=p.attributes.description&&(u.popupContentHTML="<h2>"+p.attributes.title+"</h2><p>"+p.attributes.description+"</p>"),u.overflow=p.attributes.overflow||"auto";var c=new OpenLayers.Feature(this,a,u);this.features.push(c);var d=c.createMarker();null!=p.attributes.title&&null!=p.attributes.description&&d.events.register("click",c,this.markerClick),this.addMarker(d)}this.events.triggerEvent("loadend")},markerClick:function(t){var e=this==this.layer.selectedFeature;this.layer.selectedFeature=e?null:this;for(var i=0,n=this.layer.map.popups.length;n>i;i++)this.layer.map.removePopup(this.layer.map.popups[i]);e||this.layer.map.addPopup(this.createPopup()),OpenLayers.Event.stop(t)},clearFeatures:function(){if(null!=this.features)for(;this.features.length>0;){var t=this.features[0];OpenLayers.Util.removeItem(this.features,t),t.destroy()}},CLASS_NAME:"OpenLayers.Layer.Text"}),OpenLayers.Control.Scale=OpenLayers.Class(OpenLayers.Control,{element:null,geodesic:!1,initialize:function(t,e){OpenLayers.Control.prototype.initialize.apply(this,[e]),this.element=OpenLayers.Util.getElement(t)},draw:function(){return OpenLayers.Control.prototype.draw.apply(this,arguments),this.element||(this.element=document.createElement("div"),this.div.appendChild(this.element)),this.map.events.register("moveend",this,this.updateScale),this.updateScale(),this.div},updateScale:function(){var t;if(this.geodesic===!0){var e=this.map.getUnits();if(!e)return;var i=OpenLayers.INCHES_PER_UNIT;t=(this.map.getGeodesicPixelSize().w||1e-6)*i.km*OpenLayers.DOTS_PER_INCH}else t=this.map.getScale();t&&(t=t>=9500&&95e4>=t?Math.round(t/1e3)+"K":t>=95e4?Math.round(t/1e6)+"M":Math.round(t),this.element.innerHTML=OpenLayers.i18n("Scale = 1 : ${scaleDenom}",{scaleDenom:t}))},CLASS_NAME:"OpenLayers.Control.Scale"}),OpenLayers.Layer.MapGuide=OpenLayers.Class(OpenLayers.Layer.Grid,{isBaseLayer:!0,useHttpTile:!1,singleTile:!1,useOverlay:!1,useAsyncOverlay:!0,TILE_PARAMS:{operation:"GETTILEIMAGE",version:"1.2.0"},SINGLE_TILE_PARAMS:{operation:"GETMAPIMAGE",format:"PNG",locale:"en",clip:"1",version:"1.0.0"},OVERLAY_PARAMS:{operation:"GETDYNAMICMAPOVERLAYIMAGE",format:"PNG",locale:"en",clip:"1",version:"2.0.0"},FOLDER_PARAMS:{tileColumnsPerFolder:30,tileRowsPerFolder:30,format:"png",querystring:null},defaultSize:new OpenLayers.Size(300,300),tileOriginCorner:"tl",initialize:function(t,e,i,n){OpenLayers.Layer.Grid.prototype.initialize.apply(this,arguments),(null==n||null==n.isBaseLayer)&&(this.isBaseLayer="true"!=this.transparent&&1!=this.transparent),n&&null!=n.useOverlay&&(this.useOverlay=n.useOverlay),this.singleTile?this.useOverlay?(OpenLayers.Util.applyDefaults(this.params,this.OVERLAY_PARAMS),this.useAsyncOverlay||(this.params.version="1.0.0")):OpenLayers.Util.applyDefaults(this.params,this.SINGLE_TILE_PARAMS):(this.useHttpTile?OpenLayers.Util.applyDefaults(this.params,this.FOLDER_PARAMS):OpenLayers.Util.applyDefaults(this.params,this.TILE_PARAMS),this.setTileSize(this.defaultSize))},clone:function(t){return null==t&&(t=new OpenLayers.Layer.MapGuide(this.name,this.url,this.params,this.getOptions())),t=OpenLayers.Layer.Grid.prototype.clone.apply(this,[t])},getURL:function(t){var e,i=t.getCenterLonLat(),n=this.map.getSize();if(this.singleTile){var s={setdisplaydpi:OpenLayers.DOTS_PER_INCH,setdisplayheight:n.h*this.ratio,setdisplaywidth:n.w*this.ratio,setviewcenterx:i.lon,setviewcentery:i.lat,setviewscale:this.map.getScale()};if(this.useOverlay&&!this.useAsyncOverlay){var r={};r=OpenLayers.Util.extend(r,s),r.operation="GETVISIBLEMAPEXTENT",r.version="1.0.0",r.session=this.params.session,r.mapName=this.params.mapName,r.format="text/xml",e=this.getFullRequestString(r),OpenLayers.Request.GET({url:e,async:!1})}e=this.getFullRequestString(s)}else{var o=this.map.getResolution(),a=Math.floor((t.left-this.maxExtent.left)/o);a=Math.round(a/this.tileSize.w);var l=Math.floor((this.maxExtent.top-t.top)/o);l=Math.round(l/this.tileSize.h),e=this.useHttpTile?this.getImageFilePath({tilecol:a,tilerow:l,scaleindex:this.resolutions.length-this.map.zoom-1}):this.getFullRequestString({tilecol:a,tilerow:l,scaleindex:this.resolutions.length-this.map.zoom-1})}return e},getFullRequestString:function(t,e){var i=null==e?this.url:e;"object"==typeof i&&(i=i[Math.floor(Math.random()*i.length)]);var n=i,s=OpenLayers.Util.extend({},this.params);s=OpenLayers.Util.extend(s,t);var r=OpenLayers.Util.upperCaseObject(OpenLayers.Util.getParameters(i));for(var o in s)o.toUpperCase()in r&&delete s[o];var a=OpenLayers.Util.getParameterString(s);if(a=a.replace(/,/g,"+"),""!=a){var l=i.charAt(i.length-1);n+="&"==l||"?"==l?a:-1==i.indexOf("?")?"?"+a:"&"+a}return n},getImageFilePath:function(t,e){var i=null==e?this.url:e;"object"==typeof i&&(i=i[Math.floor(Math.random()*i.length)]);var n=i,s="",r="";t.tilerow<0&&(s="-"),s+=0==t.tilerow?"0":Math.floor(Math.abs(t.tilerow/this.params.tileRowsPerFolder))*this.params.tileRowsPerFolder,t.tilecol<0&&(r="-"),r+=0==t.tilecol?"0":Math.floor(Math.abs(t.tilecol/this.params.tileColumnsPerFolder))*this.params.tileColumnsPerFolder;var o="/S"+Math.floor(t.scaleindex)+"/"+this.params.basemaplayergroupname+"/R"+s+"/C"+r+"/"+t.tilerow%this.params.tileRowsPerFolder+"_"+t.tilecol%this.params.tileColumnsPerFolder+"."+this.params.format;return this.params.querystring&&(o+="?"+this.params.querystring),n+=o},CLASS_NAME:"OpenLayers.Layer.MapGuide"}),OpenLayers.Control.Measure=OpenLayers.Class(OpenLayers.Control,{callbacks:null,displaySystem:"metric",geodesic:!1,displaySystemUnits:{geographic:["dd"],english:["mi","ft","in"],metric:["km","m"]},partialDelay:300,delayedTrigger:null,persist:!1,immediate:!1,initialize:function(t,e){OpenLayers.Control.prototype.initialize.apply(this,[e]);var i={done:this.measureComplete,point:this.measurePartial};this.immediate&&(i.modify=this.measureImmediate),this.callbacks=OpenLayers.Util.extend(i,this.callbacks),this.handlerOptions=OpenLayers.Util.extend({persist:this.persist},this.handlerOptions),this.handler=new t(this,this.callbacks,this.handlerOptions)},deactivate:function(){return this.cancelDelay(),OpenLayers.Control.prototype.deactivate.apply(this,arguments)},cancel:function(){this.cancelDelay(),this.handler.cancel()},setImmediate:function(t){this.immediate=t,this.immediate?this.callbacks.modify=this.measureImmediate:delete this.callbacks.modify},updateHandler:function(t,e){var i=this.active;i&&this.deactivate(),this.handler=new t(this,this.callbacks,e),i&&this.activate()},measureComplete:function(t){this.cancelDelay(),this.measure(t,"measure")},measurePartial:function(t,e){this.cancelDelay(),e=e.clone(),this.handler.freehandMode(this.handler.evt)?this.measure(e,"measurepartial"):this.delayedTrigger=window.setTimeout(OpenLayers.Function.bind(function(){this.delayedTrigger=null,this.measure(e,"measurepartial")},this),this.partialDelay)},measureImmediate:function(t,e,i){i&&!this.handler.freehandMode(this.handler.evt)&&(this.cancelDelay(),this.measure(e.geometry,"measurepartial"))},cancelDelay:function(){null!==this.delayedTrigger&&(window.clearTimeout(this.delayedTrigger),this.delayedTrigger=null)},measure:function(t,e){var i,n;t.CLASS_NAME.indexOf("LineString")>-1?(i=this.getBestLength(t),n=1):(i=this.getBestArea(t),n=2),this.events.triggerEvent(e,{measure:i[0],units:i[1],order:n,geometry:t})},getBestArea:function(t){for(var e,i,n=this.displaySystemUnits[this.displaySystem],s=0,r=n.length;r>s&&(e=n[s],i=this.getArea(t,e),!(i>1));++s);return[i,e]},getArea:function(t,e){var i,n;this.geodesic?(i=t.getGeodesicArea(this.map.getProjectionObject()),n="m"):(i=t.getArea(),n=this.map.getUnits());var s=OpenLayers.INCHES_PER_UNIT[e];if(s){var r=OpenLayers.INCHES_PER_UNIT[n];i*=Math.pow(r/s,2)}return i},getBestLength:function(t){for(var e,i,n=this.displaySystemUnits[this.displaySystem],s=0,r=n.length;r>s&&(e=n[s],i=this.getLength(t,e),!(i>1));++s);return[i,e]},getLength:function(t,e){var i,n;this.geodesic?(i=t.getGeodesicLength(this.map.getProjectionObject()),n="m"):(i=t.getLength(),n=this.map.getUnits());var s=OpenLayers.INCHES_PER_UNIT[e];if(s){var r=OpenLayers.INCHES_PER_UNIT[n];i*=r/s}return i},CLASS_NAME:"OpenLayers.Control.Measure"}),OpenLayers.Format.WMC.v1_0_0=OpenLayers.Class(OpenLayers.Format.WMC.v1,{VERSION:"1.0.0",schemaLocation:"http://www.opengis.net/context http://schemas.opengis.net/context/1.0.0/context.xsd",initialize:function(t){OpenLayers.Format.WMC.v1.prototype.initialize.apply(this,[t])},read_wmc_SRS:function(t,e){var i=this.getChildValue(e);"object"!=typeof t.projections&&(t.projections={});for(var n=i.split(/ +/),s=0,r=n.length;r>s;s++)t.projections[n[s]]=!0},write_wmc_Layer:function(t){var e=OpenLayers.Format.WMC.v1.prototype.write_wmc_Layer.apply(this,[t]);if(t.srs){var i=[];for(var n in t.srs)i.push(n);e.appendChild(this.createElementDefaultNS("SRS",i.join(" ")))}e.appendChild(this.write_wmc_FormatList(t)),e.appendChild(this.write_wmc_StyleList(t)),t.dimensions&&e.appendChild(this.write_wmc_DimensionList(t)),e.appendChild(this.write_wmc_LayerExtension(t))},CLASS_NAME:"OpenLayers.Format.WMC.v1_0_0"}),OpenLayers.Format.WMTSCapabilities.v1_0_0=OpenLayers.Class(OpenLayers.Format.OWSCommon.v1_1_0,{version:"1.0.0",namespaces:{ows:"http://www.opengis.net/ows/1.1",wmts:"http://www.opengis.net/wmts/1.0",xlink:"http://www.w3.org/1999/xlink"},yx:null,defaultPrefix:"wmts",initialize:function(t){OpenLayers.Format.XML.prototype.initialize.apply(this,[t]),this.options=t;var e=OpenLayers.Util.extend({},OpenLayers.Format.WMTSCapabilities.prototype.yx);this.yx=OpenLayers.Util.extend(e,this.yx)},read:function(t){"string"==typeof t&&(t=OpenLayers.Format.XML.prototype.read.apply(this,[t])),t&&9==t.nodeType&&(t=t.documentElement);var e={};return this.readNode(t,e),e.version=this.version,e},readers:{wmts:{Capabilities:function(t,e){this.readChildNodes(t,e)},Contents:function(t,e){e.contents={},e.contents.layers=[],e.contents.tileMatrixSets={},this.readChildNodes(t,e.contents)},Layer:function(t,e){var i={styles:[],formats:[],dimensions:[],tileMatrixSetLinks:[]};i.layers=[],this.readChildNodes(t,i),e.layers.push(i)},Style:function(t,e){var i={};i.isDefault="true"===t.getAttribute("isDefault"),this.readChildNodes(t,i),e.styles.push(i)},Format:function(t,e){e.formats.push(this.getChildValue(t))},TileMatrixSetLink:function(t,e){var i={};this.readChildNodes(t,i),e.tileMatrixSetLinks.push(i)},TileMatrixSet:function(t,e){if(e.layers){var i={matrixIds:[]};this.readChildNodes(t,i),e.tileMatrixSets[i.identifier]=i}else e.tileMatrixSet=this.getChildValue(t)},TileMatrix:function(t,e){var i={supportedCRS:e.supportedCRS};this.readChildNodes(t,i),e.matrixIds.push(i)},ScaleDenominator:function(t,e){e.scaleDenominator=parseFloat(this.getChildValue(t))},TopLeftCorner:function(t,e){var i,n=this.getChildValue(t),s=n.split(" ");if(e.supportedCRS){var r=e.supportedCRS.replace(/urn:ogc:def:crs:(\w+):.+:(\w+)$/,"urn:ogc:def:crs:$1::$2");i=!!this.yx[r]}e.topLeftCorner=i?new OpenLayers.LonLat(s[1],s[0]):new OpenLayers.LonLat(s[0],s[1])},TileWidth:function(t,e){e.tileWidth=parseInt(this.getChildValue(t))},TileHeight:function(t,e){e.tileHeight=parseInt(this.getChildValue(t))},MatrixWidth:function(t,e){e.matrixWidth=parseInt(this.getChildValue(t))},MatrixHeight:function(t,e){e.matrixHeight=parseInt(this.getChildValue(t))},ResourceURL:function(t,e){e.resourceUrl=e.resourceUrl||{};var i=t.getAttribute("resourceType");e.resourceUrls||(e.resourceUrls=[]);var n=e.resourceUrl[i]={format:t.getAttribute("format"),template:t.getAttribute("template"),resourceType:i};e.resourceUrls.push(n)},WSDL:function(t,e){e.wsdl={},e.wsdl.href=t.getAttribute("xlink:href")},ServiceMetadataURL:function(t,e){e.serviceMetadataUrl={},e.serviceMetadataUrl.href=t.getAttribute("xlink:href")
},LegendURL:function(t,e){e.legend={},e.legend.href=t.getAttribute("xlink:href"),e.legend.format=t.getAttribute("format")},Dimension:function(t,e){var i={values:[]};this.readChildNodes(t,i),e.dimensions.push(i)},Default:function(t,e){e["default"]=this.getChildValue(t)},Value:function(t,e){e.values.push(this.getChildValue(t))}},ows:OpenLayers.Format.OWSCommon.v1_1_0.prototype.readers.ows},CLASS_NAME:"OpenLayers.Format.WMTSCapabilities.v1_0_0"}),OpenLayers.Layer.WorldWind=OpenLayers.Class(OpenLayers.Layer.Grid,{DEFAULT_PARAMS:{},isBaseLayer:!0,lzd:null,zoomLevels:null,initialize:function(t,e,i,n,s,r){this.lzd=i,this.zoomLevels=n;var o=[];o.push(t,e,s,r),OpenLayers.Layer.Grid.prototype.initialize.apply(this,o),this.params=OpenLayers.Util.applyDefaults(this.params,this.DEFAULT_PARAMS)},getZoom:function(){{var t=this.map.getZoom();this.map.getMaxExtent()}return t-=Math.log(this.maxResolution/(this.lzd/512))/Math.log(2)},getURL:function(t){t=this.adjustBounds(t);var e=this.getZoom(),i=this.map.getMaxExtent(),n=this.lzd/Math.pow(2,this.getZoom()),s=Math.floor((t.left-i.left)/n),r=Math.floor((t.bottom-i.bottom)/n);return this.map.getResolution()<=this.lzd/512&&this.getZoom()<=this.zoomLevels?this.getFullRequestString({L:e,X:s,Y:r}):OpenLayers.Util.getImageLocation("blank.gif")},CLASS_NAME:"OpenLayers.Layer.WorldWind"}),OpenLayers.Popup.FramedCloud=OpenLayers.Class(OpenLayers.Popup.Framed,{contentDisplayClass:"olFramedCloudPopupContent",autoSize:!0,panMapIfOutOfView:!0,imageSize:new OpenLayers.Size(1276,736),isAlphaImage:!1,fixedRelativePosition:!1,positionBlocks:{tl:{offset:new OpenLayers.Pixel(44,0),padding:new OpenLayers.Bounds(8,40,8,9),blocks:[{size:new OpenLayers.Size("auto","auto"),anchor:new OpenLayers.Bounds(0,51,22,0),position:new OpenLayers.Pixel(0,0)},{size:new OpenLayers.Size(22,"auto"),anchor:new OpenLayers.Bounds(null,50,0,0),position:new OpenLayers.Pixel(-1238,0)},{size:new OpenLayers.Size("auto",19),anchor:new OpenLayers.Bounds(0,32,22,null),position:new OpenLayers.Pixel(0,-631)},{size:new OpenLayers.Size(22,18),anchor:new OpenLayers.Bounds(null,32,0,null),position:new OpenLayers.Pixel(-1238,-632)},{size:new OpenLayers.Size(81,35),anchor:new OpenLayers.Bounds(null,0,0,null),position:new OpenLayers.Pixel(0,-688)}]},tr:{offset:new OpenLayers.Pixel(-45,0),padding:new OpenLayers.Bounds(8,40,8,9),blocks:[{size:new OpenLayers.Size("auto","auto"),anchor:new OpenLayers.Bounds(0,51,22,0),position:new OpenLayers.Pixel(0,0)},{size:new OpenLayers.Size(22,"auto"),anchor:new OpenLayers.Bounds(null,50,0,0),position:new OpenLayers.Pixel(-1238,0)},{size:new OpenLayers.Size("auto",19),anchor:new OpenLayers.Bounds(0,32,22,null),position:new OpenLayers.Pixel(0,-631)},{size:new OpenLayers.Size(22,19),anchor:new OpenLayers.Bounds(null,32,0,null),position:new OpenLayers.Pixel(-1238,-631)},{size:new OpenLayers.Size(81,35),anchor:new OpenLayers.Bounds(0,0,null,null),position:new OpenLayers.Pixel(-215,-687)}]},bl:{offset:new OpenLayers.Pixel(45,0),padding:new OpenLayers.Bounds(8,9,8,40),blocks:[{size:new OpenLayers.Size("auto","auto"),anchor:new OpenLayers.Bounds(0,21,22,32),position:new OpenLayers.Pixel(0,0)},{size:new OpenLayers.Size(22,"auto"),anchor:new OpenLayers.Bounds(null,21,0,32),position:new OpenLayers.Pixel(-1238,0)},{size:new OpenLayers.Size("auto",21),anchor:new OpenLayers.Bounds(0,0,22,null),position:new OpenLayers.Pixel(0,-629)},{size:new OpenLayers.Size(22,21),anchor:new OpenLayers.Bounds(null,0,0,null),position:new OpenLayers.Pixel(-1238,-629)},{size:new OpenLayers.Size(81,33),anchor:new OpenLayers.Bounds(null,null,0,0),position:new OpenLayers.Pixel(-101,-674)}]},br:{offset:new OpenLayers.Pixel(-44,0),padding:new OpenLayers.Bounds(8,9,8,40),blocks:[{size:new OpenLayers.Size("auto","auto"),anchor:new OpenLayers.Bounds(0,21,22,32),position:new OpenLayers.Pixel(0,0)},{size:new OpenLayers.Size(22,"auto"),anchor:new OpenLayers.Bounds(null,21,0,32),position:new OpenLayers.Pixel(-1238,0)},{size:new OpenLayers.Size("auto",21),anchor:new OpenLayers.Bounds(0,0,22,null),position:new OpenLayers.Pixel(0,-629)},{size:new OpenLayers.Size(22,21),anchor:new OpenLayers.Bounds(null,0,0,null),position:new OpenLayers.Pixel(-1238,-629)},{size:new OpenLayers.Size(81,33),anchor:new OpenLayers.Bounds(0,null,null,0),position:new OpenLayers.Pixel(-311,-674)}]}},minSize:new OpenLayers.Size(105,10),maxSize:new OpenLayers.Size(1200,660),initialize:function(){this.imageSrc=OpenLayers.Util.getImageLocation("cloud-popup-relative.png"),OpenLayers.Popup.Framed.prototype.initialize.apply(this,arguments),this.contentDiv.className=this.contentDisplayClass},CLASS_NAME:"OpenLayers.Popup.FramedCloud"}),OpenLayers.Format.SOSCapabilities.v1_0_0=OpenLayers.Class(OpenLayers.Format.SOSCapabilities,{namespaces:{ows:"http://www.opengis.net/ows/1.1",sos:"http://www.opengis.net/sos/1.0",gml:"http://www.opengis.net/gml",xlink:"http://www.w3.org/1999/xlink"},regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},initialize:function(t){OpenLayers.Format.XML.prototype.initialize.apply(this,[t]),this.options=t},read:function(t){"string"==typeof t&&(t=OpenLayers.Format.XML.prototype.read.apply(this,[t])),t&&9==t.nodeType&&(t=t.documentElement);var e={};return this.readNode(t,e),e},readers:{gml:OpenLayers.Util.applyDefaults({name:function(t,e){e.name=this.getChildValue(t)},TimePeriod:function(t,e){e.timePeriod={},this.readChildNodes(t,e.timePeriod)},beginPosition:function(t,e){e.beginPosition=this.getChildValue(t)},endPosition:function(t,e){e.endPosition=this.getChildValue(t)}},OpenLayers.Format.GML.v3.prototype.readers.gml),sos:{Capabilities:function(t,e){this.readChildNodes(t,e)},Contents:function(t,e){e.contents={},this.readChildNodes(t,e.contents)},ObservationOfferingList:function(t,e){e.offeringList={},this.readChildNodes(t,e.offeringList)},ObservationOffering:function(t,e){var i=this.getAttributeNS(t,this.namespaces.gml,"id");e[i]={procedures:[],observedProperties:[],featureOfInterestIds:[],responseFormats:[],resultModels:[],responseModes:[]},this.readChildNodes(t,e[i])},time:function(t,e){e.time={},this.readChildNodes(t,e.time)},procedure:function(t,e){e.procedures.push(this.getAttributeNS(t,this.namespaces.xlink,"href"))},observedProperty:function(t,e){e.observedProperties.push(this.getAttributeNS(t,this.namespaces.xlink,"href"))},featureOfInterest:function(t,e){e.featureOfInterestIds.push(this.getAttributeNS(t,this.namespaces.xlink,"href"))},responseFormat:function(t,e){e.responseFormats.push(this.getChildValue(t))},resultModel:function(t,e){e.resultModels.push(this.getChildValue(t))},responseMode:function(t,e){e.responseModes.push(this.getChildValue(t))}},ows:OpenLayers.Format.OWSCommon.v1_1_0.prototype.readers.ows},CLASS_NAME:"OpenLayers.Format.SOSCapabilities.v1_0_0"}),OpenLayers.Handler.Pinch=OpenLayers.Class(OpenLayers.Handler,{started:!1,stopDown:!1,pinching:!1,last:null,start:null,touchstart:function(t){var e=!0;if(this.pinching=!1,OpenLayers.Event.isMultiTouch(t))this.started=!0,this.last=this.start={distance:this.getDistance(t.touches),delta:0,scale:1},this.callback("start",[t,this.start]),e=!this.stopDown;else{if(this.started)return!1;this.started=!1,this.start=null,this.last=null}return OpenLayers.Event.preventDefault(t),e},touchmove:function(t){if(this.started&&OpenLayers.Event.isMultiTouch(t)){this.pinching=!0;var e=this.getPinchData(t);this.callback("move",[t,e]),this.last=e,OpenLayers.Event.stop(t)}else if(this.started)return!1;return!0},touchend:function(t){return this.started&&!OpenLayers.Event.isMultiTouch(t)?(this.started=!1,this.pinching=!1,this.callback("done",[t,this.start,this.last]),this.start=null,this.last=null,!1):!0},activate:function(){var t=!1;return OpenLayers.Handler.prototype.activate.apply(this,arguments)&&(this.pinching=!1,t=!0),t},deactivate:function(){var t=!1;return OpenLayers.Handler.prototype.deactivate.apply(this,arguments)&&(this.started=!1,this.pinching=!1,this.start=null,this.last=null,t=!0),t},getDistance:function(t){var e=t[0],i=t[1];return Math.sqrt(Math.pow(e.olClientX-i.olClientX,2)+Math.pow(e.olClientY-i.olClientY,2))},getPinchData:function(t){var e=this.getDistance(t.touches),i=e/this.start.distance;return{distance:e,delta:this.last.distance-e,scale:i}},CLASS_NAME:"OpenLayers.Handler.Pinch"}),OpenLayers.Control.NavToolbar=OpenLayers.Class(OpenLayers.Control.Panel,{initialize:function(t){OpenLayers.Control.Panel.prototype.initialize.apply(this,[t]),this.addControls([new OpenLayers.Control.Navigation,new OpenLayers.Control.ZoomBox])},draw:function(){var t=OpenLayers.Control.Panel.prototype.draw.apply(this,arguments);return null===this.defaultControl&&(this.defaultControl=this.controls[0]),t},CLASS_NAME:"OpenLayers.Control.NavToolbar"}),OpenLayers.Layer.OSM=OpenLayers.Class(OpenLayers.Layer.XYZ,{name:"OpenStreetMap",url:["http://a.tile.openstreetmap.org/${z}/${x}/${y}.png","http://b.tile.openstreetmap.org/${z}/${x}/${y}.png","http://c.tile.openstreetmap.org/${z}/${x}/${y}.png"],attribution:"&copy; <a href='http://www.openstreetmap.org/copyright'>OpenStreetMap</a> contributors",sphericalMercator:!0,wrapDateLine:!0,tileOptions:null,initialize:function(){OpenLayers.Layer.XYZ.prototype.initialize.apply(this,arguments),this.tileOptions=OpenLayers.Util.extend({crossOriginKeyword:"anonymous"},this.options&&this.options.tileOptions)},clone:function(t){return null==t&&(t=new OpenLayers.Layer.OSM(this.name,this.url,this.getOptions())),t=OpenLayers.Layer.XYZ.prototype.clone.apply(this,[t])},CLASS_NAME:"OpenLayers.Layer.OSM"}),OpenLayers.Strategy.Refresh=OpenLayers.Class(OpenLayers.Strategy,{force:!1,interval:0,timer:null,activate:function(){var t=OpenLayers.Strategy.prototype.activate.call(this);return t&&(this.layer.visibility===!0&&this.start(),this.layer.events.on({visibilitychanged:this.reset,scope:this})),t},deactivate:function(){var t=OpenLayers.Strategy.prototype.deactivate.call(this);return t&&(this.stop(),this.layer.events.un({visibilitychanged:this.reset,scope:this})),t},reset:function(){this.layer.visibility===!0?this.start():this.stop()},start:function(){this.interval&&"number"==typeof this.interval&&this.interval>0&&(this.timer=window.setInterval(OpenLayers.Function.bind(this.refresh,this),this.interval))},refresh:function(){this.layer&&this.layer.refresh&&"function"==typeof this.layer.refresh&&this.layer.refresh({force:this.force})},stop:function(){null!==this.timer&&(window.clearInterval(this.timer),this.timer=null)},CLASS_NAME:"OpenLayers.Strategy.Refresh"}),OpenLayers.Control.Geolocate=OpenLayers.Class(OpenLayers.Control,{geolocation:null,available:"geolocation"in navigator,bind:!0,watch:!1,geolocationOptions:null,destroy:function(){this.deactivate(),OpenLayers.Control.prototype.destroy.apply(this,arguments)},activate:function(){return this.available&&!this.geolocation&&(this.geolocation=navigator.geolocation),this.geolocation?OpenLayers.Control.prototype.activate.apply(this,arguments)?(this.watch?this.watchId=this.geolocation.watchPosition(OpenLayers.Function.bind(this.geolocate,this),OpenLayers.Function.bind(this.failure,this),this.geolocationOptions):this.getCurrentLocation(),!0):!1:(this.events.triggerEvent("locationuncapable"),!1)},deactivate:function(){return this.active&&null!==this.watchId&&this.geolocation.clearWatch(this.watchId),OpenLayers.Control.prototype.deactivate.apply(this,arguments)},geolocate:function(t){var e=new OpenLayers.LonLat(t.coords.longitude,t.coords.latitude).transform(new OpenLayers.Projection("EPSG:4326"),this.map.getProjectionObject());this.bind&&this.map.setCenter(e),this.events.triggerEvent("locationupdated",{position:t,point:new OpenLayers.Geometry.Point(e.lon,e.lat)})},getCurrentLocation:function(){return!this.active||this.watch?!1:(this.geolocation.getCurrentPosition(OpenLayers.Function.bind(this.geolocate,this),OpenLayers.Function.bind(this.failure,this),this.geolocationOptions),!0)},failure:function(t){this.events.triggerEvent("locationfailed",{error:t})},CLASS_NAME:"OpenLayers.Control.Geolocate"}),OpenLayers.Layer.ArcGIS93Rest=OpenLayers.Class(OpenLayers.Layer.Grid,{DEFAULT_PARAMS:{format:"png"},isBaseLayer:!0,initialize:function(t,e,i,n){var s=[];i=OpenLayers.Util.upperCaseObject(i),s.push(t,e,i,n),OpenLayers.Layer.Grid.prototype.initialize.apply(this,s),OpenLayers.Util.applyDefaults(this.params,OpenLayers.Util.upperCaseObject(this.DEFAULT_PARAMS)),this.params.TRANSPARENT&&"true"==this.params.TRANSPARENT.toString().toLowerCase()&&(null!=n&&n.isBaseLayer||(this.isBaseLayer=!1),"jpg"==this.params.FORMAT&&(this.params.FORMAT=OpenLayers.Util.alphaHack()?"gif":"png"))},clone:function(t){return null==t&&(t=new OpenLayers.Layer.ArcGIS93Rest(this.name,this.url,this.params,this.getOptions())),t=OpenLayers.Layer.Grid.prototype.clone.apply(this,[t])},getURL:function(t){t=this.adjustBounds(t);var e=this.projection.getCode().split(":"),i=e[e.length-1],n=this.getImageSize(),s={BBOX:t.toBBOX(),SIZE:n.w+","+n.h,F:"image",BBOXSR:i,IMAGESR:i};if(this.layerDefs){var r,o=[];for(r in this.layerDefs)this.layerDefs.hasOwnProperty(r)&&this.layerDefs[r]&&(o.push(r),o.push(":"),o.push(this.layerDefs[r]),o.push(";"));o.length>0&&(s.LAYERDEFS=o.join(""))}var a=this.getFullRequestString(s);return a},setLayerFilter:function(t,e){this.layerDefs||(this.layerDefs={}),e?this.layerDefs[t]=e:delete this.layerDefs[t]},clearLayerFilter:function(t){t?delete this.layerDefs[t]:delete this.layerDefs},mergeNewParams:function(t){var e=OpenLayers.Util.upperCaseObject(t),i=[e];return OpenLayers.Layer.Grid.prototype.mergeNewParams.apply(this,i)},CLASS_NAME:"OpenLayers.Layer.ArcGIS93Rest"}),OpenLayers.Handler.Hover=OpenLayers.Class(OpenLayers.Handler,{delay:500,pixelTolerance:null,stopMove:!1,px:null,timerId:null,mousemove:function(t){return this.passesTolerance(t.xy)&&(this.clearTimer(),this.callback("move",[t]),this.px=t.xy,t=OpenLayers.Util.extend({},t),this.timerId=window.setTimeout(OpenLayers.Function.bind(this.delayedCall,this,t),this.delay)),!this.stopMove},mouseout:function(t){return OpenLayers.Util.mouseLeft(t,this.map.viewPortDiv)&&(this.clearTimer(),this.callback("move",[t])),!0},passesTolerance:function(t){var e=!0;if(this.pixelTolerance&&this.px){var i=Math.sqrt(Math.pow(this.px.x-t.x,2)+Math.pow(this.px.y-t.y,2));i<this.pixelTolerance&&(e=!1)}return e},clearTimer:function(){null!=this.timerId&&(window.clearTimeout(this.timerId),this.timerId=null)},delayedCall:function(t){this.callback("pause",[t])},deactivate:function(){var t=!1;return OpenLayers.Handler.prototype.deactivate.apply(this,arguments)&&(this.clearTimer(),t=!0),t},CLASS_NAME:"OpenLayers.Handler.Hover"}),OpenLayers.Control.GetFeature=OpenLayers.Class(OpenLayers.Control,{protocol:null,multipleKey:null,toggleKey:null,modifiers:null,multiple:!1,click:!0,single:!0,clickout:!0,toggle:!1,clickTolerance:5,hover:!1,box:!1,maxFeatures:10,features:null,hoverFeature:null,handlers:null,hoverResponse:null,filterType:OpenLayers.Filter.Spatial.BBOX,initialize:function(t){t.handlerOptions=t.handlerOptions||{},OpenLayers.Control.prototype.initialize.apply(this,[t]),this.features={},this.handlers={},this.click&&(this.handlers.click=new OpenLayers.Handler.Click(this,{click:this.selectClick},this.handlerOptions.click||{})),this.box&&(this.handlers.box=new OpenLayers.Handler.Box(this,{done:this.selectBox},OpenLayers.Util.extend(this.handlerOptions.box,{boxDivClassName:"olHandlerBoxSelectFeature"}))),this.hover&&(this.handlers.hover=new OpenLayers.Handler.Hover(this,{move:this.cancelHover,pause:this.selectHover},OpenLayers.Util.extend(this.handlerOptions.hover,{delay:250,pixelTolerance:2})))},activate:function(){if(!this.active)for(var t in this.handlers)this.handlers[t].activate();return OpenLayers.Control.prototype.activate.apply(this,arguments)},deactivate:function(){if(this.active)for(var t in this.handlers)this.handlers[t].deactivate();return OpenLayers.Control.prototype.deactivate.apply(this,arguments)},selectClick:function(t){var e=this.pixelToBounds(t.xy);this.setModifiers(t),this.request(e,{single:this.single})},selectBox:function(t){var e;if(t instanceof OpenLayers.Bounds){var i=this.map.getLonLatFromPixel({x:t.left,y:t.bottom}),n=this.map.getLonLatFromPixel({x:t.right,y:t.top});e=new OpenLayers.Bounds(i.lon,i.lat,n.lon,n.lat)}else{if(this.click)return;e=this.pixelToBounds(t)}this.setModifiers(this.handlers.box.dragHandler.evt),this.request(e)},selectHover:function(t){var e=this.pixelToBounds(t.xy);this.request(e,{single:!0,hover:!0})},cancelHover:function(){this.hoverResponse&&(this.protocol.abort(this.hoverResponse),this.hoverResponse=null,OpenLayers.Element.removeClass(this.map.viewPortDiv,"olCursorWait"))},request:function(t,e){e=e||{};var i=new OpenLayers.Filter.Spatial({type:this.filterType,value:t});OpenLayers.Element.addClass(this.map.viewPortDiv,"olCursorWait");var n=this.protocol.read({maxFeatures:1==e.single?this.maxFeatures:void 0,filter:i,callback:function(i){i.success()&&(i.features.length?1==e.single?this.selectBestFeature(i.features,t.getCenterLonLat(),e):this.select(i.features):e.hover?this.hoverSelect():(this.events.triggerEvent("clickout"),this.clickout&&this.unselectAll())),OpenLayers.Element.removeClass(this.map.viewPortDiv,"olCursorWait")},scope:this});1==e.hover&&(this.hoverResponse=n)},selectBestFeature:function(t,e,i){if(i=i||{},t.length){for(var n,s,r,o=new OpenLayers.Geometry.Point(e.lon,e.lat),a=Number.MAX_VALUE,l=0;l<t.length&&(n=t[l],!(n.geometry&&(r=o.distanceTo(n.geometry,{edge:!1}),a>r&&(a=r,s=n,0==a))));++l);1==i.hover?this.hoverSelect(s):this.select(s||t)}},setModifiers:function(t){this.modifiers={multiple:this.multiple||this.multipleKey&&t[this.multipleKey],toggle:this.toggle||this.toggleKey&&t[this.toggleKey]}},select:function(t){this.modifiers.multiple||this.modifiers.toggle||this.unselectAll(),OpenLayers.Util.isArray(t)||(t=[t]);var e=this.events.triggerEvent("beforefeaturesselected",{features:t});if(e!==!1){for(var i,n=[],s=0,r=t.length;r>s;++s)i=t[s],this.features[i.fid||i.id]?this.modifiers.toggle&&this.unselect(this.features[i.fid||i.id]):(e=this.events.triggerEvent("beforefeatureselected",{feature:i}),e!==!1&&(this.features[i.fid||i.id]=i,n.push(i),this.events.triggerEvent("featureselected",{feature:i})));this.events.triggerEvent("featuresselected",{features:n})}},hoverSelect:function(t){var e=t?t.fid||t.id:null,i=this.hoverFeature?this.hoverFeature.fid||this.hoverFeature.id:null;i&&i!=e&&(this.events.triggerEvent("outfeature",{feature:this.hoverFeature}),this.hoverFeature=null),e&&e!=i&&(this.events.triggerEvent("hoverfeature",{feature:t}),this.hoverFeature=t)},unselect:function(t){delete this.features[t.fid||t.id],this.events.triggerEvent("featureunselected",{feature:t})},unselectAll:function(){for(var t in this.features)this.unselect(this.features[t])},setMap:function(t){for(var e in this.handlers)this.handlers[e].setMap(t);OpenLayers.Control.prototype.setMap.apply(this,arguments)},pixelToBounds:function(t){var e=t.add(-this.clickTolerance/2,this.clickTolerance/2),i=t.add(this.clickTolerance/2,-this.clickTolerance/2),n=this.map.getLonLatFromPixel(e),s=this.map.getLonLatFromPixel(i);return new OpenLayers.Bounds(n.lon,n.lat,s.lon,s.lat)},CLASS_NAME:"OpenLayers.Control.GetFeature"}),OpenLayers.Format.QueryStringFilter=function(){function t(t){return t=t.replace(/%/g,"\\%"),t=t.replace(/\\\\\.(\*)?/g,function(t,e){return e?t:"\\\\_"}),t=t.replace(/\\\\\.\*/g,"\\\\%"),t=t.replace(/(\\)?\.(\*)?/g,function(t,e,i){return e||i?t:"_"}),t=t.replace(/(\\)?\.\*/g,function(t,e){return e?t:"%"}),t=t.replace(/\\\./g,"."),t=t.replace(/(\\)?\\\*/g,function(t,e){return e?t:"*"})}var e={};return e[OpenLayers.Filter.Comparison.EQUAL_TO]="eq",e[OpenLayers.Filter.Comparison.NOT_EQUAL_TO]="ne",e[OpenLayers.Filter.Comparison.LESS_THAN]="lt",e[OpenLayers.Filter.Comparison.LESS_THAN_OR_EQUAL_TO]="lte",e[OpenLayers.Filter.Comparison.GREATER_THAN]="gt",e[OpenLayers.Filter.Comparison.GREATER_THAN_OR_EQUAL_TO]="gte",e[OpenLayers.Filter.Comparison.LIKE]="ilike",OpenLayers.Class(OpenLayers.Format,{wildcarded:!1,srsInBBOX:!1,write:function(i,n){n=n||{};var s=i.CLASS_NAME,r=s.substring(s.lastIndexOf(".")+1);switch(r){case"Spatial":switch(i.type){case OpenLayers.Filter.Spatial.BBOX:n.bbox=i.value.toArray(),this.srsInBBOX&&i.projection&&n.bbox.push(i.projection.getCode());break;case OpenLayers.Filter.Spatial.DWITHIN:n.tolerance=i.distance;case OpenLayers.Filter.Spatial.WITHIN:n.lon=i.value.x,n.lat=i.value.y;break;default:OpenLayers.Console.warn("Unknown spatial filter type "+i.type)}break;case"Comparison":var o=e[i.type];if(void 0!==o){var a=i.value;i.type==OpenLayers.Filter.Comparison.LIKE&&(a=t(a),this.wildcarded&&(a="%"+a+"%")),n[i.property+"__"+o]=a,n.queryable=n.queryable||[],n.queryable.push(i.property)}else OpenLayers.Console.warn("Unknown comparison filter type "+i.type);break;case"Logical":if(i.type===OpenLayers.Filter.Logical.AND)for(var l=0,h=i.filters.length;h>l;l++)n=this.write(i.filters[l],n);else OpenLayers.Console.warn("Unsupported logical filter type "+i.type);break;default:OpenLayers.Console.warn("Unknown filter type "+r)}return n},CLASS_NAME:"OpenLayers.Format.QueryStringFilter"})}(),OpenLayers.Format.WCSCapabilities.v1_1_0=OpenLayers.Class(OpenLayers.Format.WCSCapabilities.v1,{namespaces:{wcs:"http://www.opengis.net/wcs/1.1",xlink:"http://www.w3.org/1999/xlink",xsi:"http://www.w3.org/2001/XMLSchema-instance",ows:"http://www.opengis.net/ows/1.1"},errorProperty:"operationsMetadata",readers:{wcs:OpenLayers.Util.applyDefaults({Capabilities:function(t,e){this.readChildNodes(t,e)},Contents:function(t,e){e.contentMetadata=[],this.readChildNodes(t,e.contentMetadata)},CoverageSummary:function(t,e){var i={};this.readChildNodes(t,i),e.push(i)},Identifier:function(t,e){e.identifier=this.getChildValue(t)},Title:function(t,e){e.title=this.getChildValue(t)},Abstract:function(t,e){e["abstract"]=this.getChildValue(t)},SupportedCRS:function(t,e){var i=this.getChildValue(t);i&&(e.supportedCRS||(e.supportedCRS=[]),e.supportedCRS.push(i))},SupportedFormat:function(t,e){var i=this.getChildValue(t);i&&(e.supportedFormat||(e.supportedFormat=[]),e.supportedFormat.push(i))}},OpenLayers.Format.WCSCapabilities.v1.prototype.readers.wcs),ows:OpenLayers.Format.OWSCommon.v1_1_0.prototype.readers.ows},CLASS_NAME:"OpenLayers.Format.WCSCapabilities.v1_1_0"}),OpenLayers.Control.MousePosition=OpenLayers.Class(OpenLayers.Control,{autoActivate:!0,element:null,prefix:"",separator:", ",suffix:"",numDigits:5,granularity:10,emptyString:null,lastXy:null,displayProjection:null,destroy:function(){this.deactivate(),OpenLayers.Control.prototype.destroy.apply(this,arguments)},activate:function(){return OpenLayers.Control.prototype.activate.apply(this,arguments)?(this.map.events.register("mousemove",this,this.redraw),this.map.events.register("mouseout",this,this.reset),this.redraw(),!0):!1},deactivate:function(){return OpenLayers.Control.prototype.deactivate.apply(this,arguments)?(this.map.events.unregister("mousemove",this,this.redraw),this.map.events.unregister("mouseout",this,this.reset),this.element.innerHTML="",!0):!1},draw:function(){return OpenLayers.Control.prototype.draw.apply(this,arguments),this.element||(this.div.left="",this.div.top="",this.element=this.div),this.div},redraw:function(t){var e;if(null==t)return void this.reset();if(null==this.lastXy||Math.abs(t.xy.x-this.lastXy.x)>this.granularity||Math.abs(t.xy.y-this.lastXy.y)>this.granularity)return void(this.lastXy=t.xy);if(e=this.map.getLonLatFromPixel(t.xy)){this.displayProjection&&e.transform(this.map.getProjectionObject(),this.displayProjection),this.lastXy=t.xy;var i=this.formatOutput(e);i!=this.element.innerHTML&&(this.element.innerHTML=i)}},reset:function(){null!=this.emptyString&&(this.element.innerHTML=this.emptyString)},formatOutput:function(t){var e=parseInt(this.numDigits),i=this.prefix+t.lon.toFixed(e)+this.separator+t.lat.toFixed(e)+this.suffix;return i},CLASS_NAME:"OpenLayers.Control.MousePosition"}),OpenLayers.Tile.UTFGrid=OpenLayers.Class(OpenLayers.Tile,{url:null,utfgridResolution:2,json:null,format:null,destroy:function(){this.clear(),OpenLayers.Tile.prototype.destroy.apply(this,arguments)},draw:function(){var t=OpenLayers.Tile.prototype.draw.apply(this,arguments);if(t)if(this.isLoading?(this.abortLoading(),this.events.triggerEvent("reload")):(this.isLoading=!0,this.events.triggerEvent("loadstart")),this.url=this.layer.getURL(this.bounds),this.layer.useJSONP){var e=new OpenLayers.Protocol.Script({url:this.url,callback:function(t){this.isLoading=!1,this.events.triggerEvent("loadend"),this.json=t.data},scope:this});e.read(),this.request=e}else this.request=OpenLayers.Request.GET({url:this.url,callback:function(t){this.isLoading=!1,this.events.triggerEvent("loadend"),200===t.status&&this.parseData(t.responseText)},scope:this});else this.unload();return t},abortLoading:function(){this.request&&(this.request.abort(),delete this.request),this.isLoading=!1},getFeatureInfo:function(t,e){var i=null;if(this.json){var n=this.getFeatureId(t,e);null!==n&&(i={id:n,data:this.json.data[n]})}return i},getFeatureId:function(t,e){var i=null;if(this.json){var n=this.utfgridResolution,s=Math.floor(e/n),r=Math.floor(t/n),o=this.json.grid[s].charCodeAt(r),a=this.indexFromCharCode(o),l=this.json.keys;!isNaN(a)&&a in l&&(i=l[a])}return i},indexFromCharCode:function(t){return t>=93&&t--,t>=35&&t--,t-32},parseData:function(t){this.format||(this.format=new OpenLayers.Format.JSON),this.json=this.format.read(t)},clear:function(){this.json=null},CLASS_NAME:"OpenLayers.Tile.UTFGrid"}),OpenLayers.Control.NavigationHistory=OpenLayers.Class(OpenLayers.Control,{type:OpenLayers.Control.TYPE_TOGGLE,previous:null,previousOptions:null,next:null,nextOptions:null,limit:50,autoActivate:!0,clearOnDeactivate:!1,registry:null,nextStack:null,previousStack:null,listeners:null,restoring:!1,initialize:function(t){OpenLayers.Control.prototype.initialize.apply(this,[t]),this.registry=OpenLayers.Util.extend({moveend:this.getState},this.registry);var e={trigger:OpenLayers.Function.bind(this.previousTrigger,this),displayClass:this.displayClass+" "+this.displayClass+"Previous"};OpenLayers.Util.extend(e,this.previousOptions),this.previous=new OpenLayers.Control.Button(e);var i={trigger:OpenLayers.Function.bind(this.nextTrigger,this),displayClass:this.displayClass+" "+this.displayClass+"Next"};OpenLayers.Util.extend(i,this.nextOptions),this.next=new OpenLayers.Control.Button(i),this.clear()},onPreviousChange:function(t){t&&!this.previous.active?this.previous.activate():!t&&this.previous.active&&this.previous.deactivate()},onNextChange:function(t){t&&!this.next.active?this.next.activate():!t&&this.next.active&&this.next.deactivate()},destroy:function(){OpenLayers.Control.prototype.destroy.apply(this),this.previous.destroy(),this.next.destroy(),this.deactivate();for(var t in this)this[t]=null},setMap:function(t){this.map=t,this.next.setMap(t),this.previous.setMap(t)},draw:function(){OpenLayers.Control.prototype.draw.apply(this,arguments),this.next.draw(),this.previous.draw()},previousTrigger:function(){var t=this.previousStack.shift(),e=this.previousStack.shift();return void 0!=e?(this.nextStack.unshift(t),this.previousStack.unshift(e),this.restoring=!0,this.restore(e),this.restoring=!1,this.onNextChange(this.nextStack[0],this.nextStack.length),this.onPreviousChange(this.previousStack[1],this.previousStack.length-1)):this.previousStack.unshift(t),e},nextTrigger:function(){var t=this.nextStack.shift();return void 0!=t&&(this.previousStack.unshift(t),this.restoring=!0,this.restore(t),this.restoring=!1,this.onNextChange(this.nextStack[0],this.nextStack.length),this.onPreviousChange(this.previousStack[1],this.previousStack.length-1)),t},clear:function(){this.previousStack=[],this.previous.deactivate(),this.nextStack=[],this.next.deactivate()},getState:function(){return{center:this.map.getCenter(),resolution:this.map.getResolution(),projection:this.map.getProjectionObject(),units:this.map.getProjectionObject().getUnits()||this.map.units||this.map.baseLayer.units}},restore:function(t){var e,i;if(this.map.getProjectionObject()==t.projection)i=this.map.getZoomForResolution(t.resolution),e=t.center;else{e=t.center.clone(),e.transform(t.projection,this.map.getProjectionObject());var n=t.units,s=this.map.getProjectionObject().getUnits()||this.map.units||this.map.baseLayer.units,r=n&&s?OpenLayers.INCHES_PER_UNIT[n]/OpenLayers.INCHES_PER_UNIT[s]:1;i=this.map.getZoomForResolution(r*t.resolution)}this.map.setCenter(e,i)},setListeners:function(){this.listeners={};for(var t in this.registry)this.listeners[t]=OpenLayers.Function.bind(function(){if(!this.restoring){var e=this.registry[t].apply(this,arguments);this.previousStack.unshift(e),this.previousStack.length>1&&this.onPreviousChange(this.previousStack[1],this.previousStack.length-1),this.previousStack.length>this.limit+1&&this.previousStack.pop(),this.nextStack.length>0&&(this.nextStack=[],this.onNextChange(null,0))}return!0},this)},activate:function(){var t=!1;if(this.map&&OpenLayers.Control.prototype.activate.apply(this)){null==this.listeners&&this.setListeners();for(var e in this.listeners)this.map.events.register(e,this,this.listeners[e]);t=!0,0==this.previousStack.length&&this.initStack()}return t},initStack:function(){this.map.getCenter()&&this.listeners.moveend()},deactivate:function(){var t=!1;if(this.map&&OpenLayers.Control.prototype.deactivate.apply(this)){for(var e in this.listeners)this.map.events.unregister(e,this,this.listeners[e]);this.clearOnDeactivate&&this.clear(),t=!0}return t},CLASS_NAME:"OpenLayers.Control.NavigationHistory"}),OpenLayers.Protocol.HTTP=OpenLayers.Class(OpenLayers.Protocol,{url:null,headers:null,params:null,callback:null,scope:null,readWithPOST:!1,updateWithPOST:!1,deleteWithPOST:!1,wildcarded:!1,srsInBBOX:!1,initialize:function(t){if(t=t||{},this.params={},this.headers={},OpenLayers.Protocol.prototype.initialize.apply(this,arguments),!this.filterToParams&&OpenLayers.Format.QueryStringFilter){var e=new OpenLayers.Format.QueryStringFilter({wildcarded:this.wildcarded,srsInBBOX:this.srsInBBOX});this.filterToParams=function(t,i){return e.write(t,i)}}},destroy:function(){this.params=null,this.headers=null,OpenLayers.Protocol.prototype.destroy.apply(this)},read:function(t){OpenLayers.Protocol.prototype.read.apply(this,arguments),t=t||{},t.params=OpenLayers.Util.applyDefaults(t.params,this.options.params),t=OpenLayers.Util.applyDefaults(t,this.options),t.filter&&this.filterToParams&&(t.params=this.filterToParams(t.filter,t.params));var e=void 0!==t.readWithPOST?t.readWithPOST:this.readWithPOST,i=new OpenLayers.Protocol.Response({requestType:"read"});if(e){var n=t.headers||{};n["Content-Type"]="application/x-www-form-urlencoded",i.priv=OpenLayers.Request.POST({url:t.url,callback:this.createCallback(this.handleRead,i,t),data:OpenLayers.Util.getParameterString(t.params),headers:n})}else i.priv=OpenLayers.Request.GET({url:t.url,callback:this.createCallback(this.handleRead,i,t),params:t.params,headers:t.headers});return i},handleRead:function(t,e){this.handleResponse(t,e)},create:function(t,e){e=OpenLayers.Util.applyDefaults(e,this.options);var i=new OpenLayers.Protocol.Response({reqFeatures:t,requestType:"create"});return i.priv=OpenLayers.Request.POST({url:e.url,callback:this.createCallback(this.handleCreate,i,e),headers:e.headers,data:this.format.write(t)}),i},handleCreate:function(t,e){this.handleResponse(t,e)},update:function(t,e){e=e||{};var i=e.url||t.url||this.options.url+"/"+t.fid;e=OpenLayers.Util.applyDefaults(e,this.options);var n=new OpenLayers.Protocol.Response({reqFeatures:t,requestType:"update"}),s=this.updateWithPOST?"POST":"PUT";return n.priv=OpenLayers.Request[s]({url:i,callback:this.createCallback(this.handleUpdate,n,e),headers:e.headers,data:this.format.write(t)}),n},handleUpdate:function(t,e){this.handleResponse(t,e)},"delete":function(t,e){e=e||{};var i=e.url||t.url||this.options.url+"/"+t.fid;e=OpenLayers.Util.applyDefaults(e,this.options);var n=new OpenLayers.Protocol.Response({reqFeatures:t,requestType:"delete"}),s=this.deleteWithPOST?"POST":"DELETE",r={url:i,callback:this.createCallback(this.handleDelete,n,e),headers:e.headers};
return this.deleteWithPOST&&(r.data=this.format.write(t)),n.priv=OpenLayers.Request[s](r),n},handleDelete:function(t,e){this.handleResponse(t,e)},handleResponse:function(t,e){var i=t.priv;e.callback&&(i.status>=200&&i.status<300?("delete"!=t.requestType&&(t.features=this.parseFeatures(i)),t.code=OpenLayers.Protocol.Response.SUCCESS):t.code=OpenLayers.Protocol.Response.FAILURE,e.callback.call(e.scope,t))},parseFeatures:function(t){var e=t.responseXML;return e&&e.documentElement||(e=t.responseText),!e||e.length<=0?null:this.format.read(e)},commit:function(t,e){function i(t){for(var e=t.features?t.features.length:0,i=new Array(e),s=0;e>s;++s)i[s]=t.features[s].fid;m.insertIds=i,n.apply(this,[t])}function n(t){this.callUserCallback(t,e),d=d&&t.success(),r++,r>=c&&e.callback&&(m.code=d?OpenLayers.Protocol.Response.SUCCESS:OpenLayers.Protocol.Response.FAILURE,e.callback.apply(e.scope,[m]))}e=OpenLayers.Util.applyDefaults(e,this.options);var s=[],r=0,o={};o[OpenLayers.State.INSERT]=[],o[OpenLayers.State.UPDATE]=[],o[OpenLayers.State.DELETE]=[];for(var a,l,h=[],u=0,p=t.length;p>u;++u)a=t[u],l=o[a.state],l&&(l.push(a),h.push(a));var c=(o[OpenLayers.State.INSERT].length>0?1:0)+o[OpenLayers.State.UPDATE].length+o[OpenLayers.State.DELETE].length,d=!0,m=new OpenLayers.Protocol.Response({reqFeatures:h}),f=o[OpenLayers.State.INSERT];f.length>0&&s.push(this.create(f,OpenLayers.Util.applyDefaults({callback:i,scope:this},e.create))),f=o[OpenLayers.State.UPDATE];for(var u=f.length-1;u>=0;--u)s.push(this.update(f[u],OpenLayers.Util.applyDefaults({callback:n,scope:this},e.update)));f=o[OpenLayers.State.DELETE];for(var u=f.length-1;u>=0;--u)s.push(this["delete"](f[u],OpenLayers.Util.applyDefaults({callback:n,scope:this},e["delete"])));return s},abort:function(t){t&&t.priv.abort()},callUserCallback:function(t,e){var i=e[t.requestType];i&&i.callback&&i.callback.call(i.scope,t)},CLASS_NAME:"OpenLayers.Protocol.HTTP"}),OpenLayers.Strategy.Cluster=OpenLayers.Class(OpenLayers.Strategy,{distance:20,threshold:null,features:null,clusters:null,clustering:!1,resolution:null,activate:function(){var t=OpenLayers.Strategy.prototype.activate.call(this);return t&&this.layer.events.on({beforefeaturesadded:this.cacheFeatures,featuresremoved:this.clearCache,moveend:this.cluster,scope:this}),t},deactivate:function(){var t=OpenLayers.Strategy.prototype.deactivate.call(this);return t&&(this.clearCache(),this.layer.events.un({beforefeaturesadded:this.cacheFeatures,featuresremoved:this.clearCache,moveend:this.cluster,scope:this})),t},cacheFeatures:function(t){var e=!0;return this.clustering||(this.clearCache(),this.features=t.features,this.cluster(),e=!1),e},clearCache:function(){this.clustering||(this.features=null)},cluster:function(t){if((!t||t.zoomChanged)&&this.features){var e=this.layer.map.getResolution();if(e!=this.resolution||!this.clustersExist()){this.resolution=e;for(var i,n,s,r=[],o=0;o<this.features.length;++o)if(i=this.features[o],i.geometry){n=!1;for(var a=r.length-1;a>=0;--a)if(s=r[a],this.shouldCluster(s,i)){this.addToCluster(s,i),n=!0;break}n||r.push(this.createCluster(this.features[o]))}if(this.clustering=!0,this.layer.removeAllFeatures(),this.clustering=!1,r.length>0){if(this.threshold>1){var l=r.slice();r=[];for(var h,o=0,u=l.length;u>o;++o)h=l[o],h.attributes.count<this.threshold?Array.prototype.push.apply(r,h.cluster):r.push(h)}this.clustering=!0,this.layer.addFeatures(r),this.clustering=!1}this.clusters=r}}},clustersExist:function(){var t=!1;if(this.clusters&&this.clusters.length>0&&this.clusters.length==this.layer.features.length){t=!0;for(var e=0;e<this.clusters.length;++e)if(this.clusters[e]!=this.layer.features[e]){t=!1;break}}return t},shouldCluster:function(t,e){var i=t.geometry.getBounds().getCenterLonLat(),n=e.geometry.getBounds().getCenterLonLat(),s=Math.sqrt(Math.pow(i.lon-n.lon,2)+Math.pow(i.lat-n.lat,2))/this.resolution;return s<=this.distance},addToCluster:function(t,e){t.cluster.push(e),t.attributes.count+=1},createCluster:function(t){var e=t.geometry.getBounds().getCenterLonLat(),i=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.Point(e.lon,e.lat),{count:1});return i.cluster=[t],i},CLASS_NAME:"OpenLayers.Strategy.Cluster"}),OpenLayers.Strategy.Filter=OpenLayers.Class(OpenLayers.Strategy,{filter:null,cache:null,caching:!1,activate:function(){var t=OpenLayers.Strategy.prototype.activate.apply(this,arguments);return t&&(this.cache=[],this.layer.events.on({beforefeaturesadded:this.handleAdd,beforefeaturesremoved:this.handleRemove,scope:this})),t},deactivate:function(){return this.cache=null,this.layer&&this.layer.events&&this.layer.events.un({beforefeaturesadded:this.handleAdd,beforefeaturesremoved:this.handleRemove,scope:this}),OpenLayers.Strategy.prototype.deactivate.apply(this,arguments)},handleAdd:function(t){if(!this.caching&&this.filter){var e=t.features;t.features=[];for(var i,n=0,s=e.length;s>n;++n)i=e[n],this.filter.evaluate(i)?t.features.push(i):this.cache.push(i)}},handleRemove:function(){this.caching||(this.cache=[])},setFilter:function(t){this.filter=t;var e=this.cache;if(this.cache=[],this.handleAdd({features:this.layer.features}),this.cache.length>0&&(this.caching=!0,this.layer.removeFeatures(this.cache.slice()),this.caching=!1),e.length>0){var i={features:e};this.handleAdd(i),i.features.length>0&&(this.caching=!0,this.layer.addFeatures(i.features),this.caching=!1)}},CLASS_NAME:"OpenLayers.Strategy.Filter"}),OpenLayers.Protocol.SOS=function(t){t=OpenLayers.Util.applyDefaults(t,OpenLayers.Protocol.SOS.DEFAULTS);var e=OpenLayers.Protocol.SOS["v"+t.version.replace(/\./g,"_")];if(!e)throw"Unsupported SOS version: "+t.version;return new e(t)},OpenLayers.Protocol.SOS.DEFAULTS={version:"1.0.0"},OpenLayers.Format.GeoRSS=OpenLayers.Class(OpenLayers.Format.XML,{rssns:"http://backend.userland.com/rss2",featureNS:"http://mapserver.gis.umn.edu/mapserver",georssns:"http://www.georss.org/georss",geons:"http://www.w3.org/2003/01/geo/wgs84_pos#",featureTitle:"Untitled",featureDescription:"No Description",gmlParser:null,xy:!1,createGeometryFromItem:function(t){var e=this.getElementsByTagNameNS(t,this.georssns,"point"),i=this.getElementsByTagNameNS(t,this.geons,"lat"),n=this.getElementsByTagNameNS(t,this.geons,"long"),s=this.getElementsByTagNameNS(t,this.georssns,"line"),r=this.getElementsByTagNameNS(t,this.georssns,"polygon"),o=this.getElementsByTagNameNS(t,this.georssns,"where"),a=this.getElementsByTagNameNS(t,this.georssns,"box");if(e.length>0||i.length>0&&n.length>0){var l;e.length>0?(l=OpenLayers.String.trim(e[0].firstChild.nodeValue).split(/\s+/),2!=l.length&&(l=OpenLayers.String.trim(e[0].firstChild.nodeValue).split(/\s*,\s*/))):l=[parseFloat(i[0].firstChild.nodeValue),parseFloat(n[0].firstChild.nodeValue)];var h=new OpenLayers.Geometry.Point(l[1],l[0])}else if(s.length>0){for(var e,u=OpenLayers.String.trim(this.getChildValue(s[0])).split(/\s+/),p=[],c=0,d=u.length;d>c;c+=2)e=new OpenLayers.Geometry.Point(u[c+1],u[c]),p.push(e);h=new OpenLayers.Geometry.LineString(p)}else if(r.length>0){for(var e,u=OpenLayers.String.trim(this.getChildValue(r[0])).split(/\s+/),p=[],c=0,d=u.length;d>c;c+=2)e=new OpenLayers.Geometry.Point(u[c+1],u[c]),p.push(e);h=new OpenLayers.Geometry.Polygon([new OpenLayers.Geometry.LinearRing(p)])}else if(o.length>0){this.gmlParser||(this.gmlParser=new OpenLayers.Format.GML({xy:this.xy}));var m=this.gmlParser.parseFeature(o[0]);h=m.geometry}else if(a.length>0){var e,u=OpenLayers.String.trim(a[0].firstChild.nodeValue).split(/\s+/),p=[];u.length>3&&(e=new OpenLayers.Geometry.Point(u[1],u[0]),p.push(e),e=new OpenLayers.Geometry.Point(u[1],u[2]),p.push(e),e=new OpenLayers.Geometry.Point(u[3],u[2]),p.push(e),e=new OpenLayers.Geometry.Point(u[3],u[0]),p.push(e),e=new OpenLayers.Geometry.Point(u[1],u[0]),p.push(e)),h=new OpenLayers.Geometry.Polygon([new OpenLayers.Geometry.LinearRing(p)])}return h&&this.internalProjection&&this.externalProjection&&h.transform(this.externalProjection,this.internalProjection),h},createFeatureFromItem:function(t){var e=this.createGeometryFromItem(t),i=this._getChildValue(t,"*","title",this.featureTitle),n=this._getChildValue(t,"*","description",this._getChildValue(t,"*","content",this._getChildValue(t,"*","summary",this.featureDescription))),s=this._getChildValue(t,"*","link");if(!s)try{s=this.getElementsByTagNameNS(t,"*","link")[0].getAttribute("href")}catch(r){s=null}var o=this._getChildValue(t,"*","id",null),a={title:i,description:n,link:s},l=new OpenLayers.Feature.Vector(e,a);return l.fid=o,l},_getChildValue:function(t,e,i,n){var s,r=this.getElementsByTagNameNS(t,e,i);return s=r&&r[0]&&r[0].firstChild&&r[0].firstChild.nodeValue?this.getChildValue(r[0]):void 0==n?"":n},read:function(t){"string"==typeof t&&(t=OpenLayers.Format.XML.prototype.read.apply(this,[t]));var e=null;e=this.getElementsByTagNameNS(t,"*","item"),0==e.length&&(e=this.getElementsByTagNameNS(t,"*","entry"));for(var i=e.length,n=new Array(i),s=0;i>s;s++)n[s]=this.createFeatureFromItem(e[s]);return n},write:function(t){var e;if(OpenLayers.Util.isArray(t)){e=this.createElementNS(this.rssns,"rss");for(var i=0,n=t.length;n>i;i++)e.appendChild(this.createFeatureXML(t[i]))}else e=this.createFeatureXML(t);return OpenLayers.Format.XML.prototype.write.apply(this,[e])},createFeatureXML:function(t){var e=this.buildGeometryNode(t.geometry),i=this.createElementNS(this.rssns,"item"),n=this.createElementNS(this.rssns,"title");n.appendChild(this.createTextNode(t.attributes.title?t.attributes.title:""));var s=this.createElementNS(this.rssns,"description");if(s.appendChild(this.createTextNode(t.attributes.description?t.attributes.description:"")),i.appendChild(n),i.appendChild(s),t.attributes.link){var r=this.createElementNS(this.rssns,"link");r.appendChild(this.createTextNode(t.attributes.link)),i.appendChild(r)}for(var o in t.attributes)if("link"!=o&&"title"!=o&&"description"!=o){var a=this.createTextNode(t.attributes[o]),l=o;-1!=o.search(":")&&(l=o.split(":")[1]);var h=this.createElementNS(this.featureNS,"feature:"+l);h.appendChild(a),i.appendChild(h)}return i.appendChild(e),i},buildGeometryNode:function(t){this.internalProjection&&this.externalProjection&&(t=t.clone(),t.transform(this.internalProjection,this.externalProjection));var e;if("OpenLayers.Geometry.Polygon"==t.CLASS_NAME)e=this.createElementNS(this.georssns,"georss:polygon"),e.appendChild(this.buildCoordinatesNode(t.components[0]));else if("OpenLayers.Geometry.LineString"==t.CLASS_NAME)e=this.createElementNS(this.georssns,"georss:line"),e.appendChild(this.buildCoordinatesNode(t));else{if("OpenLayers.Geometry.Point"!=t.CLASS_NAME)throw"Couldn't parse "+t.CLASS_NAME;e=this.createElementNS(this.georssns,"georss:point"),e.appendChild(this.buildCoordinatesNode(t))}return e},buildCoordinatesNode:function(t){var e=null;t.components&&(e=t.components);var i;if(e){for(var n=e.length,s=new Array(n),r=0;n>r;r++)s[r]=e[r].y+" "+e[r].x;i=s.join(" ")}else i=t.y+" "+t.x;return this.createTextNode(i)},CLASS_NAME:"OpenLayers.Format.GeoRSS"}),OpenLayers.Format.WPSCapabilities=OpenLayers.Class(OpenLayers.Format.XML.VersionedOGC,{defaultVersion:"1.0.0",CLASS_NAME:"OpenLayers.Format.WPSCapabilities"}),OpenLayers.Format.WPSCapabilities.v1_0_0=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{ows:"http://www.opengis.net/ows/1.1",wps:"http://www.opengis.net/wps/1.0.0",xlink:"http://www.w3.org/1999/xlink"},regExes:{trimSpace:/^\s*|\s*$/g,removeSpace:/\s*/g,splitSpace:/\s+/,trimComma:/\s*,\s*/g},initialize:function(t){OpenLayers.Format.XML.prototype.initialize.apply(this,[t])},read:function(t){"string"==typeof t&&(t=OpenLayers.Format.XML.prototype.read.apply(this,[t])),t&&9==t.nodeType&&(t=t.documentElement);var e={};return this.readNode(t,e),e},readers:{wps:{Capabilities:function(t,e){this.readChildNodes(t,e)},ProcessOfferings:function(t,e){e.processOfferings={},this.readChildNodes(t,e.processOfferings)},Process:function(t,e){var i=this.getAttributeNS(t,this.namespaces.wps,"processVersion"),n={processVersion:i};this.readChildNodes(t,n),e[n.identifier]=n},Languages:function(t,e){e.languages=[],this.readChildNodes(t,e.languages)},Default:function(t,e){var i={isDefault:!0};this.readChildNodes(t,i),e.push(i)},Supported:function(t,e){var i={};this.readChildNodes(t,i),e.push(i)}},ows:OpenLayers.Format.OWSCommon.v1_1_0.prototype.readers.ows},CLASS_NAME:"OpenLayers.Format.WPSCapabilities.v1_0_0"}),OpenLayers.Control.PinchZoom=OpenLayers.Class(OpenLayers.Control,{type:OpenLayers.Control.TYPE_TOOL,pinchOrigin:null,currentCenter:null,autoActivate:!0,preserveCenter:!1,initialize:function(){OpenLayers.Control.prototype.initialize.apply(this,arguments),this.handler=new OpenLayers.Handler.Pinch(this,{start:this.pinchStart,move:this.pinchMove,done:this.pinchDone},this.handlerOptions)},pinchStart:function(t){var e=this.preserveCenter?this.map.getPixelFromLonLat(this.map.getCenter()):t.xy;this.pinchOrigin=e,this.currentCenter=e},pinchMove:function(t,e){var i=e.scale,n=this.map.layerContainerOriginPx,s=this.pinchOrigin,r=this.preserveCenter?this.map.getPixelFromLonLat(this.map.getCenter()):t.xy,o=Math.round(n.x+r.x-s.x+(i-1)*(n.x-s.x)),a=Math.round(n.y+r.y-s.y+(i-1)*(n.y-s.y));this.map.applyTransform(o,a,i),this.currentCenter=r},pinchDone:function(t,e,i){this.map.applyTransform();var n=this.map.getZoomForResolution(this.map.getResolution()/i.scale,!0);if(n!==this.map.getZoom()||!this.currentCenter.equals(this.pinchOrigin)){var s=this.map.getResolutionForZoom(n),r=this.map.getLonLatFromPixel(this.pinchOrigin),o=this.currentCenter,a=this.map.getSize();r.lon+=s*(a.w/2-o.x),r.lat-=s*(a.h/2-o.y),this.map.div.clientWidth=this.map.div.clientWidth,this.map.setCenter(r,n)}},CLASS_NAME:"OpenLayers.Control.PinchZoom"}),OpenLayers.Control.TouchNavigation=OpenLayers.Class(OpenLayers.Control,{dragPan:null,dragPanOptions:null,pinchZoom:null,pinchZoomOptions:null,clickHandlerOptions:null,documentDrag:!1,autoActivate:!0,initialize:function(){this.handlers={},OpenLayers.Control.prototype.initialize.apply(this,arguments)},destroy:function(){this.deactivate(),this.dragPan&&this.dragPan.destroy(),this.dragPan=null,this.pinchZoom&&(this.pinchZoom.destroy(),delete this.pinchZoom),OpenLayers.Control.prototype.destroy.apply(this,arguments)},activate:function(){return OpenLayers.Control.prototype.activate.apply(this,arguments)?(this.dragPan.activate(),this.handlers.click.activate(),this.pinchZoom.activate(),!0):!1},deactivate:function(){return OpenLayers.Control.prototype.deactivate.apply(this,arguments)?(this.dragPan.deactivate(),this.handlers.click.deactivate(),this.pinchZoom.deactivate(),!0):!1},draw:function(){var t={click:this.defaultClick,dblclick:this.defaultDblClick},e=OpenLayers.Util.extend({"double":!0,stopDouble:!0,pixelTolerance:2},this.clickHandlerOptions);this.handlers.click=new OpenLayers.Handler.Click(this,t,e),this.dragPan=new OpenLayers.Control.DragPan(OpenLayers.Util.extend({map:this.map,documentDrag:this.documentDrag},this.dragPanOptions)),this.dragPan.draw(),this.pinchZoom=new OpenLayers.Control.PinchZoom(OpenLayers.Util.extend({map:this.map},this.pinchZoomOptions))},defaultClick:function(t){t.lastTouches&&2==t.lastTouches.length&&this.map.zoomOut()},defaultDblClick:function(t){this.map.zoomTo(this.map.zoom+1,t.xy)},CLASS_NAME:"OpenLayers.Control.TouchNavigation"}),OpenLayers.Console.warn("OpenLayers.Rico is deprecated"),OpenLayers.Rico=OpenLayers.Rico||{},OpenLayers.Rico.Color=OpenLayers.Class({initialize:function(t,e,i){this.rgb={r:t,g:e,b:i}},setRed:function(t){this.rgb.r=t},setGreen:function(t){this.rgb.g=t},setBlue:function(t){this.rgb.b=t},setHue:function(t){var e=this.asHSB();e.h=t,this.rgb=OpenLayers.Rico.Color.HSBtoRGB(e.h,e.s,e.b)},setSaturation:function(t){var e=this.asHSB();e.s=t,this.rgb=OpenLayers.Rico.Color.HSBtoRGB(e.h,e.s,e.b)},setBrightness:function(t){var e=this.asHSB();e.b=t,this.rgb=OpenLayers.Rico.Color.HSBtoRGB(e.h,e.s,e.b)},darken:function(t){var e=this.asHSB();this.rgb=OpenLayers.Rico.Color.HSBtoRGB(e.h,e.s,Math.max(e.b-t,0))},brighten:function(t){var e=this.asHSB();this.rgb=OpenLayers.Rico.Color.HSBtoRGB(e.h,e.s,Math.min(e.b+t,1))},blend:function(t){this.rgb.r=Math.floor((this.rgb.r+t.rgb.r)/2),this.rgb.g=Math.floor((this.rgb.g+t.rgb.g)/2),this.rgb.b=Math.floor((this.rgb.b+t.rgb.b)/2)},isBright:function(){this.asHSB();return this.asHSB().b>.5},isDark:function(){return!this.isBright()},asRGB:function(){return"rgb("+this.rgb.r+","+this.rgb.g+","+this.rgb.b+")"},asHex:function(){return"#"+this.rgb.r.toColorPart()+this.rgb.g.toColorPart()+this.rgb.b.toColorPart()},asHSB:function(){return OpenLayers.Rico.Color.RGBtoHSB(this.rgb.r,this.rgb.g,this.rgb.b)},toString:function(){return this.asHex()}}),OpenLayers.Rico.Color.createFromHex=function(t){if(4==t.length)for(var e=t,t="#",i=1;4>i;i++)t+=e.charAt(i)+e.charAt(i);0==t.indexOf("#")&&(t=t.substring(1));var n=t.substring(0,2),s=t.substring(2,4),r=t.substring(4,6);return new OpenLayers.Rico.Color(parseInt(n,16),parseInt(s,16),parseInt(r,16))},OpenLayers.Rico.Color.createColorFromBackground=function(t){var e=OpenLayers.Element.getStyle(OpenLayers.Util.getElement(t),"backgroundColor");if("transparent"==e&&t.parentNode)return OpenLayers.Rico.Color.createColorFromBackground(t.parentNode);if(null==e)return new OpenLayers.Rico.Color(255,255,255);if(0==e.indexOf("rgb(")){var i=e.substring(4,e.length-1),n=i.split(",");return new OpenLayers.Rico.Color(parseInt(n[0]),parseInt(n[1]),parseInt(n[2]))}return 0==e.indexOf("#")?OpenLayers.Rico.Color.createFromHex(e):new OpenLayers.Rico.Color(255,255,255)},OpenLayers.Rico.Color.HSBtoRGB=function(t,e,i){var n=0,s=0,r=0;if(0==e)n=parseInt(255*i+.5),s=n,r=n;else{var o=6*(t-Math.floor(t)),a=o-Math.floor(o),l=i*(1-e),h=i*(1-e*a),u=i*(1-e*(1-a));switch(parseInt(o)){case 0:n=255*i+.5,s=255*u+.5,r=255*l+.5;break;case 1:n=255*h+.5,s=255*i+.5,r=255*l+.5;break;case 2:n=255*l+.5,s=255*i+.5,r=255*u+.5;break;case 3:n=255*l+.5,s=255*h+.5,r=255*i+.5;break;case 4:n=255*u+.5,s=255*l+.5,r=255*i+.5;break;case 5:n=255*i+.5,s=255*l+.5,r=255*h+.5}}return{r:parseInt(n),g:parseInt(s),b:parseInt(r)}},OpenLayers.Rico.Color.RGBtoHSB=function(t,e,i){var n,s,r,o=t>e?t:e;i>o&&(o=i);var a=e>t?t:e;if(a>i&&(a=i),r=o/255,s=0!=o?(o-a)/o:0,0==s)n=0;else{var l=(o-t)/(o-a),h=(o-e)/(o-a),u=(o-i)/(o-a);n=t==o?u-h:e==o?2+l-u:4+h-l,n/=6,0>n&&(n+=1)}return{h:n,s:s,b:r}},OpenLayers.Style2=OpenLayers.Class({id:null,name:null,title:null,description:null,layerName:null,isDefault:!1,rules:null,initialize:function(t){OpenLayers.Util.extend(this,t),this.id=OpenLayers.Util.createUniqueID(this.CLASS_NAME+"_")},destroy:function(){for(var t=0,e=this.rules.length;e>t;t++)this.rules[t].destroy();delete this.rules},clone:function(){var t=OpenLayers.Util.extend({},this);if(this.rules){t.rules=[];for(var e=0,i=this.rules.length;i>e;++e)t.rules.push(this.rules[e].clone())}return new OpenLayers.Style2(t)},CLASS_NAME:"OpenLayers.Style2"}),OpenLayers.Layer.Boxes=OpenLayers.Class(OpenLayers.Layer.Markers,{drawMarker:function(t){var e=this.map.getLayerPxFromLonLat({lon:t.bounds.left,lat:t.bounds.top}),i=this.map.getLayerPxFromLonLat({lon:t.bounds.right,lat:t.bounds.bottom});if(null==i||null==e)t.display(!1);else{var n=t.draw(e,{w:Math.max(1,i.x-e.x),h:Math.max(1,i.y-e.y)});t.drawn||(this.div.appendChild(n),t.drawn=!0)}},removeMarker:function(t){OpenLayers.Util.removeItem(this.markers,t),null!=t.div&&t.div.parentNode==this.div&&this.div.removeChild(t.div)},CLASS_NAME:"OpenLayers.Layer.Boxes"}),OpenLayers.Format.WFSCapabilities.v1_0_0=OpenLayers.Class(OpenLayers.Format.WFSCapabilities.v1,{readers:{wfs:OpenLayers.Util.applyDefaults({Service:function(t,e){e.service={},this.readChildNodes(t,e.service)},Fees:function(t,e){var i=this.getChildValue(t);i&&"none"!=i.toLowerCase()&&(e.fees=i)},AccessConstraints:function(t,e){var i=this.getChildValue(t);i&&"none"!=i.toLowerCase()&&(e.accessConstraints=i)},OnlineResource:function(t,e){var i=this.getChildValue(t);i&&"none"!=i.toLowerCase()&&(e.onlineResource=i)},Keywords:function(t,e){var i=this.getChildValue(t);i&&"none"!=i.toLowerCase()&&(e.keywords=i.split(", "))},Capability:function(t,e){e.capability={},this.readChildNodes(t,e.capability)},Request:function(t,e){e.request={},this.readChildNodes(t,e.request)},GetFeature:function(t,e){e.getfeature={href:{},formats:[]},this.readChildNodes(t,e.getfeature)},ResultFormat:function(t,e){for(var i,n=t.childNodes,s=0;s<n.length;s++)i=n[s],1==i.nodeType&&e.formats.push(i.nodeName)},DCPType:function(t,e){this.readChildNodes(t,e)},HTTP:function(t,e){this.readChildNodes(t,e.href)},Get:function(t,e){e.get=t.getAttribute("onlineResource")},Post:function(t,e){e.post=t.getAttribute("onlineResource")},SRS:function(t,e){var i=this.getChildValue(t);i&&(e.srs=i)}},OpenLayers.Format.WFSCapabilities.v1.prototype.readers.wfs)},CLASS_NAME:"OpenLayers.Format.WFSCapabilities.v1_0_0"}),OpenLayers.Layer.PointGrid=OpenLayers.Class(OpenLayers.Layer.Vector,{dx:null,dy:null,ratio:1.5,maxFeatures:250,rotation:0,origin:null,gridBounds:null,initialize:function(t){t=t||{},OpenLayers.Layer.Vector.prototype.initialize.apply(this,[t.name,t])},setMap:function(t){OpenLayers.Layer.Vector.prototype.setMap.apply(this,arguments),t.events.register("moveend",this,this.onMoveEnd)},removeMap:function(t){t.events.unregister("moveend",this,this.onMoveEnd),OpenLayers.Layer.Vector.prototype.removeMap.apply(this,arguments)},setRatio:function(t){this.ratio=t,this.updateGrid(!0)},setMaxFeatures:function(t){this.maxFeatures=t,this.updateGrid(!0)},setSpacing:function(t,e){this.dx=t,this.dy=e||t,this.updateGrid(!0)},setOrigin:function(t){this.origin=t,this.updateGrid(!0)},getOrigin:function(){return this.origin||(this.origin=this.map.getExtent().getCenterLonLat()),this.origin},setRotation:function(t){this.rotation=t,this.updateGrid(!0)},onMoveEnd:function(){this.updateGrid()},getViewBounds:function(){var t=this.map.getExtent();if(this.rotation){var e=this.getOrigin(),i=new OpenLayers.Geometry.Point(e.lon,e.lat),n=t.toGeometry();n.rotate(-this.rotation,i),t=n.getBounds()}return t},updateGrid:function(t){if(t||this.invalidBounds()){var e=this.getViewBounds(),i=this.getOrigin(),n=new OpenLayers.Geometry.Point(i.lon,i.lat),s=e.getWidth(),r=e.getHeight(),o=s/r,a=Math.sqrt(this.dx*this.dy*this.maxFeatures/o),l=a*o,h=Math.min(s*this.ratio,l),u=Math.min(r*this.ratio,a),p=e.getCenterLonLat();this.gridBounds=new OpenLayers.Bounds(p.lon-h/2,p.lat-u/2,p.lon+h/2,p.lat+u/2);for(var c,d,m,f=Math.floor(u/this.dy),y=Math.floor(h/this.dx),g=i.lon+this.dx*Math.ceil((this.gridBounds.left-i.lon)/this.dx),v=i.lat+this.dy*Math.ceil((this.gridBounds.bottom-i.lat)/this.dy),L=new Array(f*y),_=0;y>_;++_){c=g+_*this.dx;for(var O=0;f>O;++O)d=v+O*this.dy,m=new OpenLayers.Geometry.Point(c,d),this.rotation&&m.rotate(this.rotation,n),L[_*f+O]=new OpenLayers.Feature.Vector(m)}this.destroyFeatures(this.features,{silent:!0}),this.addFeatures(L,{silent:!0})}},invalidBounds:function(){return!this.gridBounds||!this.gridBounds.containsBounds(this.getViewBounds())},CLASS_NAME:"OpenLayers.Layer.PointGrid"}),OpenLayers.Layer.Zoomify=OpenLayers.Class(OpenLayers.Layer.Grid,{size:null,isBaseLayer:!0,standardTileSize:256,tileOriginCorner:"tl",numberOfTiers:0,tileCountUpToTier:null,tierSizeInTiles:null,tierImageSize:null,initialize:function(t,e,i,n){this.initializeZoomify(i),OpenLayers.Layer.Grid.prototype.initialize.apply(this,[t,e,i,{},n])},initializeZoomify:function(t){var e=t.clone();this.size=t.clone();var i=new OpenLayers.Size(Math.ceil(e.w/this.standardTileSize),Math.ceil(e.h/this.standardTileSize));for(this.tierSizeInTiles=[i],this.tierImageSize=[e];e.w>this.standardTileSize||e.h>this.standardTileSize;)e=new OpenLayers.Size(Math.floor(e.w/2),Math.floor(e.h/2)),i=new OpenLayers.Size(Math.ceil(e.w/this.standardTileSize),Math.ceil(e.h/this.standardTileSize)),this.tierSizeInTiles.push(i),this.tierImageSize.push(e);this.tierSizeInTiles.reverse(),this.tierImageSize.reverse(),this.numberOfTiers=this.tierSizeInTiles.length;var n=[1];this.tileCountUpToTier=[0];for(var s=1;s<this.numberOfTiers;s++)n.unshift(Math.pow(2,s)),this.tileCountUpToTier.push(this.tierSizeInTiles[s-1].w*this.tierSizeInTiles[s-1].h+this.tileCountUpToTier[s-1]);this.serverResolutions||(this.serverResolutions=n)},destroy:function(){OpenLayers.Layer.Grid.prototype.destroy.apply(this,arguments),this.tileCountUpToTier.length=0,this.tierSizeInTiles.length=0,this.tierImageSize.length=0},clone:function(t){return null==t&&(t=new OpenLayers.Layer.Zoomify(this.name,this.url,this.size,this.options)),t=OpenLayers.Layer.Grid.prototype.clone.apply(this,[t])},getURL:function(t){t=this.adjustBounds(t);var e=this.getServerResolution(),i=Math.round((t.left-this.tileOrigin.lon)/(e*this.tileSize.w)),n=Math.round((this.tileOrigin.lat-t.top)/(e*this.tileSize.h)),s=this.getZoomForResolution(e),r=i+n*this.tierSizeInTiles[s].w+this.tileCountUpToTier[s],o="TileGroup"+Math.floor(r/256)+"/"+s+"-"+i+"-"+n+".jpg",a=this.url;return OpenLayers.Util.isArray(a)&&(a=this.selectUrl(o,a)),a+o},getImageSize:function(){if(arguments.length>0){var t=this.adjustBounds(arguments[0]),e=this.getServerResolution(),i=Math.round((t.left-this.tileOrigin.lon)/(e*this.tileSize.w)),n=Math.round((this.tileOrigin.lat-t.top)/(e*this.tileSize.h)),s=this.getZoomForResolution(e),r=this.standardTileSize,o=this.standardTileSize;if(i==this.tierSizeInTiles[s].w-1)var r=this.tierImageSize[s].w%this.standardTileSize;if(n==this.tierSizeInTiles[s].h-1)var o=this.tierImageSize[s].h%this.standardTileSize;return new OpenLayers.Size(r,o)}return this.tileSize},setMap:function(){OpenLayers.Layer.Grid.prototype.setMap.apply(this,arguments),this.tileOrigin=new OpenLayers.LonLat(this.map.maxExtent.left,this.map.maxExtent.top)},CLASS_NAME:"OpenLayers.Layer.Zoomify"}),OpenLayers.Handler.RegularPolygon=OpenLayers.Class(OpenLayers.Handler.Drag,{sides:4,radius:null,snapAngle:null,snapToggle:"shiftKey",layerOptions:null,persist:!1,irregular:!1,citeCompliant:!1,angle:null,fixedRadius:!1,feature:null,layer:null,origin:null,initialize:function(t,e,i){i&&i.layerOptions&&i.layerOptions.styleMap||(this.style=OpenLayers.Util.extend(OpenLayers.Feature.Vector.style["default"],{})),OpenLayers.Handler.Drag.prototype.initialize.apply(this,[t,e,i]),this.options=i?i:{}},setOptions:function(t){OpenLayers.Util.extend(this.options,t),OpenLayers.Util.extend(this,t)},activate:function(){var t=!1;if(OpenLayers.Handler.Drag.prototype.activate.apply(this,arguments)){var e=OpenLayers.Util.extend({displayInLayerSwitcher:!1,calculateInRange:OpenLayers.Function.True,wrapDateLine:this.citeCompliant},this.layerOptions);this.layer=new OpenLayers.Layer.Vector(this.CLASS_NAME,e),this.map.addLayer(this.layer),t=!0}return t},deactivate:function(){var t=!1;return OpenLayers.Handler.Drag.prototype.deactivate.apply(this,arguments)&&(this.dragging&&this.cancel(),null!=this.layer.map&&(this.layer.destroy(!1),this.feature&&this.feature.destroy()),this.layer=null,this.feature=null,t=!0),t},down:function(t){this.fixedRadius=!!this.radius;var e=this.layer.getLonLatFromViewPortPx(t.xy);this.origin=new OpenLayers.Geometry.Point(e.lon,e.lat),(!this.fixedRadius||this.irregular)&&(this.radius=this.map.getResolution()),this.persist&&this.clear(),this.feature=new OpenLayers.Feature.Vector,this.createGeometry(),this.callback("create",[this.origin,this.feature]),this.layer.addFeatures([this.feature],{silent:!0}),this.layer.drawFeature(this.feature,this.style)},move:function(t){var e=this.layer.getLonLatFromViewPortPx(t.xy),i=new OpenLayers.Geometry.Point(e.lon,e.lat);if(this.irregular){var n=Math.sqrt(2)*Math.abs(i.y-this.origin.y)/2;this.radius=Math.max(this.map.getResolution()/2,n)}else this.fixedRadius?this.origin=i:(this.calculateAngle(i,t),this.radius=Math.max(this.map.getResolution()/2,i.distanceTo(this.origin)));if(this.modifyGeometry(),this.irregular){var s,r=i.x-this.origin.x,o=i.y-this.origin.y;s=0==o?r/(this.radius*Math.sqrt(2)):r/o,this.feature.geometry.resize(1,this.origin,s),this.feature.geometry.move(r/2,o/2)}this.layer.drawFeature(this.feature,this.style)},up:function(t){this.finalize(),this.start==this.last&&this.callback("done",[t.xy])},out:function(){this.finalize()},createGeometry:function(){this.angle=Math.PI*(1/this.sides-.5),this.snapAngle&&(this.angle+=this.snapAngle*(Math.PI/180)),this.feature.geometry=OpenLayers.Geometry.Polygon.createRegularPolygon(this.origin,this.radius,this.sides,this.snapAngle)},modifyGeometry:function(){var t,e,i=this.feature.geometry.components[0];i.components.length!=this.sides+1&&(this.createGeometry(),i=this.feature.geometry.components[0]);for(var n=0;n<this.sides;++n)e=i.components[n],t=this.angle+2*n*Math.PI/this.sides,e.x=this.origin.x+this.radius*Math.cos(t),e.y=this.origin.y+this.radius*Math.sin(t),e.clearBounds()},calculateAngle:function(t,e){var i=Math.atan2(t.y-this.origin.y,t.x-this.origin.x);if(this.snapAngle&&this.snapToggle&&!e[this.snapToggle]){var n=Math.PI/180*this.snapAngle;this.angle=Math.round(i/n)*n}else this.angle=i},cancel:function(){this.callback("cancel",null),this.finalize()},finalize:function(){this.origin=null,this.radius=this.options.radius},clear:function(){this.layer&&(this.layer.renderer.clear(),this.layer.destroyFeatures())},callback:function(t){this.callbacks[t]&&this.callbacks[t].apply(this.control,[this.feature.geometry.clone()]),this.persist||"done"!=t&&"cancel"!=t||this.clear()},CLASS_NAME:"OpenLayers.Handler.RegularPolygon"}),OpenLayers.Layer.MapServer=OpenLayers.Class(OpenLayers.Layer.Grid,{DEFAULT_PARAMS:{mode:"map",map_imagetype:"png"},initialize:function(t,e,i,n){OpenLayers.Layer.Grid.prototype.initialize.apply(this,arguments),this.params=OpenLayers.Util.applyDefaults(this.params,this.DEFAULT_PARAMS),(null==n||null==n.isBaseLayer)&&(this.isBaseLayer="true"!=this.params.transparent&&1!=this.params.transparent)},clone:function(t){return null==t&&(t=new OpenLayers.Layer.MapServer(this.name,this.url,this.params,this.getOptions())),t=OpenLayers.Layer.Grid.prototype.clone.apply(this,[t])},getURL:function(t){t=this.adjustBounds(t);var e=[t.left,t.bottom,t.right,t.top],i=this.getImageSize(),n=this.getFullRequestString({mapext:e,imgext:e,map_size:[i.w,i.h],imgx:i.w/2,imgy:i.h/2,imgxy:[i.w,i.h]});return n},getFullRequestString:function(t,e){var i=null==e?this.url:e,n=OpenLayers.Util.extend({},this.params);n=OpenLayers.Util.extend(n,t);var s=OpenLayers.Util.getParameterString(n);OpenLayers.Util.isArray(i)&&(i=this.selectUrl(s,i));var r=OpenLayers.Util.upperCaseObject(OpenLayers.Util.getParameters(i));for(var o in n)o.toUpperCase()in r&&delete n[o];s=OpenLayers.Util.getParameterString(n);var a=i;if(s=s.replace(/,/g,"+"),""!=s){var l=i.charAt(i.length-1);a+="&"==l||"?"==l?s:-1==i.indexOf("?")?"?"+s:"&"+s}return a},CLASS_NAME:"OpenLayers.Layer.MapServer"}),OpenLayers.Renderer.VML=OpenLayers.Class(OpenLayers.Renderer.Elements,{xmlns:"urn:schemas-microsoft-com:vml",symbolCache:{},offset:null,initialize:function(){if(this.supported()){if(!document.namespaces.olv){document.namespaces.add("olv",this.xmlns);for(var t=document.createStyleSheet(),e=["shape","rect","oval","fill","stroke","imagedata","group","textbox"],i=0,n=e.length;n>i;i++)t.addRule("olv\\:"+e[i],"behavior: url(#default#VML); position: absolute; display: inline-block;")}OpenLayers.Renderer.Elements.prototype.initialize.apply(this,arguments)}},supported:function(){return!!document.namespaces},setExtent:function(t,e){var i=OpenLayers.Renderer.Elements.prototype.setExtent.apply(this,arguments),n=this.getResolution(),s=t.left/n|0,r=t.top/n-this.size.h|0;e||!this.offset?(this.offset={x:s,y:r},s=0,r=0):(s-=this.offset.x,r-=this.offset.y);var o=s-this.xOffset+" "+r;this.root.coordorigin=o;for(var a,l=[this.root,this.vectorRoot,this.textRoot],h=0,u=l.length;u>h;++h){a=l[h];var p=this.size.w+" "+this.size.h;a.coordsize=p}return this.root.style.flip="y",i},setSize:function(){OpenLayers.Renderer.prototype.setSize.apply(this,arguments);for(var t,e=[this.rendererRoot,this.root,this.vectorRoot,this.textRoot],i=this.size.w+"px",n=this.size.h+"px",s=0,r=e.length;r>s;++s)t=e[s],t.style.width=i,t.style.height=n
},getNodeType:function(t,e){var i=null;switch(t.CLASS_NAME){case"OpenLayers.Geometry.Point":i=e.externalGraphic?"olv:rect":this.isComplexSymbol(e.graphicName)?"olv:shape":"olv:oval";break;case"OpenLayers.Geometry.Rectangle":i="olv:rect";break;case"OpenLayers.Geometry.LineString":case"OpenLayers.Geometry.LinearRing":case"OpenLayers.Geometry.Polygon":case"OpenLayers.Geometry.Curve":i="olv:shape"}return i},setStyle:function(t,e,i,n){e=e||t._style,i=i||t._options;var s=e.fillColor,r=e.title||e.graphicTitle;if(r&&(t.title=r),"OpenLayers.Geometry.Point"===t._geometryClass)if(e.externalGraphic){i.isFilled=!0;var o=e.graphicWidth||e.graphicHeight,a=e.graphicHeight||e.graphicWidth;o=o?o:2*e.pointRadius,a=a?a:2*e.pointRadius;var l=this.getResolution(),h=void 0!=e.graphicXOffset?e.graphicXOffset:-(.5*o),u=void 0!=e.graphicYOffset?e.graphicYOffset:-(.5*a);t.style.left=((n.x-this.featureDx)/l-this.offset.x+h|0)+"px",t.style.top=(n.y/l-this.offset.y-(u+a)|0)+"px",t.style.width=o+"px",t.style.height=a+"px",t.style.flip="y",s="none",i.isStroked=!1}else if(this.isComplexSymbol(e.graphicName)){var p=this.importSymbol(e.graphicName);t.path=p.path,t.coordorigin=p.left+","+p.bottom;var c=p.size;t.coordsize=c+","+c,this.drawCircle(t,n,e.pointRadius),t.style.flip="y"}else this.drawCircle(t,n,e.pointRadius);i.isFilled?t.fillcolor=s:t.filled="false";var d=t.getElementsByTagName("fill"),m=0==d.length?null:d[0];i.isFilled?(m||(m=this.createNode("olv:fill",t.id+"_fill")),m.opacity=e.fillOpacity,"OpenLayers.Geometry.Point"===t._geometryClass&&e.externalGraphic&&(e.graphicOpacity&&(m.opacity=e.graphicOpacity),m.src=e.externalGraphic,m.type="frame",e.graphicWidth&&e.graphicHeight||(m.aspect="atmost")),m.parentNode!=t&&t.appendChild(m)):m&&t.removeChild(m);var f=e.rotation;(void 0!==f||void 0!==t._rotation)&&(t._rotation=f,e.externalGraphic?(this.graphicRotate(t,h,u,e),m.opacity=0):"OpenLayers.Geometry.Point"===t._geometryClass&&(t.style.rotation=f||0));var y=t.getElementsByTagName("stroke"),g=0==y.length?null:y[0];return i.isStroked?(g||(g=this.createNode("olv:stroke",t.id+"_stroke"),t.appendChild(g)),g.on=!0,g.color=e.strokeColor,g.weight=e.strokeWidth+"px",g.opacity=e.strokeOpacity,g.endcap="butt"==e.strokeLinecap?"flat":e.strokeLinecap||"round",e.strokeDashstyle&&(g.dashstyle=this.dashStyle(e))):(t.stroked=!1,g&&(g.on=!1)),"inherit"!=e.cursor&&null!=e.cursor&&(t.style.cursor=e.cursor),t},graphicRotate:function(t,e,i,n){var s,r,n=n||t._style,o=n.rotation||0;if(!n.graphicWidth||!n.graphicHeight){var a=new Image;return a.onreadystatechange=OpenLayers.Function.bind(function(){("complete"==a.readyState||"interactive"==a.readyState)&&(s=a.width/a.height,r=Math.max(2*n.pointRadius,n.graphicWidth||0,n.graphicHeight||0),e*=s,n.graphicWidth=r*s,n.graphicHeight=r,this.graphicRotate(t,e,i,n))},this),void(a.src=n.externalGraphic)}r=Math.max(n.graphicWidth,n.graphicHeight),s=n.graphicWidth/n.graphicHeight;var l=Math.round(n.graphicWidth||r*s),h=Math.round(n.graphicHeight||r);t.style.width=l+"px",t.style.height=h+"px";var u=document.getElementById(t.id+"_image");u||(u=this.createNode("olv:imagedata",t.id+"_image"),t.appendChild(u)),u.style.width=l+"px",u.style.height=h+"px",u.src=n.externalGraphic,u.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='', sizingMethod='scale')";var p=o*Math.PI/180,c=Math.sin(p),d=Math.cos(p),m="progid:DXImageTransform.Microsoft.Matrix(M11="+d+",M12="+-c+",M21="+c+",M22="+d+",SizingMethod='auto expand')\n",f=n.graphicOpacity||n.fillOpacity;f&&1!=f&&(m+="progid:DXImageTransform.Microsoft.BasicImage(opacity="+f+")\n"),t.style.filter=m;var y=new OpenLayers.Geometry.Point(-e,-i),g=new OpenLayers.Bounds(0,0,l,h).toGeometry();g.rotate(n.rotation,y);var v=g.getBounds();t.style.left=Math.round(parseInt(t.style.left)+v.left)+"px",t.style.top=Math.round(parseInt(t.style.top)-v.bottom)+"px"},postDraw:function(t){t.style.visibility="visible";var e=t._style.fillColor,i=t._style.strokeColor;"none"==e&&t.fillcolor!=e&&(t.fillcolor=e),"none"==i&&t.strokecolor!=i&&(t.strokecolor=i)},setNodeDimension:function(t,e){var i=e.getBounds();if(i){var n=this.getResolution(),s=new OpenLayers.Bounds((i.left-this.featureDx)/n-this.offset.x|0,i.bottom/n-this.offset.y|0,(i.right-this.featureDx)/n-this.offset.x|0,i.top/n-this.offset.y|0);t.style.left=s.left+"px",t.style.top=s.top+"px",t.style.width=s.getWidth()+"px",t.style.height=s.getHeight()+"px",t.coordorigin=s.left+" "+s.top,t.coordsize=s.getWidth()+" "+s.getHeight()}},dashStyle:function(t){var e=t.strokeDashstyle;switch(e){case"solid":case"dot":case"dash":case"dashdot":case"longdash":case"longdashdot":return e;default:var i=e.split(/[ ,]/);return 2==i.length?1*i[0]>=2*i[1]?"longdash":1==i[0]||1==i[1]?"dot":"dash":4==i.length?1*i[0]>=2*i[1]?"longdashdot":"dashdot":"solid"}},createNode:function(t,e){var i=document.createElement(t);return e&&(i.id=e),i.unselectable="on",i.onselectstart=OpenLayers.Function.False,i},nodeTypeCompare:function(t,e){var i=e,n=i.indexOf(":");-1!=n&&(i=i.substr(n+1));var s=t.nodeName;return n=s.indexOf(":"),-1!=n&&(s=s.substr(n+1)),i==s},createRenderRoot:function(){return this.nodeFactory(this.container.id+"_vmlRoot","div")},createRoot:function(t){return this.nodeFactory(this.container.id+t,"olv:group")},drawPoint:function(t,e){return this.drawCircle(t,e,1)},drawCircle:function(t,e,i){if(!isNaN(e.x)&&!isNaN(e.y)){var n=this.getResolution();t.style.left=((e.x-this.featureDx)/n-this.offset.x|0)-i+"px",t.style.top=(e.y/n-this.offset.y|0)-i+"px";var s=2*i;return t.style.width=s+"px",t.style.height=s+"px",t}return!1},drawLineString:function(t,e){return this.drawLine(t,e,!1)},drawLinearRing:function(t,e){return this.drawLine(t,e,!0)},drawLine:function(t,e,i){this.setNodeDimension(t,e);for(var n,s,r,o=this.getResolution(),a=e.components.length,l=new Array(a),h=0;a>h;h++)n=e.components[h],s=(n.x-this.featureDx)/o-this.offset.x|0,r=n.y/o-this.offset.y|0,l[h]=" "+s+","+r+" l ";var u=i?" x e":" e";return t.path="m"+l.join("")+u,t},drawPolygon:function(t,e){this.setNodeDimension(t,e);var i,n,s,r,o,a,l,h,u,p,c,d,m=this.getResolution(),f=[];for(i=0,n=e.components.length;n>i;i++){for(f.push("m"),s=e.components[i].components,r=0===i,o=null,a=null,l=0,h=s.length;h>l;l++)u=s[l],c=(u.x-this.featureDx)/m-this.offset.x|0,d=u.y/m-this.offset.y|0,p=" "+c+","+d,f.push(p),0==l&&f.push(" l"),r||(o?o!=p&&(a?a!=p&&(r=!0):a=p):o=p);f.push(r?" x ":" ")}return f.push("e"),t.path=f.join(""),t},drawRectangle:function(t,e){var i=this.getResolution();return t.style.left=((e.x-this.featureDx)/i-this.offset.x|0)+"px",t.style.top=(e.y/i-this.offset.y|0)+"px",t.style.width=(e.width/i|0)+"px",t.style.height=(e.height/i|0)+"px",t},drawText:function(t,e,i){var n=this.nodeFactory(t+this.LABEL_ID_SUFFIX,"olv:rect"),s=this.nodeFactory(t+this.LABEL_ID_SUFFIX+"_textbox","olv:textbox"),r=this.getResolution();n.style.left=((i.x-this.featureDx)/r-this.offset.x|0)+"px",n.style.top=(i.y/r-this.offset.y|0)+"px",n.style.flip="y",s.innerText=e.label,"inherit"!=e.cursor&&null!=e.cursor&&(s.style.cursor=e.cursor),e.fontColor&&(s.style.color=e.fontColor),e.fontOpacity&&(s.style.filter="alpha(opacity="+100*e.fontOpacity+")"),e.fontFamily&&(s.style.fontFamily=e.fontFamily),e.fontSize&&(s.style.fontSize=e.fontSize),e.fontWeight&&(s.style.fontWeight=e.fontWeight),e.fontStyle&&(s.style.fontStyle=e.fontStyle),e.labelSelect===!0&&(n._featureId=t,s._featureId=t,s._geometry=i,s._geometryClass=i.CLASS_NAME),s.style.whiteSpace="nowrap",s.inset="1px,0px,0px,0px",n.parentNode||(n.appendChild(s),this.textRoot.appendChild(n));var o=e.labelAlign||"cm";1==o.length&&(o+="m");var a=s.clientWidth*OpenLayers.Renderer.VML.LABEL_SHIFT[o.substr(0,1)],l=s.clientHeight*OpenLayers.Renderer.VML.LABEL_SHIFT[o.substr(1,1)];n.style.left=parseInt(n.style.left)-a-1+"px",n.style.top=parseInt(n.style.top)+l+"px"},moveRoot:function(t){var e=this.map.getLayer(t.container.id);e instanceof OpenLayers.Layer.Vector.RootContainer&&(e=this.map.getLayer(this.container.id)),e&&e.renderer.clear(),OpenLayers.Renderer.Elements.prototype.moveRoot.apply(this,arguments),e&&e.redraw()},importSymbol:function(t){var e=this.container.id+"-"+t,i=this.symbolCache[e];if(i)return i;var n=OpenLayers.Renderer.symbol[t];if(!n)throw new Error(t+" is not a valid symbol name");for(var s=new OpenLayers.Bounds(Number.MAX_VALUE,Number.MAX_VALUE,0,0),r=["m"],o=0;o<n.length;o+=2){var a=n[o],l=n[o+1];s.left=Math.min(s.left,a),s.bottom=Math.min(s.bottom,l),s.right=Math.max(s.right,a),s.top=Math.max(s.top,l),r.push(a),r.push(l),0==o&&r.push("l")}r.push("x e");var h=r.join(" "),u=(s.getWidth()-s.getHeight())/2;return u>0?(s.bottom=s.bottom-u,s.top=s.top+u):(s.left=s.left+u,s.right=s.right-u),i={path:h,size:s.getWidth(),left:s.left,bottom:s.bottom},this.symbolCache[e]=i,i},CLASS_NAME:"OpenLayers.Renderer.VML"}),OpenLayers.Renderer.VML.LABEL_SHIFT={l:0,c:.5,r:1,t:0,m:.5,b:1},OpenLayers.Control.CacheRead=OpenLayers.Class(OpenLayers.Control,{fetchEvent:"tileloadstart",layers:null,autoActivate:!0,setMap:function(t){OpenLayers.Control.prototype.setMap.apply(this,arguments);var e,i=this.layers||t.layers;for(e=i.length-1;e>=0;--e)this.addLayer({layer:i[e]});this.layers||t.events.on({addlayer:this.addLayer,removeLayer:this.removeLayer,scope:this})},addLayer:function(t){t.layer.events.register(this.fetchEvent,this,this.fetch)},removeLayer:function(t){t.layer.events.unregister(this.fetchEvent,this,this.fetch)},fetch:function(t){if(this.active&&window.localStorage&&t.tile instanceof OpenLayers.Tile.Image){var e=t.tile,i=e.url;!e.layer.crossOriginKeyword&&OpenLayers.ProxyHost&&0===i.indexOf(OpenLayers.ProxyHost)&&(i=OpenLayers.Control.CacheWrite.urlMap[i]);var n=window.localStorage.getItem("olCache_"+i);n&&(e.url=n,"tileerror"===t.type&&e.setImgSrc(n))}},destroy:function(){if(this.layers||this.map){var t,e=this.layers||this.map.layers;for(t=e.length-1;t>=0;--t)this.removeLayer({layer:e[t]})}this.map&&this.map.events.un({addlayer:this.addLayer,removeLayer:this.removeLayer,scope:this}),OpenLayers.Control.prototype.destroy.apply(this,arguments)},CLASS_NAME:"OpenLayers.Control.CacheRead"}),OpenLayers.Protocol.WFS.v1_0_0=OpenLayers.Class(OpenLayers.Protocol.WFS.v1,{version:"1.0.0",CLASS_NAME:"OpenLayers.Protocol.WFS.v1_0_0"}),OpenLayers.Control.WMTSGetFeatureInfo=OpenLayers.Class(OpenLayers.Control,{hover:!1,requestEncoding:"KVP",drillDown:!1,maxFeatures:10,clickCallback:"click",layers:null,queryVisible:!0,infoFormat:"text/html",vendorParams:{},format:null,formatOptions:null,handler:null,hoverRequest:null,pending:0,initialize:function(t){if(t=t||{},t.handlerOptions=t.handlerOptions||{},OpenLayers.Control.prototype.initialize.apply(this,[t]),this.format||(this.format=new OpenLayers.Format.WMSGetFeatureInfo(t.formatOptions)),this.drillDown===!0&&(this.hover=!1),this.hover)this.handler=new OpenLayers.Handler.Hover(this,{move:this.cancelHover,pause:this.getInfoForHover},OpenLayers.Util.extend(this.handlerOptions.hover||{},{delay:250}));else{var e={};e[this.clickCallback]=this.getInfoForClick,this.handler=new OpenLayers.Handler.Click(this,e,this.handlerOptions.click||{})}},getInfoForClick:function(t){this.request(t.xy,{})},getInfoForHover:function(t){this.request(t.xy,{hover:!0})},cancelHover:function(){this.hoverRequest&&(--this.pending,this.pending<=0&&(OpenLayers.Element.removeClass(this.map.viewPortDiv,"olCursorWait"),this.pending=0),this.hoverRequest.abort(),this.hoverRequest=null)},findLayers:function(){for(var t,e=this.layers||this.map.layers,i=[],n=e.length-1;n>=0&&(t=e[n],!(t instanceof OpenLayers.Layer.WMTS&&t.requestEncoding===this.requestEncoding)||this.queryVisible&&!t.getVisibility()||(i.push(t),this.drillDown&&!this.hover));--n);return i},buildRequestOptions:function(t,e){var i=this.map.getLonLatFromPixel(e),n=t.getURL(new OpenLayers.Bounds(i.lon,i.lat,i.lon,i.lat)),s=OpenLayers.Util.getParameters(n),r=t.getTileInfo(i);return OpenLayers.Util.extend(s,{service:"WMTS",version:t.version,request:"GetFeatureInfo",infoFormat:this.infoFormat,i:r.i,j:r.j}),OpenLayers.Util.applyDefaults(s,this.vendorParams),{url:OpenLayers.Util.isArray(t.url)?t.url[0]:t.url,params:OpenLayers.Util.upperCaseObject(s),callback:function(i){this.handleResponse(e,i,t)},scope:this}},request:function(t,e){e=e||{};var i=this.findLayers();if(i.length>0){for(var n,s,r=0,o=i.length;o>r;r++)if(s=i[r],n=this.events.triggerEvent("beforegetfeatureinfo",{xy:t,layer:s}),n!==!1){++this.pending;var a=this.buildRequestOptions(s,t),l=OpenLayers.Request.GET(a);e.hover===!0&&(this.hoverRequest=l)}this.pending>0&&OpenLayers.Element.addClass(this.map.viewPortDiv,"olCursorWait")}},handleResponse:function(t,e,i){if(--this.pending,this.pending<=0&&(OpenLayers.Element.removeClass(this.map.viewPortDiv,"olCursorWait"),this.pending=0),e.status&&(e.status<200||e.status>=300))this.events.triggerEvent("exception",{xy:t,request:e,layer:i});else{var n=e.responseXML;n&&n.documentElement||(n=e.responseText);var s,r;try{s=this.format.read(n)}catch(o){r=!0,this.events.triggerEvent("exception",{xy:t,request:e,error:o,layer:i})}r||this.events.triggerEvent("getfeatureinfo",{text:e.responseText,features:s,request:e,xy:t,layer:i})}},CLASS_NAME:"OpenLayers.Control.WMTSGetFeatureInfo"}),OpenLayers.Protocol.CSW.v2_0_2=OpenLayers.Class(OpenLayers.Protocol,{formatOptions:null,initialize:function(t){OpenLayers.Protocol.prototype.initialize.apply(this,[t]),t.format||(this.format=new OpenLayers.Format.CSWGetRecords.v2_0_2(OpenLayers.Util.extend({},this.formatOptions)))},destroy:function(){this.options&&!this.options.format&&this.format.destroy(),this.format=null,OpenLayers.Protocol.prototype.destroy.apply(this)},read:function(t){t=OpenLayers.Util.extend({},t),OpenLayers.Util.applyDefaults(t,this.options||{});var e=new OpenLayers.Protocol.Response({requestType:"read"}),i=this.format.write(t.params||t);return e.priv=OpenLayers.Request.POST({url:t.url,callback:this.createCallback(this.handleRead,e,t),params:t.params,headers:t.headers,data:i}),e},handleRead:function(t,e){if(e.callback){var i=t.priv;i.status>=200&&i.status<300?(t.data=this.parseData(i),t.code=OpenLayers.Protocol.Response.SUCCESS):t.code=OpenLayers.Protocol.Response.FAILURE,e.callback.call(e.scope,t)}},parseData:function(t){var e=t.responseXML;return e&&e.documentElement||(e=t.responseText),!e||e.length<=0?null:this.format.read(e)},CLASS_NAME:"OpenLayers.Protocol.CSW.v2_0_2"}),OpenLayers.Control.SLDSelect=OpenLayers.Class(OpenLayers.Control,{clearOnDeactivate:!1,layers:null,callbacks:null,selectionSymbolizer:{Polygon:{fillColor:"#FF0000",stroke:!1},Line:{strokeColor:"#FF0000",strokeWidth:2},Point:{graphicName:"square",fillColor:"#FF0000",pointRadius:5}},layerOptions:null,sketchStyle:null,wfsCache:{},layerCache:{},initialize:function(t,e){OpenLayers.Control.prototype.initialize.apply(this,[e]),this.callbacks=OpenLayers.Util.extend({done:this.select,click:this.select},this.callbacks),this.handlerOptions=this.handlerOptions||{},this.layerOptions=OpenLayers.Util.applyDefaults(this.layerOptions,{displayInLayerSwitcher:!1,tileOptions:{maxGetUrlLength:2048}}),this.sketchStyle&&(this.handlerOptions.layerOptions=OpenLayers.Util.applyDefaults(this.handlerOptions.layerOptions,{styleMap:new OpenLayers.StyleMap({"default":this.sketchStyle})})),this.handler=new t(this,this.callbacks,this.handlerOptions)},destroy:function(){for(var t in this.layerCache)delete this.layerCache[t];for(var t in this.wfsCache)delete this.wfsCache[t];OpenLayers.Control.prototype.destroy.apply(this,arguments)},coupleLayerVisiblity:function(t){this.setVisibility(t.object.getVisibility())},createSelectionLayer:function(t){var e;return this.layerCache[t.id]?e=this.layerCache[t.id]:(e=new OpenLayers.Layer.WMS(t.name,t.url,t.params,OpenLayers.Util.applyDefaults(this.layerOptions,t.getOptions())),this.layerCache[t.id]=e,this.layerOptions.displayInLayerSwitcher===!1&&t.events.on({visibilitychanged:this.coupleLayerVisiblity,scope:e}),this.map.addLayer(e)),e},createSLD:function(t,e,i){for(var n={version:"1.0.0",namedLayers:{}},s=[t.params.LAYERS].join(",").split(","),r=0,o=s.length;o>r;r++){var a=s[r];n.namedLayers[a]={name:a,userStyles:[]};var l=this.selectionSymbolizer,h=i[r];h.type.indexOf("Polygon")>=0?l={Polygon:this.selectionSymbolizer.Polygon}:h.type.indexOf("LineString")>=0?l={Line:this.selectionSymbolizer.Line}:h.type.indexOf("Point")>=0&&(l={Point:this.selectionSymbolizer.Point});var u=e[r];n.namedLayers[a].userStyles.push({name:"default",rules:[new OpenLayers.Rule({symbolizer:l,filter:u,maxScaleDenominator:t.options.minScale})]})}return new OpenLayers.Format.SLD({srsName:this.map.getProjection()}).write(n)},parseDescribeLayer:function(t){var e=new OpenLayers.Format.WMSDescribeLayer,i=t.responseXML;i&&i.documentElement||(i=t.responseText);for(var n=e.read(i),s=[],r=null,o=0,a=n.length;a>o;o++)"WFS"==n[o].owsType&&(s.push(n[o].typeName),r=n[o].owsURL);var l={url:r,params:{SERVICE:"WFS",TYPENAME:s.toString(),REQUEST:"DescribeFeatureType",VERSION:"1.0.0"},callback:function(t){var e=new OpenLayers.Format.WFSDescribeFeatureType,i=t.responseXML;i&&i.documentElement||(i=t.responseText);var n=e.read(i);this.control.wfsCache[this.layer.id]=n,this.control._queue&&this.control.applySelection()},scope:this};OpenLayers.Request.GET(l)},getGeometryAttributes:function(t){for(var e=[],i=this.wfsCache[t.id],n=0,s=i.featureTypes.length;s>n;n++)for(var r=i.featureTypes[n],o=r.properties,a=0,l=o.length;l>a;a++){var h=o[a],u=h.type;(u.indexOf("LineString")>=0||u.indexOf("GeometryAssociationType")>=0||u.indexOf("GeometryPropertyType")>=0||u.indexOf("Point")>=0||u.indexOf("Polygon")>=0)&&e.push(h)}return e},activate:function(){var t=OpenLayers.Control.prototype.activate.call(this);if(t)for(var e=0,i=this.layers.length;i>e;e++){var n=this.layers[e];if(n&&!this.wfsCache[n.id]){var s={url:n.url,params:{SERVICE:"WMS",VERSION:n.params.VERSION,LAYERS:n.params.LAYERS,REQUEST:"DescribeLayer"},callback:this.parseDescribeLayer,scope:{layer:n,control:this}};OpenLayers.Request.GET(s)}}return t},deactivate:function(){var t=OpenLayers.Control.prototype.deactivate.call(this);if(t)for(var e=0,i=this.layers.length;i>e;e++){var n=this.layers[e];if(n&&this.clearOnDeactivate===!0){var s=this.layerCache,r=s[n.id];r&&(n.events.un({visibilitychanged:this.coupleLayerVisiblity,scope:r}),r.destroy(),delete s[n.id])}}return t},setLayers:function(t){this.active?(this.deactivate(),this.layers=t,this.activate()):this.layers=t},createFilter:function(t,e){var i=null;return this.handler instanceof OpenLayers.Handler.RegularPolygon?i=new OpenLayers.Filter.Spatial(this.handler.irregular===!0?{type:OpenLayers.Filter.Spatial.BBOX,property:t.name,value:e.getBounds()}:{type:OpenLayers.Filter.Spatial.INTERSECTS,property:t.name,value:e}):this.handler instanceof OpenLayers.Handler.Polygon?i=new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.INTERSECTS,property:t.name,value:e}):this.handler instanceof OpenLayers.Handler.Path?i=new OpenLayers.Filter.Spatial(t.type.indexOf("Point")>=0?{type:OpenLayers.Filter.Spatial.DWITHIN,property:t.name,distance:.01*this.map.getExtent().getWidth(),distanceUnits:this.map.getUnits(),value:e}:{type:OpenLayers.Filter.Spatial.INTERSECTS,property:t.name,value:e}):this.handler instanceof OpenLayers.Handler.Click&&(i=new OpenLayers.Filter.Spatial(t.type.indexOf("Polygon")>=0?{type:OpenLayers.Filter.Spatial.INTERSECTS,property:t.name,value:e}:{type:OpenLayers.Filter.Spatial.DWITHIN,property:t.name,distance:.01*this.map.getExtent().getWidth(),distanceUnits:this.map.getUnits(),value:e})),i},select:function(t){this._queue=function(){for(var e=0,i=this.layers.length;i>e;e++){for(var n=this.layers[e],s=this.getGeometryAttributes(n),r=[],o=0,a=s.length;a>o;o++){var l=s[o];if(null!==l){if(!(t instanceof OpenLayers.Geometry)){var h=this.map.getLonLatFromPixel(t.xy);t=new OpenLayers.Geometry.Point(h.lon,h.lat)}var u=this.createFilter(l,t);null!==u&&r.push(u)}}var p=this.createSelectionLayer(n);this.events.triggerEvent("selected",{layer:n,filters:r});var c=this.createSLD(n,r,s);p.mergeNewParams({SLD_BODY:c}),delete this._queue}},this.applySelection()},applySelection:function(){for(var t=!0,e=0,i=this.layers.length;i>e;e++)if(!this.wfsCache[this.layers[e].id]){t=!1;break}t&&this._queue.call(this)},CLASS_NAME:"OpenLayers.Control.SLDSelect"}),OpenLayers.Control.Graticule=OpenLayers.Class(OpenLayers.Control,{autoActivate:!0,intervals:[45,30,20,10,5,2,1,.5,.2,.1,.05,.01,.005,.002,.001],displayInLayerSwitcher:!0,visible:!0,numPoints:50,targetSize:200,layerName:null,labelled:!0,labelFormat:"dm",lineSymbolizer:{strokeColor:"#333",strokeWidth:1,strokeOpacity:.5},labelSymbolizer:{},gratLayer:null,initialize:function(t){t=t||{},t.layerName=t.layerName||OpenLayers.i18n("Graticule"),OpenLayers.Control.prototype.initialize.apply(this,[t]),this.labelSymbolizer.stroke=!1,this.labelSymbolizer.fill=!1,this.labelSymbolizer.label="${label}",this.labelSymbolizer.labelAlign="${labelAlign}",this.labelSymbolizer.labelXOffset="${xOffset}",this.labelSymbolizer.labelYOffset="${yOffset}"},destroy:function(){this.deactivate(),OpenLayers.Control.prototype.destroy.apply(this,arguments),this.gratLayer&&(this.gratLayer.destroy(),this.gratLayer=null)},draw:function(){if(OpenLayers.Control.prototype.draw.apply(this,arguments),!this.gratLayer){var t=new OpenLayers.Style({},{rules:[new OpenLayers.Rule({symbolizer:{Point:this.labelSymbolizer,Line:this.lineSymbolizer}})]});this.gratLayer=new OpenLayers.Layer.Vector(this.layerName,{styleMap:new OpenLayers.StyleMap({"default":t}),visibility:this.visible,displayInLayerSwitcher:this.displayInLayerSwitcher})}return this.div},activate:function(){return OpenLayers.Control.prototype.activate.apply(this,arguments)?(this.map.addLayer(this.gratLayer),this.map.events.register("moveend",this,this.update),this.update(),!0):!1},deactivate:function(){return OpenLayers.Control.prototype.deactivate.apply(this,arguments)?(this.map.events.unregister("moveend",this,this.update),this.map.removeLayer(this.gratLayer),!0):!1},update:function(){var t=this.map.getExtent();if(t){this.gratLayer.destroyFeatures();var e=new OpenLayers.Projection("EPSG:4326"),i=this.map.getProjectionObject(),n=this.map.getResolution();i.proj&&"longlat"==i.proj.projName&&(this.numPoints=1);var s=this.map.getCenter(),r=new OpenLayers.Pixel(s.lon,s.lat);OpenLayers.Projection.transform(r,i,e);var o=this.targetSize*n;o*=o;for(var a,l=0;l<this.intervals.length;++l){a=this.intervals[l];var h=a/2,u=r.offset({x:-h,y:-h}),p=r.offset({x:h,y:h});OpenLayers.Projection.transform(u,e,i),OpenLayers.Projection.transform(p,e,i);var c=(u.x-p.x)*(u.x-p.x)+(u.y-p.y)*(u.y-p.y);if(o>=c)break}r.x=Math.floor(r.x/a)*a,r.y=Math.floor(r.y/a)*a;var d,m=0,f=[r.clone()],y=r.clone();do y=y.offset({x:0,y:a}),d=OpenLayers.Projection.transform(y.clone(),e,i),f.unshift(y);while(t.containsPixel(d)&&++m<1e3);y=r.clone();do y=y.offset({x:0,y:-a}),d=OpenLayers.Projection.transform(y.clone(),e,i),f.push(y);while(t.containsPixel(d)&&++m<1e3);m=0;var g=[r.clone()];y=r.clone();do y=y.offset({x:-a,y:0}),d=OpenLayers.Projection.transform(y.clone(),e,i),g.unshift(y);while(t.containsPixel(d)&&++m<1e3);y=r.clone();do y=y.offset({x:a,y:0}),d=OpenLayers.Projection.transform(y.clone(),e,i),g.push(y);while(t.containsPixel(d)&&++m<1e3);for(var v=[],l=0;l<g.length;++l){for(var L=g[l].x,_=[],O=null,b=Math.min(f[0].y,90),w=Math.max(f[f.length-1].y,-90),x=(b-w)/this.numPoints,S=w,C=0;C<=this.numPoints;++C){var E=new OpenLayers.Geometry.Point(L,S);E.transform(e,i),_.push(E),S+=x,E.y>=t.bottom&&!O&&(O=E)}if(this.labelled){var P=new OpenLayers.Geometry.Point(O.x,t.bottom),M={value:L,label:this.labelled?OpenLayers.Util.getFormattedLonLat(L,"lon",this.labelFormat):"",labelAlign:"cb",xOffset:0,yOffset:2};this.gratLayer.addFeatures(new OpenLayers.Feature.Vector(P,M))}var N=new OpenLayers.Geometry.LineString(_);v.push(new OpenLayers.Feature.Vector(N))}for(var C=0;C<f.length;++C)if(S=f[C].y,!(-90>S||S>90)){for(var _=[],T=g[0].x,A=g[g.length-1].x,k=(A-T)/this.numPoints,L=T,O=null,l=0;l<=this.numPoints;++l){var E=new OpenLayers.Geometry.Point(L,S);E.transform(e,i),_.push(E),L+=k,E.x<t.right&&(O=E)}if(this.labelled){var P=new OpenLayers.Geometry.Point(t.right,O.y),M={value:S,label:this.labelled?OpenLayers.Util.getFormattedLonLat(S,"lat",this.labelFormat):"",labelAlign:"rb",xOffset:-2,yOffset:2};this.gratLayer.addFeatures(new OpenLayers.Feature.Vector(P,M))}var N=new OpenLayers.Geometry.LineString(_);v.push(new OpenLayers.Feature.Vector(N))}this.gratLayer.addFeatures(v)}},CLASS_NAME:"OpenLayers.Control.Graticule"}),OpenLayers.Control.DragFeature=OpenLayers.Class(OpenLayers.Control,{geometryTypes:null,onStart:function(){},onDrag:function(){},onComplete:function(){},onEnter:function(){},onLeave:function(){},documentDrag:!1,layer:null,feature:null,dragCallbacks:{},featureCallbacks:{},lastPixel:null,initialize:function(t,e){OpenLayers.Control.prototype.initialize.apply(this,[e]),this.layer=t,this.handlers={drag:new OpenLayers.Handler.Drag(this,OpenLayers.Util.extend({down:this.downFeature,move:this.moveFeature,up:this.upFeature,out:this.cancel,done:this.doneDragging},this.dragCallbacks),{documentDrag:this.documentDrag}),feature:new OpenLayers.Handler.Feature(this,this.layer,OpenLayers.Util.extend({click:this.clickFeature,clickout:this.clickoutFeature,over:this.overFeature,out:this.outFeature},this.featureCallbacks),{geometryTypes:this.geometryTypes})}},clickFeature:function(t){this.handlers.feature.touch&&!this.over&&this.overFeature(t)&&(this.handlers.drag.dragstart(this.handlers.feature.evt),this.handlers.drag.stopDown=!1)},clickoutFeature:function(t){this.handlers.feature.touch&&this.over&&(this.outFeature(t),this.handlers.drag.stopDown=!0)},destroy:function(){this.layer=null,OpenLayers.Control.prototype.destroy.apply(this,[])},activate:function(){return this.handlers.feature.activate()&&OpenLayers.Control.prototype.activate.apply(this,arguments)},deactivate:function(){return this.handlers.drag.deactivate(),this.handlers.feature.deactivate(),this.feature=null,this.dragging=!1,this.lastPixel=null,OpenLayers.Element.removeClass(this.map.viewPortDiv,this.displayClass+"Over"),OpenLayers.Control.prototype.deactivate.apply(this,arguments)},overFeature:function(t){var e=!1;return this.handlers.drag.dragging?this.over=this.feature.id==t.id?!0:!1:(this.feature=t,this.handlers.drag.activate(),e=!0,this.over=!0,OpenLayers.Element.addClass(this.map.viewPortDiv,this.displayClass+"Over"),this.onEnter(t)),e},downFeature:function(t){this.lastPixel=t,this.onStart(this.feature,t)},moveFeature:function(t){var e=this.map.getResolution();this.feature.geometry.move(e*(t.x-this.lastPixel.x),e*(this.lastPixel.y-t.y)),this.layer.drawFeature(this.feature),this.lastPixel=t,this.onDrag(this.feature,t)},upFeature:function(){this.over||this.handlers.drag.deactivate()},doneDragging:function(t){this.onComplete(this.feature,t)},outFeature:function(t){this.handlers.drag.dragging?this.feature.id==t.id&&(this.over=!1):(this.over=!1,this.handlers.drag.deactivate(),OpenLayers.Element.removeClass(this.map.viewPortDiv,this.displayClass+"Over"),this.onLeave(t),this.feature=null)},cancel:function(){this.handlers.drag.deactivate(),this.over=!1},setMap:function(t){this.handlers.drag.setMap(t),this.handlers.feature.setMap(t),OpenLayers.Control.prototype.setMap.apply(this,arguments)},CLASS_NAME:"OpenLayers.Control.DragFeature"}),OpenLayers.Console.warn("OpenLayers.Rico is deprecated"),OpenLayers.Rico=OpenLayers.Rico||{},OpenLayers.Rico.Corner={round:function(t,e){t=OpenLayers.Util.getElement(t),this._setOptions(e);var i=this.options.color;"fromElement"==this.options.color&&(i=this._background(t));var n=this.options.bgColor;"fromParent"==this.options.bgColor&&(n=this._background(t.offsetParent)),this._roundCornersImpl(t,i,n)},changeColor:function(t,e){t.style.backgroundColor=e;for(var i=t.parentNode.getElementsByTagName("span"),n=0;n<i.length;n++)i[n].style.backgroundColor=e},changeOpacity:function(t,e){var i=e,n="alpha(opacity="+100*e+")";t.style.opacity=i,t.style.filter=n;for(var s=t.parentNode.getElementsByTagName("span"),r=0;r<s.length;r++)s[r].style.opacity=i,s[r].style.filter=n},reRound:function(t,e){var i=t.parentNode.childNodes[0],n=t.parentNode.childNodes[2];t.parentNode.removeChild(i),t.parentNode.removeChild(n),this.round(t.parentNode,e)},_roundCornersImpl:function(t,e,i){this.options.border&&this._renderBorder(t,i),this._isTopRounded()&&this._roundTopCorners(t,e,i),this._isBottomRounded()&&this._roundBottomCorners(t,e,i)},_renderBorder:function(t,e){var i="1px solid "+this._borderColor(e),n="border-left: "+i,s="border-right: "+i,r="style='"+n+";"+s+"'";t.innerHTML="<div "+r+">"+t.innerHTML+"</div>"},_roundTopCorners:function(t,e,i){for(var n=this._createCorner(i),s=0;s<this.options.numSlices;s++)n.appendChild(this._createCornerSlice(e,i,s,"top"));t.style.paddingTop=0,t.insertBefore(n,t.firstChild)},_roundBottomCorners:function(t,e,i){for(var n=this._createCorner(i),s=this.options.numSlices-1;s>=0;s--)n.appendChild(this._createCornerSlice(e,i,s,"bottom"));t.style.paddingBottom=0,t.appendChild(n)},_createCorner:function(t){var e=document.createElement("div");return e.style.backgroundColor=this._isTransparent()?"transparent":t,e},_createCornerSlice:function(t,e,i,n){var s=document.createElement("span"),r=s.style;r.backgroundColor=t,r.display="block",r.height="1px",r.overflow="hidden",r.fontSize="1px";var o=this._borderColor(t,e);return this.options.border&&0==i?(r.borderTopStyle="solid",r.borderTopWidth="1px",r.borderLeftWidth="0px",r.borderRightWidth="0px",r.borderBottomWidth="0px",r.height="0px",r.borderColor=o):o&&(r.borderColor=o,r.borderStyle="solid",r.borderWidth="0px 1px"),this.options.compact||i!=this.options.numSlices-1||(r.height="2px"),this._setMargin(s,i,n),this._setBorder(s,i,n),s},_setOptions:function(t){this.options={corners:"all",color:"fromElement",bgColor:"fromParent",blend:!0,border:!1,compact:!1},OpenLayers.Util.extend(this.options,t||{}),this.options.numSlices=this.options.compact?2:4,this._isTransparent()&&(this.options.blend=!1)},_whichSideTop:function(){return this._hasString(this.options.corners,"all","top")?"":this.options.corners.indexOf("tl")>=0&&this.options.corners.indexOf("tr")>=0?"":this.options.corners.indexOf("tl")>=0?"left":this.options.corners.indexOf("tr")>=0?"right":""},_whichSideBottom:function(){return this._hasString(this.options.corners,"all","bottom")?"":this.options.corners.indexOf("bl")>=0&&this.options.corners.indexOf("br")>=0?"":this.options.corners.indexOf("bl")>=0?"left":this.options.corners.indexOf("br")>=0?"right":""},_borderColor:function(t,e){return"transparent"==t?e:this.options.border?this.options.border:this.options.blend?this._blend(e,t):""},_setMargin:function(t,e,i){var n=this._marginSize(e),s="top"==i?this._whichSideTop():this._whichSideBottom();"left"==s?(t.style.marginLeft=n+"px",t.style.marginRight="0px"):"right"==s?(t.style.marginRight=n+"px",t.style.marginLeft="0px"):(t.style.marginLeft=n+"px",t.style.marginRight=n+"px")},_setBorder:function(t,e,i){var n=this._borderSize(e),s="top"==i?this._whichSideTop():this._whichSideBottom();"left"==s?(t.style.borderLeftWidth=n+"px",t.style.borderRightWidth="0px"):"right"==s?(t.style.borderRightWidth=n+"px",t.style.borderLeftWidth="0px"):(t.style.borderLeftWidth=n+"px",t.style.borderRightWidth=n+"px"),0!=this.options.border&&(t.style.borderLeftWidth=n+"px",t.style.borderRightWidth=n+"px")},_marginSize:function(t){if(this._isTransparent())return 0;var e=[5,3,2,1],i=[3,2,1,0],n=[2,1],s=[1,0];return this.options.compact&&this.options.blend?s[t]:this.options.compact?n[t]:this.options.blend?i[t]:e[t]},_borderSize:function(t){var e=[5,3,2,1],i=[2,1,1,1],n=[1,0],s=[0,2,0,0];return this.options.compact&&(this.options.blend||this._isTransparent())?1:this.options.compact?n[t]:this.options.blend?i[t]:this.options.border?s[t]:this._isTransparent()?e[t]:0},_hasString:function(t){for(var e=1;e<arguments.length;e++)if(t.indexOf(arguments[e])>=0)return!0;return!1},_blend:function(t,e){var i=OpenLayers.Rico.Color.createFromHex(t);
return i.blend(OpenLayers.Rico.Color.createFromHex(e)),i},_background:function(t){try{return OpenLayers.Rico.Color.createColorFromBackground(t).asHex()}catch(e){return"#ffffff"}},_isTransparent:function(){return"transparent"==this.options.color},_isTopRounded:function(){return this._hasString(this.options.corners,"all","top","tl","tr")},_isBottomRounded:function(){return this._hasString(this.options.corners,"all","bottom","bl","br")},_hasSingleTextChild:function(t){return 1==t.childNodes.length&&3==t.childNodes[0].nodeType}},OpenLayers.Layer.UTFGrid=OpenLayers.Class(OpenLayers.Layer.XYZ,{isBaseLayer:!1,projection:new OpenLayers.Projection("EPSG:900913"),useJSONP:!1,tileClass:OpenLayers.Tile.UTFGrid,initialize:function(t){OpenLayers.Layer.Grid.prototype.initialize.apply(this,[t.name,t.url,{},t]),this.tileOptions=OpenLayers.Util.extend({utfgridResolution:this.utfgridResolution},this.tileOptions)},createBackBuffer:function(){},clone:function(t){return null==t&&(t=new OpenLayers.Layer.UTFGrid(this.getOptions())),t=OpenLayers.Layer.Grid.prototype.clone.apply(this,[t])},getFeatureInfo:function(t){var e=null,i=this.getTileData(t);return i&&i.tile&&(e=i.tile.getFeatureInfo(i.i,i.j)),e},getFeatureId:function(t){var e=null,i=this.getTileData(t);return i.tile&&(e=i.tile.getFeatureId(i.i,i.j)),e},CLASS_NAME:"OpenLayers.Layer.UTFGrid"}),OpenLayers.TileManager=OpenLayers.Class({cacheSize:256,tilesPerFrame:2,frameDelay:16,moveDelay:100,zoomDelay:200,maps:null,tileQueueId:null,tileQueue:null,tileCache:null,tileCacheIndex:null,initialize:function(t){OpenLayers.Util.extend(this,t),this.maps=[],this.tileQueueId={},this.tileQueue={},this.tileCache={},this.tileCacheIndex=[]},addMap:function(t){if(!this._destroyed&&OpenLayers.Layer.Grid){this.maps.push(t),this.tileQueue[t.id]=[];for(var e=0,i=t.layers.length;i>e;++e)this.addLayer({layer:t.layers[e]});t.events.on({move:this.move,zoomend:this.zoomEnd,changelayer:this.changeLayer,addlayer:this.addLayer,preremovelayer:this.removeLayer,scope:this})}},removeMap:function(t){if(!this._destroyed&&OpenLayers.Layer.Grid){if(window.clearTimeout(this.tileQueueId[t.id]),t.layers)for(var e=0,i=t.layers.length;i>e;++e)this.removeLayer({layer:t.layers[e]});t.events&&t.events.un({move:this.move,zoomend:this.zoomEnd,changelayer:this.changeLayer,addlayer:this.addLayer,preremovelayer:this.removeLayer,scope:this}),delete this.tileQueue[t.id],delete this.tileQueueId[t.id],OpenLayers.Util.removeItem(this.maps,t)}},move:function(t){this.updateTimeout(t.object,this.moveDelay,!0)},zoomEnd:function(t){this.updateTimeout(t.object,this.zoomDelay)},changeLayer:function(t){("visibility"===t.property||"params"===t.property)&&this.updateTimeout(t.object,0)},addLayer:function(t){var e=t.layer;if(e instanceof OpenLayers.Layer.Grid){e.events.on({addtile:this.addTile,retile:this.clearTileQueue,scope:this});var i,n,s;for(i=e.grid.length-1;i>=0;--i)for(n=e.grid[i].length-1;n>=0;--n)s=e.grid[i][n],this.addTile({tile:s}),s.url&&!s.imgDiv&&this.manageTileCache({object:s})}},removeLayer:function(t){var e=t.layer;if(e instanceof OpenLayers.Layer.Grid&&(this.clearTileQueue({object:e}),e.events&&e.events.un({addtile:this.addTile,retile:this.clearTileQueue,scope:this}),e.grid)){var i,n,s;for(i=e.grid.length-1;i>=0;--i)for(n=e.grid[i].length-1;n>=0;--n)s=e.grid[i][n],this.unloadTile({object:s})}},updateTimeout:function(t,e,i){window.clearTimeout(this.tileQueueId[t.id]);var n=this.tileQueue[t.id];(!i||n.length)&&(this.tileQueueId[t.id]=window.setTimeout(OpenLayers.Function.bind(function(){this.drawTilesFromQueue(t),n.length&&this.updateTimeout(t,this.frameDelay)},this),e))},addTile:function(t){t.tile instanceof OpenLayers.Tile.Image?t.tile.events.on({beforedraw:this.queueTileDraw,beforeload:this.manageTileCache,loadend:this.addToCache,unload:this.unloadTile,scope:this}):this.removeLayer({layer:t.tile.layer})},unloadTile:function(t){var e=t.object;e.events.un({beforedraw:this.queueTileDraw,beforeload:this.manageTileCache,loadend:this.addToCache,unload:this.unloadTile,scope:this}),OpenLayers.Util.removeItem(this.tileQueue[e.layer.map.id],e)},queueTileDraw:function(t){var e=t.object,i=!1,n=e.layer,s=n.getURL(e.bounds),r=this.tileCache[s];if(r&&"olTileImage"!==r.className&&(delete this.tileCache[s],OpenLayers.Util.removeItem(this.tileCacheIndex,s),r=null),n.url&&(n.async||!r)){var o=this.tileQueue[n.map.id];~OpenLayers.Util.indexOf(o,e)||o.push(e),i=!0}return!i},drawTilesFromQueue:function(t){for(var e=this.tileQueue[t.id],i=this.tilesPerFrame,n=t.zoomTween&&t.zoomTween.playing;!n&&e.length&&i;)e.shift().draw(!0),--i},manageTileCache:function(t){var e=t.object,i=this.tileCache[e.url];i&&(i.parentNode&&OpenLayers.Element.hasClass(i.parentNode,"olBackBuffer")&&(i.parentNode.removeChild(i),i.id=null),i.parentNode||(i.style.visibility="hidden",i.style.opacity=0,e.setImage(i),OpenLayers.Util.removeItem(this.tileCacheIndex,e.url),this.tileCacheIndex.push(e.url)))},addToCache:function(t){var e=t.object;this.tileCache[e.url]||OpenLayers.Element.hasClass(e.imgDiv,"olImageLoadError")||(this.tileCacheIndex.length>=this.cacheSize&&(delete this.tileCache[this.tileCacheIndex[0]],this.tileCacheIndex.shift()),this.tileCache[e.url]=e.imgDiv,this.tileCacheIndex.push(e.url))},clearTileQueue:function(t){for(var e=t.object,i=this.tileQueue[e.map.id],n=i.length-1;n>=0;--n)i[n].layer===e&&i.splice(n,1)},destroy:function(){for(var t=this.maps.length-1;t>=0;--t)this.removeMap(this.maps[t]);this.maps=null,this.tileQueue=null,this.tileQueueId=null,this.tileCache=null,this.tileCacheIndex=null,this._destroyed=!0}}),OpenLayers.Protocol.Script=OpenLayers.Class(OpenLayers.Protocol,{url:null,params:null,callback:null,callbackTemplate:"OpenLayers.Protocol.Script.registry.${id}",callbackKey:"callback",callbackPrefix:"",scope:null,format:null,pendingRequests:null,srsInBBOX:!1,initialize:function(t){if(t=t||{},this.params={},this.pendingRequests={},OpenLayers.Protocol.prototype.initialize.apply(this,arguments),this.format||(this.format=new OpenLayers.Format.GeoJSON),!this.filterToParams&&OpenLayers.Format.QueryStringFilter){var e=new OpenLayers.Format.QueryStringFilter({srsInBBOX:this.srsInBBOX});this.filterToParams=function(t,i){return e.write(t,i)}}},read:function(t){OpenLayers.Protocol.prototype.read.apply(this,arguments),t=OpenLayers.Util.applyDefaults(t,this.options),t.params=OpenLayers.Util.applyDefaults(t.params,this.options.params),t.filter&&this.filterToParams&&(t.params=this.filterToParams(t.filter,t.params));var e=new OpenLayers.Protocol.Response({requestType:"read"}),i=this.createRequest(t.url,t.params,OpenLayers.Function.bind(function(i){e.data=i,this.handleRead(e,t)},this));return e.priv=i,e},createRequest:function(t,e,i){var n=OpenLayers.Protocol.Script.register(i),s=OpenLayers.String.format(this.callbackTemplate,{id:n});e=OpenLayers.Util.extend({},e),e[this.callbackKey]=this.callbackPrefix+s,t=OpenLayers.Util.urlAppend(t,OpenLayers.Util.getParameterString(e));var r=document.createElement("script");r.type="text/javascript",r.src=t,r.id="OpenLayers_Protocol_Script_"+n,this.pendingRequests[r.id]=r;var o=document.getElementsByTagName("head")[0];return o.appendChild(r),r},destroyRequest:function(t){OpenLayers.Protocol.Script.unregister(t.id.split("_").pop()),delete this.pendingRequests[t.id],t.parentNode&&t.parentNode.removeChild(t)},handleRead:function(t,e){this.handleResponse(t,e)},handleResponse:function(t,e){e.callback&&(t.data?(t.features=this.parseFeatures(t.data),t.code=OpenLayers.Protocol.Response.SUCCESS):t.code=OpenLayers.Protocol.Response.FAILURE,this.destroyRequest(t.priv),e.callback.call(e.scope,t))},parseFeatures:function(t){return this.format.read(t)},abort:function(t){if(t)this.destroyRequest(t.priv);else for(var e in this.pendingRequests)this.destroyRequest(this.pendingRequests[e])},destroy:function(){this.abort(),delete this.params,delete this.format,OpenLayers.Protocol.prototype.destroy.apply(this)},CLASS_NAME:"OpenLayers.Protocol.Script"}),function(){var t=OpenLayers.Protocol.Script,e=0;t.registry={},t.register=function(i){var n="c"+ ++e;return t.registry[n]=function(){i.apply(this,arguments)},n},t.unregister=function(e){delete t.registry[e]}}(),OpenLayers.Control.TransformFeature=OpenLayers.Class(OpenLayers.Control,{geometryTypes:null,layer:null,preserveAspectRatio:!1,rotate:!0,feature:null,renderIntent:"temporary",rotationHandleSymbolizer:null,box:null,center:null,scale:1,ratio:1,rotation:0,handles:null,rotationHandles:null,dragControl:null,irregular:!1,initialize:function(t,e){OpenLayers.Control.prototype.initialize.apply(this,[e]),this.layer=t,this.rotationHandleSymbolizer||(this.rotationHandleSymbolizer={stroke:!1,pointRadius:10,fillOpacity:0,cursor:"pointer"}),this.createBox(),this.createControl()},activate:function(){var t=!1;return OpenLayers.Control.prototype.activate.apply(this,arguments)&&(this.dragControl.activate(),this.layer.addFeatures([this.box]),this.rotate&&this.layer.addFeatures(this.rotationHandles),this.layer.addFeatures(this.handles),t=!0),t},deactivate:function(){var t=!1;return OpenLayers.Control.prototype.deactivate.apply(this,arguments)&&(this.layer.removeFeatures(this.handles),this.rotate&&this.layer.removeFeatures(this.rotationHandles),this.layer.removeFeatures([this.box]),this.dragControl.deactivate(),t=!0),t},setMap:function(t){this.dragControl.setMap(t),OpenLayers.Control.prototype.setMap.apply(this,arguments)},setFeature:function(t,e){e=OpenLayers.Util.applyDefaults(e,{rotation:0,scale:1,ratio:1});var i=this.rotation,n=this.center;OpenLayers.Util.extend(this,e);var s=this.events.triggerEvent("beforesetfeature",{feature:t});if(s!==!1){this.feature=t,this.activate(),this._setfeature=!0;var r=this.feature.geometry.getBounds();this.box.move(r.getCenterLonLat()),this.box.geometry.rotate(-i,n),this._angle=0;var o;if(this.rotation){var a=t.geometry.clone();a.rotate(-this.rotation,this.center);var l=new OpenLayers.Feature.Vector(a.getBounds().toGeometry());l.geometry.rotate(this.rotation,this.center),this.box.geometry.rotate(this.rotation,this.center),this.box.move(l.geometry.getBounds().getCenterLonLat());var h=l.geometry.components[0].components[0];o=h.getBounds().getCenterLonLat()}else o=new OpenLayers.LonLat(r.left,r.bottom);this.handles[0].move(o),delete this._setfeature,this.events.triggerEvent("setfeature",{feature:t})}},unsetFeature:function(){this.active?this.deactivate():(this.feature=null,this.rotation=0,this.scale=1,this.ratio=1)},createBox:function(){var t=this;this.center=new OpenLayers.Geometry.Point(0,0),this.box=new OpenLayers.Feature.Vector(new OpenLayers.Geometry.LineString([new OpenLayers.Geometry.Point(-1,-1),new OpenLayers.Geometry.Point(0,-1),new OpenLayers.Geometry.Point(1,-1),new OpenLayers.Geometry.Point(1,0),new OpenLayers.Geometry.Point(1,1),new OpenLayers.Geometry.Point(0,1),new OpenLayers.Geometry.Point(-1,1),new OpenLayers.Geometry.Point(-1,0),new OpenLayers.Geometry.Point(-1,-1)]),null,"string"==typeof this.renderIntent?null:this.renderIntent),this.box.geometry.move=function(e,i){t._moving=!0,OpenLayers.Geometry.LineString.prototype.move.apply(this,arguments),t.center.move(e,i),delete t._moving};for(var e,i,n,s=function(t,e){OpenLayers.Geometry.Point.prototype.move.apply(this,arguments),this._rotationHandle&&this._rotationHandle.geometry.move(t,e),this._handle.geometry.move(t,e)},r=function(t,e,i){OpenLayers.Geometry.Point.prototype.resize.apply(this,arguments),this._rotationHandle&&this._rotationHandle.geometry.resize(t,e,i),this._handle.geometry.resize(t,e,i)},o=function(t,e){OpenLayers.Geometry.Point.prototype.rotate.apply(this,arguments),this._rotationHandle&&this._rotationHandle.geometry.rotate(t,e),this._handle.geometry.rotate(t,e)},a=function(e,i){var n=this.x,s=this.y;if(OpenLayers.Geometry.Point.prototype.move.call(this,e,i),!t._moving){var r=t.dragControl.handlers.drag.evt,o=!t._setfeature&&t.preserveAspectRatio,a=!(o||r&&r.shiftKey),l=new OpenLayers.Geometry.Point(n,s),h=t.center;this.rotate(-t.rotation,h),l.rotate(-t.rotation,h);var u=this.x-h.x,p=this.y-h.y,c=u-(this.x-l.x),d=p-(this.y-l.y);t.irregular&&!t._setfeature&&(u-=(this.x-l.x)/2,p-=(this.y-l.y)/2),this.x=n,this.y=s;var m,f=1;if(a)m=Math.abs(d)<1e-5?1:p/d,f=(Math.abs(c)<1e-5?1:u/c)/m;else{var y=Math.sqrt(c*c+d*d),g=Math.sqrt(u*u+p*p);m=g/y}if(t._moving=!0,t.box.geometry.rotate(-t.rotation,h),delete t._moving,t.box.geometry.resize(m,h,f),t.box.geometry.rotate(t.rotation,h),t.transformFeature({scale:m,ratio:f}),t.irregular&&!t._setfeature){var v=h.clone();v.x+=Math.abs(n-h.x)<1e-5?0:this.x-n,v.y+=Math.abs(s-h.y)<1e-5?0:this.y-s,t.box.geometry.move(this.x-n,this.y-s),t.transformFeature({center:v})}}},l=function(e,i){var n=this.x,s=this.y;if(OpenLayers.Geometry.Point.prototype.move.call(this,e,i),!t._moving){var r=t.dragControl.handlers.drag.evt,o=r&&r.shiftKey?45:1,a=t.center,l=this.x-a.x,h=this.y-a.y,u=l-e,p=h-i;this.x=n,this.y=s;var c=Math.atan2(p,u),d=Math.atan2(h,l),m=d-c;m*=180/Math.PI,t._angle=(t._angle+m)%360;var f=t.rotation%o;(Math.abs(t._angle)>=o||0!==f)&&(m=Math.round(t._angle/o)*o-f,t._angle=0,t.box.geometry.rotate(m,a),t.transformFeature({rotation:m}))}},h=new Array(8),u=new Array(4),p=["sw","s","se","e","ne","n","nw","w"],c=0;8>c;++c)e=this.box.geometry.components[c],i=new OpenLayers.Feature.Vector(e.clone(),{role:p[c]+"-resize"},"string"==typeof this.renderIntent?null:this.renderIntent),c%2==0&&(n=new OpenLayers.Feature.Vector(e.clone(),{role:p[c]+"-rotate"},"string"==typeof this.rotationHandleSymbolizer?null:this.rotationHandleSymbolizer),n.geometry.move=l,e._rotationHandle=n,u[c/2]=n),e.move=s,e.resize=r,e.rotate=o,i.geometry.move=a,e._handle=i,h[c]=i;this.rotationHandles=u,this.handles=h},createControl:function(){var t=this;this.dragControl=new OpenLayers.Control.DragFeature(this.layer,{documentDrag:!0,moveFeature:function(){this.feature===t.feature&&(this.feature=t.box),OpenLayers.Control.DragFeature.prototype.moveFeature.apply(this,arguments)},onDrag:function(e){e===t.box&&t.transformFeature({center:t.center})},onStart:function(e){var i=!t.geometryTypes||-1!==OpenLayers.Util.indexOf(t.geometryTypes,e.geometry.CLASS_NAME),n=OpenLayers.Util.indexOf(t.handles,e);n+=OpenLayers.Util.indexOf(t.rotationHandles,e),e!==t.feature&&e!==t.box&&-2==n&&i&&t.setFeature(e)},onComplete:function(){t.events.triggerEvent("transformcomplete",{feature:t.feature})}})},drawHandles:function(){for(var t=this.layer,e=0;8>e;++e)this.rotate&&e%2===0&&t.drawFeature(this.rotationHandles[e/2],this.rotationHandleSymbolizer),t.drawFeature(this.handles[e],this.renderIntent)},transformFeature:function(t){if(!this._setfeature){this.scale*=t.scale||1,this.ratio*=t.ratio||1;var e=this.rotation;if(this.rotation=(this.rotation+(t.rotation||0))%360,this.events.triggerEvent("beforetransform",t)!==!1){var i=this.feature,n=i.geometry,s=this.center;n.rotate(-e,s),t.scale||t.ratio?n.resize(t.scale,s,t.ratio):t.center&&i.move(t.center.getBounds().getCenterLonLat()),n.rotate(this.rotation,s),this.layer.drawFeature(i),i.toState(OpenLayers.State.UPDATE),this.events.triggerEvent("transform",t)}}this.layer.drawFeature(this.box,this.renderIntent),this.drawHandles()},destroy:function(){for(var t,e=0;8>e;++e)t=this.box.geometry.components[e],t._handle.destroy(),t._handle=null,t._rotationHandle&&t._rotationHandle.destroy(),t._rotationHandle=null;this.center=null,this.feature=null,this.handles=null,this.rotationHandleSymbolizer=null,this.rotationHandles=null,this.box.destroy(),this.box=null,this.layer=null,this.dragControl.destroy(),this.dragControl=null,OpenLayers.Control.prototype.destroy.apply(this,arguments)},CLASS_NAME:"OpenLayers.Control.TransformFeature"}),OpenLayers.Layer.ArcGISCache=OpenLayers.Class(OpenLayers.Layer.XYZ,{url:null,tileOrigin:null,tileSize:new OpenLayers.Size(256,256),useArcGISServer:!0,type:"png",useScales:!1,overrideDPI:!1,initialize:function(){if(OpenLayers.Layer.XYZ.prototype.initialize.apply(this,arguments),this.resolutions&&(this.serverResolutions=this.resolutions,this.maxExtent=this.getMaxExtentForResolution(this.resolutions[0])),this.layerInfo){var t=this.layerInfo,e=new OpenLayers.Bounds(t.fullExtent.xmin,t.fullExtent.ymin,t.fullExtent.xmax,t.fullExtent.ymax);if(this.projection="EPSG:"+t.spatialReference.wkid,this.sphericalMercator=102100==t.spatialReference.wkid,this.units="esriFeet"==t.units?"ft":"m",t.tileInfo){this.tileSize=new OpenLayers.Size(t.tileInfo.width||t.tileInfo.cols,t.tileInfo.height||t.tileInfo.rows),this.tileOrigin=new OpenLayers.LonLat(t.tileInfo.origin.x,t.tileInfo.origin.y);var i=new OpenLayers.Geometry.Point(e.left,e.top),n=new OpenLayers.Geometry.Point(e.right,e.bottom);this.useScales?this.scales=[]:this.resolutions=[],this.lods=[];for(var s in t.tileInfo.lods)if(t.tileInfo.lods.hasOwnProperty(s)){var r=t.tileInfo.lods[s];this.useScales?this.scales.push(r.scale):this.resolutions.push(r.resolution);var o=this.getContainingTileCoords(i,r.resolution);r.startTileCol=o.x,r.startTileRow=o.y;var a=this.getContainingTileCoords(n,r.resolution);r.endTileCol=a.x,r.endTileRow=a.y,this.lods.push(r)}this.maxExtent=this.calculateMaxExtentWithLOD(this.lods[0]),this.serverResolutions=this.resolutions,this.overrideDPI&&t.tileInfo.dpi&&(OpenLayers.DOTS_PER_INCH=t.tileInfo.dpi)}}},getContainingTileCoords:function(t,e){return new OpenLayers.Pixel(Math.max(Math.floor((t.x-this.tileOrigin.lon)/(this.tileSize.w*e)),0),Math.max(Math.floor((this.tileOrigin.lat-t.y)/(this.tileSize.h*e)),0))},calculateMaxExtentWithLOD:function(t){var e=t.endTileCol-t.startTileCol+1,i=t.endTileRow-t.startTileRow+1,n=this.tileOrigin.lon+t.startTileCol*this.tileSize.w*t.resolution,s=n+e*this.tileSize.w*t.resolution,r=this.tileOrigin.lat-t.startTileRow*this.tileSize.h*t.resolution,o=r-i*this.tileSize.h*t.resolution;return new OpenLayers.Bounds(n,o,s,r)},calculateMaxExtentWithExtent:function(t,e){var i=new OpenLayers.Geometry.Point(t.left,t.top),n=new OpenLayers.Geometry.Point(t.right,t.bottom),s=this.getContainingTileCoords(i,e),r=this.getContainingTileCoords(n,e),o={resolution:e,startTileCol:s.x,startTileRow:s.y,endTileCol:r.x,endTileRow:r.y};return this.calculateMaxExtentWithLOD(o)},getUpperLeftTileCoord:function(t){var e=new OpenLayers.Geometry.Point(this.maxExtent.left,this.maxExtent.top);return this.getContainingTileCoords(e,t)},getLowerRightTileCoord:function(t){var e=new OpenLayers.Geometry.Point(this.maxExtent.right,this.maxExtent.bottom);return this.getContainingTileCoords(e,t)},getMaxExtentForResolution:function(t){var e=this.getUpperLeftTileCoord(t),i=this.getLowerRightTileCoord(t),n=i.x-e.x+1,s=i.y-e.y+1,r=this.tileOrigin.lon+e.x*this.tileSize.w*t,o=r+n*this.tileSize.w*t,a=this.tileOrigin.lat-e.y*this.tileSize.h*t,l=a-s*this.tileSize.h*t;return new OpenLayers.Bounds(r,l,o,a)},clone:function(t){return null==t&&(t=new OpenLayers.Layer.ArcGISCache(this.name,this.url,this.options)),OpenLayers.Layer.XYZ.prototype.clone.apply(this,[t])},initGriddedTiles:function(){delete this._tileOrigin,OpenLayers.Layer.XYZ.prototype.initGriddedTiles.apply(this,arguments)},getMaxExtent:function(){var t=this.map.getResolution();return this.maxExtent=this.getMaxExtentForResolution(t)},getTileOrigin:function(){if(!this._tileOrigin){var t=this.getMaxExtent();this._tileOrigin=new OpenLayers.LonLat(t.left,t.bottom)}return this._tileOrigin},getURL:function(t){var e=this.getResolution(),i=this.tileOrigin.lon+e*this.tileSize.w/2,n=this.tileOrigin.lat-e*this.tileSize.h/2,s=t.getCenterLonLat(),r=({x:s.lon,y:s.lat},Math.round(Math.abs((s.lon-i)/(e*this.tileSize.w)))),o=Math.round(Math.abs((n-s.lat)/(e*this.tileSize.h))),a=this.map.getZoom();if(this.lods){var l=this.lods[this.map.getZoom()];if(r<l.startTileCol||r>l.endTileCol||o<l.startTileRow||o>l.endTileRow)return null}else{var h=this.getUpperLeftTileCoord(e),u=this.getLowerRightTileCoord(e);if(r<h.x||r>=u.x||o<h.y||o>=u.y)return null}var p=this.url,c=""+r+o+a;return OpenLayers.Util.isArray(p)&&(p=this.selectUrl(c,p)),this.useArcGISServer?p+="/tile/${z}/${y}/${x}":(r="C"+OpenLayers.Number.zeroPad(r,8,16),o="R"+OpenLayers.Number.zeroPad(o,8,16),a="L"+OpenLayers.Number.zeroPad(a,2,10),p=p+"/${z}/${y}/${x}."+this.type),p=OpenLayers.String.format(p,{x:r,y:o,z:a}),OpenLayers.Util.urlAppend(p,OpenLayers.Util.getParameterString(this.params))},CLASS_NAME:"OpenLayers.Layer.ArcGISCache"}),OpenLayers.Control.WMSGetFeatureInfo=OpenLayers.Class(OpenLayers.Control,{hover:!1,drillDown:!1,maxFeatures:10,clickCallback:"click",output:"features",layers:null,queryVisible:!1,url:null,layerUrls:null,infoFormat:"text/html",vendorParams:{},format:null,formatOptions:null,handler:null,hoverRequest:null,initialize:function(t){if(t=t||{},t.handlerOptions=t.handlerOptions||{},OpenLayers.Control.prototype.initialize.apply(this,[t]),this.format||(this.format=new OpenLayers.Format.WMSGetFeatureInfo(t.formatOptions)),this.drillDown===!0&&(this.hover=!1),this.hover)this.handler=new OpenLayers.Handler.Hover(this,{move:this.cancelHover,pause:this.getInfoForHover},OpenLayers.Util.extend(this.handlerOptions.hover||{},{delay:250}));else{var e={};e[this.clickCallback]=this.getInfoForClick,this.handler=new OpenLayers.Handler.Click(this,e,this.handlerOptions.click||{})}},getInfoForClick:function(t){this.events.triggerEvent("beforegetfeatureinfo",{xy:t.xy}),OpenLayers.Element.addClass(this.map.viewPortDiv,"olCursorWait"),this.request(t.xy,{})},getInfoForHover:function(t){this.events.triggerEvent("beforegetfeatureinfo",{xy:t.xy}),this.request(t.xy,{hover:!0})},cancelHover:function(){this.hoverRequest&&(this.hoverRequest.abort(),this.hoverRequest=null)},findLayers:function(){for(var t,e,i=this.layers||this.map.layers,n=[],s=i.length-1;s>=0;--s)t=i[s],t instanceof OpenLayers.Layer.WMS&&(!this.queryVisible||t.getVisibility())&&(e=OpenLayers.Util.isArray(t.url)?t.url[0]:t.url,this.drillDown!==!1||this.url||(this.url=e),(this.drillDown===!0||this.urlMatches(e))&&n.push(t));return n},urlMatches:function(t){var e=OpenLayers.Util.isEquivalentUrl(this.url,t);if(!e&&this.layerUrls)for(var i=0,n=this.layerUrls.length;n>i;++i)if(OpenLayers.Util.isEquivalentUrl(this.layerUrls[i],t)){e=!0;break}return e},buildWMSOptions:function(t,e,i,n){for(var s=[],r=[],o=0,a=e.length;a>o;o++)null!=e[o].params.LAYERS&&(s=s.concat(e[o].params.LAYERS),r=r.concat(this.getStyleNames(e[o])));var l=e[0],h=this.map.getProjection(),u=l.projection;u&&u.equals(this.map.getProjectionObject())&&(h=u.getCode());var p=OpenLayers.Util.extend({service:"WMS",version:l.params.VERSION,request:"GetFeatureInfo",exceptions:l.params.EXCEPTIONS,bbox:this.map.getExtent().toBBOX(null,l.reverseAxisOrder()),feature_count:this.maxFeatures,height:this.map.getSize().h,width:this.map.getSize().w,format:n,info_format:l.params.INFO_FORMAT||this.infoFormat},parseFloat(l.params.VERSION)>=1.3?{crs:h,i:parseInt(i.x),j:parseInt(i.y)}:{srs:h,x:parseInt(i.x),y:parseInt(i.y)});return 0!=s.length&&(p=OpenLayers.Util.extend({layers:s,query_layers:s,styles:r},p)),OpenLayers.Util.applyDefaults(p,this.vendorParams),{url:t,params:OpenLayers.Util.upperCaseObject(p),callback:function(e){this.handleResponse(i,e,t)},scope:this}},getStyleNames:function(t){var e;return e=t.params.STYLES?t.params.STYLES:OpenLayers.Util.isArray(t.params.LAYERS)?new Array(t.params.LAYERS.length):t.params.LAYERS.replace(/[^,]/g,"")},request:function(t,e){var i=this.findLayers();if(0==i.length)return this.events.triggerEvent("nogetfeatureinfo"),void OpenLayers.Element.removeClass(this.map.viewPortDiv,"olCursorWait");if(e=e||{},this.drillDown===!1){var n=this.buildWMSOptions(this.url,i,t,i[0].params.FORMAT),s=OpenLayers.Request.GET(n);e.hover===!0&&(this.hoverRequest=s)}else{this._requestCount=0,this._numRequests=0,this.features=[];for(var r,o={},a=0,l=i.length;l>a;a++){var h=i[a];r=OpenLayers.Util.isArray(h.url)?h.url[0]:h.url,r in o?o[r].push(h):(this._numRequests++,o[r]=[h])}var i;for(var r in o){i=o[r];var n=this.buildWMSOptions(r,i,t,i[0].params.FORMAT);OpenLayers.Request.GET(n)}}},triggerGetFeatureInfo:function(t,e,i){this.events.triggerEvent("getfeatureinfo",{text:t.responseText,features:i,request:t,xy:e}),OpenLayers.Element.removeClass(this.map.viewPortDiv,"olCursorWait")},handleResponse:function(t,e,i){var n=e.responseXML;n&&n.documentElement||(n=e.responseText);var s=this.format.read(n);this.drillDown===!1?this.triggerGetFeatureInfo(e,t,s):(this._requestCount++,this._features=(this._features||[]).concat("object"===this.output?{url:i,features:s}:s),this._requestCount===this._numRequests&&(this.triggerGetFeatureInfo(e,t,this._features.concat()),delete this._features,delete this._requestCount,delete this._numRequests))},CLASS_NAME:"OpenLayers.Control.WMSGetFeatureInfo"}),OpenLayers.Format.WMSCapabilities.v1_3_0=OpenLayers.Class(OpenLayers.Format.WMSCapabilities.v1_3,{version:"1.3.0",CLASS_NAME:"OpenLayers.Format.WMSCapabilities.v1_3_0"}),OpenLayers.Format.WFS=OpenLayers.Class(OpenLayers.Format.GML,{layer:null,wfsns:"http://www.opengis.net/wfs",ogcns:"http://www.opengis.net/ogc",initialize:function(t,e){OpenLayers.Format.GML.prototype.initialize.apply(this,[t]),this.layer=e,this.layer.featureNS&&(this.featureNS=this.layer.featureNS),this.layer.options.geometry_column&&(this.geometryName=this.layer.options.geometry_column),this.layer.options.typename&&(this.featureName=this.layer.options.typename)},write:function(t){var e=this.createElementNS(this.wfsns,"wfs:Transaction");e.setAttribute("version","1.0.0"),e.setAttribute("service","WFS");for(var i=0;i<t.length;i++)switch(t[i].state){case OpenLayers.State.INSERT:e.appendChild(this.insert(t[i]));break;case OpenLayers.State.UPDATE:e.appendChild(this.update(t[i]));break;case OpenLayers.State.DELETE:e.appendChild(this.remove(t[i]))}return OpenLayers.Format.XML.prototype.write.apply(this,[e])},createFeatureXML:function(t){var e=this.buildGeometryNode(t.geometry),i=this.createElementNS(this.featureNS,"feature:"+this.geometryName);i.appendChild(e);var n=this.createElementNS(this.featureNS,"feature:"+this.featureName);n.appendChild(i);for(var s in t.attributes){var r=this.createTextNode(t.attributes[s]),o=s;-1!=s.search(":")&&(o=s.split(":")[1]);var a=this.createElementNS(this.featureNS,"feature:"+o);a.appendChild(r),n.appendChild(a)}return n},insert:function(t){var e=this.createElementNS(this.wfsns,"wfs:Insert");return e.appendChild(this.createFeatureXML(t)),e},update:function(t){t.fid||OpenLayers.Console.userError(OpenLayers.i18n("noFID"));var e=this.createElementNS(this.wfsns,"wfs:Update");e.setAttribute("typeName",this.featurePrefix+":"+this.featureName),e.setAttribute("xmlns:"+this.featurePrefix,this.featureNS);var i=this.createElementNS(this.wfsns,"wfs:Property"),n=this.createElementNS(this.wfsns,"wfs:Name"),s=this.createTextNode(this.geometryName);n.appendChild(s),i.appendChild(n);var r=this.createElementNS(this.wfsns,"wfs:Value"),o=this.buildGeometryNode(t.geometry);t.layer&&o.setAttribute("srsName",t.layer.projection.getCode()),r.appendChild(o),i.appendChild(r),e.appendChild(i);for(var a in t.attributes)i=this.createElementNS(this.wfsns,"wfs:Property"),n=this.createElementNS(this.wfsns,"wfs:Name"),n.appendChild(this.createTextNode(a)),i.appendChild(n),r=this.createElementNS(this.wfsns,"wfs:Value"),r.appendChild(this.createTextNode(t.attributes[a])),i.appendChild(r),e.appendChild(i);var l=this.createElementNS(this.ogcns,"ogc:Filter"),h=this.createElementNS(this.ogcns,"ogc:FeatureId");return h.setAttribute("fid",t.fid),l.appendChild(h),e.appendChild(l),e},remove:function(t){if(!t.fid)return OpenLayers.Console.userError(OpenLayers.i18n("noFID")),!1;var e=this.createElementNS(this.wfsns,"wfs:Delete");e.setAttribute("typeName",this.featurePrefix+":"+this.featureName),e.setAttribute("xmlns:"+this.featurePrefix,this.featureNS);var i=this.createElementNS(this.ogcns,"ogc:Filter"),n=this.createElementNS(this.ogcns,"ogc:FeatureId");return n.setAttribute("fid",t.fid),i.appendChild(n),e.appendChild(i),e},destroy:function(){this.layer=null},CLASS_NAME:"OpenLayers.Format.WFS"}),OpenLayers.Control.UTFGrid=OpenLayers.Class(OpenLayers.Control,{autoActivate:!0,layers:null,defaultHandlerOptions:{delay:300,pixelTolerance:4,stopMove:!1,single:!0,"double":!1,stopSingle:!1,stopDouble:!1},handlerMode:"click",setHandler:function(t){this.handlerMode=t,this.resetHandler()},resetHandler:function(){return this.handler&&(this.handler.deactivate(),this.handler.destroy(),this.handler=null),"hover"==this.handlerMode?this.handler=new OpenLayers.Handler.Hover(this,{pause:this.handleEvent,move:this.reset},this.handlerOptions):"click"==this.handlerMode?this.handler=new OpenLayers.Handler.Click(this,{click:this.handleEvent},this.handlerOptions):"move"==this.handlerMode&&(this.handler=new OpenLayers.Handler.Hover(this,{pause:this.handleEvent,move:this.handleEvent},this.handlerOptions)),this.handler?!0:!1},initialize:function(t){t=t||{},t.handlerOptions=t.handlerOptions||this.defaultHandlerOptions,OpenLayers.Control.prototype.initialize.apply(this,[t]),this.resetHandler()},handleEvent:function(t){if(null==t)return void this.reset();var e=this.map.getLonLatFromPixel(t.xy);if(e){var i=this.findLayers();if(i.length>0){for(var n,s,r={},o=0,a=i.length;a>o;o++)n=i[o],s=OpenLayers.Util.indexOf(this.map.layers,n),r[s]=n.getFeatureInfo(e);this.callback(r,e,t.xy)}}},callback:function(){},reset:function(){this.callback(null)},findLayers:function(){for(var t,e=this.layers||this.map.layers,i=[],n=e.length-1;n>=0;--n)t=e[n],t instanceof OpenLayers.Layer.UTFGrid&&i.push(t);return i},CLASS_NAME:"OpenLayers.Control.UTFGrid"}),OpenLayers.Format.CQL=function(){function t(t,e){return e instanceof RegExp?e.exec(t):e(t)}function e(e,i){var n,s,o=i.length;for(n=0;o>n;n++){s=i[n];var a=r[s],l=t(e,a);if(l){var h=l[0],u=e.substr(h.length).replace(/^\s*/,"");return{type:s,text:h,remainder:u}}}var p="ERROR: In parsing: ["+e+"], expected one of: ";for(n=0;o>n;n++)s=i[n],p+="\n    "+s+": "+r[s];throw new Error(p)}function i(t){var i,n=[],s=["NOT","GEOMETRY","SPATIAL","PROPERTY","LPAREN"];do{if(i=e(t,s),t=i.remainder,s=o[i.type],"END"!=i.type&&!s)throw new Error("No follows list for "+i.type);n.push(i)}while("END"!=i.type);return n}function n(t){function e(){var t=n.pop();switch(t.type){case"LOGICAL":var i=e(),s=e();return new OpenLayers.Filter.Logical({filters:[s,i],type:h[t.text.toUpperCase()]});case"NOT":var r=e();return new OpenLayers.Filter.Logical({filters:[r],type:OpenLayers.Filter.Logical.NOT});case"BETWEEN":var o,l,u;return n.pop(),l=e(),o=e(),u=e(),new OpenLayers.Filter.Comparison({property:u,lowerBoundary:o,upperBoundary:l,type:OpenLayers.Filter.Comparison.BETWEEN});case"COMPARISON":var p=e(),u=e();return new OpenLayers.Filter.Comparison({property:u,value:p,type:a[t.text.toUpperCase()]});case"IS_NULL":var u=e();return new OpenLayers.Filter.Comparison({property:u,type:a[t.text.toUpperCase()]});case"VALUE":var c=t.text.match(/^'(.*)'$/);return c?c[1].replace(/''/g,"'"):Number(t.text);case"SPATIAL":switch(t.text.toUpperCase()){case"BBOX":var d=e(),m=e(),f=e(),y=e(),g=e();return new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.BBOX,property:g,value:OpenLayers.Bounds.fromArray([y,f,m,d])});case"INTERSECTS":var p=e(),u=e();return new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.INTERSECTS,property:u,value:p});case"WITHIN":var p=e(),u=e();return new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.WITHIN,property:u,value:p});case"CONTAINS":var p=e(),u=e();return new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.CONTAINS,property:u,value:p});case"DWITHIN":var v=e(),p=e(),u=e();return new OpenLayers.Filter.Spatial({type:OpenLayers.Filter.Spatial.DWITHIN,value:p,property:u,distance:Number(v)})}case"GEOMETRY":return OpenLayers.Geometry.fromWKT(t.text);default:return t.text}}for(var i=[],n=[];t.length;){var s=t.shift();switch(s.type){case"PROPERTY":case"GEOMETRY":case"VALUE":n.push(s);break;case"COMPARISON":case"BETWEEN":case"IS_NULL":case"LOGICAL":for(var r=p[s.type];i.length>0&&p[i[i.length-1].type]<=r;)n.push(i.pop());i.push(s);break;case"SPATIAL":case"NOT":case"LPAREN":i.push(s);break;case"RPAREN":for(;i.length>0&&"LPAREN"!=i[i.length-1].type;)n.push(i.pop());
i.pop(),i.length>0&&"SPATIAL"==i[i.length-1].type&&n.push(i.pop());case"COMMA":case"END":break;default:throw new Error("Unknown token type "+s.type)}}for(;i.length>0;)n.push(i.pop());var o=e();if(n.length>0){for(var l="Remaining tokens after building AST: \n",u=n.length-1;u>=0;u--)l+=n[u].type+": "+n[u].text+"\n";throw new Error(l)}return o}var s,r={PROPERTY:/^[_a-zA-Z]\w*/,COMPARISON:/^(=|<>|<=|<|>=|>|LIKE)/i,IS_NULL:/^IS NULL/i,COMMA:/^,/,LOGICAL:/^(AND|OR)/i,VALUE:/^('([^']|'')*'|\d+(\.\d*)?|\.\d+)/,LPAREN:/^\(/,RPAREN:/^\)/,SPATIAL:/^(BBOX|INTERSECTS|DWITHIN|WITHIN|CONTAINS)/i,NOT:/^NOT/i,BETWEEN:/^BETWEEN/i,GEOMETRY:function(t){var e=/^(POINT|LINESTRING|POLYGON|MULTIPOINT|MULTILINESTRING|MULTIPOLYGON|GEOMETRYCOLLECTION)/.exec(t);if(e){var i=t.length,n=t.indexOf("(",e[0].length);if(n>-1)for(var s=1;i>n&&s>0;)switch(n++,t.charAt(n)){case"(":s++;break;case")":s--}return[t.substr(0,n+1)]}},END:/^$/},o={LPAREN:["GEOMETRY","SPATIAL","PROPERTY","VALUE","LPAREN"],RPAREN:["NOT","LOGICAL","END","RPAREN"],PROPERTY:["COMPARISON","BETWEEN","COMMA","IS_NULL"],BETWEEN:["VALUE"],IS_NULL:["END"],COMPARISON:["VALUE"],COMMA:["GEOMETRY","VALUE","PROPERTY"],VALUE:["LOGICAL","COMMA","RPAREN","END"],SPATIAL:["LPAREN"],LOGICAL:["NOT","VALUE","SPATIAL","PROPERTY","LPAREN"],NOT:["PROPERTY","LPAREN"],GEOMETRY:["COMMA","RPAREN"]},a={"=":OpenLayers.Filter.Comparison.EQUAL_TO,"<>":OpenLayers.Filter.Comparison.NOT_EQUAL_TO,"<":OpenLayers.Filter.Comparison.LESS_THAN,"<=":OpenLayers.Filter.Comparison.LESS_THAN_OR_EQUAL_TO,">":OpenLayers.Filter.Comparison.GREATER_THAN,">=":OpenLayers.Filter.Comparison.GREATER_THAN_OR_EQUAL_TO,LIKE:OpenLayers.Filter.Comparison.LIKE,BETWEEN:OpenLayers.Filter.Comparison.BETWEEN,"IS NULL":OpenLayers.Filter.Comparison.IS_NULL},l={},h={AND:OpenLayers.Filter.Logical.AND,OR:OpenLayers.Filter.Logical.OR},u={},p={RPAREN:3,LOGICAL:2,COMPARISON:1};for(s in a)a.hasOwnProperty(s)&&(l[a[s]]=s);for(s in h)h.hasOwnProperty(s)&&(u[h[s]]=s);return OpenLayers.Class(OpenLayers.Format,{read:function(t){var e=n(i(t));return this.keepData&&(this.data=e),e},write:function(t){if(t instanceof OpenLayers.Geometry)return t.toString();switch(t.CLASS_NAME){case"OpenLayers.Filter.Spatial":switch(t.type){case OpenLayers.Filter.Spatial.BBOX:return"BBOX("+t.property+","+t.value.toBBOX()+")";case OpenLayers.Filter.Spatial.DWITHIN:return"DWITHIN("+t.property+", "+this.write(t.value)+", "+t.distance+")";case OpenLayers.Filter.Spatial.WITHIN:return"WITHIN("+t.property+", "+this.write(t.value)+")";case OpenLayers.Filter.Spatial.INTERSECTS:return"INTERSECTS("+t.property+", "+this.write(t.value)+")";case OpenLayers.Filter.Spatial.CONTAINS:return"CONTAINS("+t.property+", "+this.write(t.value)+")";default:throw new Error("Unknown spatial filter type: "+t.type)}case"OpenLayers.Filter.Logical":if(t.type==OpenLayers.Filter.Logical.NOT)return"NOT ("+this.write(t.filters[0])+")";for(var e="(",i=!0,n=0;n<t.filters.length;n++)i?i=!1:e+=") "+u[t.type]+" (",e+=this.write(t.filters[n]);return e+")";case"OpenLayers.Filter.Comparison":return t.type==OpenLayers.Filter.Comparison.BETWEEN?t.property+" BETWEEN "+this.write(t.lowerBoundary)+" AND "+this.write(t.upperBoundary):null!==t.value?t.property+" "+l[t.type]+" "+this.write(t.value):t.property+" "+l[t.type];case void 0:if("string"==typeof t)return"'"+t.replace(/'/g,"''")+"'";if("number"==typeof t)return String(t);default:throw new Error("Can't encode: "+t.CLASS_NAME+" "+t)}},CLASS_NAME:"OpenLayers.Format.CQL"})}(),OpenLayers.Control.Split=OpenLayers.Class(OpenLayers.Control,{layer:null,source:null,sourceOptions:null,tolerance:null,edge:!0,deferDelete:!1,mutual:!0,targetFilter:null,sourceFilter:null,handler:null,initialize:function(t){OpenLayers.Control.prototype.initialize.apply(this,[t]),this.options=t||{},this.options.source&&this.setSource(this.options.source)},setSource:function(t){this.active?(this.deactivate(),this.handler&&(this.handler.destroy(),delete this.handler),this.source=t,this.activate()):this.source=t},activate:function(){var t=OpenLayers.Control.prototype.activate.call(this);return t&&(this.source?this.source.events&&this.source.events.on({sketchcomplete:this.onSketchComplete,afterfeaturemodified:this.afterFeatureModified,scope:this}):(this.handler||(this.handler=new OpenLayers.Handler.Path(this,{done:function(t){this.onSketchComplete({feature:new OpenLayers.Feature.Vector(t)})}},{layerOptions:this.sourceOptions})),this.handler.activate())),t},deactivate:function(){var t=OpenLayers.Control.prototype.deactivate.call(this);return t&&this.source&&this.source.events&&this.source.events.un({sketchcomplete:this.onSketchComplete,afterfeaturemodified:this.afterFeatureModified,scope:this}),t},onSketchComplete:function(t){return this.feature=null,!this.considerSplit(t.feature)},afterFeatureModified:function(t){if(t.modified){var e=t.feature;"function"==typeof e.geometry.split&&(this.feature=t.feature,this.considerSplit(t.feature))}},removeByGeometry:function(t,e){for(var i=0,n=t.length;n>i;++i)if(t[i].geometry===e){t.splice(i,1);break}},isEligible:function(t){return t.geometry?t.state!==OpenLayers.State.DELETE&&"function"==typeof t.geometry.split&&this.feature!==t&&(!this.targetFilter||this.targetFilter.evaluate(t.attributes)):!1},considerSplit:function(t){var e=!1,i=!1;if(!this.sourceFilter||this.sourceFilter.evaluate(t.attributes)){for(var n,s,r,o,a,l,h,u=this.layer&&this.layer.features||[],p=[],c=[],d=this.layer===this.source&&this.mutual,m={edge:this.edge,tolerance:this.tolerance,mutual:d},f=[t.geometry],y=0,g=u.length;g>y;++y)if(o=u[y],this.isEligible(o)){a=[o.geometry];for(var v=0;v<f.length;++v){l=f[v];for(var L=0;L<a.length;++L)n=a[L],l.getBounds().intersectsBounds(n.getBounds())&&(s=l.split(n,m),s&&(r=this.events.triggerEvent("beforesplit",{source:t,target:o}),r!==!1&&(d&&(h=s[0],h.length>1&&(h.unshift(v,1),Array.prototype.splice.apply(f,h),v+=h.length-3),s=s[1]),s.length>1&&(s.unshift(L,1),Array.prototype.splice.apply(a,s),L+=s.length-3))))}a&&a.length>1&&(this.geomsToFeatures(o,a),this.events.triggerEvent("split",{original:o,features:a}),Array.prototype.push.apply(p,a),c.push(o),i=!0)}if(f&&f.length>1&&(this.geomsToFeatures(t,f),this.events.triggerEvent("split",{original:t,features:f}),Array.prototype.push.apply(p,f),c.push(t),e=!0),e||i){if(this.deferDelete){for(var _,O=[],y=0,g=c.length;g>y;++y)_=c[y],_.state===OpenLayers.State.INSERT?O.push(_):(_.state=OpenLayers.State.DELETE,this.layer.drawFeature(_));this.layer.destroyFeatures(O,{silent:!0});for(var y=0,g=p.length;g>y;++y)p[y].state=OpenLayers.State.INSERT}else this.layer.destroyFeatures(c,{silent:!0});this.layer.addFeatures(p,{silent:!0}),this.events.triggerEvent("aftersplit",{source:t,features:p})}}return e},geomsToFeatures:function(t,e){var i=t.clone();delete i.geometry;for(var n,s=0,r=e.length;r>s;++s)n=i.clone(),n.geometry=e[s],n.state=OpenLayers.State.INSERT,e[s]=n},destroy:function(){this.active&&this.deactivate(),OpenLayers.Control.prototype.destroy.call(this)},CLASS_NAME:"OpenLayers.Control.Split"}),OpenLayers.Layer.WMTS=OpenLayers.Class(OpenLayers.Layer.Grid,{isBaseLayer:!0,version:"1.0.0",requestEncoding:"KVP",url:null,layer:null,matrixSet:null,style:null,format:"image/jpeg",tileOrigin:null,tileFullExtent:null,formatSuffix:null,matrixIds:null,dimensions:null,params:null,zoomOffset:0,serverResolutions:null,formatSuffixMap:{"image/png":"png","image/png8":"png","image/png24":"png","image/png32":"png",png:"png","image/jpeg":"jpg","image/jpg":"jpg",jpeg:"jpg",jpg:"jpg"},matrix:null,initialize:function(t){var e={url:!0,layer:!0,style:!0,matrixSet:!0};for(var i in e)if(!(i in t))throw new Error("Missing property '"+i+"' in layer configuration.");t.params=OpenLayers.Util.upperCaseObject(t.params);var n=[t.name,t.url,t.params,t];if(OpenLayers.Layer.Grid.prototype.initialize.apply(this,n),this.formatSuffix||(this.formatSuffix=this.formatSuffixMap[this.format]||this.format.split("/").pop()),this.matrixIds){var s=this.matrixIds.length;if(s&&"string"==typeof this.matrixIds[0]){var r=this.matrixIds;this.matrixIds=new Array(s);for(var o=0;s>o;++o)this.matrixIds[o]={identifier:r[o]}}}},setMap:function(){OpenLayers.Layer.Grid.prototype.setMap.apply(this,arguments)},updateMatrixProperties:function(){this.matrix=this.getMatrix(),this.matrix&&(this.matrix.topLeftCorner&&(this.tileOrigin=this.matrix.topLeftCorner),this.matrix.tileWidth&&this.matrix.tileHeight&&(this.tileSize=new OpenLayers.Size(this.matrix.tileWidth,this.matrix.tileHeight)),this.tileOrigin||(this.tileOrigin=new OpenLayers.LonLat(this.maxExtent.left,this.maxExtent.top)),this.tileFullExtent||(this.tileFullExtent=this.maxExtent))},moveTo:function(t,e){return(e||!this.matrix)&&this.updateMatrixProperties(),OpenLayers.Layer.Grid.prototype.moveTo.apply(this,arguments)},clone:function(t){return null==t&&(t=new OpenLayers.Layer.WMTS(this.options)),t=OpenLayers.Layer.Grid.prototype.clone.apply(this,[t])},getIdentifier:function(){return this.getServerZoom()},getMatrix:function(){var t;if(this.matrixIds&&0!==this.matrixIds.length)if("scaleDenominator"in this.matrixIds[0])for(var e,i=OpenLayers.METERS_PER_INCH*OpenLayers.INCHES_PER_UNIT[this.units]*this.getServerResolution()/28e-5,n=Number.POSITIVE_INFINITY,s=0,r=this.matrixIds.length;r>s;++s)e=Math.abs(1-this.matrixIds[s].scaleDenominator/i),n>e&&(n=e,t=this.matrixIds[s]);else t=this.matrixIds[this.getIdentifier()];else t={identifier:this.getIdentifier()};return t},getTileInfo:function(t){var e=this.getServerResolution(),i=(t.lon-this.tileOrigin.lon)/(e*this.tileSize.w),n=(this.tileOrigin.lat-t.lat)/(e*this.tileSize.h),s=Math.floor(i),r=Math.floor(n);return{col:s,row:r,i:Math.floor((i-s)*this.tileSize.w),j:Math.floor((n-r)*this.tileSize.h)}},getURL:function(t){t=this.adjustBounds(t);var e="";if(!this.tileFullExtent||this.tileFullExtent.intersectsBounds(t)){var i,n=t.getCenterLonLat(),s=this.getTileInfo(n),r=(this.matrix.identifier,this.dimensions);if(e=OpenLayers.Util.isArray(this.url)?this.selectUrl([this.version,this.style,this.matrixSet,this.matrix.identifier,s.row,s.col].join(","),this.url):this.url,"REST"===this.requestEncoding.toUpperCase())if(i=this.params,-1!==e.indexOf("{")){var o=e.replace(/\{/g,"${"),a={style:this.style,Style:this.style,TileMatrixSet:this.matrixSet,TileMatrix:this.matrix.identifier,TileRow:s.row,TileCol:s.col};if(r){var l,h;for(h=r.length-1;h>=0;--h)l=r[h],a[l]=i[l.toUpperCase()]}e=OpenLayers.String.format(o,a)}else{var u=this.version+"/"+this.layer+"/"+this.style+"/";if(r)for(var h=0;h<r.length;h++)i[r[h]]&&(u=u+i[r[h]]+"/");u=u+this.matrixSet+"/"+this.matrix.identifier+"/"+s.row+"/"+s.col+"."+this.formatSuffix,e.match(/\/$/)||(e+="/"),e+=u}else"KVP"===this.requestEncoding.toUpperCase()&&(i={SERVICE:"WMTS",REQUEST:"GetTile",VERSION:this.version,LAYER:this.layer,STYLE:this.style,TILEMATRIXSET:this.matrixSet,TILEMATRIX:this.matrix.identifier,TILEROW:s.row,TILECOL:s.col,FORMAT:this.format},e=OpenLayers.Layer.Grid.prototype.getFullRequestString.apply(this,[i]))}return e},mergeNewParams:function(t){return"KVP"===this.requestEncoding.toUpperCase()?OpenLayers.Layer.Grid.prototype.mergeNewParams.apply(this,[OpenLayers.Util.upperCaseObject(t)]):void 0},CLASS_NAME:"OpenLayers.Layer.WMTS"}),OpenLayers.Protocol.SOS.v1_0_0=OpenLayers.Class(OpenLayers.Protocol,{fois:null,formatOptions:null,initialize:function(t){OpenLayers.Protocol.prototype.initialize.apply(this,[t]),t.format||(this.format=new OpenLayers.Format.SOSGetFeatureOfInterest(this.formatOptions))},destroy:function(){this.options&&!this.options.format&&this.format.destroy(),this.format=null,OpenLayers.Protocol.prototype.destroy.apply(this)},read:function(t){t=OpenLayers.Util.extend({},t),OpenLayers.Util.applyDefaults(t,this.options||{});var e=new OpenLayers.Protocol.Response({requestType:"read"}),i=this.format,n=OpenLayers.Format.XML.prototype.write.apply(i,[i.writeNode("sos:GetFeatureOfInterest",{fois:this.fois})]);return e.priv=OpenLayers.Request.POST({url:t.url,callback:this.createCallback(this.handleRead,e,t),data:n}),e},handleRead:function(t,e){if(e.callback){var i=t.priv;i.status>=200&&i.status<300?(t.features=this.parseFeatures(i),t.code=OpenLayers.Protocol.Response.SUCCESS):t.code=OpenLayers.Protocol.Response.FAILURE,e.callback.call(e.scope,t)}},parseFeatures:function(t){var e=t.responseXML;return e&&e.documentElement||(e=t.responseText),!e||e.length<=0?null:this.format.read(e)},CLASS_NAME:"OpenLayers.Protocol.SOS.v1_0_0"}),OpenLayers.Layer.KaMapCache=OpenLayers.Class(OpenLayers.Layer.KaMap,{IMAGE_EXTENSIONS:{jpeg:"jpg",gif:"gif",png:"png",png8:"png",png24:"png",dithered:"png"},DEFAULT_FORMAT:"jpeg",initialize:function(){OpenLayers.Layer.KaMap.prototype.initialize.apply(this,arguments),this.extension=this.IMAGE_EXTENSIONS[this.params.i.toLowerCase()||this.DEFAULT_FORMAT]},getURL:function(t){t=this.adjustBounds(t);var e=this.map.getResolution(),i=Math.round(1e4*this.map.getScale())/1e4,n=Math.round(t.left/e),s=-Math.round(t.top/e),r=Math.floor(n/this.tileSize.w/this.params.metaTileSize.w)*this.tileSize.w*this.params.metaTileSize.w,o=Math.floor(s/this.tileSize.h/this.params.metaTileSize.h)*this.tileSize.h*this.params.metaTileSize.h,a=["/",this.params.map,"/",i,"/",this.params.g.replace(/\s/g,"_"),"/def/t",o,"/l",r,"/t",s,"l",n,".",this.extension],l=this.url;return OpenLayers.Util.isArray(l)&&(l=this.selectUrl(a.join(""),l)),l+a.join("")},CLASS_NAME:"OpenLayers.Layer.KaMapCache"}),OpenLayers.Layer.TileCache=OpenLayers.Class(OpenLayers.Layer.Grid,{isBaseLayer:!0,format:"image/png",serverResolutions:null,initialize:function(t,e,i,n){this.layername=i,OpenLayers.Layer.Grid.prototype.initialize.apply(this,[t,e,{},n]),this.extension=this.format.split("/")[1].toLowerCase(),this.extension="jpg"==this.extension?"jpeg":this.extension},clone:function(t){return null==t&&(t=new OpenLayers.Layer.TileCache(this.name,this.url,this.layername,this.getOptions())),t=OpenLayers.Layer.Grid.prototype.clone.apply(this,[t])},getURL:function(t){var e=this.getServerResolution(),i=this.maxExtent,n=this.tileSize,s=Math.round((t.left-i.left)/(e*n.w)),r=Math.round((t.bottom-i.bottom)/(e*n.h)),o=null!=this.serverResolutions?OpenLayers.Util.indexOf(this.serverResolutions,e):this.map.getZoom(),a=[this.layername,OpenLayers.Number.zeroPad(o,2),OpenLayers.Number.zeroPad(parseInt(s/1e6),3),OpenLayers.Number.zeroPad(parseInt(s/1e3)%1e3,3),OpenLayers.Number.zeroPad(parseInt(s)%1e3,3),OpenLayers.Number.zeroPad(parseInt(r/1e6),3),OpenLayers.Number.zeroPad(parseInt(r/1e3)%1e3,3),OpenLayers.Number.zeroPad(parseInt(r)%1e3,3)+"."+this.extension],l=a.join("/"),h=this.url;return OpenLayers.Util.isArray(h)&&(h=this.selectUrl(l,h)),h="/"==h.charAt(h.length-1)?h:h+"/",h+l},CLASS_NAME:"OpenLayers.Layer.TileCache"}),OpenLayers.Format.WMSCapabilities.v1_1_1=OpenLayers.Class(OpenLayers.Format.WMSCapabilities.v1_1,{version:"1.1.1",readers:{wms:OpenLayers.Util.applyDefaults({SRS:function(t,e){e.srs[this.getChildValue(t)]=!0}},OpenLayers.Format.WMSCapabilities.v1_1.prototype.readers.wms)},CLASS_NAME:"OpenLayers.Format.WMSCapabilities.v1_1_1"}),OpenLayers.Format.WMSCapabilities.v1_1_1_WMSC=OpenLayers.Class(OpenLayers.Format.WMSCapabilities.v1_1_1,{version:"1.1.1",profile:"WMSC",readers:{wms:OpenLayers.Util.applyDefaults({VendorSpecificCapabilities:function(t,e){e.vendorSpecific={tileSets:[]},this.readChildNodes(t,e.vendorSpecific)},TileSet:function(t,e){var i={srs:{},bbox:{},resolutions:[]};this.readChildNodes(t,i),e.tileSets.push(i)},Resolutions:function(t,e){for(var i=this.getChildValue(t).split(" "),n=0,s=i.length;s>n;n++)""!=i[n]&&e.resolutions.push(parseFloat(i[n]))},Width:function(t,e){e.width=parseInt(this.getChildValue(t))},Height:function(t,e){e.height=parseInt(this.getChildValue(t))},Layers:function(t,e){e.layers=this.getChildValue(t)},Styles:function(t,e){e.styles=this.getChildValue(t)}},OpenLayers.Format.WMSCapabilities.v1_1_1.prototype.readers.wms)},CLASS_NAME:"OpenLayers.Format.WMSCapabilities.v1_1_1_WMSC"}),OpenLayers.Control.LayerSwitcher=OpenLayers.Class(OpenLayers.Control,{layerStates:null,layersDiv:null,baseLayersDiv:null,baseLayers:null,dataLbl:null,dataLayersDiv:null,dataLayers:null,minimizeDiv:null,maximizeDiv:null,ascending:!0,initialize:function(){OpenLayers.Control.prototype.initialize.apply(this,arguments),this.layerStates=[]},destroy:function(){this.clearLayersArray("base"),this.clearLayersArray("data"),this.map.events.un({buttonclick:this.onButtonClick,addlayer:this.redraw,changelayer:this.redraw,removelayer:this.redraw,changebaselayer:this.redraw,scope:this}),this.events.unregister("buttonclick",this,this.onButtonClick),OpenLayers.Control.prototype.destroy.apply(this,arguments)},setMap:function(){OpenLayers.Control.prototype.setMap.apply(this,arguments),this.map.events.on({addlayer:this.redraw,changelayer:this.redraw,removelayer:this.redraw,changebaselayer:this.redraw,scope:this}),this.outsideViewport?(this.events.attachToElement(this.div),this.events.register("buttonclick",this,this.onButtonClick)):this.map.events.register("buttonclick",this,this.onButtonClick)},draw:function(){return OpenLayers.Control.prototype.draw.apply(this),this.loadContents(),this.outsideViewport||this.minimizeControl(),this.redraw(),this.div},onButtonClick:function(t){var e=t.buttonElement;e===this.minimizeDiv?this.minimizeControl():e===this.maximizeDiv?this.maximizeControl():e._layerSwitcher===this.id&&(e["for"]&&(e=document.getElementById(e["for"])),e.disabled||("radio"==e.type?(e.checked=!0,this.map.setBaseLayer(this.map.getLayer(e._layer))):(e.checked=!e.checked,this.updateMap())))},clearLayersArray:function(t){this[t+"LayersDiv"].innerHTML="",this[t+"Layers"]=[]},checkRedraw:function(){if(!this.layerStates.length||this.map.layers.length!=this.layerStates.length)return!0;for(var t=0,e=this.layerStates.length;e>t;t++){var i=this.layerStates[t],n=this.map.layers[t];if(i.name!=n.name||i.inRange!=n.inRange||i.id!=n.id||i.visibility!=n.visibility)return!0}return!1},redraw:function(){if(!this.checkRedraw())return this.div;this.clearLayersArray("base"),this.clearLayersArray("data");var t=!1,e=!1,i=this.map.layers.length;this.layerStates=new Array(i);for(var n=0;i>n;n++){var s=this.map.layers[n];this.layerStates[n]={name:s.name,visibility:s.visibility,inRange:s.inRange,id:s.id}}var r=this.map.layers.slice();this.ascending||r.reverse();for(var n=0,i=r.length;i>n;n++){var s=r[n],o=s.isBaseLayer;if(s.displayInLayerSwitcher){o?e=!0:t=!0;var a=o?s==this.map.baseLayer:s.getVisibility(),l=document.createElement("input"),h=OpenLayers.Util.createUniqueID(this.id+"_input_");l.id=h,l.name=o?this.id+"_baseLayers":s.name,l.type=o?"radio":"checkbox",l.value=s.name,l.checked=a,l.defaultChecked=a,l.className="olButton",l._layer=s.id,l._layerSwitcher=this.id,o||s.inRange||(l.disabled=!0);var u=document.createElement("label");u["for"]=l.id,OpenLayers.Element.addClass(u,"labelSpan olButton"),u._layer=s.id,u._layerSwitcher=this.id,o||s.inRange||(u.style.color="gray"),u.innerHTML=s.name,u.style.verticalAlign=o?"bottom":"baseline";var p=document.createElement("br"),c=o?this.baseLayers:this.dataLayers;c.push({layer:s,inputElem:l,labelSpan:u});var d=o?this.baseLayersDiv:this.dataLayersDiv;d.appendChild(l),d.appendChild(u),d.appendChild(p)}}return this.dataLbl.style.display=t?"":"none",this.baseLbl.style.display=e?"":"none",this.div},updateMap:function(){for(var t=0,e=this.baseLayers.length;e>t;t++){var i=this.baseLayers[t];i.inputElem.checked&&this.map.setBaseLayer(i.layer,!1)}for(var t=0,e=this.dataLayers.length;e>t;t++){var i=this.dataLayers[t];i.layer.setVisibility(i.inputElem.checked)}},maximizeControl:function(t){this.div.style.width="",this.div.style.height="",this.showControls(!1),null!=t&&OpenLayers.Event.stop(t)},minimizeControl:function(t){this.div.style.width="0px",this.div.style.height="0px",this.showControls(!0),null!=t&&OpenLayers.Event.stop(t)},showControls:function(t){this.maximizeDiv.style.display=t?"":"none",this.minimizeDiv.style.display=t?"none":"",this.layersDiv.style.display=t?"none":""},loadContents:function(){this.layersDiv=document.createElement("div"),this.layersDiv.id=this.id+"_layersDiv",OpenLayers.Element.addClass(this.layersDiv,"layersDiv"),this.baseLbl=document.createElement("div"),this.baseLbl.innerHTML=OpenLayers.i18n("Base Layer"),OpenLayers.Element.addClass(this.baseLbl,"baseLbl"),this.baseLayersDiv=document.createElement("div"),OpenLayers.Element.addClass(this.baseLayersDiv,"baseLayersDiv"),this.dataLbl=document.createElement("div"),this.dataLbl.innerHTML=OpenLayers.i18n("Overlays"),OpenLayers.Element.addClass(this.dataLbl,"dataLbl"),this.dataLayersDiv=document.createElement("div"),OpenLayers.Element.addClass(this.dataLayersDiv,"dataLayersDiv"),this.ascending?(this.layersDiv.appendChild(this.baseLbl),this.layersDiv.appendChild(this.baseLayersDiv),this.layersDiv.appendChild(this.dataLbl),this.layersDiv.appendChild(this.dataLayersDiv)):(this.layersDiv.appendChild(this.dataLbl),this.layersDiv.appendChild(this.dataLayersDiv),this.layersDiv.appendChild(this.baseLbl),this.layersDiv.appendChild(this.baseLayersDiv)),this.div.appendChild(this.layersDiv);var t=OpenLayers.Util.getImageLocation("layer-switcher-maximize.png");this.maximizeDiv=OpenLayers.Util.createAlphaImageDiv("OpenLayers_Control_MaximizeDiv",null,null,t,"absolute"),OpenLayers.Element.addClass(this.maximizeDiv,"maximizeDiv olButton"),this.maximizeDiv.style.display="none",this.div.appendChild(this.maximizeDiv);var t=OpenLayers.Util.getImageLocation("layer-switcher-minimize.png");this.minimizeDiv=OpenLayers.Util.createAlphaImageDiv("OpenLayers_Control_MinimizeDiv",null,null,t,"absolute"),OpenLayers.Element.addClass(this.minimizeDiv,"minimizeDiv olButton"),this.minimizeDiv.style.display="none",this.div.appendChild(this.minimizeDiv)},CLASS_NAME:"OpenLayers.Control.LayerSwitcher"}),OpenLayers.Tile.Image.IFrame={useIFrame:null,blankImageUrl:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAQAIBRAA7",draw:function(){var t=OpenLayers.Tile.Image.prototype.shouldDraw.call(this);if(t){var e=this.layer.getURL(this.bounds),i=this.useIFrame;this.useIFrame=null!==this.maxGetUrlLength&&!this.layer.async&&e.length>this.maxGetUrlLength;var n=i&&!this.useIFrame,s=!i&&this.useIFrame;(n||s)&&(this.imgDiv&&this.imgDiv.parentNode===this.frame&&this.frame.removeChild(this.imgDiv),this.imgDiv=null,n&&this.frame.removeChild(this.frame.firstChild))}return OpenLayers.Tile.Image.prototype.draw.apply(this,arguments)},getImage:function(){if(this.useIFrame===!0){if(!this.frame.childNodes.length){var t=document.createElement("div"),e=t.style;e.position="absolute",e.width="100%",e.height="100%",e.zIndex=1,e.backgroundImage="url("+this.blankImageUrl+")",this.frame.appendChild(t)}var i,n=this.id+"_iFrame";return parseFloat(navigator.appVersion.split("MSIE")[1])<9?(i=document.createElement('<iframe name="'+n+'">'),i.style.backgroundColor="#FFFFFF",i.style.filter="chroma(color=#FFFFFF)"):(i=document.createElement("iframe"),i.style.backgroundColor="transparent",i.name=n),i.scrolling="no",i.marginWidth="0px",i.marginHeight="0px",i.frameBorder="0",i.style.position="absolute",i.style.width="100%",i.style.height="100%",this.layer.opacity<1&&OpenLayers.Util.modifyDOMElement(i,null,null,null,null,null,null,this.layer.opacity),this.frame.appendChild(i),this.imgDiv=i,i}return OpenLayers.Tile.Image.prototype.getImage.apply(this,arguments)},createRequestForm:function(){var t=document.createElement("form");t.method="POST";var e=this.layer.params._OLSALT;e=(e?e+"_":"")+this.bounds.toBBOX(),t.action=OpenLayers.Util.urlAppend(this.layer.url,e),t.target=this.id+"_iFrame";var i,n=(this.layer.getImageSize(),OpenLayers.Util.getParameters(this.url));for(var s in n)i=document.createElement("input"),i.type="hidden",i.name=s,i.value=n[s],t.appendChild(i);return t},setImgSrc:function(t){if(this.useIFrame===!0)if(t){var e=this.createRequestForm();this.frame.appendChild(e),e.submit(),this.frame.removeChild(e)}else this.imgDiv.parentNode===this.frame&&(this.frame.removeChild(this.imgDiv),this.imgDiv=null);else OpenLayers.Tile.Image.prototype.setImgSrc.apply(this,arguments)},onImageLoad:function(){OpenLayers.Tile.Image.prototype.onImageLoad.apply(this,arguments),this.useIFrame===!0&&(this.imgDiv.style.opacity=1,this.frame.style.opacity=this.layer.opacity)},createBackBuffer:function(){var t;return this.useIFrame===!1&&(t=OpenLayers.Tile.Image.prototype.createBackBuffer.call(this)),t}},OpenLayers.Format.Atom=OpenLayers.Class(OpenLayers.Format.XML,{namespaces:{atom:"http://www.w3.org/2005/Atom",georss:"http://www.georss.org/georss"},feedTitle:"untitled",defaultEntryTitle:"untitled",gmlParser:null,xy:!1,read:function(t){return"string"==typeof t&&(t=OpenLayers.Format.XML.prototype.read.apply(this,[t])),this.parseFeatures(t)},write:function(t){var e;if(OpenLayers.Util.isArray(t)){e=this.createElementNSPlus("atom:feed"),e.appendChild(this.createElementNSPlus("atom:title",{value:this.feedTitle}));for(var i=0,n=t.length;n>i;i++)e.appendChild(this.buildEntryNode(t[i]))}else e=this.buildEntryNode(t);return OpenLayers.Format.XML.prototype.write.apply(this,[e])},buildContentNode:function(t){var e=this.createElementNSPlus("atom:content",{attributes:{type:t.type||null}});if(t.src)e.setAttribute("src",t.src);else if("text"==t.type||null==t.type)e.appendChild(this.createTextNode(t.value));else if("html"==t.type){if("string"!=typeof t.value)throw"HTML content must be in form of an escaped string";e.appendChild(this.createTextNode(t.value))}else e.appendChild("xhtml"==t.type?t.value:"xhtml"==t.type||t.type.match(/(\+|\/)xml$/)?t.value:this.createTextNode(t.value));return e},buildEntryNode:function(t){var e=t.attributes,i=e.atom||{},n=this.createElementNSPlus("atom:entry");if(i.authors)for(var s=OpenLayers.Util.isArray(i.authors)?i.authors:[i.authors],r=0,o=s.length;o>r;r++)n.appendChild(this.buildPersonConstructNode("author",s[r]));if(i.categories)for(var a,l=OpenLayers.Util.isArray(i.categories)?i.categories:[i.categories],r=0,o=l.length;o>r;r++)a=l[r],n.appendChild(this.createElementNSPlus("atom:category",{attributes:{term:a.term,scheme:a.scheme||null,label:a.label||null}}));if(i.content&&n.appendChild(this.buildContentNode(i.content)),i.contributors)for(var h=OpenLayers.Util.isArray(i.contributors)?i.contributors:[i.contributors],r=0,o=h.length;o>r;r++)n.appendChild(this.buildPersonConstructNode("contributor",h[r]));if(t.fid&&n.appendChild(this.createElementNSPlus("atom:id",{value:t.fid})),i.links)for(var u,p=OpenLayers.Util.isArray(i.links)?i.links:[i.links],r=0,o=p.length;o>r;r++)u=p[r],n.appendChild(this.createElementNSPlus("atom:link",{attributes:{href:u.href,rel:u.rel||null,type:u.type||null,hreflang:u.hreflang||null,title:u.title||null,length:u.length||null}}));if(i.published&&n.appendChild(this.createElementNSPlus("atom:published",{value:i.published})),i.rights&&n.appendChild(this.createElementNSPlus("atom:rights",{value:i.rights})),(i.summary||e.description)&&n.appendChild(this.createElementNSPlus("atom:summary",{value:i.summary||e.description})),n.appendChild(this.createElementNSPlus("atom:title",{value:i.title||e.title||this.defaultEntryTitle})),i.updated&&n.appendChild(this.createElementNSPlus("atom:updated",{value:i.updated})),t.geometry){var c=this.createElementNSPlus("georss:where");c.appendChild(this.buildGeometryNode(t.geometry)),n.appendChild(c)}return n},initGmlParser:function(){this.gmlParser=new OpenLayers.Format.GML.v3({xy:this.xy,featureNS:"http://example.com#feature",internalProjection:this.internalProjection,externalProjection:this.externalProjection})},buildGeometryNode:function(t){this.gmlParser||this.initGmlParser();var e=this.gmlParser.writeNode("feature:_geometry",t);return e.firstChild},buildPersonConstructNode:function(t,e){var i=["uri","email"],n=this.createElementNSPlus("atom:"+t);n.appendChild(this.createElementNSPlus("atom:name",{value:e.name}));for(var s=0,r=i.length;r>s;s++)e[i[s]]&&n.appendChild(this.createElementNSPlus("atom:"+i[s],{value:e[i[s]]}));return n},getFirstChildValue:function(t,e,i,n){var s,r=this.getElementsByTagNameNS(t,e,i);return s=r&&r.length>0?this.getChildValue(r[0],n):n},parseFeature:function(t){var e={},i=null,n=null,s=null,r=this.namespaces.atom;this.parsePersonConstructs(t,"author",e),n=this.getElementsByTagNameNS(t,r,"category"),n.length>0&&(e.categories=[]);for(var o=0,a=n.length;a>o;o++)i={},i.term=n[o].getAttribute("term"),s=n[o].getAttribute("scheme"),s&&(i.scheme=s),s=n[o].getAttribute("label"),s&&(i.label=s),e.categories.push(i);n=this.getElementsByTagNameNS(t,r,"content"),n.length>0&&(i={},s=n[0].getAttribute("type"),s&&(i.type=s),s=n[0].getAttribute("src"),s?i.src=s:(i.value="text"==i.type||"html"==i.type||null==i.type?this.getFirstChildValue(t,r,"content",null):"xhtml"==i.type||i.type.match(/(\+|\/)xml$/)?this.getChildEl(n[0]):this.getFirstChildValue(t,r,"content",null),e.content=i)),this.parsePersonConstructs(t,"contributor",e),e.id=this.getFirstChildValue(t,r,"id",null),n=this.getElementsByTagNameNS(t,r,"link"),n.length>0&&(e.links=new Array(n.length));for(var l=["rel","type","hreflang","title","length"],o=0,a=n.length;a>o;o++){i={},i.href=n[o].getAttribute("href");for(var h=0,u=l.length;u>h;h++)s=n[o].getAttribute(l[h]),s&&(i[l[h]]=s);e.links[o]=i}i=this.getFirstChildValue(t,r,"published",null),i&&(e.published=i),i=this.getFirstChildValue(t,r,"rights",null),i&&(e.rights=i),i=this.getFirstChildValue(t,r,"summary",null),i&&(e.summary=i),e.title=this.getFirstChildValue(t,r,"title",null),e.updated=this.getFirstChildValue(t,r,"updated",null);var p={title:e.title,description:e.summary,atom:e},c=this.parseLocations(t)[0],d=new OpenLayers.Feature.Vector(c,p);return d.fid=e.id,d},parseFeatures:function(t){var e=[],i=this.getElementsByTagNameNS(t,this.namespaces.atom,"entry");0==i.length&&(i=[t]);for(var n=0,s=i.length;s>n;n++)e.push(this.parseFeature(i[n]));return e},parseLocations:function(t){var e=this.namespaces.georss,i={components:[]},n=this.getElementsByTagNameNS(t,e,"where");if(n&&n.length>0){this.gmlParser||this.initGmlParser();for(var s=0,r=n.length;r>s;s++)this.gmlParser.readChildNodes(n[s],i)}var o=i.components,a=this.getElementsByTagNameNS(t,e,"point");if(a&&a.length>0)for(var s=0,r=a.length;r>s;s++){var l=OpenLayers.String.trim(a[s].firstChild.nodeValue).split(/\s+/);2!=l.length&&(l=OpenLayers.String.trim(a[s].firstChild.nodeValue).split(/\s*,\s*/)),o.push(new OpenLayers.Geometry.Point(l[1],l[0]))}var h=this.getElementsByTagNameNS(t,e,"line");if(h&&h.length>0)for(var u,p,c,s=0,r=h.length;r>s;s++){u=OpenLayers.String.trim(h[s].firstChild.nodeValue).split(/\s+/),c=[];for(var d=0,m=u.length;m>d;d+=2)p=new OpenLayers.Geometry.Point(u[d+1],u[d]),c.push(p);o.push(new OpenLayers.Geometry.LineString(c))}var f=this.getElementsByTagNameNS(t,e,"polygon");if(f&&f.length>0)for(var u,p,c,s=0,r=f.length;r>s;s++){u=OpenLayers.String.trim(f[s].firstChild.nodeValue).split(/\s+/),c=[];for(var d=0,m=u.length;m>d;d+=2)p=new OpenLayers.Geometry.Point(u[d+1],u[d]),c.push(p);o.push(new OpenLayers.Geometry.Polygon([new OpenLayers.Geometry.LinearRing(c)]))}if(this.internalProjection&&this.externalProjection)for(var s=0,r=o.length;r>s;s++)o[s]&&o[s].transform(this.externalProjection,this.internalProjection);return o},parsePersonConstructs:function(t,e,i){for(var n=[],s=this.namespaces.atom,r=this.getElementsByTagNameNS(t,s,e),o=["uri","email"],a=0,l=r.length;l>a;a++){var h={};h.name=this.getFirstChildValue(r[a],s,"name",null);for(var u=0,p=o.length;p>u;u++){var c=this.getFirstChildValue(r[a],s,o[u],null);c&&(h[o[u]]=c)}n.push(h)}n.length>0&&(i[e+"s"]=n)},CLASS_NAME:"OpenLayers.Format.Atom"}),OpenLayers.Control.KeyboardDefaults=OpenLayers.Class(OpenLayers.Control,{autoActivate:!0,slideFactor:75,observeElement:null,draw:function(){var t=this.observeElement||document;this.handler=new OpenLayers.Handler.Keyboard(this,{keydown:this.defaultKeyPress},{observeElement:t})},defaultKeyPress:function(t){var e,i=!0,n=OpenLayers.Event.element(t);if(!n||"INPUT"!=n.tagName&&"TEXTAREA"!=n.tagName&&"SELECT"!=n.tagName){switch(t.keyCode){case OpenLayers.Event.KEY_LEFT:this.map.pan(-this.slideFactor,0);
break;case OpenLayers.Event.KEY_RIGHT:this.map.pan(this.slideFactor,0);break;case OpenLayers.Event.KEY_UP:this.map.pan(0,-this.slideFactor);break;case OpenLayers.Event.KEY_DOWN:this.map.pan(0,this.slideFactor);break;case 33:e=this.map.getSize(),this.map.pan(0,-.75*e.h);break;case 34:e=this.map.getSize(),this.map.pan(0,.75*e.h);break;case 35:e=this.map.getSize(),this.map.pan(.75*e.w,0);break;case 36:e=this.map.getSize(),this.map.pan(-.75*e.w,0);break;case 43:case 61:case 187:case 107:this.map.zoomIn();break;case 45:case 109:case 189:case 95:this.map.zoomOut();break;default:i=!1}i&&OpenLayers.Event.stop(t)}},CLASS_NAME:"OpenLayers.Control.KeyboardDefaults"}),function(){"use strict";var t="undefined"!=typeof module&&module.exports,e="undefined"!=typeof Element&&"ALLOW_KEYBOARD_INPUT"in Element,i=function(){for(var t,e,i=[["requestFullscreen","exitFullscreen","fullscreenElement","fullscreenEnabled","fullscreenchange","fullscreenerror"],["webkitRequestFullscreen","webkitExitFullscreen","webkitFullscreenElement","webkitFullscreenEnabled","webkitfullscreenchange","webkitfullscreenerror"],["webkitRequestFullScreen","webkitCancelFullScreen","webkitCurrentFullScreenElement","webkitCancelFullScreen","webkitfullscreenchange","webkitfullscreenerror"],["mozRequestFullScreen","mozCancelFullScreen","mozFullScreenElement","mozFullScreenEnabled","mozfullscreenchange","mozfullscreenerror"],["msRequestFullscreen","msExitFullscreen","msFullscreenElement","msFullscreenEnabled","MSFullscreenChange","MSFullscreenError"]],n=0,s=i.length,r={};s>n;n++)if(t=i[n],t&&t[1]in document){for(n=0,e=t.length;e>n;n++)r[i[0][n]]=t[n];return r}return!1}(),n={request:function(t){var n=i.requestFullscreen;t=t||document.documentElement,/5\.1[\.\d]* Safari/.test(navigator.userAgent)?t[n]():t[n](e&&Element.ALLOW_KEYBOARD_INPUT)},exit:function(){document[i.exitFullscreen]()},toggle:function(t){this.isFullscreen?this.exit():this.request(t)},onchange:function(){},onerror:function(){},raw:i};return i?(Object.defineProperties(n,{isFullscreen:{get:function(){return!!document[i.fullscreenElement]}},element:{enumerable:!0,get:function(){return document[i.fullscreenElement]}},enabled:{enumerable:!0,get:function(){return!!document[i.fullscreenEnabled]}}}),document.addEventListener(i.fullscreenchange,function(t){n.onchange.call(n,t)}),document.addEventListener(i.fullscreenerror,function(t){n.onerror.call(n,t)}),void(t?module.exports=n:window.screenfull=n)):void(t?module.exports=!1:window.screenfull=!1)}(),L.Icon.Default.imagePath="lib/leaflet/dist/images";